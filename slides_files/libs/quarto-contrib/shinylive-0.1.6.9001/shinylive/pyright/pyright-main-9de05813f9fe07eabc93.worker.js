/*! For license information please see pyright-main-9de05813f9fe07eabc93.worker.js.LICENSE.txt */
(()=>{var __webpack_modules__={9742:(e,t)=>{"use strict";t.byteLength=function(e){var t=l(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,s=l(e),o=s[0],a=s[1],c=new r(function(e,t,n){return 3*(t+n)/4-n}(0,o,a)),u=0,p=a>0?o-4:o;for(n=0;n<p;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===a&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,c[u++]=255&t),1===a&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,i=e.length,r=i%3,s=[],o=16383,a=0,l=i-r;a<l;a+=o)s.push(c(e,a,a+o>l?l:a+o));return 1===r?(t=e[i-1],s.push(n[t>>2]+n[t<<4&63]+"==")):2===r&&(t=(e[i-2]<<8)+e[i-1],s.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),s.join("")};for(var n=[],i=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=s.length;o<a;++o)n[o]=s[o],i[s.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,i){for(var r,s,o=[],a=t;a<i;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(n[(s=r)>>18&63]+n[s>>12&63]+n[s>>6&63]+n[63&s]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},8764:(e,t,n)=>{"use strict";const i=n(9742),r=n(645),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50;const o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return p(e)}return c(e,t,n)}function c(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|f(e,t);let i=a(n);const r=i.write(e,t);return r!==n&&(i=i.slice(0,r)),i}(e,t);if(ArrayBuffer.isView(e))return function(e){if(J(e,Uint8Array)){const t=new Uint8Array(e);return h(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(J(e,ArrayBuffer)||e&&J(e.buffer,ArrayBuffer))return h(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(J(e,SharedArrayBuffer)||e&&J(e.buffer,SharedArrayBuffer)))return h(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return l.from(i,t,n);const r=function(e){if(l.isBuffer(e)){const t=0|m(e.length),n=a(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||Y(e.length)?a(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function p(e){return u(e),a(e<0?0:0|m(e))}function d(e){const t=e.length<0?0:0|m(e.length),n=a(t);for(let i=0;i<t;i+=1)n[i]=255&e[i];return n}function h(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let i;return i=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(i,l.prototype),i}function m(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function f(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||J(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===n)return 0;let r=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(e).length;default:if(r)return i?-1:H(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){let i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return A(this,t,n);case"utf8":case"utf-8":return w(this,t,n);case"ascii":return k(this,t,n);case"latin1":case"binary":return D(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function y(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function _(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Y(n=+n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:v(e,t,n,i,r);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,i,r){let s,o=1,a=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;o=2,a/=2,l/=2,n/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(r){let i=-1;for(s=n;s<a;s++)if(c(e,s)===c(t,-1===i?0:s-i)){if(-1===i&&(i=s),s-i+1===l)return i*o}else-1!==i&&(s-=s-i),i=-1}else for(n+l>a&&(n=a-l),s=n;s>=0;s--){let n=!0;for(let i=0;i<l;i++)if(c(e,s+i)!==c(t,i)){n=!1;break}if(n)return s}return-1}function T(e,t,n,i){n=Number(n)||0;const r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;const s=t.length;let o;for(i>s/2&&(i=s/2),o=0;o<i;++o){const i=parseInt(t.substr(2*o,2),16);if(Y(i))return o;e[n+o]=i}return o}function b(e,t,n,i){return K(H(t,e.length-n),e,n,i)}function I(e,t,n,i){return K(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function S(e,t,n,i){return K(G(t),e,n,i)}function x(e,t,n,i){return K(function(e,t){let n,i,r;const s=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),i=n>>8,r=n%256,s.push(r),s.push(i);return s}(t,e.length-n),e,n,i)}function C(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function w(e,t,n){n=Math.min(e.length,n);const i=[];let r=t;for(;r<n;){const t=e[r];let s=null,o=t>239?4:t>223?3:t>191?2:1;if(r+o<=n){let n,i,a,l;switch(o){case 1:t<128&&(s=t);break;case 2:n=e[r+1],128==(192&n)&&(l=(31&t)<<6|63&n,l>127&&(s=l));break;case 3:n=e[r+1],i=e[r+2],128==(192&n)&&128==(192&i)&&(l=(15&t)<<12|(63&n)<<6|63&i,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:n=e[r+1],i=e[r+2],a=e[r+3],128==(192&n)&&128==(192&i)&&128==(192&a)&&(l=(15&t)<<18|(63&n)<<12|(63&i)<<6|63&a,l>65535&&l<1114112&&(s=l))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|1023&s),i.push(s),r+=o}return function(e){const t=e.length;if(t<=E)return String.fromCharCode.apply(String,e);let n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=E));return n}(i)}t.kMaxLength=o,l.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return c(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return function(e,t,n){return u(e),e<=0?a(e):void 0!==t?"string"==typeof n?a(e).fill(t,n):a(e).fill(t):a(e)}(e,t,n)},l.allocUnsafe=function(e){return p(e)},l.allocUnsafeSlow=function(e){return p(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(J(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),J(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,i=t.length;for(let r=0,s=Math.min(n,i);r<s;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const i=l.allocUnsafe(t);let r=0;for(n=0;n<e.length;++n){let t=e[n];if(J(t,Uint8Array))r+t.length>i.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(i,r)):Uint8Array.prototype.set.call(i,t,r);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(i,r)}r+=t.length}return i},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?w(this,0,e):g.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},s&&(l.prototype[s]=l.prototype.inspect),l.prototype.compare=function(e,t,n,i,r){if(J(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(this===e)return 0;let s=(r>>>=0)-(i>>>=0),o=(n>>>=0)-(t>>>=0);const a=Math.min(s,o),c=this.slice(i,r),u=e.slice(t,n);for(let e=0;e<a;++e)if(c[e]!==u[e]){s=c[e],o=u[e];break}return s<o?-1:o<s?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return _(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return _(this,e,t,n,!1)},l.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}const r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let s=!1;for(;;)switch(i){case"hex":return T(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":case"latin1":case"binary":return I(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const E=4096;function k(e,t,n){let i="";n=Math.min(e.length,n);for(let r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function D(e,t,n){let i="";n=Math.min(e.length,n);for(let r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function A(e,t,n){const i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);let r="";for(let i=t;i<n;++i)r+=Q[e[i]];return r}function P(e,t,n){const i=e.slice(t,n);let r="";for(let e=0;e<i.length-1;e+=2)r+=String.fromCharCode(i[e]+256*i[e+1]);return r}function R(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function F(e,t,n,i,r,s){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<s)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function N(e,t,n,i,r){W(t,i,r,e,n,7);let s=Number(t&BigInt(4294967295));e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,n}function M(e,t,n,i,r){W(t,i,r,e,n,7);let s=Number(t&BigInt(4294967295));e[n+7]=s,s>>=8,e[n+6]=s,s>>=8,e[n+5]=s,s>>=8,e[n+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=o,o>>=8,e[n+2]=o,o>>=8,e[n+1]=o,o>>=8,e[n]=o,n+8}function O(e,t,n,i,r,s){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(e,t,n,i,s){return t=+t,n>>>=0,s||O(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function U(e,t,n,i,s){return t=+t,n>>>=0,s||O(e,0,n,8),r.write(e,t,n,i,52,8),n+8}l.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const i=this.subarray(e,t);return Object.setPrototypeOf(i,l.prototype),i},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||R(e,t,this.length);let i=this[e],r=1,s=0;for(;++s<t&&(r*=256);)i+=this[e+s]*r;return i},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||R(e,t,this.length);let i=this[e+--t],r=1;for(;t>0&&(r*=256);)i+=this[e+--t]*r;return i},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=Z((function(e){j(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||z(e,this.length-8);const i=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,r=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(i)+(BigInt(r)<<BigInt(32))})),l.prototype.readBigUInt64BE=Z((function(e){j(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||z(e,this.length-8);const i=t*2**24+65536*this[++e]+256*this[++e]+this[++e],r=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(i)<<BigInt(32))+BigInt(r)})),l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||R(e,t,this.length);let i=this[e],r=1,s=0;for(;++s<t&&(r*=256);)i+=this[e+s]*r;return r*=128,i>=r&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||R(e,t,this.length);let i=t,r=1,s=this[e+--i];for(;i>0&&(r*=256);)s+=this[e+--i]*r;return r*=128,s>=r&&(s-=Math.pow(2,8*t)),s},l.prototype.readInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||R(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||R(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=Z((function(e){j(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||z(e,this.length-8);const i=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=Z((function(e){j(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||z(e,this.length-8);const i=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||R(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||R(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||R(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||R(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,i){e=+e,t>>>=0,n>>>=0,i||F(this,e,t,n,Math.pow(2,8*n)-1,0);let r=1,s=0;for(this[t]=255&e;++s<n&&(r*=256);)this[t+s]=e/r&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,i){e=+e,t>>>=0,n>>>=0,i||F(this,e,t,n,Math.pow(2,8*n)-1,0);let r=n-1,s=1;for(this[t+r]=255&e;--r>=0&&(s*=256);)this[t+r]=e/s&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=Z((function(e,t=0){return N(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=Z((function(e,t=0){return M(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t>>>=0,!i){const i=Math.pow(2,8*n-1);F(this,e,t,n,i-1,-i)}let r=0,s=1,o=0;for(this[t]=255&e;++r<n&&(s*=256);)e<0&&0===o&&0!==this[t+r-1]&&(o=1),this[t+r]=(e/s>>0)-o&255;return t+n},l.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t>>>=0,!i){const i=Math.pow(2,8*n-1);F(this,e,t,n,i-1,-i)}let r=n-1,s=1,o=0;for(this[t+r]=255&e;--r>=0&&(s*=256);)e<0&&0===o&&0!==this[t+r+1]&&(o=1),this[t+r]=(e/s>>0)-o&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=Z((function(e,t=0){return N(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=Z((function(e,t=0){return M(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,n){return L(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return L(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return U(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return U(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,i){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);const r=i-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),t),r},l.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===e.length){const t=e.charCodeAt(0);("utf8"===i&&t<128||"latin1"===i)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let r;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(r=t;r<n;++r)this[r]=e;else{const s=l.isBuffer(e)?e:l.from(e,i),o=s.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(r=0;r<n-t;++r)this[r+t]=s[r%o]}return this};const q={};function V(e,t,n){q[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function B(e){let t="",n=e.length;const i="-"===e[0]?1:0;for(;n>=i+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function W(e,t,n,i,r,s){if(e>n||e<t){const i="bigint"==typeof t?"n":"";let r;throw r=s>3?0===t||t===BigInt(0)?`>= 0${i} and < 2${i} ** ${8*(s+1)}${i}`:`>= -(2${i} ** ${8*(s+1)-1}${i}) and < 2 ** ${8*(s+1)-1}${i}`:`>= ${t}${i} and <= ${n}${i}`,new q.ERR_OUT_OF_RANGE("value",r,e)}!function(e,t,n){j(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||z(t,e.length-(n+1))}(i,r,s)}function j(e,t){if("number"!=typeof e)throw new q.ERR_INVALID_ARG_TYPE(t,"number",e)}function z(e,t,n){if(Math.floor(e)!==e)throw j(e,n),new q.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new q.ERR_BUFFER_OUT_OF_BOUNDS;throw new q.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}V("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),V("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),V("ERR_OUT_OF_RANGE",(function(e,t,n){let i=`The value of "${e}" is out of range.`,r=n;return Number.isInteger(n)&&Math.abs(n)>2**32?r=B(String(n)):"bigint"==typeof n&&(r=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(r=B(r)),r+="n"),i+=` It must be ${t}. Received ${r}`,i}),RangeError);const $=/[^+/0-9A-Za-z-_]/g;function H(e,t){let n;t=t||1/0;const i=e.length;let r=null;const s=[];for(let o=0;o<i;++o){if(n=e.charCodeAt(o),n>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(t-=3)>-1&&s.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&s.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function G(e){return i.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace($,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function K(e,t,n,i){let r;for(r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}function J(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!=e}const Q=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const i=16*n;for(let r=0;r<16;++r)t[i+r]=e[n]+e[r]}return t}();function Z(e){return"undefined"==typeof BigInt?X:e}function X(){throw new Error("BigInt not supported")}},645:(e,t)=>{t.read=function(e,t,n,i,r){var s,o,a=8*r-i-1,l=(1<<a)-1,c=l>>1,u=-7,p=n?r-1:0,d=n?-1:1,h=e[t+p];for(p+=d,s=h&(1<<-u)-1,h>>=-u,u+=a;u>0;s=256*s+e[t+p],p+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=i;u>0;o=256*o+e[t+p],p+=d,u-=8);if(0===s)s=1-c;else{if(s===l)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,i),s-=c}return(h?-1:1)*o*Math.pow(2,s-i)},t.write=function(e,t,n,i,r,s){var o,a,l,c=8*s-r-1,u=(1<<c)-1,p=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,h=i?0:s-1,m=i?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+p>=1?d/l:d*Math.pow(2,1-p))*l>=2&&(o++,l/=2),o+p>=u?(a=0,o=u):o+p>=1?(a=(t*l-1)*Math.pow(2,r),o+=p):(a=t*Math.pow(2,p-1)*Math.pow(2,r),o=0));r>=8;e[n+h]=255&a,h+=m,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;e[n+h]=255&o,h+=m,o/=256,c-=8);e[n+h-m]|=128*f}},6470:e=>{"use strict";function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function n(e,t){for(var n,i="",r=0,s=-1,o=0,a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(47===n)break;n=47}if(47===n){if(s===a-1||1===o);else if(s!==a-1&&2===o){if(i.length<2||2!==r||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){var l=i.lastIndexOf("/");if(l!==i.length-1){-1===l?(i="",r=0):r=(i=i.slice(0,l)).length-1-i.lastIndexOf("/"),s=a,o=0;continue}}else if(2===i.length||1===i.length){i="",r=0,s=a,o=0;continue}t&&(i.length>0?i+="/..":i="..",r=2)}else i.length>0?i+="/"+e.slice(s+1,a):i=e.slice(s+1,a),r=a-s-1;s=a,o=0}else 46===n&&-1!==o?++o:o=-1}return i}var i={resolve:function(){for(var e,i="",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var o;s>=0?o=arguments[s]:(void 0===e&&(e="/"),o=e),t(o),0!==o.length&&(i=o+"/"+i,r=47===o.charCodeAt(0))}return i=n(i,!r),r?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(e){if(t(e),0===e.length)return".";var i=47===e.charCodeAt(0),r=47===e.charCodeAt(e.length-1);return 0!==(e=n(e,!i)).length||i||(e="."),e.length>0&&r&&(e+="/"),i?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,n=0;n<arguments.length;++n){var r=arguments[n];t(r),r.length>0&&(void 0===e?e=r:e+="/"+r)}return void 0===e?".":i.normalize(e)},relative:function(e,n){if(t(e),t(n),e===n)return"";if((e=i.resolve(e))===(n=i.resolve(n)))return"";for(var r=1;r<e.length&&47===e.charCodeAt(r);++r);for(var s=e.length,o=s-r,a=1;a<n.length&&47===n.charCodeAt(a);++a);for(var l=n.length-a,c=o<l?o:l,u=-1,p=0;p<=c;++p){if(p===c){if(l>c){if(47===n.charCodeAt(a+p))return n.slice(a+p+1);if(0===p)return n.slice(a+p)}else o>c&&(47===e.charCodeAt(r+p)?u=p:0===p&&(u=0));break}var d=e.charCodeAt(r+p);if(d!==n.charCodeAt(a+p))break;47===d&&(u=p)}var h="";for(p=r+u+1;p<=s;++p)p!==s&&47!==e.charCodeAt(p)||(0===h.length?h+="..":h+="/..");return h.length>0?h+n.slice(a+u):(a+=u,47===n.charCodeAt(a)&&++a,n.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var n=e.charCodeAt(0),i=47===n,r=-1,s=!0,o=e.length-1;o>=1;--o)if(47===(n=e.charCodeAt(o))){if(!s){r=o;break}}else s=!1;return-1===r?i?"/":".":i&&1===r?"//":e.slice(0,r)},basename:function(e,n){if(void 0!==n&&"string"!=typeof n)throw new TypeError('"ext" argument must be a string');t(e);var i,r=0,s=-1,o=!0;if(void 0!==n&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return"";var a=n.length-1,l=-1;for(i=e.length-1;i>=0;--i){var c=e.charCodeAt(i);if(47===c){if(!o){r=i+1;break}}else-1===l&&(o=!1,l=i+1),a>=0&&(c===n.charCodeAt(a)?-1==--a&&(s=i):(a=-1,s=l))}return r===s?s=l:-1===s&&(s=e.length),e.slice(r,s)}for(i=e.length-1;i>=0;--i)if(47===e.charCodeAt(i)){if(!o){r=i+1;break}}else-1===s&&(o=!1,s=i+1);return-1===s?"":e.slice(r,s)},extname:function(e){t(e);for(var n=-1,i=0,r=-1,s=!0,o=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(47!==l)-1===r&&(s=!1,r=a+1),46===l?-1===n?n=a:1!==o&&(o=1):-1!==n&&(o=-1);else if(!s){i=a+1;break}}return-1===n||-1===r||0===o||1===o&&n===r-1&&n===i+1?"":e.slice(n,r)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+i:n+"/"+i:i}(0,e)},parse:function(e){t(e);var n={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return n;var i,r=e.charCodeAt(0),s=47===r;s?(n.root="/",i=1):i=0;for(var o=-1,a=0,l=-1,c=!0,u=e.length-1,p=0;u>=i;--u)if(47!==(r=e.charCodeAt(u)))-1===l&&(c=!1,l=u+1),46===r?-1===o?o=u:1!==p&&(p=1):-1!==o&&(p=-1);else if(!c){a=u+1;break}return-1===o||-1===l||0===p||1===p&&o===l-1&&o===a+1?-1!==l&&(n.base=n.name=0===a&&s?e.slice(1,l):e.slice(a,l)):(0===a&&s?(n.name=e.slice(1,o),n.base=e.slice(1,l)):(n.name=e.slice(a,o),n.base=e.slice(a,l)),n.ext=e.slice(o,l)),a>0?n.dir=e.slice(0,a-1):s&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};i.posix=i,e.exports=i},6755:()=>{"use strict";Promise.prototype.ignoreErrors=function(){this.catch((()=>{}))}},1169:(e,t,n)=>{"use strict";e.exports=n(9054)},9054:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.BrowserMessageWriter=t.BrowserMessageReader=void 0,n(5669).default.install();const s=n(3870);r(n(3870),t);class o extends s.AbstractMessageReader{constructor(e){super(),this._onData=new s.Emitter,this._messageListener=e=>{this._onData.fire(e.data)},e.addEventListener("error",(e=>this.fireError(e))),e.onmessage=this._messageListener}listen(e){return this._onData.event(e)}}t.BrowserMessageReader=o;class a extends s.AbstractMessageWriter{constructor(e){super(),this.context=e,this.errorCount=0,e.addEventListener("error",(e=>this.fireError(e)))}write(e){try{return this.context.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}}t.BrowserMessageWriter=a,t.createMessageConnection=function(e,t,n,i){return void 0===n&&(n=s.NullLogger),s.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),s.createMessageConnection(e,t,n,i)}},5669:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(147),r=n(3911),s=n(7135),o=n(5530);class a extends o.AbstractMessageBuffer{constructor(e="utf-8"){super(e),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return a.emptyBuffer}fromString(e,t){return(new TextEncoder).encode(e)}toString(e,t){return"ascii"===t?this.asciiDecoder.decode(e):new TextDecoder(t).decode(e)}asNative(e,t){return void 0===t?e:e.slice(0,t)}allocNative(e){return new Uint8Array(e)}}a.emptyBuffer=new Uint8Array(0);class l{constructor(e){this.socket=e,this._onData=new s.Emitter,this._messageListener=e=>{e.data.arrayBuffer().then((e=>{this._onData.fire(new Uint8Array(e))}))},this.socket.addEventListener("message",this._messageListener)}onClose(e){return this.socket.addEventListener("close",e),r.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),r.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),r.Disposable.create((()=>this.socket.removeEventListener("end",e)))}onData(e){return this._onData.event(e)}}class c{constructor(e){this.socket=e}onClose(e){return this.socket.addEventListener("close",e),r.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),r.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),r.Disposable.create((()=>this.socket.removeEventListener("end",e)))}write(e,t){if("string"==typeof e){if(void 0!==t&&"utf-8"!==t)throw new Error(`In a Browser environments only utf-8 text encding is supported. But got encoding: ${t}`);this.socket.send(e)}else this.socket.send(e);return Promise.resolve()}end(){this.socket.close()}}const u=new TextEncoder,p=Object.freeze({messageBuffer:Object.freeze({create:e=>new a(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{if("utf-8"!==t.charset)throw new Error(`In a Browser environments only utf-8 text encding is supported. But got encoding: ${t.charset}`);return Promise.resolve(u.encode(JSON.stringify(e,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{if(!(e instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(t.charset).decode(e)))}})}),stream:Object.freeze({asReadableStream:e=>new l(e),asWritableStream:e=>new c(e)}),console,timer:Object.freeze({setTimeout:(e,t,...n)=>setTimeout(e,t,...n),clearTimeout(e){clearTimeout(e)},setImmediate:(e,...t)=>setTimeout(e,0,...t),clearImmediate(e){clearTimeout(e)}})});function d(){return p}!function(e){e.install=function(){i.default.install(p)}}(d||(d={})),t.default=d},3870:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.Trace=t.ProgressType=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=t.ConnectionStrategy=t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.RAL=void 0,t.CancellationStrategy=void 0;const i=n(839);Object.defineProperty(t,"RequestType",{enumerable:!0,get:function(){return i.RequestType}}),Object.defineProperty(t,"RequestType0",{enumerable:!0,get:function(){return i.RequestType0}}),Object.defineProperty(t,"RequestType1",{enumerable:!0,get:function(){return i.RequestType1}}),Object.defineProperty(t,"RequestType2",{enumerable:!0,get:function(){return i.RequestType2}}),Object.defineProperty(t,"RequestType3",{enumerable:!0,get:function(){return i.RequestType3}}),Object.defineProperty(t,"RequestType4",{enumerable:!0,get:function(){return i.RequestType4}}),Object.defineProperty(t,"RequestType5",{enumerable:!0,get:function(){return i.RequestType5}}),Object.defineProperty(t,"RequestType6",{enumerable:!0,get:function(){return i.RequestType6}}),Object.defineProperty(t,"RequestType7",{enumerable:!0,get:function(){return i.RequestType7}}),Object.defineProperty(t,"RequestType8",{enumerable:!0,get:function(){return i.RequestType8}}),Object.defineProperty(t,"RequestType9",{enumerable:!0,get:function(){return i.RequestType9}}),Object.defineProperty(t,"ResponseError",{enumerable:!0,get:function(){return i.ResponseError}}),Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return i.ErrorCodes}}),Object.defineProperty(t,"NotificationType",{enumerable:!0,get:function(){return i.NotificationType}}),Object.defineProperty(t,"NotificationType0",{enumerable:!0,get:function(){return i.NotificationType0}}),Object.defineProperty(t,"NotificationType1",{enumerable:!0,get:function(){return i.NotificationType1}}),Object.defineProperty(t,"NotificationType2",{enumerable:!0,get:function(){return i.NotificationType2}}),Object.defineProperty(t,"NotificationType3",{enumerable:!0,get:function(){return i.NotificationType3}}),Object.defineProperty(t,"NotificationType4",{enumerable:!0,get:function(){return i.NotificationType4}}),Object.defineProperty(t,"NotificationType5",{enumerable:!0,get:function(){return i.NotificationType5}}),Object.defineProperty(t,"NotificationType6",{enumerable:!0,get:function(){return i.NotificationType6}}),Object.defineProperty(t,"NotificationType7",{enumerable:!0,get:function(){return i.NotificationType7}}),Object.defineProperty(t,"NotificationType8",{enumerable:!0,get:function(){return i.NotificationType8}}),Object.defineProperty(t,"NotificationType9",{enumerable:!0,get:function(){return i.NotificationType9}}),Object.defineProperty(t,"ParameterStructures",{enumerable:!0,get:function(){return i.ParameterStructures}});const r=n(3911);Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return r.Disposable}});const s=n(7135);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return s.Event}}),Object.defineProperty(t,"Emitter",{enumerable:!0,get:function(){return s.Emitter}});const o=n(3881);Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return o.CancellationTokenSource}}),Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return o.CancellationToken}});const a=n(6525);Object.defineProperty(t,"MessageReader",{enumerable:!0,get:function(){return a.MessageReader}}),Object.defineProperty(t,"AbstractMessageReader",{enumerable:!0,get:function(){return a.AbstractMessageReader}}),Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return a.ReadableStreamMessageReader}});const l=n(6654);Object.defineProperty(t,"MessageWriter",{enumerable:!0,get:function(){return l.MessageWriter}}),Object.defineProperty(t,"AbstractMessageWriter",{enumerable:!0,get:function(){return l.AbstractMessageWriter}}),Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return l.WriteableStreamMessageWriter}});const c=n(1343);Object.defineProperty(t,"ConnectionStrategy",{enumerable:!0,get:function(){return c.ConnectionStrategy}}),Object.defineProperty(t,"ConnectionOptions",{enumerable:!0,get:function(){return c.ConnectionOptions}}),Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return c.NullLogger}}),Object.defineProperty(t,"createMessageConnection",{enumerable:!0,get:function(){return c.createMessageConnection}}),Object.defineProperty(t,"ProgressType",{enumerable:!0,get:function(){return c.ProgressType}}),Object.defineProperty(t,"Trace",{enumerable:!0,get:function(){return c.Trace}}),Object.defineProperty(t,"TraceFormat",{enumerable:!0,get:function(){return c.TraceFormat}}),Object.defineProperty(t,"SetTraceNotification",{enumerable:!0,get:function(){return c.SetTraceNotification}}),Object.defineProperty(t,"LogTraceNotification",{enumerable:!0,get:function(){return c.LogTraceNotification}}),Object.defineProperty(t,"ConnectionErrors",{enumerable:!0,get:function(){return c.ConnectionErrors}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return c.ConnectionError}}),Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return c.CancellationReceiverStrategy}}),Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:!0,get:function(){return c.CancellationSenderStrategy}}),Object.defineProperty(t,"CancellationStrategy",{enumerable:!0,get:function(){return c.CancellationStrategy}});const u=n(147);t.RAL=u.default},3881:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationTokenSource=t.CancellationToken=void 0;const i=n(147),r=n(7574),s=n(7135);var o;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:s.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:s.Event.None}),e.is=function(t){const n=t;return n&&(n===e.None||n===e.Cancelled||r.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}}(o=t.CancellationToken||(t.CancellationToken={}));const a=Object.freeze((function(e,t){const n=i.default().timer.setTimeout(e.bind(t),0);return{dispose(){i.default().timer.clearTimeout(n)}}}));class l{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?a:(this._emitter||(this._emitter=new s.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new l),this._token}cancel(){this._token?this._token.cancel():this._token=o.Cancelled}dispose(){this._token?this._token instanceof l&&this._token.dispose():this._token=o.None}}},1343:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.ConnectionOptions=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.Trace=t.NullLogger=t.ProgressType=void 0;const i=n(147),r=n(7574),s=n(839),o=n(6184),a=n(7135),l=n(3881);var c,u,p,d,h,m,f,g,y,_,v,T,b;!function(e){e.type=new s.NotificationType("$/cancelRequest")}(c||(c={})),function(e){e.type=new s.NotificationType("$/progress")}(u||(u={})),t.ProgressType=class{constructor(){}},function(e){e.is=function(e){return r.func(e)}}(p||(p={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(d=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){if(!r.string(t))return e.Off;switch(t=t.toLowerCase()){case"off":return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose;default:return e.Off}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(d=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(h=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new s.NotificationType("$/setTrace")}(m=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new s.NotificationType("$/logTrace")}(f=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(g=t.ConnectionErrors||(t.ConnectionErrors={}));class I extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,I.prototype)}}t.ConnectionError=I,function(e){e.is=function(e){const t=e;return t&&r.func(t.cancelUndispatched)}}(y=t.ConnectionStrategy||(t.ConnectionStrategy={})),function(e){e.Message=Object.freeze({createCancellationTokenSource:e=>new l.CancellationTokenSource}),e.is=function(e){const t=e;return t&&r.func(t.createCancellationTokenSource)}}(_=t.CancellationReceiverStrategy||(t.CancellationReceiverStrategy={})),function(e){e.Message=Object.freeze({sendCancellation(e,t){e.sendNotification(c.type,{id:t})},cleanup(e){}}),e.is=function(e){const t=e;return t&&r.func(t.sendCancellation)&&r.func(t.cleanup)}}(v=t.CancellationSenderStrategy||(t.CancellationSenderStrategy={})),function(e){e.Message=Object.freeze({receiver:_.Message,sender:v.Message}),e.is=function(e){const t=e;return t&&_.is(t.receiver)&&v.is(t.sender)}}(T=t.CancellationStrategy||(t.CancellationStrategy={})),(t.ConnectionOptions||(t.ConnectionOptions={})).is=function(e){const t=e;return t&&(T.is(t.cancellationStrategy)||y.is(t.connectionStrategy))},function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(b||(b={})),t.createMessageConnection=function(e,n,y,_){const v=void 0!==y?y:t.NullLogger;let S=0,x=0,C=0;const w="2.0";let E;const k=Object.create(null);let D;const A=Object.create(null),P=new Map;let R,F,N=new o.LinkedMap,M=Object.create(null),O=Object.create(null),L=d.Off,U=h.Text,q=b.New;const V=new a.Emitter,B=new a.Emitter,W=new a.Emitter,j=new a.Emitter,z=new a.Emitter,$=_&&_.cancellationStrategy?_.cancellationStrategy:T.Message;function H(e){if(null===e)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+e.toString()}function G(e){}function K(){return q===b.Listening}function J(){return q===b.Closed}function Y(){return q===b.Disposed}function Q(){q!==b.New&&q!==b.Listening||(q=b.Closed,B.fire(void 0))}function Z(){R||0===N.size||(R=i.default().timer.setImmediate((()=>{R=void 0,function(){if(0===N.size)return;const e=N.shift();try{s.isRequestMessage(e)?function(e){if(Y())return;function t(t,i,r){const o={jsonrpc:w,id:e.id};t instanceof s.ResponseError?o.error=t.toJson():o.result=void 0===t?null:t,ee(o,i,r),n.write(o)}function i(t,i,r){const s={jsonrpc:w,id:e.id,error:t.toJson()};ee(s,i,r),n.write(s)}!function(e){if(L!==d.Off&&F)if(U===h.Text){let t;L===d.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),F.log(`Received request '${e.method} - (${e.id})'.`,t)}else te("receive-request",e)}(e);const o=k[e.method];let a,l;o&&(a=o.type,l=o.handler);const c=Date.now();if(l||E){const o=String(e.id),u=$.receiver.createCancellationTokenSource(o);O[o]=u;try{let p;if(l)if(void 0===e.params){if(void 0!==a&&0!==a.numberOfParams)return void i(new s.ResponseError(s.ErrorCodes.InvalidParams,`Request ${e.method} defines ${a.numberOfParams} params but recevied none.`),e.method,c);p=l(u.token)}else if(Array.isArray(e.params)){if(void 0!==a&&a.parameterStructures===s.ParameterStructures.byName)return void i(new s.ResponseError(s.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by name but received parameters by position`),e.method,c);p=l(...e.params,u.token)}else{if(void 0!==a&&a.parameterStructures===s.ParameterStructures.byPosition)return void i(new s.ResponseError(s.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by position but received parameters by name`),e.method,c);p=l(e.params,u.token)}else E&&(p=E(e.method,e.params,u.token));const d=p;p?d.then?d.then((n=>{delete O[o],t(n,e.method,c)}),(t=>{delete O[o],t instanceof s.ResponseError?i(t,e.method,c):t&&r.string(t.message)?i(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,c):i(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,c)})):(delete O[o],t(p,e.method,c)):(delete O[o],function(t,i,r){void 0===t&&(t=null);const s={jsonrpc:w,id:e.id,result:t};ee(s,i,r),n.write(s)}(p,e.method,c))}catch(n){delete O[o],n instanceof s.ResponseError?t(n,e.method,c):n&&r.string(n.message)?i(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${n.message}`),e.method,c):i(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,c)}}else i(new s.ResponseError(s.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,c)}(e):s.isNotificationMessage(e)?function(e){if(Y())return;let t,n;if(e.method===c.type.method)n=e=>{const t=e.id,n=O[String(t)];n&&n.cancel()};else{const i=A[e.method];i&&(n=i.handler,t=i.type)}if(n||D)try{!function(e){if(L!==d.Off&&F&&e.method!==f.type.method)if(U===h.Text){let t;L===d.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),F.log(`Received notification '${e.method}'.`,t)}else te("receive-notification",e)}(e),n?void 0===e.params?(void 0!==t&&0!==t.numberOfParams&&t.parameterStructures!==s.ParameterStructures.byName&&v.error(`Notification ${e.method} defines ${t.numberOfParams} params but recevied none.`),n()):Array.isArray(e.params)?(void 0!==t&&(t.parameterStructures===s.ParameterStructures.byName&&v.error(`Notification ${e.method} defines parameters by name but received parameters by position`),t.numberOfParams!==e.params.length&&v.error(`Notification ${e.method} defines ${t.numberOfParams} params but received ${e.params.length} argumennts`)),n(...e.params)):(void 0!==t&&t.parameterStructures===s.ParameterStructures.byPosition&&v.error(`Notification ${e.method} defines parameters by position but received parameters by name`),n(e.params)):D&&D(e.method,e.params)}catch(t){t.message?v.error(`Notification handler '${e.method}' failed with message: ${t.message}`):v.error(`Notification handler '${e.method}' failed unexpectedly.`)}else W.fire(e)}(e):s.isResponseMessage(e)?function(e){if(!Y())if(null===e.id)e.error?v.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):v.error("Received response message without id. No further error information provided.");else{const t=String(e.id),n=M[t];if(function(e,t){if(L!==d.Off&&F)if(U===h.Text){let n;if(L===d.Verbose&&(e.error&&e.error.data?n=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?n=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),t){const i=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";F.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${i}`,n)}else F.log(`Received response ${e.id} without active response promise.`,n)}else te("receive-response",e)}(e,n),n){delete M[t];try{if(e.error){const t=e.error;n.reject(new s.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");n.resolve(e.result)}}catch(e){e.message?v.error(`Response handler '${n.method}' failed with message: ${e.message}`):v.error(`Response handler '${n.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void v.error("Received empty message.");v.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);const t=e;if(r.string(t.id)||r.number(t.id)){const e=String(t.id),n=M[e];n&&n.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{Z()}}()})))}e.onClose(Q),e.onError((function(e){V.fire([e,void 0,void 0])})),n.onClose(Q),n.onError((function(e){V.fire(e)}));const X=e=>{try{if(s.isNotificationMessage(e)&&e.method===c.type.method){const t=H(e.params.id),i=N.get(t);if(s.isRequestMessage(i)){const r=null==_?void 0:_.connectionStrategy,s=r&&r.cancelUndispatched?r.cancelUndispatched(i,G):void 0;if(s&&(void 0!==s.error||void 0!==s.result))return N.delete(t),s.id=i.id,ee(s,e.method,Date.now()),void n.write(s)}}!function(e,t){var n;s.isRequestMessage(t)?e.set(H(t.id),t):s.isResponseMessage(t)?e.set(null===(n=t.id)?"res-unknown-"+(++C).toString():"res-"+n.toString(),t):e.set("not-"+(++x).toString(),t)}(N,e)}finally{Z()}};function ee(e,t,n){if(L!==d.Off&&F)if(U===h.Text){let i;L===d.Verbose&&(e.error&&e.error.data?i=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?i=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(i="No result returned.\n\n")),F.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-n}ms`,i)}else te("send-response",e)}function te(e,t){if(!F||L===d.Off)return;const n={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};F.log(n)}function ne(){if(J())throw new I(g.Closed,"Connection is closed.");if(Y())throw new I(g.Disposed,"Connection is disposed.")}function ie(e){return void 0===e?null:e}function re(e){return null===e?void 0:e}function se(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function oe(e,t){switch(e){case s.ParameterStructures.auto:return se(t)?re(t):[ie(t)];case s.ParameterStructures.byName:if(!se(t))throw new Error("Recevied parameters by name but param is not an object literal.");return re(t);case s.ParameterStructures.byPosition:return[ie(t)];default:throw new Error(`Unknown parameter structure ${e.toString()}`)}}function ae(e,t){let n;const i=e.numberOfParams;switch(i){case 0:n=void 0;break;case 1:n=oe(e.parameterStructures,t[0]);break;default:n=[];for(let e=0;e<t.length&&e<i;e++)n.push(ie(t[e]));if(t.length<i)for(let e=t.length;e<i;e++)n.push(null)}return n}const le={sendNotification:(e,...t)=>{let i,o;if(ne(),r.string(e)){i=e;const n=t[0];let r=0,a=s.ParameterStructures.auto;s.ParameterStructures.is(n)&&(r=1,a=n);let l=t.length;const c=l-r;switch(c){case 0:o=void 0;break;case 1:o=oe(a,t[r]);break;default:if(a===s.ParameterStructures.byName)throw new Error(`Recevied ${c} parameters for 'by Name' notification parameter structure.`);o=t.slice(r,l).map((e=>ie(e)))}}else{const n=t;i=e.method,o=ae(e,n)}const a={jsonrpc:w,method:i,params:o};!function(e){if(L!==d.Off&&F)if(U===h.Text){let t;L===d.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),F.log(`Sending notification '${e.method}'.`,t)}else te("send-notification",e)}(a),n.write(a)},onNotification:(e,t)=>{let n;return ne(),r.func(e)?D=e:t&&(r.string(e)?(n=e,A[e]={type:void 0,handler:t}):(n=e.method,A[e.method]={type:e,handler:t})),{dispose:()=>{void 0!==n?delete A[n]:D=void 0}}},onProgress:(e,t,n)=>{if(P.has(t))throw new Error(`Progress handler for token ${t} already registered`);return P.set(t,n),{dispose:()=>{P.delete(t)}}},sendProgress:(e,t,n)=>{le.sendNotification(u.type,{token:t,value:n})},onUnhandledProgress:j.event,sendRequest:(e,...t)=>{let i,o,a;if(ne(),function(){if(!K())throw new Error("Call listen() first.")}(),r.string(e)){i=e;const n=t[0],r=t[t.length-1];let c=0,u=s.ParameterStructures.auto;s.ParameterStructures.is(n)&&(c=1,u=n);let p=t.length;l.CancellationToken.is(r)&&(p-=1,a=r);const d=p-c;switch(d){case 0:o=void 0;break;case 1:o=oe(u,t[c]);break;default:if(u===s.ParameterStructures.byName)throw new Error(`Recevied ${d} parameters for 'by Name' request parameter structure.`);o=t.slice(c,p).map((e=>ie(e)))}}else{const n=t;i=e.method,o=ae(e,n);const r=e.numberOfParams;a=l.CancellationToken.is(n[r])?n[r]:void 0}const c=S++;let u;return a&&(u=a.onCancellationRequested((()=>{$.sender.sendCancellation(le,c)}))),new Promise(((e,t)=>{const r={jsonrpc:w,id:c,method:i,params:o};let a={method:i,timerStart:Date.now(),resolve:t=>{e(t),$.sender.cleanup(c),null==u||u.dispose()},reject:e=>{t(e),$.sender.cleanup(c),null==u||u.dispose()}};!function(e){if(L!==d.Off&&F)if(U===h.Text){let t;L===d.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),F.log(`Sending request '${e.method} - (${e.id})'.`,t)}else te("send-request",e)}(r);try{n.write(r)}catch(e){a.reject(new s.ResponseError(s.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),a=null}a&&(M[String(c)]=a)}))},onRequest:(e,t)=>{ne();let n=null;return p.is(e)?(n=void 0,E=e):r.string(e)?(n=null,void 0!==t&&(n=e,k[e]={handler:t,type:void 0})):void 0!==t&&(n=e.method,k[e.method]={type:e,handler:t}),{dispose:()=>{null!==n&&(void 0!==n?delete k[n]:E=void 0)}}},trace:(e,t,n)=>{let i=!1,s=h.Text;void 0!==n&&(r.boolean(n)?i=n:(i=n.sendNotification||!1,s=n.traceFormat||h.Text)),L=e,U=s,F=L===d.Off?void 0:t,!i||J()||Y()||le.sendNotification(m.type,{value:d.toString(e)})},onError:V.event,onClose:B.event,onUnhandledNotification:W.event,onDispose:z.event,end:()=>{n.end()},dispose:()=>{if(Y())return;q=b.Disposed,z.fire(void 0);const t=new Error("Connection got disposed.");Object.keys(M).forEach((e=>{M[e].reject(t)})),M=Object.create(null),O=Object.create(null),N=new o.LinkedMap,r.func(n.dispose)&&n.dispose(),r.func(e.dispose)&&e.dispose()},listen:()=>{ne(),function(){if(K())throw new I(g.AlreadyListening,"Connection is already listening")}(),q=b.Listening,e.listen(X)},inspect:()=>{i.default().console.log("inspect")}};return le.onNotification(f.type,(e=>{L!==d.Off&&F&&F.log(e.message,L===d.Verbose?e.verbose:void 0)})),le.onNotification(u.type,(e=>{const t=P.get(e.token);t?t(e.value):j.fire(e)})),le}},3911:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Disposable=void 0,(t.Disposable||(t.Disposable={})).create=function(e){return{dispose:e}}},7135:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Emitter=t.Event=void 0;const i=n(147);!function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class r{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let n=!1;for(let i=0,r=this._callbacks.length;i<r;i++)if(this._callbacks[i]===e){if(this._contexts[i]===t)return this._callbacks.splice(i,1),void this._contexts.splice(i,1);n=!0}if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],n=this._callbacks.slice(0),r=this._contexts.slice(0);for(let s=0,o=n.length;s<o;s++)try{t.push(n[s].apply(r[s],e))}catch(e){i.default().console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class s{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{this._callbacks||(this._callbacks=new r),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=s._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(n)&&n.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=s,s._noop=function(){}},7574:(e,t)=>{"use strict";function n(e){return"string"==typeof e||e instanceof String}function i(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=i,t.stringArray=function(e){return i(e)&&e.every((e=>n(e)))}},6184:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=t.LinkedMap=t.Touch=void 0,function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last}(n=t.Touch||(t.Touch={}));class i{constructor(){this[Symbol.toStringTag]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return null===(e=this._head)||void 0===e?void 0:e.value}get last(){var e;return null===(e=this._tail)||void 0===e?void 0:e.value}has(e){return this._map.has(e)}get(e,t=n.None){const i=this._map.get(e);if(i)return t!==n.None&&this.touch(i,t),i.value}set(e,t,i=n.None){let r=this._map.get(e);if(r)r.value=t,i!==n.None&&this.touch(r,i);else{switch(r={key:e,value:t,next:void 0,previous:void 0},i){case n.None:this.addItemLast(r);break;case n.First:this.addItemFirst(r);break;case n.Last:default:this.addItemLast(r)}this._map.set(e,r),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const n=this._state;let i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this,t=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:n.key,done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return i}values(){const e=this,t=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:n.value,done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return i}entries(){const e=this,t=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:[n.key,n.value],done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return i}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e,this._state++}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===n.First||t===n.Last)if(t===n.First){if(e===this._head)return;const t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===n.Last){if(e===this._tail)return;const t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}toJSON(){const e=[];return this.forEach(((t,n)=>{e.push([n,t])})),e}fromJSON(e){this.clear();for(const[t,n]of e)this.set(t,n)}}t.LinkedMap=i,t.LRUCache=class extends i{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=n.AsNew){return super.get(e,t)}peek(e){return super.get(e,n.None)}set(e,t){return super.set(e,t,n.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}},5530:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractMessageBuffer=void 0,t.AbstractMessageBuffer=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t="string"==typeof e?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(){if(0===this._chunks.length)return;let e=0,t=0,n=0,i=0;e:for(;t<this._chunks.length;){const r=this._chunks[t];for(n=0;n<r.length;){switch(r[n]){case 13:switch(e){case 0:e=1;break;case 2:e=3;break;default:e=0}break;case 10:switch(e){case 1:e=2;break;case 3:e=4,n++;break e;default:e=0}break;default:e=0}n++}i+=r.byteLength,t++}if(4!==e)return;const r=this._read(i+n),s=new Map,o=this.toString(r,"ascii").split("\r\n");if(o.length<2)return s;for(let e=0;e<o.length-2;e++){const t=o[e],n=t.indexOf(":");if(-1===n)throw new Error("Message header must separate key and value using :");const i=t.substr(0,n),r=t.substr(n+1).trim();s.set(i,r)}return s}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(0===e)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const t=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(t)}if(this._chunks[0].byteLength>e){const t=this._chunks[0],n=this.asNative(t,e);return this._chunks[0]=t.slice(e),this._totalLength-=e,n}const t=this.allocNative(e);let n=0;for(;e>0;){const i=this._chunks[0];if(i.byteLength>e){const r=i.slice(0,e);t.set(r,n),n+=e,this._chunks[0]=i.slice(e),this._totalLength-=e,e-=e}else t.set(i,n),n+=i.byteLength,this._chunks.shift(),this._totalLength-=i.byteLength,e-=i.byteLength}return t}}},6525:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=void 0;const i=n(147),r=n(7574),s=n(7135);var o;(t.MessageReader||(t.MessageReader={})).is=function(e){let t=e;return t&&r.func(t.listen)&&r.func(t.dispose)&&r.func(t.onError)&&r.func(t.onClose)&&r.func(t.onPartialMessage)};class a{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter,this.partialMessageEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${r.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=a,function(e){e.fromOptions=function(e){var t;let n,r;const s=new Map;let o;const a=new Map;if(void 0===e||"string"==typeof e)n=null!=e?e:"utf-8";else{if(n=null!==(t=e.charset)&&void 0!==t?t:"utf-8",void 0!==e.contentDecoder&&(r=e.contentDecoder,s.set(r.name,r)),void 0!==e.contentDecoders)for(const t of e.contentDecoders)s.set(t.name,t);if(void 0!==e.contentTypeDecoder&&(o=e.contentTypeDecoder,a.set(o.name,o)),void 0!==e.contentTypeDecoders)for(const t of e.contentTypeDecoders)a.set(t.name,t)}return void 0===o&&(o=i.default().applicationJson.decoder,a.set(o.name,o)),{charset:n,contentDecoder:r,contentDecoders:s,contentTypeDecoder:o,contentTypeDecoders:a}}}(o||(o={})),t.ReadableStreamMessageReader=class extends a{constructor(e,t){super(),this.readable=e,this.options=o.fromOptions(t),this.buffer=i.default().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData((e=>{this.onData(e)}));return this.readable.onError((e=>this.fireError(e))),this.readable.onClose((()=>this.fireClose())),t}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){const e=this.buffer.tryReadHeaders();if(!e)return;const t=e.get("Content-Length");if(!t)throw new Error("Header must provide a Content-Length property.");const n=parseInt(t);if(isNaN(n))throw new Error("Content-Length value must be a number.");this.nextMessageLength=n}const e=this.buffer.tryReadBody(this.nextMessageLength);if(void 0===e)return void this.setPartialMessageTimer();let t;this.clearPartialMessageTimer(),this.nextMessageLength=-1,t=void 0!==this.options.contentDecoder?this.options.contentDecoder.decode(e):Promise.resolve(e),t.then((e=>{this.options.contentTypeDecoder.decode(e,this.options).then((e=>{this.callback(e)}),(e=>{this.fireError(e)}))}),(e=>{this.fireError(e)}))}}clearPartialMessageTimer(){this.partialMessageTimer&&(i.default().timer.clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=i.default().timer.setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}},6654:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=void 0;const i=n(147),r=n(7574),s=n(142),o=n(7135);var a;(t.MessageWriter||(t.MessageWriter={})).is=function(e){let t=e;return t&&r.func(t.dispose)&&r.func(t.onClose)&&r.func(t.onError)&&r.func(t.write)};class l{constructor(){this.errorEmitter=new o.Emitter,this.closeEmitter=new o.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${r.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=l,function(e){e.fromOptions=function(e){var t,n;return void 0===e||"string"==typeof e?{charset:null!=e?e:"utf-8",contentTypeEncoder:i.default().applicationJson.encoder}:{charset:null!==(t=e.charset)&&void 0!==t?t:"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:null!==(n=e.contentTypeEncoder)&&void 0!==n?n:i.default().applicationJson.encoder}}}(a||(a={})),t.WriteableStreamMessageWriter=class extends l{constructor(e,t){super(),this.writable=e,this.options=a.fromOptions(t),this.errorCount=0,this.writeSemaphore=new s.Semaphore(1),this.writable.onError((e=>this.fireError(e))),this.writable.onClose((()=>this.fireClose()))}async write(e){return this.writeSemaphore.lock((async()=>this.options.contentTypeEncoder.encode(e,this.options).then((e=>void 0!==this.options.contentEncoder?this.options.contentEncoder.encode(e):e)).then((t=>{const n=[];return n.push("Content-Length: ",t.byteLength.toString(),"\r\n"),n.push("\r\n"),this.doWrite(e,n,t)}),(e=>{throw this.fireError(e),e}))))}async doWrite(e,t,n){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(n)}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}},839:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isResponseMessage=t.isNotificationMessage=t.isRequestMessage=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType=t.RequestType0=t.AbstractMessageSignature=t.ParameterStructures=t.ResponseError=t.ErrorCodes=void 0;const i=n(7574);var r;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.jsonrpcReservedErrorRangeStart=-32099,e.serverErrorStart=e.jsonrpcReservedErrorRangeStart,e.MessageWriteError=-32099,e.MessageReadError=-32098,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.jsonrpcReservedErrorRangeEnd=-32e3,e.serverErrorEnd=e.jsonrpcReservedErrorRangeEnd}(r=t.ErrorCodes||(t.ErrorCodes={}));class s extends Error{constructor(e,t,n){super(t),this.code=i.number(e)?e:r.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,s.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}}t.ResponseError=s;class o{constructor(e){this.kind=e}static is(e){return e===o.auto||e===o.byName||e===o.byPosition}toString(){return this.kind}}t.ParameterStructures=o,o.auto=new o("auto"),o.byPosition=new o("byPosition"),o.byName=new o("byName");class a{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return o.auto}}t.AbstractMessageSignature=a,t.RequestType0=class extends a{constructor(e){super(e,0)}},t.RequestType=class extends a{constructor(e,t=o.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType1=class extends a{constructor(e,t=o.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType2=class extends a{constructor(e){super(e,2)}},t.RequestType3=class extends a{constructor(e){super(e,3)}},t.RequestType4=class extends a{constructor(e){super(e,4)}},t.RequestType5=class extends a{constructor(e){super(e,5)}},t.RequestType6=class extends a{constructor(e){super(e,6)}},t.RequestType7=class extends a{constructor(e){super(e,7)}},t.RequestType8=class extends a{constructor(e){super(e,8)}},t.RequestType9=class extends a{constructor(e){super(e,9)}},t.NotificationType=class extends a{constructor(e,t=o.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType0=class extends a{constructor(e){super(e,0)}},t.NotificationType1=class extends a{constructor(e,t=o.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType2=class extends a{constructor(e){super(e,2)}},t.NotificationType3=class extends a{constructor(e){super(e,3)}},t.NotificationType4=class extends a{constructor(e){super(e,4)}},t.NotificationType5=class extends a{constructor(e){super(e,5)}},t.NotificationType6=class extends a{constructor(e){super(e,6)}},t.NotificationType7=class extends a{constructor(e){super(e,7)}},t.NotificationType8=class extends a{constructor(e){super(e,8)}},t.NotificationType9=class extends a{constructor(e){super(e,9)}},t.isRequestMessage=function(e){const t=e;return t&&i.string(t.method)&&(i.string(t.id)||i.number(t.id))},t.isNotificationMessage=function(e){const t=e;return t&&i.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){const t=e;return t&&(void 0!==t.result||!!t.error)&&(i.string(t.id)||i.number(t.id)||null===t.id)}},147:(e,t)=>{"use strict";let n;function i(){if(void 0===n)throw new Error("No runtime abstraction layer installed");return n}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.install=function(e){if(void 0===e)throw new Error("No runtime abstraction layer provided");n=e}}(i||(i={})),t.default=i},142:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Semaphore=void 0;const i=n(147);t.Semaphore=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise(((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()}))}get active(){return this._active}runNext(){0!==this._waiting.length&&this._active!==this._capacity&&i.default().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(0===this._waiting.length||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then((t=>{this._active--,e.resolve(t),this.runNext()}),(t=>{this._active--,e.reject(t),this.runNext()})):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}}},5224:(e,t,n)=>{"use strict";e.exports=n(152)},152:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const s=n(1169);r(n(1169),t),r(n(1661),t),t.createProtocolConnection=function(e,t,n,i){return s.createMessageConnection(e,t,n,i)}},1661:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.LSPErrorCodes=t.createProtocolConnection=void 0,r(n(9054),t),r(n(1674),t),r(n(6140),t),r(n(542),t);var s,o=n(3767);Object.defineProperty(t,"createProtocolConnection",{enumerable:!0,get:function(){return o.createProtocolConnection}}),(s=t.LSPErrorCodes||(t.LSPErrorCodes={})).lspReservedErrorRangeStart=-32899,s.ContentModified=-32801,s.RequestCancelled=-32800,s.lspReservedErrorRangeEnd=-32800},3767:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const i=n(9054);t.createProtocolConnection=function(e,t,n,r){return i.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),i.createMessageConnection(e,t,n,r)}},6140:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolNotificationType=t.ProtocolNotificationType0=t.ProtocolRequestType=t.ProtocolRequestType0=t.RegistrationType=void 0;const i=n(9054);t.RegistrationType=class{constructor(e){this.method=e}};class r extends i.RequestType0{constructor(e){super(e)}}t.ProtocolRequestType0=r;class s extends i.RequestType{constructor(e){super(e,i.ParameterStructures.byName)}}t.ProtocolRequestType=s;class o extends i.NotificationType0{constructor(e){super(e)}}t.ProtocolNotificationType0=o;class a extends i.NotificationType{constructor(e){super(e,i.ParameterStructures.byName)}}t.ProtocolNotificationType=a},2918:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.CallHierarchyPrepareRequest=void 0;const i=n(6140);var r,s,o;(o=t.CallHierarchyPrepareRequest||(t.CallHierarchyPrepareRequest={})).method="textDocument/prepareCallHierarchy",o.type=new i.ProtocolRequestType(o.method),(s=t.CallHierarchyIncomingCallsRequest||(t.CallHierarchyIncomingCallsRequest={})).method="callHierarchy/incomingCalls",s.type=new i.ProtocolRequestType(s.method),(r=t.CallHierarchyOutgoingCallsRequest||(t.CallHierarchyOutgoingCallsRequest={})).method="callHierarchy/outgoingCalls",r.type=new i.ProtocolRequestType(r.method)},9891:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorPresentationRequest=t.DocumentColorRequest=void 0;const i=n(6140);var r;(r=t.DocumentColorRequest||(t.DocumentColorRequest={})).method="textDocument/documentColor",r.type=new i.ProtocolRequestType(r.method),(t.ColorPresentationRequest||(t.ColorPresentationRequest={})).type=new i.ProtocolRequestType("textDocument/colorPresentation")},5934:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationRequest=void 0;const i=n(6140);(t.ConfigurationRequest||(t.ConfigurationRequest={})).type=new i.ProtocolRequestType("workspace/configuration")},764:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeclarationRequest=void 0;const i=n(6140);var r;(r=t.DeclarationRequest||(t.DeclarationRequest={})).method="textDocument/declaration",r.type=new i.ProtocolRequestType(r.method)},7846:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.DidRenameFilesNotification=t.WillRenameFilesRequest=t.DidCreateFilesNotification=t.WillCreateFilesRequest=t.FileOperationPatternKind=void 0;const i=n(6140);var r,s,o,a,l,c,u;(u=t.FileOperationPatternKind||(t.FileOperationPatternKind={})).file="file",u.folder="folder",(c=t.WillCreateFilesRequest||(t.WillCreateFilesRequest={})).method="workspace/willCreateFiles",c.type=new i.ProtocolRequestType(c.method),(l=t.DidCreateFilesNotification||(t.DidCreateFilesNotification={})).method="workspace/didCreateFiles",l.type=new i.ProtocolNotificationType(l.method),(a=t.WillRenameFilesRequest||(t.WillRenameFilesRequest={})).method="workspace/willRenameFiles",a.type=new i.ProtocolRequestType(a.method),(o=t.DidRenameFilesNotification||(t.DidRenameFilesNotification={})).method="workspace/didRenameFiles",o.type=new i.ProtocolNotificationType(o.method),(s=t.DidDeleteFilesNotification||(t.DidDeleteFilesNotification={})).method="workspace/didDeleteFiles",s.type=new i.ProtocolNotificationType(s.method),(r=t.WillDeleteFilesRequest||(t.WillDeleteFilesRequest={})).method="workspace/willDeleteFiles",r.type=new i.ProtocolRequestType(r.method)},3394:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FoldingRangeRequest=t.FoldingRangeKind=void 0;const i=n(6140);var r,s;(s=t.FoldingRangeKind||(t.FoldingRangeKind={})).Comment="comment",s.Imports="imports",s.Region="region",(r=t.FoldingRangeRequest||(t.FoldingRangeRequest={})).method="textDocument/foldingRange",r.type=new i.ProtocolRequestType(r.method)},2122:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImplementationRequest=void 0;const i=n(6140);var r;(r=t.ImplementationRequest||(t.ImplementationRequest={})).method="textDocument/implementation",r.type=new i.ProtocolRequestType(r.method)},542:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentLinkRequest=t.CodeLensRefreshRequest=t.CodeLensResolveRequest=t.CodeLensRequest=t.WorkspaceSymbolRequest=t.CodeActionResolveRequest=t.CodeActionRequest=t.DocumentSymbolRequest=t.DocumentHighlightRequest=t.ReferencesRequest=t.DefinitionRequest=t.SignatureHelpRequest=t.SignatureHelpTriggerKind=t.HoverRequest=t.CompletionResolveRequest=t.CompletionRequest=t.CompletionTriggerKind=t.PublishDiagnosticsNotification=t.WatchKind=t.FileChangeType=t.DidChangeWatchedFilesNotification=t.WillSaveTextDocumentWaitUntilRequest=t.WillSaveTextDocumentNotification=t.TextDocumentSaveReason=t.DidSaveTextDocumentNotification=t.DidCloseTextDocumentNotification=t.DidChangeTextDocumentNotification=t.TextDocumentContentChangeEvent=t.DidOpenTextDocumentNotification=t.TextDocumentSyncKind=t.TelemetryEventNotification=t.LogMessageNotification=t.ShowMessageRequest=t.ShowMessageNotification=t.MessageType=t.DidChangeConfigurationNotification=t.ExitNotification=t.ShutdownRequest=t.InitializedNotification=t.InitializeError=t.InitializeRequest=t.WorkDoneProgressOptions=t.TextDocumentRegistrationOptions=t.StaticRegistrationOptions=t.FailureHandlingKind=t.ResourceOperationKind=t.UnregistrationRequest=t.RegistrationRequest=t.DocumentSelector=t.DocumentFilter=void 0,t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.WillRenameFilesRequest=t.DidRenameFilesNotification=t.WillCreateFilesRequest=t.DidCreateFilesNotification=t.FileOperationPatternKind=t.LinkedEditingRangeRequest=t.ShowDocumentRequest=t.SemanticTokensRegistrationType=t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.TokenFormat=t.SemanticTokens=t.SemanticTokenModifiers=t.SemanticTokenTypes=t.CallHierarchyPrepareRequest=t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=t.SelectionRangeRequest=t.DeclarationRequest=t.FoldingRangeRequest=t.ColorPresentationRequest=t.DocumentColorRequest=t.ConfigurationRequest=t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=t.TypeDefinitionRequest=t.ImplementationRequest=t.ApplyWorkspaceEditRequest=t.ExecuteCommandRequest=t.PrepareRenameRequest=t.RenameRequest=t.PrepareSupportDefaultBehavior=t.DocumentOnTypeFormattingRequest=t.DocumentRangeFormattingRequest=t.DocumentFormattingRequest=t.DocumentLinkResolveRequest=void 0;const i=n(9533),r=n(6140),s=n(2122);Object.defineProperty(t,"ImplementationRequest",{enumerable:!0,get:function(){return s.ImplementationRequest}});const o=n(1589);Object.defineProperty(t,"TypeDefinitionRequest",{enumerable:!0,get:function(){return o.TypeDefinitionRequest}});const a=n(9795);Object.defineProperty(t,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return a.WorkspaceFoldersRequest}}),Object.defineProperty(t,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return a.DidChangeWorkspaceFoldersNotification}});const l=n(5934);Object.defineProperty(t,"ConfigurationRequest",{enumerable:!0,get:function(){return l.ConfigurationRequest}});const c=n(9891);Object.defineProperty(t,"DocumentColorRequest",{enumerable:!0,get:function(){return c.DocumentColorRequest}}),Object.defineProperty(t,"ColorPresentationRequest",{enumerable:!0,get:function(){return c.ColorPresentationRequest}});const u=n(3394);Object.defineProperty(t,"FoldingRangeRequest",{enumerable:!0,get:function(){return u.FoldingRangeRequest}});const p=n(764);Object.defineProperty(t,"DeclarationRequest",{enumerable:!0,get:function(){return p.DeclarationRequest}});const d=n(5206);Object.defineProperty(t,"SelectionRangeRequest",{enumerable:!0,get:function(){return d.SelectionRangeRequest}});const h=n(1862);Object.defineProperty(t,"WorkDoneProgress",{enumerable:!0,get:function(){return h.WorkDoneProgress}}),Object.defineProperty(t,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return h.WorkDoneProgressCreateRequest}}),Object.defineProperty(t,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return h.WorkDoneProgressCancelNotification}});const m=n(2918);Object.defineProperty(t,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return m.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(t,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return m.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(t,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return m.CallHierarchyPrepareRequest}});const f=n(9434);Object.defineProperty(t,"SemanticTokenTypes",{enumerable:!0,get:function(){return f.SemanticTokenTypes}}),Object.defineProperty(t,"SemanticTokenModifiers",{enumerable:!0,get:function(){return f.SemanticTokenModifiers}}),Object.defineProperty(t,"SemanticTokens",{enumerable:!0,get:function(){return f.SemanticTokens}}),Object.defineProperty(t,"TokenFormat",{enumerable:!0,get:function(){return f.TokenFormat}}),Object.defineProperty(t,"SemanticTokensRequest",{enumerable:!0,get:function(){return f.SemanticTokensRequest}}),Object.defineProperty(t,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return f.SemanticTokensDeltaRequest}}),Object.defineProperty(t,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return f.SemanticTokensRangeRequest}}),Object.defineProperty(t,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return f.SemanticTokensRefreshRequest}}),Object.defineProperty(t,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return f.SemanticTokensRegistrationType}});const g=n(5726);Object.defineProperty(t,"ShowDocumentRequest",{enumerable:!0,get:function(){return g.ShowDocumentRequest}});const y=n(6305);Object.defineProperty(t,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return y.LinkedEditingRangeRequest}});const _=n(7846);Object.defineProperty(t,"FileOperationPatternKind",{enumerable:!0,get:function(){return _.FileOperationPatternKind}}),Object.defineProperty(t,"DidCreateFilesNotification",{enumerable:!0,get:function(){return _.DidCreateFilesNotification}}),Object.defineProperty(t,"WillCreateFilesRequest",{enumerable:!0,get:function(){return _.WillCreateFilesRequest}}),Object.defineProperty(t,"DidRenameFilesNotification",{enumerable:!0,get:function(){return _.DidRenameFilesNotification}}),Object.defineProperty(t,"WillRenameFilesRequest",{enumerable:!0,get:function(){return _.WillRenameFilesRequest}}),Object.defineProperty(t,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return _.DidDeleteFilesNotification}}),Object.defineProperty(t,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return _.WillDeleteFilesRequest}});const v=n(3443);var T,b,I,S,x,C,w,E,k,D,A,P,R,F,N,M,O,L,U,q,V,B,W,j,z,$,H,G,K,J,Y,Q,Z,X,ee,te,ne,ie,re,se;Object.defineProperty(t,"UniquenessLevel",{enumerable:!0,get:function(){return v.UniquenessLevel}}),Object.defineProperty(t,"MonikerKind",{enumerable:!0,get:function(){return v.MonikerKind}}),Object.defineProperty(t,"MonikerRequest",{enumerable:!0,get:function(){return v.MonikerRequest}}),function(e){e.is=function(e){const t=e;return i.string(t.language)||i.string(t.scheme)||i.string(t.pattern)}}(T=t.DocumentFilter||(t.DocumentFilter={})),function(e){e.is=function(e){if(!Array.isArray(e))return!1;for(let t of e)if(!i.string(t)&&!T.is(t))return!1;return!0}}(b=t.DocumentSelector||(t.DocumentSelector={})),(t.RegistrationRequest||(t.RegistrationRequest={})).type=new r.ProtocolRequestType("client/registerCapability"),(t.UnregistrationRequest||(t.UnregistrationRequest={})).type=new r.ProtocolRequestType("client/unregisterCapability"),(se=t.ResourceOperationKind||(t.ResourceOperationKind={})).Create="create",se.Rename="rename",se.Delete="delete",(re=t.FailureHandlingKind||(t.FailureHandlingKind={})).Abort="abort",re.Transactional="transactional",re.TextOnlyTransactional="textOnlyTransactional",re.Undo="undo",(t.StaticRegistrationOptions||(t.StaticRegistrationOptions={})).hasId=function(e){const t=e;return t&&i.string(t.id)&&t.id.length>0},(t.TextDocumentRegistrationOptions||(t.TextDocumentRegistrationOptions={})).is=function(e){const t=e;return t&&(null===t.documentSelector||b.is(t.documentSelector))},(ie=t.WorkDoneProgressOptions||(t.WorkDoneProgressOptions={})).is=function(e){const t=e;return i.objectLiteral(t)&&(void 0===t.workDoneProgress||i.boolean(t.workDoneProgress))},ie.hasWorkDoneProgress=function(e){const t=e;return t&&i.boolean(t.workDoneProgress)},(t.InitializeRequest||(t.InitializeRequest={})).type=new r.ProtocolRequestType("initialize"),(t.InitializeError||(t.InitializeError={})).unknownProtocolVersion=1,(t.InitializedNotification||(t.InitializedNotification={})).type=new r.ProtocolNotificationType("initialized"),(t.ShutdownRequest||(t.ShutdownRequest={})).type=new r.ProtocolRequestType0("shutdown"),(t.ExitNotification||(t.ExitNotification={})).type=new r.ProtocolNotificationType0("exit"),(t.DidChangeConfigurationNotification||(t.DidChangeConfigurationNotification={})).type=new r.ProtocolNotificationType("workspace/didChangeConfiguration"),(ne=t.MessageType||(t.MessageType={})).Error=1,ne.Warning=2,ne.Info=3,ne.Log=4,(t.ShowMessageNotification||(t.ShowMessageNotification={})).type=new r.ProtocolNotificationType("window/showMessage"),(t.ShowMessageRequest||(t.ShowMessageRequest={})).type=new r.ProtocolRequestType("window/showMessageRequest"),(t.LogMessageNotification||(t.LogMessageNotification={})).type=new r.ProtocolNotificationType("window/logMessage"),(t.TelemetryEventNotification||(t.TelemetryEventNotification={})).type=new r.ProtocolNotificationType("telemetry/event"),(te=t.TextDocumentSyncKind||(t.TextDocumentSyncKind={})).None=0,te.Full=1,te.Incremental=2,(ee=t.DidOpenTextDocumentNotification||(t.DidOpenTextDocumentNotification={})).method="textDocument/didOpen",ee.type=new r.ProtocolNotificationType(ee.method),(X=t.TextDocumentContentChangeEvent||(t.TextDocumentContentChangeEvent={})).isIncremental=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)},X.isFull=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength},(Z=t.DidChangeTextDocumentNotification||(t.DidChangeTextDocumentNotification={})).method="textDocument/didChange",Z.type=new r.ProtocolNotificationType(Z.method),(Q=t.DidCloseTextDocumentNotification||(t.DidCloseTextDocumentNotification={})).method="textDocument/didClose",Q.type=new r.ProtocolNotificationType(Q.method),(Y=t.DidSaveTextDocumentNotification||(t.DidSaveTextDocumentNotification={})).method="textDocument/didSave",Y.type=new r.ProtocolNotificationType(Y.method),(J=t.TextDocumentSaveReason||(t.TextDocumentSaveReason={})).Manual=1,J.AfterDelay=2,J.FocusOut=3,(K=t.WillSaveTextDocumentNotification||(t.WillSaveTextDocumentNotification={})).method="textDocument/willSave",K.type=new r.ProtocolNotificationType(K.method),(G=t.WillSaveTextDocumentWaitUntilRequest||(t.WillSaveTextDocumentWaitUntilRequest={})).method="textDocument/willSaveWaitUntil",G.type=new r.ProtocolRequestType(G.method),(t.DidChangeWatchedFilesNotification||(t.DidChangeWatchedFilesNotification={})).type=new r.ProtocolNotificationType("workspace/didChangeWatchedFiles"),(H=t.FileChangeType||(t.FileChangeType={})).Created=1,H.Changed=2,H.Deleted=3,($=t.WatchKind||(t.WatchKind={})).Create=1,$.Change=2,$.Delete=4,(t.PublishDiagnosticsNotification||(t.PublishDiagnosticsNotification={})).type=new r.ProtocolNotificationType("textDocument/publishDiagnostics"),(z=t.CompletionTriggerKind||(t.CompletionTriggerKind={})).Invoked=1,z.TriggerCharacter=2,z.TriggerForIncompleteCompletions=3,(j=t.CompletionRequest||(t.CompletionRequest={})).method="textDocument/completion",j.type=new r.ProtocolRequestType(j.method),(W=t.CompletionResolveRequest||(t.CompletionResolveRequest={})).method="completionItem/resolve",W.type=new r.ProtocolRequestType(W.method),(B=t.HoverRequest||(t.HoverRequest={})).method="textDocument/hover",B.type=new r.ProtocolRequestType(B.method),(V=t.SignatureHelpTriggerKind||(t.SignatureHelpTriggerKind={})).Invoked=1,V.TriggerCharacter=2,V.ContentChange=3,(q=t.SignatureHelpRequest||(t.SignatureHelpRequest={})).method="textDocument/signatureHelp",q.type=new r.ProtocolRequestType(q.method),(U=t.DefinitionRequest||(t.DefinitionRequest={})).method="textDocument/definition",U.type=new r.ProtocolRequestType(U.method),(L=t.ReferencesRequest||(t.ReferencesRequest={})).method="textDocument/references",L.type=new r.ProtocolRequestType(L.method),(O=t.DocumentHighlightRequest||(t.DocumentHighlightRequest={})).method="textDocument/documentHighlight",O.type=new r.ProtocolRequestType(O.method),(M=t.DocumentSymbolRequest||(t.DocumentSymbolRequest={})).method="textDocument/documentSymbol",M.type=new r.ProtocolRequestType(M.method),(N=t.CodeActionRequest||(t.CodeActionRequest={})).method="textDocument/codeAction",N.type=new r.ProtocolRequestType(N.method),(F=t.CodeActionResolveRequest||(t.CodeActionResolveRequest={})).method="codeAction/resolve",F.type=new r.ProtocolRequestType(F.method),(R=t.WorkspaceSymbolRequest||(t.WorkspaceSymbolRequest={})).method="workspace/symbol",R.type=new r.ProtocolRequestType(R.method),(P=t.CodeLensRequest||(t.CodeLensRequest={})).method="textDocument/codeLens",P.type=new r.ProtocolRequestType(P.method),(A=t.CodeLensResolveRequest||(t.CodeLensResolveRequest={})).method="codeLens/resolve",A.type=new r.ProtocolRequestType(A.method),(D=t.CodeLensRefreshRequest||(t.CodeLensRefreshRequest={})).method="workspace/codeLens/refresh",D.type=new r.ProtocolRequestType0(D.method),(k=t.DocumentLinkRequest||(t.DocumentLinkRequest={})).method="textDocument/documentLink",k.type=new r.ProtocolRequestType(k.method),(E=t.DocumentLinkResolveRequest||(t.DocumentLinkResolveRequest={})).method="documentLink/resolve",E.type=new r.ProtocolRequestType(E.method),(w=t.DocumentFormattingRequest||(t.DocumentFormattingRequest={})).method="textDocument/formatting",w.type=new r.ProtocolRequestType(w.method),(C=t.DocumentRangeFormattingRequest||(t.DocumentRangeFormattingRequest={})).method="textDocument/rangeFormatting",C.type=new r.ProtocolRequestType(C.method),(x=t.DocumentOnTypeFormattingRequest||(t.DocumentOnTypeFormattingRequest={})).method="textDocument/onTypeFormatting",x.type=new r.ProtocolRequestType(x.method),(t.PrepareSupportDefaultBehavior||(t.PrepareSupportDefaultBehavior={})).Identifier=1,(S=t.RenameRequest||(t.RenameRequest={})).method="textDocument/rename",S.type=new r.ProtocolRequestType(S.method),(I=t.PrepareRenameRequest||(t.PrepareRenameRequest={})).method="textDocument/prepareRename",I.type=new r.ProtocolRequestType(I.method),(t.ExecuteCommandRequest||(t.ExecuteCommandRequest={})).type=new r.ProtocolRequestType("workspace/executeCommand"),(t.ApplyWorkspaceEditRequest||(t.ApplyWorkspaceEditRequest={})).type=new r.ProtocolRequestType("workspace/applyEdit")},6305:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeRequest=void 0;const i=n(6140);var r;(r=t.LinkedEditingRangeRequest||(t.LinkedEditingRangeRequest={})).method="textDocument/linkedEditingRange",r.type=new i.ProtocolRequestType(r.method)},3443:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=void 0;const i=n(6140);var r,s,o;(o=t.UniquenessLevel||(t.UniquenessLevel={})).document="document",o.project="project",o.group="group",o.scheme="scheme",o.global="global",(s=t.MonikerKind||(t.MonikerKind={})).import="import",s.export="export",s.local="local",(r=t.MonikerRequest||(t.MonikerRequest={})).method="textDocument/moniker",r.type=new i.ProtocolRequestType(r.method)},1862:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=void 0;const i=n(9054),r=n(6140);var s;(s=t.WorkDoneProgress||(t.WorkDoneProgress={})).type=new i.ProgressType,s.is=function(e){return e===s.type},(t.WorkDoneProgressCreateRequest||(t.WorkDoneProgressCreateRequest={})).type=new r.ProtocolRequestType("window/workDoneProgress/create"),(t.WorkDoneProgressCancelNotification||(t.WorkDoneProgressCancelNotification={})).type=new r.ProtocolNotificationType("window/workDoneProgress/cancel")},5206:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRangeRequest=void 0;const i=n(6140);var r;(r=t.SelectionRangeRequest||(t.SelectionRangeRequest={})).method="textDocument/selectionRange",r.type=new i.ProtocolRequestType(r.method)},9434:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.SemanticTokensRegistrationType=t.TokenFormat=t.SemanticTokens=t.SemanticTokenModifiers=t.SemanticTokenTypes=void 0;const i=n(6140);var r,s,o,a,l,c,u;(u=t.SemanticTokenTypes||(t.SemanticTokenTypes={})).namespace="namespace",u.type="type",u.class="class",u.enum="enum",u.interface="interface",u.struct="struct",u.typeParameter="typeParameter",u.parameter="parameter",u.variable="variable",u.property="property",u.enumMember="enumMember",u.event="event",u.function="function",u.method="method",u.macro="macro",u.keyword="keyword",u.modifier="modifier",u.comment="comment",u.string="string",u.number="number",u.regexp="regexp",u.operator="operator",(c=t.SemanticTokenModifiers||(t.SemanticTokenModifiers={})).declaration="declaration",c.definition="definition",c.readonly="readonly",c.static="static",c.deprecated="deprecated",c.abstract="abstract",c.async="async",c.modification="modification",c.documentation="documentation",c.defaultLibrary="defaultLibrary",(t.SemanticTokens||(t.SemanticTokens={})).is=function(e){const t=e;return void 0!==t&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])},(t.TokenFormat||(t.TokenFormat={})).Relative="relative",(l=t.SemanticTokensRegistrationType||(t.SemanticTokensRegistrationType={})).method="textDocument/semanticTokens",l.type=new i.RegistrationType(l.method),(a=t.SemanticTokensRequest||(t.SemanticTokensRequest={})).method="textDocument/semanticTokens/full",a.type=new i.ProtocolRequestType(a.method),(o=t.SemanticTokensDeltaRequest||(t.SemanticTokensDeltaRequest={})).method="textDocument/semanticTokens/full/delta",o.type=new i.ProtocolRequestType(o.method),(s=t.SemanticTokensRangeRequest||(t.SemanticTokensRangeRequest={})).method="textDocument/semanticTokens/range",s.type=new i.ProtocolRequestType(s.method),(r=t.SemanticTokensRefreshRequest||(t.SemanticTokensRefreshRequest={})).method="workspace/semanticTokens/refresh",r.type=new i.ProtocolRequestType0(r.method)},5726:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentRequest=void 0;const i=n(6140);var r;(r=t.ShowDocumentRequest||(t.ShowDocumentRequest={})).method="window/showDocument",r.type=new i.ProtocolRequestType(r.method)},1589:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeDefinitionRequest=void 0;const i=n(6140);var r;(r=t.TypeDefinitionRequest||(t.TypeDefinitionRequest={})).method="textDocument/typeDefinition",r.type=new i.ProtocolRequestType(r.method)},9795:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=void 0;const i=n(6140);(t.WorkspaceFoldersRequest||(t.WorkspaceFoldersRequest={})).type=new i.ProtocolRequestType0("workspace/workspaceFolders"),(t.DidChangeWorkspaceFoldersNotification||(t.DidChangeWorkspaceFoldersNotification={})).type=new i.ProtocolNotificationType("workspace/didChangeWorkspaceFolders")},9533:(e,t)=>{"use strict";function n(e){return"string"==typeof e||e instanceof String}function i(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.objectLiteral=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=i,t.stringArray=function(e){return i(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.objectLiteral=function(e){return null!==e&&"object"==typeof e}},1674:(e,t,n)=>{"use strict";var i,r,s,o,a,l,c,u,p,d,h,m,f,g,y,_,v,T,b,I,S,x,C,w,E,k;n.r(t),n.d(t,{integer:()=>i,uinteger:()=>r,Position:()=>s,Range:()=>o,Location:()=>a,LocationLink:()=>l,Color:()=>c,ColorInformation:()=>u,ColorPresentation:()=>p,FoldingRangeKind:()=>d,FoldingRange:()=>h,DiagnosticRelatedInformation:()=>m,DiagnosticSeverity:()=>f,DiagnosticTag:()=>g,CodeDescription:()=>y,Diagnostic:()=>_,Command:()=>v,TextEdit:()=>T,ChangeAnnotation:()=>b,ChangeAnnotationIdentifier:()=>I,AnnotatedTextEdit:()=>S,TextDocumentEdit:()=>x,CreateFile:()=>C,RenameFile:()=>w,DeleteFile:()=>E,WorkspaceEdit:()=>k,WorkspaceChange:()=>ae,TextDocumentIdentifier:()=>D,VersionedTextDocumentIdentifier:()=>A,OptionalVersionedTextDocumentIdentifier:()=>P,TextDocumentItem:()=>R,MarkupKind:()=>F,MarkupContent:()=>N,CompletionItemKind:()=>M,InsertTextFormat:()=>O,CompletionItemTag:()=>L,InsertReplaceEdit:()=>U,InsertTextMode:()=>q,CompletionItem:()=>V,CompletionList:()=>B,MarkedString:()=>W,Hover:()=>j,ParameterInformation:()=>z,SignatureInformation:()=>$,DocumentHighlightKind:()=>H,DocumentHighlight:()=>G,SymbolKind:()=>K,SymbolTag:()=>J,SymbolInformation:()=>Y,DocumentSymbol:()=>Q,CodeActionKind:()=>Z,CodeActionContext:()=>X,CodeAction:()=>ee,CodeLens:()=>te,FormattingOptions:()=>ne,DocumentLink:()=>ie,SelectionRange:()=>re,EOL:()=>ce,TextDocument:()=>le}),function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647}(i||(i={})),function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647}(r||(r={})),function(e){e.create=function(e,t){return e===Number.MAX_VALUE&&(e=r.MAX_VALUE),t===Number.MAX_VALUE&&(t=r.MAX_VALUE),{line:e,character:t}},e.is=function(e){var t=e;return ue.objectLiteral(t)&&ue.uinteger(t.line)&&ue.uinteger(t.character)}}(s||(s={})),function(e){e.create=function(e,t,n,i){if(ue.uinteger(e)&&ue.uinteger(t)&&ue.uinteger(n)&&ue.uinteger(i))return{start:s.create(e,t),end:s.create(n,i)};if(s.is(e)&&s.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments["+e+", "+t+", "+n+", "+i+"]")},e.is=function(e){var t=e;return ue.objectLiteral(t)&&s.is(t.start)&&s.is(t.end)}}(o||(o={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return ue.defined(t)&&o.is(t.range)&&(ue.string(t.uri)||ue.undefined(t.uri))}}(a||(a={})),function(e){e.create=function(e,t,n,i){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:i}},e.is=function(e){var t=e;return ue.defined(t)&&o.is(t.targetRange)&&ue.string(t.targetUri)&&(o.is(t.targetSelectionRange)||ue.undefined(t.targetSelectionRange))&&(o.is(t.originSelectionRange)||ue.undefined(t.originSelectionRange))}}(l||(l={})),function(e){e.create=function(e,t,n,i){return{red:e,green:t,blue:n,alpha:i}},e.is=function(e){var t=e;return ue.numberRange(t.red,0,1)&&ue.numberRange(t.green,0,1)&&ue.numberRange(t.blue,0,1)&&ue.numberRange(t.alpha,0,1)}}(c||(c={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return o.is(t.range)&&c.is(t.color)}}(u||(u={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){var t=e;return ue.string(t.label)&&(ue.undefined(t.textEdit)||T.is(t))&&(ue.undefined(t.additionalTextEdits)||ue.typedArray(t.additionalTextEdits,T.is))}}(p||(p={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(d||(d={})),function(e){e.create=function(e,t,n,i,r){var s={startLine:e,endLine:t};return ue.defined(n)&&(s.startCharacter=n),ue.defined(i)&&(s.endCharacter=i),ue.defined(r)&&(s.kind=r),s},e.is=function(e){var t=e;return ue.uinteger(t.startLine)&&ue.uinteger(t.startLine)&&(ue.undefined(t.startCharacter)||ue.uinteger(t.startCharacter))&&(ue.undefined(t.endCharacter)||ue.uinteger(t.endCharacter))&&(ue.undefined(t.kind)||ue.string(t.kind))}}(h||(h={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return ue.defined(t)&&a.is(t.location)&&ue.string(t.message)}}(m||(m={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(f||(f={})),function(e){e.Unnecessary=1,e.Deprecated=2}(g||(g={})),function(e){e.is=function(e){var t=e;return null!=t&&ue.string(t.href)}}(y||(y={})),function(e){e.create=function(e,t,n,i,r,s){var o={range:e,message:t};return ue.defined(n)&&(o.severity=n),ue.defined(i)&&(o.code=i),ue.defined(r)&&(o.source=r),ue.defined(s)&&(o.relatedInformation=s),o},e.is=function(e){var t,n=e;return ue.defined(n)&&o.is(n.range)&&ue.string(n.message)&&(ue.number(n.severity)||ue.undefined(n.severity))&&(ue.integer(n.code)||ue.string(n.code)||ue.undefined(n.code))&&(ue.undefined(n.codeDescription)||ue.string(null===(t=n.codeDescription)||void 0===t?void 0:t.href))&&(ue.string(n.source)||ue.undefined(n.source))&&(ue.undefined(n.relatedInformation)||ue.typedArray(n.relatedInformation,m.is))}}(_||(_={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r={title:e,command:t};return ue.defined(n)&&n.length>0&&(r.arguments=n),r},e.is=function(e){var t=e;return ue.defined(t)&&ue.string(t.title)&&ue.string(t.command)}}(v||(v={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return ue.objectLiteral(t)&&ue.string(t.newText)&&o.is(t.range)}}(T||(T={})),function(e){e.create=function(e,t,n){var i={label:e};return void 0!==t&&(i.needsConfirmation=t),void 0!==n&&(i.description=n),i},e.is=function(e){var t=e;return void 0!==t&&ue.objectLiteral(t)&&ue.string(t.label)&&(ue.boolean(t.needsConfirmation)||void 0===t.needsConfirmation)&&(ue.string(t.description)||void 0===t.description)}}(b||(b={})),function(e){e.is=function(e){return"string"==typeof e}}(I||(I={})),function(e){e.replace=function(e,t,n){return{range:e,newText:t,annotationId:n}},e.insert=function(e,t,n){return{range:{start:e,end:e},newText:t,annotationId:n}},e.del=function(e,t){return{range:e,newText:"",annotationId:t}},e.is=function(e){var t=e;return T.is(t)&&(b.is(t.annotationId)||I.is(t.annotationId))}}(S||(S={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return ue.defined(t)&&P.is(t.textDocument)&&Array.isArray(t.edits)}}(x||(x={})),function(e){e.create=function(e,t,n){var i={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){var t=e;return t&&"create"===t.kind&&ue.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||ue.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||ue.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||I.is(t.annotationId))}}(C||(C={})),function(e){e.create=function(e,t,n,i){var r={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(r.options=n),void 0!==i&&(r.annotationId=i),r},e.is=function(e){var t=e;return t&&"rename"===t.kind&&ue.string(t.oldUri)&&ue.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||ue.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||ue.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||I.is(t.annotationId))}}(w||(w={})),function(e){e.create=function(e,t,n){var i={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){var t=e;return t&&"delete"===t.kind&&ue.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||ue.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||ue.boolean(t.options.ignoreIfNotExists)))&&(void 0===t.annotationId||I.is(t.annotationId))}}(E||(E={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return ue.string(e.kind)?C.is(e)||w.is(e)||E.is(e):x.is(e)})))}}(k||(k={}));var D,A,P,R,F,N,M,O,L,U,q,V,B,W,j,z,$,H,G,K,J,Y,Q,Z,X,ee,te,ne,ie,re,se=function(){function e(e,t){this.edits=e,this.changeAnnotations=t}return e.prototype.insert=function(e,t,n){var i,r;if(void 0===n?i=T.insert(e,t):I.is(n)?(r=n,i=S.insert(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),r=this.changeAnnotations.manage(n),i=S.insert(e,t,r)),this.edits.push(i),void 0!==r)return r},e.prototype.replace=function(e,t,n){var i,r;if(void 0===n?i=T.replace(e,t):I.is(n)?(r=n,i=S.replace(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),r=this.changeAnnotations.manage(n),i=S.replace(e,t,r)),this.edits.push(i),void 0!==r)return r},e.prototype.delete=function(e,t){var n,i;if(void 0===t?n=T.del(e):I.is(t)?(i=t,n=S.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(t),n=S.del(e,i)),this.edits.push(n),void 0!==i)return i},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e.prototype.assertChangeAnnotations=function(e){if(void 0===e)throw new Error("Text edit change is not configured to manage change annotations.")},e}(),oe=function(){function e(e){this._annotations=void 0===e?Object.create(null):e,this._counter=0,this._size=0}return e.prototype.all=function(){return this._annotations},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.manage=function(e,t){var n;if(I.is(e)?n=e:(n=this.nextId(),t=e),void 0!==this._annotations[n])throw new Error("Id "+n+" is already in use.");if(void 0===t)throw new Error("No annotation provided for id "+n);return this._annotations[n]=t,this._size++,n},e.prototype.nextId=function(){return this._counter++,this._counter.toString()},e}(),ae=function(){function e(e){var t=this;this._textEditChanges=Object.create(null),void 0!==e?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new oe(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach((function(e){if(x.is(e)){var n=new se(e.edits,t._changeAnnotations);t._textEditChanges[e.textDocument.uri]=n}}))):e.changes&&Object.keys(e.changes).forEach((function(n){var i=new se(e.changes[n]);t._textEditChanges[n]=i}))):this._workspaceEdit={}}return Object.defineProperty(e.prototype,"edit",{get:function(){return this.initDocumentChanges(),void 0!==this._changeAnnotations&&(0===this._changeAnnotations.size?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),e.prototype.getTextEditChange=function(e){if(P.is(e)){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t={uri:e.uri,version:e.version};if(!(i=this._textEditChanges[t.uri])){var n={textDocument:t,edits:r=[]};this._workspaceEdit.documentChanges.push(n),i=new se(r,this._changeAnnotations),this._textEditChanges[t.uri]=i}return i}if(this.initChanges(),void 0===this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var i;if(!(i=this._textEditChanges[e])){var r=[];this._workspaceEdit.changes[e]=r,i=new se(r),this._textEditChanges[e]=i}return i},e.prototype.initDocumentChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._changeAnnotations=new oe,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},e.prototype.initChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._workspaceEdit.changes=Object.create(null))},e.prototype.createFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var i,r,s;if(b.is(t)||I.is(t)?i=t:n=t,void 0===i?r=C.create(e,n):(s=I.is(i)?i:this._changeAnnotations.manage(i),r=C.create(e,n,s)),this._workspaceEdit.documentChanges.push(r),void 0!==s)return s},e.prototype.renameFile=function(e,t,n,i){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var r,s,o;if(b.is(n)||I.is(n)?r=n:i=n,void 0===r?s=w.create(e,t,i):(o=I.is(r)?r:this._changeAnnotations.manage(r),s=w.create(e,t,i,o)),this._workspaceEdit.documentChanges.push(s),void 0!==o)return o},e.prototype.deleteFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var i,r,s;if(b.is(t)||I.is(t)?i=t:n=t,void 0===i?r=E.create(e,n):(s=I.is(i)?i:this._changeAnnotations.manage(i),r=E.create(e,n,s)),this._workspaceEdit.documentChanges.push(r),void 0!==s)return s},e}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return ue.defined(t)&&ue.string(t.uri)}}(D||(D={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return ue.defined(t)&&ue.string(t.uri)&&ue.integer(t.version)}}(A||(A={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return ue.defined(t)&&ue.string(t.uri)&&(null===t.version||ue.integer(t.version))}}(P||(P={})),function(e){e.create=function(e,t,n,i){return{uri:e,languageId:t,version:n,text:i}},e.is=function(e){var t=e;return ue.defined(t)&&ue.string(t.uri)&&ue.string(t.languageId)&&ue.integer(t.version)&&ue.string(t.text)}}(R||(R={})),function(e){e.PlainText="plaintext",e.Markdown="markdown"}(F||(F={})),function(e){e.is=function(t){var n=t;return n===e.PlainText||n===e.Markdown}}(F||(F={})),function(e){e.is=function(e){var t=e;return ue.objectLiteral(e)&&F.is(t.kind)&&ue.string(t.value)}}(N||(N={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(M||(M={})),function(e){e.PlainText=1,e.Snippet=2}(O||(O={})),function(e){e.Deprecated=1}(L||(L={})),function(e){e.create=function(e,t,n){return{newText:e,insert:t,replace:n}},e.is=function(e){var t=e;return t&&ue.string(t.newText)&&o.is(t.insert)&&o.is(t.replace)}}(U||(U={})),function(e){e.asIs=1,e.adjustIndentation=2}(q||(q={})),function(e){e.create=function(e){return{label:e}}}(V||(V={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(B||(B={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return ue.string(t)||ue.objectLiteral(t)&&ue.string(t.language)&&ue.string(t.value)}}(W||(W={})),function(e){e.is=function(e){var t=e;return!!t&&ue.objectLiteral(t)&&(N.is(t.contents)||W.is(t.contents)||ue.typedArray(t.contents,W.is))&&(void 0===e.range||o.is(e.range))}}(j||(j={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(z||(z={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r={label:e};return ue.defined(t)&&(r.documentation=t),ue.defined(n)?r.parameters=n:r.parameters=[],r}}($||($={})),function(e){e.Text=1,e.Read=2,e.Write=3}(H||(H={})),function(e){e.create=function(e,t){var n={range:e};return ue.number(t)&&(n.kind=t),n}}(G||(G={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(K||(K={})),function(e){e.Deprecated=1}(J||(J={})),function(e){e.create=function(e,t,n,i,r){var s={name:e,kind:t,location:{uri:i,range:n}};return r&&(s.containerName=r),s}}(Y||(Y={})),function(e){e.create=function(e,t,n,i,r,s){var o={name:e,detail:t,kind:n,range:i,selectionRange:r};return void 0!==s&&(o.children=s),o},e.is=function(e){var t=e;return t&&ue.string(t.name)&&ue.number(t.kind)&&o.is(t.range)&&o.is(t.selectionRange)&&(void 0===t.detail||ue.string(t.detail))&&(void 0===t.deprecated||ue.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))&&(void 0===t.tags||Array.isArray(t.tags))}}(Q||(Q={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(Z||(Z={})),function(e){e.create=function(e,t){var n={diagnostics:e};return null!=t&&(n.only=t),n},e.is=function(e){var t=e;return ue.defined(t)&&ue.typedArray(t.diagnostics,_.is)&&(void 0===t.only||ue.typedArray(t.only,ue.string))}}(X||(X={})),function(e){e.create=function(e,t,n){var i={title:e},r=!0;return"string"==typeof t?(r=!1,i.kind=t):v.is(t)?i.command=t:i.edit=t,r&&void 0!==n&&(i.kind=n),i},e.is=function(e){var t=e;return t&&ue.string(t.title)&&(void 0===t.diagnostics||ue.typedArray(t.diagnostics,_.is))&&(void 0===t.kind||ue.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||v.is(t.command))&&(void 0===t.isPreferred||ue.boolean(t.isPreferred))&&(void 0===t.edit||k.is(t.edit))}}(ee||(ee={})),function(e){e.create=function(e,t){var n={range:e};return ue.defined(t)&&(n.data=t),n},e.is=function(e){var t=e;return ue.defined(t)&&o.is(t.range)&&(ue.undefined(t.command)||v.is(t.command))}}(te||(te={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return ue.defined(t)&&ue.uinteger(t.tabSize)&&ue.boolean(t.insertSpaces)}}(ne||(ne={})),function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){var t=e;return ue.defined(t)&&o.is(t.range)&&(ue.undefined(t.target)||ue.string(t.target))}}(ie||(ie={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){var n=t;return void 0!==n&&o.is(n.range)&&(void 0===n.parent||e.is(n.parent))}}(re||(re={}));var le,ce=["\n","\r\n","\r"];!function(e){function t(e,n){if(e.length<=1)return e;var i=e.length/2|0,r=e.slice(0,i),s=e.slice(i);t(r,n),t(s,n);for(var o=0,a=0,l=0;o<r.length&&a<s.length;){var c=n(r[o],s[a]);e[l++]=c<=0?r[o++]:s[a++]}for(;o<r.length;)e[l++]=r[o++];for(;a<s.length;)e[l++]=s[a++];return e}e.create=function(e,t,n,i){return new pe(e,t,n,i)},e.is=function(e){var t=e;return!!(ue.defined(t)&&ue.string(t.uri)&&(ue.undefined(t.languageId)||ue.string(t.languageId))&&ue.uinteger(t.lineCount)&&ue.func(t.getText)&&ue.func(t.positionAt)&&ue.func(t.offsetAt))},e.applyEdits=function(e,n){for(var i=e.getText(),r=t(n,(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),s=i.length,o=r.length-1;o>=0;o--){var a=r[o],l=e.offsetAt(a.range.start),c=e.offsetAt(a.range.end);if(!(c<=s))throw new Error("Overlapping edit");i=i.substring(0,l)+a.newText+i.substring(c,i.length),s=l}return i}}(le||(le={}));var ue,pe=function(){function e(e,t,n,i){this._uri=e,this._languageId=t,this._version=n,this._content=i,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(void 0===this._lineOffsets){for(var e=[],t=this._content,n=!0,i=0;i<t.length;i++){n&&(e.push(i),n=!1);var r=t.charAt(i);n="\r"===r||"\n"===r,"\r"===r&&i+1<t.length&&"\n"===t.charAt(i+1)&&i++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,i=t.length;if(0===i)return s.create(0,e);for(;n<i;){var r=Math.floor((n+i)/2);t[r]>e?i=r:n=r+1}var o=n-1;return s.create(o,e-t[o])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.numberRange=function(e,n,i){return"[object Number]"===t.call(e)&&n<=e&&e<=i},e.integer=function(e){return"[object Number]"===t.call(e)&&-2147483648<=e&&e<=2147483647},e.uinteger=function(e){return"[object Number]"===t.call(e)&&0<=e&&e<=2147483647},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(ue||(ue={}))},3984:(e,t,n)=>{"use strict";e.exports=n(7630)},7630:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=void 0;const s=n(6265);r(n(5224),t),r(n(6265),t);let o=!1;const a={initialize:e=>{},get shutdownReceived(){return o},set shutdownReceived(e){o=e},exit:e=>{}};t.createConnection=function(e,t,n,i){let r,o,l,c;return void 0!==e&&"features"===e.__brand&&(r=e,e=t,t=n,n=i),s.ConnectionStrategy.is(e)||s.ConnectionOptions.is(e)?c=e:(o=e,l=t,c=n),s.createConnection((e=>s.createProtocolConnection(o,l,e,c)),a,r)}},6265:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.ProposedFeatures=t.SemanticTokensBuilder=void 0;const s=n(9817);Object.defineProperty(t,"SemanticTokensBuilder",{enumerable:!0,get:function(){return s.SemanticTokensBuilder}}),r(n(152),t),r(n(5878),t),(t.ProposedFeatures||(t.ProposedFeatures={})).all={__brand:"features"}},7985:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyFeature=void 0;const i=n(152);t.CallHierarchyFeature=e=>class extends e{get callHierarchy(){return{onPrepare:e=>{this.connection.onRequest(i.CallHierarchyPrepareRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0)))},onIncomingCalls:e=>{const t=i.CallHierarchyIncomingCallsRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onOutgoingCalls:e=>{const t=i.CallHierarchyOutgoingCallsRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},2507:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationFeature=void 0;const i=n(152),r=n(289);t.ConfigurationFeature=e=>class extends e{getConfiguration(e){return e?r.string(e)?this._getConfiguration({section:e}):this._getConfiguration(e):this._getConfiguration({})}_getConfiguration(e){let t={items:Array.isArray(e)?e:[e]};return this.connection.sendRequest(i.ConfigurationRequest.type,t).then((t=>Array.isArray(e)?t:t[0]))}}},828:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileOperationsFeature=void 0;const i=n(152);t.FileOperationsFeature=e=>class extends e{onDidCreateFiles(e){this.connection.onNotification(i.DidCreateFilesNotification.type,(t=>{e(t)}))}onDidRenameFiles(e){this.connection.onNotification(i.DidRenameFilesNotification.type,(t=>{e(t)}))}onDidDeleteFiles(e){this.connection.onNotification(i.DidDeleteFilesNotification.type,(t=>{e(t)}))}onWillCreateFiles(e){return this.connection.onRequest(i.WillCreateFilesRequest.type,((t,n)=>e(t,n)))}onWillRenameFiles(e){return this.connection.onRequest(i.WillRenameFilesRequest.type,((t,n)=>e(t,n)))}onWillDeleteFiles(e){return this.connection.onRequest(i.WillDeleteFilesRequest.type,((t,n)=>e(t,n)))}}},2776:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeFeature=void 0;const i=n(152);t.LinkedEditingRangeFeature=e=>class extends e{onLinkedEditingRange(e){this.connection.onRequest(i.LinkedEditingRangeRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0)))}}},8120:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerFeature=void 0;const i=n(152);t.MonikerFeature=e=>class extends e{get moniker(){return{on:e=>{const t=i.MonikerRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},2731:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachPartialResult=t.ProgressFeature=t.attachWorkDone=void 0;const i=n(152),r=n(7560);class s{constructor(e,t){this._connection=e,this._token=t,s.Instances.set(this._token,this)}begin(e,t,n,r){let s={kind:"begin",title:e,percentage:t,message:n,cancellable:r};this._connection.sendProgress(i.WorkDoneProgress.type,this._token,s)}report(e,t){let n={kind:"report"};"number"==typeof e?(n.percentage=e,void 0!==t&&(n.message=t)):n.message=e,this._connection.sendProgress(i.WorkDoneProgress.type,this._token,n)}done(){s.Instances.delete(this._token),this._connection.sendProgress(i.WorkDoneProgress.type,this._token,{kind:"end"})}}s.Instances=new Map;class o extends s{constructor(e,t){super(e,t),this._source=new i.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}}class a{constructor(){}begin(){}report(){}done(){}}class l extends a{constructor(){super(),this._source=new i.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}}var c;t.attachWorkDone=function(e,t){if(void 0===t||void 0===t.workDoneToken)return new a;const n=t.workDoneToken;return delete t.workDoneToken,new s(e,n)},t.ProgressFeature=e=>class extends e{constructor(){super(),this._progressSupported=!1}initialize(e){var t;!0===(null===(t=null==e?void 0:e.window)||void 0===t?void 0:t.workDoneProgress)&&(this._progressSupported=!0,this.connection.onNotification(i.WorkDoneProgressCancelNotification.type,(e=>{let t=s.Instances.get(e.token);(t instanceof o||t instanceof l)&&t.cancel()})))}attachWorkDoneProgress(e){return void 0===e?new a:new s(this.connection,e)}createWorkDoneProgress(){if(this._progressSupported){const e=r.generateUuid();return this.connection.sendRequest(i.WorkDoneProgressCreateRequest.type,{token:e}).then((()=>new o(this.connection,e)))}return Promise.resolve(new l)}},function(e){e.type=new i.ProgressType}(c||(c={}));class u{constructor(e,t){this._connection=e,this._token=t}report(e){this._connection.sendProgress(c.type,this._token,e)}}t.attachPartialResult=function(e,t){if(void 0===t||void 0===t.partialResultToken)return;const n=t.partialResultToken;return delete t.partialResultToken,new u(e,n)}},9817:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensBuilder=t.SemanticTokensFeature=void 0;const i=n(152);t.SemanticTokensFeature=e=>class extends e{get semanticTokens(){return{on:e=>{const t=i.SemanticTokensRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onDelta:e=>{const t=i.SemanticTokensDeltaRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onRange:e=>{const t=i.SemanticTokensRangeRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}},t.SemanticTokensBuilder=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(e,t,n,i,r){let s=e,o=t;this._dataLen>0&&(s-=this._prevLine,0===s&&(o-=this._prevChar)),this._data[this._dataLen++]=s,this._data[this._dataLen++]=o,this._data[this._dataLen++]=n,this._data[this._dataLen++]=i,this._data[this._dataLen++]=r,this._prevLine=e,this._prevChar=t}get id(){return this._id.toString()}previousResult(e){this.id===e&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return void 0!==this._prevData}buildEdits(){if(void 0!==this._prevData){const e=this._prevData.length,t=this._data.length;let n=0;for(;n<t&&n<e&&this._prevData[n]===this._data[n];)n++;if(n<t&&n<e){let i=0;for(;i<t&&i<e&&this._prevData[e-1-i]===this._data[t-1-i];)i++;const r=this._data.slice(n,t-i);return{resultId:this.id,edits:[{start:n,deleteCount:e-i-n,data:r}]}}return n<t?{resultId:this.id,edits:[{start:n,deleteCount:0,data:this._data.slice(n)}]}:n<e?{resultId:this.id,edits:[{start:n,deleteCount:e-n}]}:{resultId:this.id,edits:[]}}return this.build()}}},5878:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=t.combineFeatures=t.combineLanguagesFeatures=t.combineWorkspaceFeatures=t.combineWindowFeatures=t.combineClientFeatures=t.combineTracerFeatures=t.combineTelemetryFeatures=t.combineConsoleFeatures=t._LanguagesImpl=t.BulkUnregistration=t.BulkRegistration=t.ErrorMessageTracker=t.TextDocuments=void 0;const i=n(152),r=n(289),s=n(7560),o=n(2731),a=n(2507),l=n(8634),c=n(7985),u=n(9817),p=n(5421),d=n(828),h=n(2776),m=n(8120);function f(e){if(null!==e)return e}t.TextDocuments=class{constructor(e){this._documents=Object.create(null),this._configuration=e,this._onDidChangeContent=new i.Emitter,this._onDidOpen=new i.Emitter,this._onDidClose=new i.Emitter,this._onDidSave=new i.Emitter,this._onWillSave=new i.Emitter}get onDidChangeContent(){return this._onDidChangeContent.event}get onDidOpen(){return this._onDidOpen.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._documents[e]}all(){return Object.keys(this._documents).map((e=>this._documents[e]))}keys(){return Object.keys(this._documents)}listen(e){e.__textDocumentSync=i.TextDocumentSyncKind.Full,e.onDidOpenTextDocument((e=>{let t=e.textDocument,n=this._configuration.create(t.uri,t.languageId,t.version,t.text);this._documents[t.uri]=n;let i=Object.freeze({document:n});this._onDidOpen.fire(i),this._onDidChangeContent.fire(i)})),e.onDidChangeTextDocument((e=>{let t=e.textDocument,n=e.contentChanges;if(0===n.length)return;let i=this._documents[t.uri];const{version:r}=t;if(null==r)throw new Error(`Received document change event for ${t.uri} without valid version identifier`);i=this._configuration.update(i,n,r),this._documents[t.uri]=i,this._onDidChangeContent.fire(Object.freeze({document:i}))})),e.onDidCloseTextDocument((e=>{let t=this._documents[e.textDocument.uri];t&&(delete this._documents[e.textDocument.uri],this._onDidClose.fire(Object.freeze({document:t})))})),e.onWillSaveTextDocument((e=>{let t=this._documents[e.textDocument.uri];t&&this._onWillSave.fire(Object.freeze({document:t,reason:e.reason}))})),e.onWillSaveTextDocumentWaitUntil(((e,t)=>{let n=this._documents[e.textDocument.uri];return n&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:n,reason:e.reason}),t):[]})),e.onDidSaveTextDocument((e=>{let t=this._documents[e.textDocument.uri];t&&this._onDidSave.fire(Object.freeze({document:t}))}))}},t.ErrorMessageTracker=class{constructor(){this._messages=Object.create(null)}add(e){let t=this._messages[e];t||(t=0),t++,this._messages[e]=t}sendErrors(e){Object.keys(this._messages).forEach((t=>{e.window.showErrorMessage(t)}))}};class g{constructor(){}rawAttach(e){this._rawConnection=e}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(e){}initialize(e){}error(e){this.send(i.MessageType.Error,e)}warn(e){this.send(i.MessageType.Warning,e)}info(e){this.send(i.MessageType.Info,e)}log(e){this.send(i.MessageType.Log,e)}send(e,t){this._rawConnection&&this._rawConnection.sendNotification(i.LogMessageNotification.type,{type:e,message:t})}}const y=p.ShowDocumentFeature(o.ProgressFeature(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}showErrorMessage(e,...t){let n={type:i.MessageType.Error,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(f)}showWarningMessage(e,...t){let n={type:i.MessageType.Warning,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(f)}showInformationMessage(e,...t){let n={type:i.MessageType.Info,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(f)}}));(t.BulkRegistration||(t.BulkRegistration={})).create=function(){return new _};class _{constructor(){this._registrations=[],this._registered=new Set}add(e,t){const n=r.string(e)?e:e.method;if(this._registered.has(n))throw new Error(`${n} is already added to this registration`);const i=s.generateUuid();this._registrations.push({id:i,method:n,registerOptions:t||{}}),this._registered.add(n)}asRegistrationParams(){return{registrations:this._registrations}}}(t.BulkUnregistration||(t.BulkUnregistration={})).create=function(){return new v(void 0,[])};class v{constructor(e,t){this._connection=e,this._unregistrations=new Map,t.forEach((e=>{this._unregistrations.set(e.method,e)}))}get isAttached(){return!!this._connection}attach(e){this._connection=e}add(e){this._unregistrations.set(e.method,e)}dispose(){let e=[];for(let t of this._unregistrations.values())e.push(t);let t={unregisterations:e};this._connection.sendRequest(i.UnregistrationRequest.type,t).then(void 0,(e=>{this._connection.console.info("Bulk unregistration failed.")}))}disposeSingle(e){const t=r.string(e)?e:e.method,n=this._unregistrations.get(t);if(!n)return!1;let s={unregisterations:[n]};return this._connection.sendRequest(i.UnregistrationRequest.type,s).then((()=>{this._unregistrations.delete(t)}),(e=>{this._connection.console.info(`Un-registering request handler for ${n.id} failed.`)})),!0}}class T{attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}register(e,t,n){return e instanceof _?this.registerMany(e):e instanceof v?this.registerSingle1(e,t,n):this.registerSingle2(e,t)}registerSingle1(e,t,n){const o=r.string(t)?t:t.method,a=s.generateUuid();let l={registrations:[{id:a,method:o,registerOptions:n||{}}]};return e.isAttached||e.attach(this.connection),this.connection.sendRequest(i.RegistrationRequest.type,l).then((t=>(e.add({id:a,method:o}),e)),(e=>(this.connection.console.info(`Registering request handler for ${o} failed.`),Promise.reject(e))))}registerSingle2(e,t){const n=r.string(e)?e:e.method,o=s.generateUuid();let a={registrations:[{id:o,method:n,registerOptions:t||{}}]};return this.connection.sendRequest(i.RegistrationRequest.type,a).then((e=>i.Disposable.create((()=>{this.unregisterSingle(o,n)}))),(e=>(this.connection.console.info(`Registering request handler for ${n} failed.`),Promise.reject(e))))}unregisterSingle(e,t){let n={unregisterations:[{id:e,method:t}]};return this.connection.sendRequest(i.UnregistrationRequest.type,n).then(void 0,(t=>{this.connection.console.info(`Un-registering request handler for ${e} failed.`)}))}registerMany(e){let t=e.asRegistrationParams();return this.connection.sendRequest(i.RegistrationRequest.type,t).then((()=>new v(this._connection,t.registrations.map((e=>({id:e.id,method:e.method}))))),(e=>(this.connection.console.info("Bulk registration failed."),Promise.reject(e))))}}const b=d.FileOperationsFeature(l.WorkspaceFoldersFeature(a.ConfigurationFeature(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}applyEdit(e){let t=(n=e)&&n.edit?e:{edit:e};var n;return this.connection.sendRequest(i.ApplyWorkspaceEditRequest.type,t)}})));class I{constructor(){this._trace=i.Trace.Off}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}set trace(e){this._trace=e}log(e,t){this._trace!==i.Trace.Off&&this.connection.sendNotification(i.LogTraceNotification.type,{message:e,verbose:this._trace===i.Trace.Verbose?t:void 0})}}class S{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}logEvent(e){this.connection.sendNotification(i.TelemetryEventNotification.type,e)}}class x{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return o.attachWorkDone(this.connection,e)}attachPartialResultProgress(e,t){return o.attachPartialResult(this.connection,t)}}t._LanguagesImpl=x;const C=m.MonikerFeature(h.LinkedEditingRangeFeature(u.SemanticTokensFeature(c.CallHierarchyFeature(x))));function w(e,t){return function(n){return t(e(n))}}function E(e,t){return function(n){return t(e(n))}}function k(e,t){return function(n){return t(e(n))}}function D(e,t){return function(n){return t(e(n))}}function A(e,t){return function(n){return t(e(n))}}function P(e,t){return function(n){return t(e(n))}}t.combineConsoleFeatures=w,t.combineTelemetryFeatures=E,t.combineTracerFeatures=k,t.combineClientFeatures=D,t.combineWindowFeatures=A,t.combineWorkspaceFeatures=P,t.combineLanguagesFeatures=function(e,t){return function(n){return t(e(n))}},t.combineFeatures=function(e,t){function n(e,t,n){return e&&t?n(e,t):e||t}return{__brand:"features",console:n(e.console,t.console,w),tracer:n(e.tracer,t.tracer,k),telemetry:n(e.telemetry,t.telemetry,E),client:n(e.client,t.client,D),window:n(e.window,t.window,A),workspace:n(e.workspace,t.workspace,P)}},t.createConnection=function(e,t,n){const s=n&&n.console?new(n.console(g)):new g,a=e(s);s.rawAttach(a);const l=n&&n.tracer?new(n.tracer(I)):new I,c=n&&n.telemetry?new(n.telemetry(S)):new S,u=n&&n.client?new(n.client(T)):new T,p=n&&n.window?new(n.window(y)):new y,d=n&&n.workspace?new(n.workspace(b)):new b,h=n&&n.languages?new(n.languages(C)):new C,m=[s,l,c,u,p,d,h];function f(e){return e instanceof Promise?e:r.thenable(e)?new Promise(((t,n)=>{e.then((e=>t(e)),(e=>n(e)))})):Promise.resolve(e)}let _,v,x,w={listen:()=>a.listen(),sendRequest:(e,...t)=>a.sendRequest(r.string(e)?e:e.method,...t),onRequest:(e,t)=>a.onRequest(e,t),sendNotification:(e,t)=>{const n=r.string(e)?e:e.method;1===arguments.length?a.sendNotification(n):a.sendNotification(n,t)},onNotification:(e,t)=>a.onNotification(e,t),onProgress:a.onProgress,sendProgress:a.sendProgress,onInitialize:e=>v=e,onInitialized:e=>a.onNotification(i.InitializedNotification.type,e),onShutdown:e=>_=e,onExit:e=>x=e,get console(){return s},get telemetry(){return c},get tracer(){return l},get client(){return u},get window(){return p},get workspace(){return d},get languages(){return h},onDidChangeConfiguration:e=>a.onNotification(i.DidChangeConfigurationNotification.type,e),onDidChangeWatchedFiles:e=>a.onNotification(i.DidChangeWatchedFilesNotification.type,e),__textDocumentSync:void 0,onDidOpenTextDocument:e=>a.onNotification(i.DidOpenTextDocumentNotification.type,e),onDidChangeTextDocument:e=>a.onNotification(i.DidChangeTextDocumentNotification.type,e),onDidCloseTextDocument:e=>a.onNotification(i.DidCloseTextDocumentNotification.type,e),onWillSaveTextDocument:e=>a.onNotification(i.WillSaveTextDocumentNotification.type,e),onWillSaveTextDocumentWaitUntil:e=>a.onRequest(i.WillSaveTextDocumentWaitUntilRequest.type,e),onDidSaveTextDocument:e=>a.onNotification(i.DidSaveTextDocumentNotification.type,e),sendDiagnostics:e=>a.sendNotification(i.PublishDiagnosticsNotification.type,e),onHover:e=>a.onRequest(i.HoverRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),void 0))),onCompletion:e=>a.onRequest(i.CompletionRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onCompletionResolve:e=>a.onRequest(i.CompletionResolveRequest.type,e),onSignatureHelp:e=>a.onRequest(i.SignatureHelpRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),void 0))),onDeclaration:e=>a.onRequest(i.DeclarationRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onDefinition:e=>a.onRequest(i.DefinitionRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onTypeDefinition:e=>a.onRequest(i.TypeDefinitionRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onImplementation:e=>a.onRequest(i.ImplementationRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onReferences:e=>a.onRequest(i.ReferencesRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onDocumentHighlight:e=>a.onRequest(i.DocumentHighlightRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onDocumentSymbol:e=>a.onRequest(i.DocumentSymbolRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onWorkspaceSymbol:e=>a.onRequest(i.WorkspaceSymbolRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onCodeAction:e=>a.onRequest(i.CodeActionRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onCodeActionResolve:e=>a.onRequest(i.CodeActionResolveRequest.type,((t,n)=>e(t,n))),onCodeLens:e=>a.onRequest(i.CodeLensRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onCodeLensResolve:e=>a.onRequest(i.CodeLensResolveRequest.type,((t,n)=>e(t,n))),onDocumentFormatting:e=>a.onRequest(i.DocumentFormattingRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),void 0))),onDocumentRangeFormatting:e=>a.onRequest(i.DocumentRangeFormattingRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),void 0))),onDocumentOnTypeFormatting:e=>a.onRequest(i.DocumentOnTypeFormattingRequest.type,((t,n)=>e(t,n))),onRenameRequest:e=>a.onRequest(i.RenameRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),void 0))),onPrepareRename:e=>a.onRequest(i.PrepareRenameRequest.type,((t,n)=>e(t,n))),onDocumentLinks:e=>a.onRequest(i.DocumentLinkRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onDocumentLinkResolve:e=>a.onRequest(i.DocumentLinkResolveRequest.type,((t,n)=>e(t,n))),onDocumentColor:e=>a.onRequest(i.DocumentColorRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onColorPresentation:e=>a.onRequest(i.ColorPresentationRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onFoldingRanges:e=>a.onRequest(i.FoldingRangeRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onSelectionRanges:e=>a.onRequest(i.SelectionRangeRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onExecuteCommand:e=>a.onRequest(i.ExecuteCommandRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),void 0))),dispose:()=>a.dispose()};for(let e of m)e.attach(w);return a.onRequest(i.InitializeRequest.type,(e=>{t.initialize(e),r.string(e.trace)&&(l.trace=i.Trace.fromString(e.trace));for(let t of m)t.initialize(e.capabilities);if(v)return f(v(e,(new i.CancellationTokenSource).token,o.attachWorkDone(a,e),void 0)).then((e=>{if(e instanceof i.ResponseError)return e;let t=e;t||(t={capabilities:{}});let n=t.capabilities;n||(n={},t.capabilities=n),void 0===n.textDocumentSync||null===n.textDocumentSync?n.textDocumentSync=r.number(w.__textDocumentSync)?w.__textDocumentSync:i.TextDocumentSyncKind.None:r.number(n.textDocumentSync)||r.number(n.textDocumentSync.change)||(n.textDocumentSync.change=r.number(w.__textDocumentSync)?w.__textDocumentSync:i.TextDocumentSyncKind.None);for(let e of m)e.fillServerCapabilities(n);return t}));{let e={capabilities:{textDocumentSync:i.TextDocumentSyncKind.None}};for(let t of m)t.fillServerCapabilities(e.capabilities);return e}})),a.onRequest(i.ShutdownRequest.type,(()=>(t.shutdownReceived=!0,_?_((new i.CancellationTokenSource).token):void 0))),a.onNotification(i.ExitNotification.type,(()=>{try{x&&x()}finally{t.shutdownReceived?t.exit(0):t.exit(1)}})),a.onNotification(i.SetTraceNotification.type,(e=>{l.trace=i.Trace.fromString(e.value)})),w}},5421:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentFeature=void 0;const i=n(152);t.ShowDocumentFeature=e=>class extends e{showDocument(e){return this.connection.sendRequest(i.ShowDocumentRequest.type,e)}}},289:(e,t)=>{"use strict";function n(e){return"string"==typeof e||e instanceof String}function i(e){return"function"==typeof e}function r(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.thenable=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=i,t.array=r,t.stringArray=function(e){return r(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.thenable=function(e){return e&&i(e.then)}},7560:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateUuid=t.parse=t.isUUID=t.v4=t.empty=void 0;class n{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class i extends n{constructor(){super([i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),"-",i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),"-","4",i._randomHex(),i._randomHex(),i._randomHex(),"-",i._oneOf(i._timeHighBits),i._randomHex(),i._randomHex(),i._randomHex(),"-",i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return i._oneOf(i._chars)}}function r(){return new i}i._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],i._timeHighBits=["8","9","a","b"],t.empty=new n("00000000-0000-0000-0000-000000000000"),t.v4=r;const s=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function o(e){return s.test(e)}t.isUUID=o,t.parse=function(e){if(!o(e))throw new Error("invalid uuid");return new n(e)},t.generateUuid=function(){return r().asHex()}},8634:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceFoldersFeature=void 0;const i=n(152);t.WorkspaceFoldersFeature=e=>class extends e{initialize(e){let t=e.workspace;t&&t.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new i.Emitter,this.connection.onNotification(i.DidChangeWorkspaceFoldersNotification.type,(e=>{this._onDidChangeWorkspaceFolders.fire(e.event)})))}getWorkspaceFolders(){return this.connection.sendRequest(i.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return this._unregistration||(this._unregistration=this.connection.client.register(i.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}}},306:e=>{"use strict";e.exports={i8:"1.1.159"}},3574:(e,t,n)=>{"use strict";const i=n(9149),r=n.g.Date;class s extends r{constructor(e){super(e),this.isDate=!0}toISOString(){return`${this.getUTCFullYear()}-${i(2,this.getUTCMonth()+1)}-${i(2,this.getUTCDate())}`}}e.exports=e=>{const t=new s(e);if(isNaN(t))throw new TypeError("Invalid Datetime");return t}},8477:(e,t,n)=>{"use strict";const i=n(9149);class r extends Date{constructor(e){super(e+"Z"),this.isFloating=!0}toISOString(){return`${this.getUTCFullYear()}-${i(2,this.getUTCMonth()+1)}-${i(2,this.getUTCDate())}T${i(2,this.getUTCHours())}:${i(2,this.getUTCMinutes())}:${i(2,this.getUTCSeconds())}.${i(3,this.getUTCMilliseconds())}`}}e.exports=e=>{const t=new r(e);if(isNaN(t))throw new TypeError("Invalid Datetime");return t}},350:e=>{"use strict";e.exports=e=>{const t=new Date(e);if(isNaN(t))throw new TypeError("Invalid Datetime");return t}},7571:(e,t,n)=>{"use strict";const i=n(9149);class r extends Date{constructor(e){super(`0000-01-01T${e}Z`),this.isTime=!0}toISOString(){return`${i(2,this.getUTCHours())}:${i(2,this.getUTCMinutes())}:${i(2,this.getUTCSeconds())}.${i(3,this.getUTCMilliseconds())}`}}e.exports=e=>{const t=new r(e);if(isNaN(t))throw new TypeError("Invalid Datetime");return t}},9149:e=>{"use strict";e.exports=(e,t)=>{for(t=String(t);t.length<e;)t="0"+t;return t}},2306:e=>{"use strict";const t=1114112;class n extends Error{constructor(e,t,i){super("[ParserError] "+e,t,i),this.name="ParserError",this.code="ParserError",Error.captureStackTrace&&Error.captureStackTrace(this,n)}}class i{constructor(e){this.parser=e,this.buf="",this.returned=null,this.result=null,this.resultTable=null,this.resultArr=null}}class r{constructor(){this.pos=0,this.col=0,this.line=0,this.obj={},this.ctx=this.obj,this.stack=[],this._buf="",this.char=null,this.ii=0,this.state=new i(this.parseStart)}parse(e){if(0===e.length||null==e.length)return;let t;for(this._buf=String(e),this.ii=-1,this.char=-1;!1===t||this.nextChar();)t=this.runOne();this._buf=null}nextChar(){return 10===this.char&&(++this.line,this.col=-1),++this.ii,this.char=this._buf.codePointAt(this.ii),++this.pos,++this.col,this.haveBuffer()}haveBuffer(){return this.ii<this._buf.length}runOne(){return this.state.parser.call(this,this.state.returned)}finish(){let e;this.char=t;do{e=this.state.parser,this.runOne()}while(this.state.parser!==e);return this.ctx=null,this.state=null,this._buf=null,this.obj}next(e){if("function"!=typeof e)throw new n("Tried to set state to non-existent state: "+JSON.stringify(e));this.state.parser=e}goto(e){return this.next(e),this.runOne()}call(e,t){t&&this.next(t),this.stack.push(this.state),this.state=new i(e)}callNow(e,t){return this.call(e,t),this.runOne()}return(e){if(0===this.stack.length)throw this.error(new n("Stack underflow"));void 0===e&&(e=this.state.buf),this.state=this.stack.pop(),this.state.returned=e}returnNow(e){return this.return(e),this.runOne()}consume(){if(this.char===t)throw this.error(new n("Unexpected end-of-buffer"));this.state.buf+=this._buf[this.ii]}error(e){return e.line=this.line,e.col=this.col,e.pos=this.pos,e}parseStart(){throw new n("Must declare a parseStart method")}}r.END=t,r.Error=n,e.exports=r},2725:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=makeParserClass(__webpack_require__(2306)),module.exports.makeParserClass=makeParserClass;class TomlError extends Error{constructor(e){super(e),this.name="TomlError",Error.captureStackTrace&&Error.captureStackTrace(this,TomlError),this.fromTOML=!0,this.wrapped=null}}TomlError.wrap=e=>{const t=new TomlError(e.message);return t.code=e.code,t.wrapped=e,t},module.exports.TomlError=TomlError;const createDateTime=__webpack_require__(350),createDateTimeFloat=__webpack_require__(8477),createDate=__webpack_require__(3574),createTime=__webpack_require__(7571),CTRL_I=9,CTRL_J=10,CTRL_M=13,CTRL_CHAR_BOUNDARY=31,CHAR_SP=32,CHAR_QUOT=34,CHAR_NUM=35,CHAR_APOS=39,CHAR_PLUS=43,CHAR_COMMA=44,CHAR_HYPHEN=45,CHAR_PERIOD=46,CHAR_0=48,CHAR_1=49,CHAR_7=55,CHAR_9=57,CHAR_COLON=58,CHAR_EQUALS=61,CHAR_A=65,CHAR_E=69,CHAR_F=70,CHAR_T=84,CHAR_U=85,CHAR_Z=90,CHAR_LOWBAR=95,CHAR_a=97,CHAR_b=98,CHAR_e=101,CHAR_f=102,CHAR_i=105,CHAR_l=108,CHAR_n=110,CHAR_o=111,CHAR_r=114,CHAR_s=115,CHAR_t=116,CHAR_u=117,CHAR_x=120,CHAR_z=122,CHAR_LCUB=123,CHAR_RCUB=125,CHAR_LSQB=91,CHAR_BSOL=92,CHAR_RSQB=93,CHAR_DEL=127,SURROGATE_FIRST=55296,SURROGATE_LAST=57343,escapes={[CHAR_b]:"\b",[CHAR_t]:"\t",[CHAR_n]:"\n",[CHAR_f]:"\f",[CHAR_r]:"\r",[CHAR_QUOT]:'"',[CHAR_BSOL]:"\\"};function isDigit(e){return e>=CHAR_0&&e<=CHAR_9}function isHexit(e){return e>=CHAR_A&&e<=CHAR_F||e>=CHAR_a&&e<=CHAR_f||e>=CHAR_0&&e<=CHAR_9}function isBit(e){return e===CHAR_1||e===CHAR_0}function isOctit(e){return e>=CHAR_0&&e<=CHAR_7}function isAlphaNumQuoteHyphen(e){return e>=CHAR_A&&e<=CHAR_Z||e>=CHAR_a&&e<=CHAR_z||e>=CHAR_0&&e<=CHAR_9||e===CHAR_APOS||e===CHAR_QUOT||e===CHAR_LOWBAR||e===CHAR_HYPHEN}function isAlphaNumHyphen(e){return e>=CHAR_A&&e<=CHAR_Z||e>=CHAR_a&&e<=CHAR_z||e>=CHAR_0&&e<=CHAR_9||e===CHAR_LOWBAR||e===CHAR_HYPHEN}const _type=Symbol("type"),_declared=Symbol("declared"),hasOwnProperty=Object.prototype.hasOwnProperty,defineProperty=Object.defineProperty,descriptor={configurable:!0,enumerable:!0,writable:!0,value:void 0};function hasKey(e,t){return!!hasOwnProperty.call(e,t)||("__proto__"===t&&defineProperty(e,"__proto__",descriptor),!1)}const INLINE_TABLE=Symbol("inline-table");function InlineTable(){return Object.defineProperties({},{[_type]:{value:INLINE_TABLE}})}function isInlineTable(e){return null!==e&&"object"==typeof e&&e[_type]===INLINE_TABLE}const TABLE=Symbol("table");function Table(){return Object.defineProperties({},{[_type]:{value:TABLE},[_declared]:{value:!1,writable:!0}})}function isTable(e){return null!==e&&"object"==typeof e&&e[_type]===TABLE}const _contentType=Symbol("content-type"),INLINE_LIST=Symbol("inline-list");function InlineList(e){return Object.defineProperties([],{[_type]:{value:INLINE_LIST},[_contentType]:{value:e}})}function isInlineList(e){return null!==e&&"object"==typeof e&&e[_type]===INLINE_LIST}const LIST=Symbol("list");function List(){return Object.defineProperties([],{[_type]:{value:LIST}})}function isList(e){return null!==e&&"object"==typeof e&&e[_type]===LIST}let _custom;try{const utilInspect=eval("require('util').inspect");_custom=utilInspect.custom}catch(e){}const _inspect=_custom||"inspect";class BoxedBigInt{constructor(e){try{this.value=__webpack_require__.g.BigInt.asIntN(64,e)}catch(e){this.value=null}Object.defineProperty(this,_type,{value:INTEGER})}isNaN(){return null===this.value}toString(){return String(this.value)}[_inspect](){return`[BigInt: ${this.toString()}]}`}valueOf(){return this.value}}const INTEGER=Symbol("integer");function Integer(e){let t=Number(e);return Object.is(t,-0)&&(t=0),__webpack_require__.g.BigInt&&!Number.isSafeInteger(t)?new BoxedBigInt(e):Object.defineProperties(new Number(t),{isNaN:{value:function(){return isNaN(this)}},[_type]:{value:INTEGER},[_inspect]:{value:()=>`[Integer: ${e}]`}})}function isInteger(e){return null!==e&&"object"==typeof e&&e[_type]===INTEGER}const FLOAT=Symbol("float");function Float(e){return Object.defineProperties(new Number(e),{[_type]:{value:FLOAT},[_inspect]:{value:()=>`[Float: ${e}]`}})}function isFloat(e){return null!==e&&"object"==typeof e&&e[_type]===FLOAT}function tomlType(e){const t=typeof e;if("object"===t){if(null===e)return"null";if(e instanceof Date)return"datetime";if(_type in e)switch(e[_type]){case INLINE_TABLE:return"inline-table";case INLINE_LIST:return"inline-list";case TABLE:return"table";case LIST:return"list";case FLOAT:return"float";case INTEGER:return"integer"}}return t}function makeParserClass(e){return class extends e{constructor(){super(),this.ctx=this.obj=Table()}atEndOfWord(){return this.char===CHAR_NUM||this.char===CTRL_I||this.char===CHAR_SP||this.atEndOfLine()}atEndOfLine(){return this.char===e.END||this.char===CTRL_J||this.char===CTRL_M}parseStart(){if(this.char===e.END)return null;if(this.char===CHAR_LSQB)return this.call(this.parseTableOrList);if(this.char===CHAR_NUM)return this.call(this.parseComment);if(this.char===CTRL_J||this.char===CHAR_SP||this.char===CTRL_I||this.char===CTRL_M)return null;if(isAlphaNumQuoteHyphen(this.char))return this.callNow(this.parseAssignStatement);throw this.error(new TomlError(`Unknown character "${this.char}"`))}parseWhitespaceToEOL(){if(this.char===CHAR_SP||this.char===CTRL_I||this.char===CTRL_M)return null;if(this.char===CHAR_NUM)return this.goto(this.parseComment);if(this.char===e.END||this.char===CTRL_J)return this.return();throw this.error(new TomlError("Unexpected character, expected only whitespace or comments till end of line"))}parseAssignStatement(){return this.callNow(this.parseAssign,this.recordAssignStatement)}recordAssignStatement(e){let t=this.ctx,n=e.key.pop();for(let n of e.key){if(hasKey(t,n)&&(!isTable(t[n])||t[n][_declared]))throw this.error(new TomlError("Can't redefine existing key"));t=t[n]=t[n]||Table()}if(hasKey(t,n))throw this.error(new TomlError("Can't redefine existing key"));return isInteger(e.value)||isFloat(e.value)?t[n]=e.value.valueOf():t[n]=e.value,this.goto(this.parseWhitespaceToEOL)}parseAssign(){return this.callNow(this.parseKeyword,this.recordAssignKeyword)}recordAssignKeyword(e){return this.state.resultTable?this.state.resultTable.push(e):this.state.resultTable=[e],this.goto(this.parseAssignKeywordPreDot)}parseAssignKeywordPreDot(){return this.char===CHAR_PERIOD?this.next(this.parseAssignKeywordPostDot):this.char!==CHAR_SP&&this.char!==CTRL_I?this.goto(this.parseAssignEqual):void 0}parseAssignKeywordPostDot(){if(this.char!==CHAR_SP&&this.char!==CTRL_I)return this.callNow(this.parseKeyword,this.recordAssignKeyword)}parseAssignEqual(){if(this.char===CHAR_EQUALS)return this.next(this.parseAssignPreValue);throw this.error(new TomlError('Invalid character, expected "="'))}parseAssignPreValue(){return this.char===CHAR_SP||this.char===CTRL_I?null:this.callNow(this.parseValue,this.recordAssignValue)}recordAssignValue(e){return this.returnNow({key:this.state.resultTable,value:e})}parseComment(){do{if(this.char===e.END||this.char===CTRL_J)return this.return()}while(this.nextChar())}parseTableOrList(){if(this.char!==CHAR_LSQB)return this.goto(this.parseTable);this.next(this.parseList)}parseTable(){return this.ctx=this.obj,this.goto(this.parseTableNext)}parseTableNext(){return this.char===CHAR_SP||this.char===CTRL_I?null:this.callNow(this.parseKeyword,this.parseTableMore)}parseTableMore(e){if(this.char===CHAR_SP||this.char===CTRL_I)return null;if(this.char===CHAR_RSQB){if(hasKey(this.ctx,e)&&(!isTable(this.ctx[e])||this.ctx[e][_declared]))throw this.error(new TomlError("Can't redefine existing key"));return this.ctx=this.ctx[e]=this.ctx[e]||Table(),this.ctx[_declared]=!0,this.next(this.parseWhitespaceToEOL)}if(this.char===CHAR_PERIOD){if(hasKey(this.ctx,e))if(isTable(this.ctx[e]))this.ctx=this.ctx[e];else{if(!isList(this.ctx[e]))throw this.error(new TomlError("Can't redefine existing key"));this.ctx=this.ctx[e][this.ctx[e].length-1]}else this.ctx=this.ctx[e]=Table();return this.next(this.parseTableNext)}throw this.error(new TomlError("Unexpected character, expected whitespace, . or ]"))}parseList(){return this.ctx=this.obj,this.goto(this.parseListNext)}parseListNext(){return this.char===CHAR_SP||this.char===CTRL_I?null:this.callNow(this.parseKeyword,this.parseListMore)}parseListMore(e){if(this.char===CHAR_SP||this.char===CTRL_I)return null;if(this.char===CHAR_RSQB){if(hasKey(this.ctx,e)||(this.ctx[e]=List()),isInlineList(this.ctx[e]))throw this.error(new TomlError("Can't extend an inline array"));if(!isList(this.ctx[e]))throw this.error(new TomlError("Can't redefine an existing key"));{const t=Table();this.ctx[e].push(t),this.ctx=t}return this.next(this.parseListEnd)}if(this.char===CHAR_PERIOD){if(hasKey(this.ctx,e)){if(isInlineList(this.ctx[e]))throw this.error(new TomlError("Can't extend an inline array"));if(isInlineTable(this.ctx[e]))throw this.error(new TomlError("Can't extend an inline table"));if(isList(this.ctx[e]))this.ctx=this.ctx[e][this.ctx[e].length-1];else{if(!isTable(this.ctx[e]))throw this.error(new TomlError("Can't redefine an existing key"));this.ctx=this.ctx[e]}}else this.ctx=this.ctx[e]=Table();return this.next(this.parseListNext)}throw this.error(new TomlError("Unexpected character, expected whitespace, . or ]"))}parseListEnd(e){if(this.char===CHAR_RSQB)return this.next(this.parseWhitespaceToEOL);throw this.error(new TomlError("Unexpected character, expected whitespace, . or ]"))}parseValue(){if(this.char===e.END)throw this.error(new TomlError("Key without value"));if(this.char===CHAR_QUOT)return this.next(this.parseDoubleString);if(this.char===CHAR_APOS)return this.next(this.parseSingleString);if(this.char===CHAR_HYPHEN||this.char===CHAR_PLUS)return this.goto(this.parseNumberSign);if(this.char===CHAR_i)return this.next(this.parseInf);if(this.char===CHAR_n)return this.next(this.parseNan);if(isDigit(this.char))return this.goto(this.parseNumberOrDateTime);if(this.char===CHAR_t||this.char===CHAR_f)return this.goto(this.parseBoolean);if(this.char===CHAR_LSQB)return this.call(this.parseInlineList,this.recordValue);if(this.char===CHAR_LCUB)return this.call(this.parseInlineTable,this.recordValue);throw this.error(new TomlError("Unexpected character, expecting string, number, datetime, boolean, inline array or inline table"))}recordValue(e){return this.returnNow(e)}parseInf(){if(this.char===CHAR_n)return this.next(this.parseInf2);throw this.error(new TomlError('Unexpected character, expected "inf", "+inf" or "-inf"'))}parseInf2(){if(this.char===CHAR_f)return"-"===this.state.buf?this.return(-1/0):this.return(1/0);throw this.error(new TomlError('Unexpected character, expected "inf", "+inf" or "-inf"'))}parseNan(){if(this.char===CHAR_a)return this.next(this.parseNan2);throw this.error(new TomlError('Unexpected character, expected "nan"'))}parseNan2(){if(this.char===CHAR_n)return this.return(NaN);throw this.error(new TomlError('Unexpected character, expected "nan"'))}parseKeyword(){return this.char===CHAR_QUOT?this.next(this.parseBasicString):this.char===CHAR_APOS?this.next(this.parseLiteralString):this.goto(this.parseBareKey)}parseBareKey(){do{if(this.char===e.END)throw this.error(new TomlError("Key ended without value"));if(!isAlphaNumHyphen(this.char)){if(0===this.state.buf.length)throw this.error(new TomlError("Empty bare keys are not allowed"));return this.returnNow()}this.consume()}while(this.nextChar())}parseSingleString(){return this.char===CHAR_APOS?this.next(this.parseLiteralMultiStringMaybe):this.goto(this.parseLiteralString)}parseLiteralString(){do{if(this.char===CHAR_APOS)return this.return();if(this.atEndOfLine())throw this.error(new TomlError("Unterminated string"));if(this.char===CHAR_DEL||this.char<=CTRL_CHAR_BOUNDARY&&this.char!==CTRL_I)throw this.errorControlCharInString();this.consume()}while(this.nextChar())}parseLiteralMultiStringMaybe(){return this.char===CHAR_APOS?this.next(this.parseLiteralMultiString):this.returnNow()}parseLiteralMultiString(){return this.char===CTRL_M?null:this.char===CTRL_J?this.next(this.parseLiteralMultiStringContent):this.goto(this.parseLiteralMultiStringContent)}parseLiteralMultiStringContent(){do{if(this.char===CHAR_APOS)return this.next(this.parseLiteralMultiEnd);if(this.char===e.END)throw this.error(new TomlError("Unterminated multi-line string"));if(this.char===CHAR_DEL||this.char<=CTRL_CHAR_BOUNDARY&&this.char!==CTRL_I&&this.char!==CTRL_J&&this.char!==CTRL_M)throw this.errorControlCharInString();this.consume()}while(this.nextChar())}parseLiteralMultiEnd(){return this.char===CHAR_APOS?this.next(this.parseLiteralMultiEnd2):(this.state.buf+="'",this.goto(this.parseLiteralMultiStringContent))}parseLiteralMultiEnd2(){return this.char===CHAR_APOS?this.return():(this.state.buf+="''",this.goto(this.parseLiteralMultiStringContent))}parseDoubleString(){return this.char===CHAR_QUOT?this.next(this.parseMultiStringMaybe):this.goto(this.parseBasicString)}parseBasicString(){do{if(this.char===CHAR_BSOL)return this.call(this.parseEscape,this.recordEscapeReplacement);if(this.char===CHAR_QUOT)return this.return();if(this.atEndOfLine())throw this.error(new TomlError("Unterminated string"));if(this.char===CHAR_DEL||this.char<=CTRL_CHAR_BOUNDARY&&this.char!==CTRL_I)throw this.errorControlCharInString();this.consume()}while(this.nextChar())}recordEscapeReplacement(e){return this.state.buf+=e,this.goto(this.parseBasicString)}parseMultiStringMaybe(){return this.char===CHAR_QUOT?this.next(this.parseMultiString):this.returnNow()}parseMultiString(){return this.char===CTRL_M?null:this.char===CTRL_J?this.next(this.parseMultiStringContent):this.goto(this.parseMultiStringContent)}parseMultiStringContent(){do{if(this.char===CHAR_BSOL)return this.call(this.parseMultiEscape,this.recordMultiEscapeReplacement);if(this.char===CHAR_QUOT)return this.next(this.parseMultiEnd);if(this.char===e.END)throw this.error(new TomlError("Unterminated multi-line string"));if(this.char===CHAR_DEL||this.char<=CTRL_CHAR_BOUNDARY&&this.char!==CTRL_I&&this.char!==CTRL_J&&this.char!==CTRL_M)throw this.errorControlCharInString();this.consume()}while(this.nextChar())}errorControlCharInString(){let e="\\u00";return this.char<16&&(e+="0"),e+=this.char.toString(16),this.error(new TomlError(`Control characters (codes < 0x1f and 0x7f) are not allowed in strings, use ${e} instead`))}recordMultiEscapeReplacement(e){return this.state.buf+=e,this.goto(this.parseMultiStringContent)}parseMultiEnd(){return this.char===CHAR_QUOT?this.next(this.parseMultiEnd2):(this.state.buf+='"',this.goto(this.parseMultiStringContent))}parseMultiEnd2(){return this.char===CHAR_QUOT?this.return():(this.state.buf+='""',this.goto(this.parseMultiStringContent))}parseMultiEscape(){return this.char===CTRL_M||this.char===CTRL_J?this.next(this.parseMultiTrim):this.char===CHAR_SP||this.char===CTRL_I?this.next(this.parsePreMultiTrim):this.goto(this.parseEscape)}parsePreMultiTrim(){if(this.char===CHAR_SP||this.char===CTRL_I)return null;if(this.char===CTRL_M||this.char===CTRL_J)return this.next(this.parseMultiTrim);throw this.error(new TomlError("Can't escape whitespace"))}parseMultiTrim(){return this.char===CTRL_J||this.char===CHAR_SP||this.char===CTRL_I||this.char===CTRL_M?null:this.returnNow()}parseEscape(){if(this.char in escapes)return this.return(escapes[this.char]);if(this.char===CHAR_u)return this.call(this.parseSmallUnicode,this.parseUnicodeReturn);if(this.char===CHAR_U)return this.call(this.parseLargeUnicode,this.parseUnicodeReturn);throw this.error(new TomlError("Unknown escape character: "+this.char))}parseUnicodeReturn(e){try{const t=parseInt(e,16);if(t>=SURROGATE_FIRST&&t<=SURROGATE_LAST)throw this.error(new TomlError("Invalid unicode, character in range 0xD800 - 0xDFFF is reserved"));return this.returnNow(String.fromCodePoint(t))}catch(e){throw this.error(TomlError.wrap(e))}}parseSmallUnicode(){if(!isHexit(this.char))throw this.error(new TomlError("Invalid character in unicode sequence, expected hex"));if(this.consume(),this.state.buf.length>=4)return this.return()}parseLargeUnicode(){if(!isHexit(this.char))throw this.error(new TomlError("Invalid character in unicode sequence, expected hex"));if(this.consume(),this.state.buf.length>=8)return this.return()}parseNumberSign(){return this.consume(),this.next(this.parseMaybeSignedInfOrNan)}parseMaybeSignedInfOrNan(){return this.char===CHAR_i?this.next(this.parseInf):this.char===CHAR_n?this.next(this.parseNan):this.callNow(this.parseNoUnder,this.parseNumberIntegerStart)}parseNumberIntegerStart(){return this.char===CHAR_0?(this.consume(),this.next(this.parseNumberIntegerExponentOrDecimal)):this.goto(this.parseNumberInteger)}parseNumberIntegerExponentOrDecimal(){return this.char===CHAR_PERIOD?(this.consume(),this.call(this.parseNoUnder,this.parseNumberFloat)):this.char===CHAR_E||this.char===CHAR_e?(this.consume(),this.next(this.parseNumberExponentSign)):this.returnNow(Integer(this.state.buf))}parseNumberInteger(){if(!isDigit(this.char)){if(this.char===CHAR_LOWBAR)return this.call(this.parseNoUnder);if(this.char===CHAR_E||this.char===CHAR_e)return this.consume(),this.next(this.parseNumberExponentSign);if(this.char===CHAR_PERIOD)return this.consume(),this.call(this.parseNoUnder,this.parseNumberFloat);{const e=Integer(this.state.buf);if(e.isNaN())throw this.error(new TomlError("Invalid number"));return this.returnNow(e)}}this.consume()}parseNoUnder(){if(this.char===CHAR_LOWBAR||this.char===CHAR_PERIOD||this.char===CHAR_E||this.char===CHAR_e)throw this.error(new TomlError("Unexpected character, expected digit"));if(this.atEndOfWord())throw this.error(new TomlError("Incomplete number"));return this.returnNow()}parseNoUnderHexOctBinLiteral(){if(this.char===CHAR_LOWBAR||this.char===CHAR_PERIOD)throw this.error(new TomlError("Unexpected character, expected digit"));if(this.atEndOfWord())throw this.error(new TomlError("Incomplete number"));return this.returnNow()}parseNumberFloat(){return this.char===CHAR_LOWBAR?this.call(this.parseNoUnder,this.parseNumberFloat):isDigit(this.char)?void this.consume():this.char===CHAR_E||this.char===CHAR_e?(this.consume(),this.next(this.parseNumberExponentSign)):this.returnNow(Float(this.state.buf))}parseNumberExponentSign(){if(isDigit(this.char))return this.goto(this.parseNumberExponent);if(this.char!==CHAR_HYPHEN&&this.char!==CHAR_PLUS)throw this.error(new TomlError("Unexpected character, expected -, + or digit"));this.consume(),this.call(this.parseNoUnder,this.parseNumberExponent)}parseNumberExponent(){if(!isDigit(this.char))return this.char===CHAR_LOWBAR?this.call(this.parseNoUnder):this.returnNow(Float(this.state.buf));this.consume()}parseNumberOrDateTime(){return this.char===CHAR_0?(this.consume(),this.next(this.parseNumberBaseOrDateTime)):this.goto(this.parseNumberOrDateTimeOnly)}parseNumberOrDateTimeOnly(){return this.char===CHAR_LOWBAR?this.call(this.parseNoUnder,this.parseNumberInteger):isDigit(this.char)?(this.consume(),void(this.state.buf.length>4&&this.next(this.parseNumberInteger))):this.char===CHAR_E||this.char===CHAR_e?(this.consume(),this.next(this.parseNumberExponentSign)):this.char===CHAR_PERIOD?(this.consume(),this.call(this.parseNoUnder,this.parseNumberFloat)):this.char===CHAR_HYPHEN?this.goto(this.parseDateTime):this.char===CHAR_COLON?this.goto(this.parseOnlyTimeHour):this.returnNow(Integer(this.state.buf))}parseDateTimeOnly(){if(this.state.buf.length<4){if(isDigit(this.char))return this.consume();if(this.char===CHAR_COLON)return this.goto(this.parseOnlyTimeHour);throw this.error(new TomlError("Expected digit while parsing year part of a date"))}if(this.char===CHAR_HYPHEN)return this.goto(this.parseDateTime);throw this.error(new TomlError("Expected hyphen (-) while parsing year part of date"))}parseNumberBaseOrDateTime(){return this.char===CHAR_b?(this.consume(),this.call(this.parseNoUnderHexOctBinLiteral,this.parseIntegerBin)):this.char===CHAR_o?(this.consume(),this.call(this.parseNoUnderHexOctBinLiteral,this.parseIntegerOct)):this.char===CHAR_x?(this.consume(),this.call(this.parseNoUnderHexOctBinLiteral,this.parseIntegerHex)):this.char===CHAR_PERIOD?this.goto(this.parseNumberInteger):isDigit(this.char)?this.goto(this.parseDateTimeOnly):this.returnNow(Integer(this.state.buf))}parseIntegerHex(){if(!isHexit(this.char)){if(this.char===CHAR_LOWBAR)return this.call(this.parseNoUnderHexOctBinLiteral);{const e=Integer(this.state.buf);if(e.isNaN())throw this.error(new TomlError("Invalid number"));return this.returnNow(e)}}this.consume()}parseIntegerOct(){if(!isOctit(this.char)){if(this.char===CHAR_LOWBAR)return this.call(this.parseNoUnderHexOctBinLiteral);{const e=Integer(this.state.buf);if(e.isNaN())throw this.error(new TomlError("Invalid number"));return this.returnNow(e)}}this.consume()}parseIntegerBin(){if(!isBit(this.char)){if(this.char===CHAR_LOWBAR)return this.call(this.parseNoUnderHexOctBinLiteral);{const e=Integer(this.state.buf);if(e.isNaN())throw this.error(new TomlError("Invalid number"));return this.returnNow(e)}}this.consume()}parseDateTime(){if(this.state.buf.length<4)throw this.error(new TomlError("Years less than 1000 must be zero padded to four characters"));return this.state.result=this.state.buf,this.state.buf="",this.next(this.parseDateMonth)}parseDateMonth(){if(this.char===CHAR_HYPHEN){if(this.state.buf.length<2)throw this.error(new TomlError("Months less than 10 must be zero padded to two characters"));return this.state.result+="-"+this.state.buf,this.state.buf="",this.next(this.parseDateDay)}if(!isDigit(this.char))throw this.error(new TomlError("Incomplete datetime"));this.consume()}parseDateDay(){if(this.char===CHAR_T||this.char===CHAR_SP){if(this.state.buf.length<2)throw this.error(new TomlError("Days less than 10 must be zero padded to two characters"));return this.state.result+="-"+this.state.buf,this.state.buf="",this.next(this.parseStartTimeHour)}if(this.atEndOfWord())return this.returnNow(createDate(this.state.result+"-"+this.state.buf));if(!isDigit(this.char))throw this.error(new TomlError("Incomplete datetime"));this.consume()}parseStartTimeHour(){return this.atEndOfWord()?this.returnNow(createDate(this.state.result)):this.goto(this.parseTimeHour)}parseTimeHour(){if(this.char===CHAR_COLON){if(this.state.buf.length<2)throw this.error(new TomlError("Hours less than 10 must be zero padded to two characters"));return this.state.result+="T"+this.state.buf,this.state.buf="",this.next(this.parseTimeMin)}if(!isDigit(this.char))throw this.error(new TomlError("Incomplete datetime"));this.consume()}parseTimeMin(){if(!(this.state.buf.length<2&&isDigit(this.char))){if(2===this.state.buf.length&&this.char===CHAR_COLON)return this.state.result+=":"+this.state.buf,this.state.buf="",this.next(this.parseTimeSec);throw this.error(new TomlError("Incomplete datetime"))}this.consume()}parseTimeSec(){if(!isDigit(this.char))throw this.error(new TomlError("Incomplete datetime"));if(this.consume(),2===this.state.buf.length)return this.state.result+=":"+this.state.buf,this.state.buf="",this.next(this.parseTimeZoneOrFraction)}parseOnlyTimeHour(){if(this.char===CHAR_COLON){if(this.state.buf.length<2)throw this.error(new TomlError("Hours less than 10 must be zero padded to two characters"));return this.state.result=this.state.buf,this.state.buf="",this.next(this.parseOnlyTimeMin)}throw this.error(new TomlError("Incomplete time"))}parseOnlyTimeMin(){if(!(this.state.buf.length<2&&isDigit(this.char))){if(2===this.state.buf.length&&this.char===CHAR_COLON)return this.state.result+=":"+this.state.buf,this.state.buf="",this.next(this.parseOnlyTimeSec);throw this.error(new TomlError("Incomplete time"))}this.consume()}parseOnlyTimeSec(){if(!isDigit(this.char))throw this.error(new TomlError("Incomplete time"));if(this.consume(),2===this.state.buf.length)return this.next(this.parseOnlyTimeFractionMaybe)}parseOnlyTimeFractionMaybe(){if(this.state.result+=":"+this.state.buf,this.char!==CHAR_PERIOD)return this.return(createTime(this.state.result));this.state.buf="",this.next(this.parseOnlyTimeFraction)}parseOnlyTimeFraction(){if(!isDigit(this.char)){if(this.atEndOfWord()){if(0===this.state.buf.length)throw this.error(new TomlError("Expected digit in milliseconds"));return this.returnNow(createTime(this.state.result+"."+this.state.buf))}throw this.error(new TomlError("Unexpected character in datetime, expected period (.), minus (-), plus (+) or Z"))}this.consume()}parseTimeZoneOrFraction(){if(this.char===CHAR_PERIOD)this.consume(),this.next(this.parseDateTimeFraction);else{if(this.char!==CHAR_HYPHEN&&this.char!==CHAR_PLUS){if(this.char===CHAR_Z)return this.consume(),this.return(createDateTime(this.state.result+this.state.buf));if(this.atEndOfWord())return this.returnNow(createDateTimeFloat(this.state.result+this.state.buf));throw this.error(new TomlError("Unexpected character in datetime, expected period (.), minus (-), plus (+) or Z"))}this.consume(),this.next(this.parseTimeZoneHour)}}parseDateTimeFraction(){if(isDigit(this.char))this.consume();else{if(1===this.state.buf.length)throw this.error(new TomlError("Expected digit in milliseconds"));if(this.char!==CHAR_HYPHEN&&this.char!==CHAR_PLUS){if(this.char===CHAR_Z)return this.consume(),this.return(createDateTime(this.state.result+this.state.buf));if(this.atEndOfWord())return this.returnNow(createDateTimeFloat(this.state.result+this.state.buf));throw this.error(new TomlError("Unexpected character in datetime, expected period (.), minus (-), plus (+) or Z"))}this.consume(),this.next(this.parseTimeZoneHour)}}parseTimeZoneHour(){if(!isDigit(this.char))throw this.error(new TomlError("Unexpected character in datetime, expected digit"));if(this.consume(),/\d\d$/.test(this.state.buf))return this.next(this.parseTimeZoneSep)}parseTimeZoneSep(){if(this.char!==CHAR_COLON)throw this.error(new TomlError("Unexpected character in datetime, expected colon"));this.consume(),this.next(this.parseTimeZoneMin)}parseTimeZoneMin(){if(!isDigit(this.char))throw this.error(new TomlError("Unexpected character in datetime, expected digit"));if(this.consume(),/\d\d$/.test(this.state.buf))return this.return(createDateTime(this.state.result+this.state.buf))}parseBoolean(){return this.char===CHAR_t?(this.consume(),this.next(this.parseTrue_r)):this.char===CHAR_f?(this.consume(),this.next(this.parseFalse_a)):void 0}parseTrue_r(){if(this.char===CHAR_r)return this.consume(),this.next(this.parseTrue_u);throw this.error(new TomlError("Invalid boolean, expected true or false"))}parseTrue_u(){if(this.char===CHAR_u)return this.consume(),this.next(this.parseTrue_e);throw this.error(new TomlError("Invalid boolean, expected true or false"))}parseTrue_e(){if(this.char===CHAR_e)return this.return(!0);throw this.error(new TomlError("Invalid boolean, expected true or false"))}parseFalse_a(){if(this.char===CHAR_a)return this.consume(),this.next(this.parseFalse_l);throw this.error(new TomlError("Invalid boolean, expected true or false"))}parseFalse_l(){if(this.char===CHAR_l)return this.consume(),this.next(this.parseFalse_s);throw this.error(new TomlError("Invalid boolean, expected true or false"))}parseFalse_s(){if(this.char===CHAR_s)return this.consume(),this.next(this.parseFalse_e);throw this.error(new TomlError("Invalid boolean, expected true or false"))}parseFalse_e(){if(this.char===CHAR_e)return this.return(!1);throw this.error(new TomlError("Invalid boolean, expected true or false"))}parseInlineList(){if(this.char===CHAR_SP||this.char===CTRL_I||this.char===CTRL_M||this.char===CTRL_J)return null;if(this.char===e.END)throw this.error(new TomlError("Unterminated inline array"));return this.char===CHAR_NUM?this.call(this.parseComment):this.char===CHAR_RSQB?this.return(this.state.resultArr||InlineList()):this.callNow(this.parseValue,this.recordInlineListValue)}recordInlineListValue(e){if(this.state.resultArr){const t=this.state.resultArr[_contentType],n=tomlType(e);if(t!==n)throw this.error(new TomlError(`Inline lists must be a single type, not a mix of ${t} and ${n}`))}else this.state.resultArr=InlineList(tomlType(e));return isFloat(e)||isInteger(e)?this.state.resultArr.push(e.valueOf()):this.state.resultArr.push(e),this.goto(this.parseInlineListNext)}parseInlineListNext(){if(this.char===CHAR_SP||this.char===CTRL_I||this.char===CTRL_M||this.char===CTRL_J)return null;if(this.char===CHAR_NUM)return this.call(this.parseComment);if(this.char===CHAR_COMMA)return this.next(this.parseInlineList);if(this.char===CHAR_RSQB)return this.goto(this.parseInlineList);throw this.error(new TomlError("Invalid character, expected whitespace, comma (,) or close bracket (])"))}parseInlineTable(){if(this.char===CHAR_SP||this.char===CTRL_I)return null;if(this.char===e.END||this.char===CHAR_NUM||this.char===CTRL_J||this.char===CTRL_M)throw this.error(new TomlError("Unterminated inline array"));return this.char===CHAR_RCUB?this.return(this.state.resultTable||InlineTable()):(this.state.resultTable||(this.state.resultTable=InlineTable()),this.callNow(this.parseAssign,this.recordInlineTableValue))}recordInlineTableValue(e){let t=this.state.resultTable,n=e.key.pop();for(let n of e.key){if(hasKey(t,n)&&(!isTable(t[n])||t[n][_declared]))throw this.error(new TomlError("Can't redefine existing key"));t=t[n]=t[n]||Table()}if(hasKey(t,n))throw this.error(new TomlError("Can't redefine existing key"));return isInteger(e.value)||isFloat(e.value)?t[n]=e.value.valueOf():t[n]=e.value,this.goto(this.parseInlineTableNext)}parseInlineTableNext(){if(this.char===CHAR_SP||this.char===CTRL_I)return null;if(this.char===e.END||this.char===CHAR_NUM||this.char===CTRL_J||this.char===CTRL_M)throw this.error(new TomlError("Unterminated inline array"));if(this.char===CHAR_COMMA)return this.next(this.parseInlineTable);if(this.char===CHAR_RCUB)return this.goto(this.parseInlineTable);throw this.error(new TomlError("Invalid character, expected whitespace, comma (,) or close bracket (])"))}}}},5352:(e,t,n)=>{"use strict";e.exports=function(e,t){t||(t={});const n=t.blocksize||40960,s=new i;return new Promise(((e,t)=>{setImmediate(o,0,n,e,t)}));function o(t,n,i,a){if(t>=e.length)try{return i(s.finish())}catch(t){return a(r(t,e))}try{s.parse(e.slice(t,t+n)),setImmediate(o,t+n,n,i,a)}catch(t){a(r(t,e))}}};const i=n(2725),r=n(4354)},4354:e=>{"use strict";e.exports=function(e,t){if(null==e.pos||null==e.line)return e;let n=e.message;if(n+=` at row ${e.line+1}, col ${e.col+1}, pos ${e.pos}:\n`,t&&t.split){const i=t.split(/\n/),r=String(Math.min(i.length,e.line+3)).length;let s=" ";for(;s.length<r;)s+=" ";for(let t=Math.max(0,e.line-1);t<Math.min(i.length,e.line+2);++t){let o=String(t+1);if(o.length<r&&(o=" "+o),e.line===t){n+=o+"> "+i[t]+"\n",n+=s+"  ";for(let t=0;t<e.col;++t)n+=" ";n+="^\n"}else n+=o+": "+i[t]+"\n"}}return e.message=n+"\n",e}},2173:(e,t,n)=>{"use strict";e.exports=function(e){return e?function(e){const t=new r;return e.setEncoding("utf8"),new Promise(((n,i)=>{let r,s=!1,o=!1;function a(){if(s=!0,!r)try{n(t.finish())}catch(e){i(e)}}function l(e){o=!0,i(e)}e.once("end",a),e.once("error",l),function n(){let i;for(r=!0;null!==(i=e.read());)try{t.parse(i)}catch(e){return l(e)}if(r=!1,s)return a();o||e.once("readable",n)}()}))}(e):function(){const e=new r;return new i.Transform({objectMode:!0,transform(t,n,i){try{e.parse(t.toString(n))}catch(e){this.emit("error",e)}i()},flush(t){try{this.push(e.finish())}catch(e){this.emit("error",e)}t()}})}()};const i=n(9191),r=n(2725)},4567:(e,t,n)=>{"use strict";e.exports=function(e){n.g.Buffer&&n.g.Buffer.isBuffer(e)&&(e=e.toString("utf8"));const t=new i;try{return t.parse(e),t.finish()}catch(t){throw r(t,e)}};const i=n(2725),r=n(4354)},2884:(e,t,n)=>{"use strict";e.exports=n(4567),e.exports.async=n(5352),e.exports.stream=n(2173),e.exports.prettyError=n(4354)},5249:e=>{"use strict";function t(e){return new Error("Can only stringify objects, not "+e)}function n(e){return Object.keys(e).filter((t=>s(e[t])))}function i(e){let t=Array.isArray(e)?[]:Object.prototype.hasOwnProperty.call(e,"__proto__")?{["__proto__"]:void 0}:{};for(let n of Object.keys(e))e[n]&&"function"==typeof e[n].toJSON&&!("toISOString"in e[n])?t[n]=e[n].toJSON():t[n]=e[n];return t}function r(e,l,c){var p,d;p=n(c=i(c)),d=function(e){return Object.keys(e).filter((t=>!s(e[t])))}(c);var m=[],f=l||"";p.forEach((e=>{var t=o(c[e]);"undefined"!==t&&"null"!==t&&m.push(f+a(e)+" = "+u(c[e],!0))})),m.length>0&&m.push("");var g=e&&p.length>0?l+"  ":"";return d.forEach((s=>{m.push(function(e,s,l,c){var u=o(c);if("array"===u)return function(e,n,s,l){h(l=i(l));var c=o(l[0]);if("table"!==c)throw t(c);var u=e+a(s),p="";return l.forEach((e=>{p.length>0&&(p+="\n"),p+=n+"[["+u+"]]\n",p+=r(u+".",n,e)})),p}(e,s,l,c);if("table"===u)return function(e,t,i,s){var o=e+a(i),l="";return n(s).length>0&&(l+=t+"["+o+"]\n"),l+r(o+".",t,s)}(e,s,l,c);throw t(u)}(e,g,s,c[s]))})),m.join("\n")}function s(e){switch(o(e)){case"undefined":case"null":case"integer":case"nan":case"float":case"boolean":case"string":case"datetime":return!0;case"array":return 0===e.length||"table"!==o(e[0]);case"table":return 0===Object.keys(e).length;default:return!1}}function o(e){return void 0===e?"undefined":null===e?"null":"bigint"==typeof e||Number.isInteger(e)&&!Object.is(e,-0)?"integer":"number"==typeof e?"float":"boolean"==typeof e?"boolean":"string"==typeof e?"string":"toISOString"in e?isNaN(e)?"undefined":"datetime":Array.isArray(e)?"array":"table"}function a(e){var t=String(e);return/^[-A-Za-z0-9_]+$/.test(t)?t:l(t)}function l(e){return'"'+c(e).replace(/"/g,'\\"')+'"'}function c(e){return e.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/([\u0000-\u001f\u007f])/,(e=>"\\u"+function(e,t){for(;t.length<4;)t="0"+t;return t}(0,e.codePointAt(0).toString(16))))}function u(e,t){let n=o(e);return"string"===n&&(t&&/\n/.test(e)?n="string-multiline":!/[\b\t\n\f\r']/.test(e)&&/"/.test(e)&&(n="string-literal")),p(e,n)}function p(e,n){switch(n||(n=o(e)),n){case"string-multiline":return function(e){let t=e.split(/\n/).map((e=>c(e).replace(/"(?="")/g,'\\"'))).join("\n");return'"'===t.slice(-1)&&(t+="\\\n"),'"""\n'+t+'"""'}(e);case"string":return l(e);case"string-literal":return"'"+e+"'";case"integer":return d(e);case"float":return function(e){if(e===1/0)return"inf";if(e===-1/0)return"-inf";if(Object.is(e,NaN))return"nan";if(Object.is(e,-0))return"-0.0";var t=String(e).split("."),n=t[0],i=t[1]||0;return d(n)+"."+i}(e);case"boolean":return function(e){return String(e)}(e);case"datetime":return function(e){return e.toISOString()}(e);case"array":return function(e){const t=h(e=i(e));var n="[",r=e.map((e=>p(e,t)));return r.join(", ").length>60||/\n/.test(r)?n+="\n  "+r.join(",\n  ")+"\n":n+=" "+r.join(", ")+(r.length>0?" ":""),n+"]"}(e.filter((e=>"null"!==o(e)&&"undefined"!==o(e)&&"nan"!==o(e))));case"table":return function(e){e=i(e);var t=[];return Object.keys(e).forEach((n=>{t.push(a(n)+" = "+u(e[n],!1))})),"{ "+t.join(", ")+(t.length>0?" ":"")+"}"}(e);default:throw t(n)}}function d(e){return String(e).replace(/\B(?=(\d{3})+(?!\d))/g,"_")}function h(e){const t=function(e){var t=o(e[0]);return e.every((e=>o(e)===t))?t:e.every((e=>{return"float"===(t=o(e))||"integer"===t;var t}))?"float":"mixed"}(e);if("mixed"===t)throw new Error("Array values can't have mixed types");return t}e.exports=function(e){if(null===e)throw t("null");if(void 0===e)throw t("undefined");if("object"!=typeof e)throw t(typeof e);if("function"==typeof e.toJSON&&(e=e.toJSON()),null==e)return null;const n=o(e);if("table"!==n)throw t(n);return r("","",e)},e.exports.value=p},2125:(e,t,n)=>{"use strict";t.parse=n(2884),n(5249)},7588:e=>{"use strict";const t=[],n=[],i=(e,i)=>{if(e===i)return 0;const r=e;e.length>i.length&&(e=i,i=r);let s=e.length,o=i.length;for(;s>0&&e.charCodeAt(~-s)===i.charCodeAt(~-o);)s--,o--;let a,l,c,u,p=0;for(;p<s&&e.charCodeAt(p)===i.charCodeAt(p);)p++;if(s-=p,o-=p,0===s)return o;let d=0,h=0;for(;d<s;)n[d]=e.charCodeAt(p+d),t[d]=++d;for(;h<o;)for(a=i.charCodeAt(p+h),c=h++,l=h,d=0;d<s;d++)u=a===n[d]?c:c+1,c=t[d],l=t[d]=c>l?u>l?l+1:u:u>c?c+1:u;return l};e.exports=i,e.exports.default=i},2797:(e,t,n)=>{"use strict";e.exports=n(3374)},3374:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.BrowserMessageWriter=t.BrowserMessageReader=void 0,n(485).default.install();const s=n(7504);r(n(7504),t);class o extends s.AbstractMessageReader{constructor(e){super(),this._onData=new s.Emitter,this._messageListener=e=>{this._onData.fire(e.data)},e.addEventListener("error",(e=>this.fireError(e))),e.onmessage=this._messageListener}listen(e){return this._onData.event(e)}}t.BrowserMessageReader=o;class a extends s.AbstractMessageWriter{constructor(e){super(),this.context=e,this.errorCount=0,e.addEventListener("error",(e=>this.fireError(e)))}write(e){try{return this.context.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}}t.BrowserMessageWriter=a,t.createMessageConnection=function(e,t,n,i){return void 0===n&&(n=s.NullLogger),s.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),s.createMessageConnection(e,t,n,i)}},485:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(9872),r=n(4469),s=n(2479),o=n(9053);class a extends o.AbstractMessageBuffer{constructor(e="utf-8"){super(e),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return a.emptyBuffer}fromString(e,t){return(new TextEncoder).encode(e)}toString(e,t){return"ascii"===t?this.asciiDecoder.decode(e):new TextDecoder(t).decode(e)}asNative(e,t){return void 0===t?e:e.slice(0,t)}allocNative(e){return new Uint8Array(e)}}a.emptyBuffer=new Uint8Array(0);class l{constructor(e){this.socket=e,this._onData=new s.Emitter,this._messageListener=e=>{e.data.arrayBuffer().then((e=>{this._onData.fire(new Uint8Array(e))}))},this.socket.addEventListener("message",this._messageListener)}onClose(e){return this.socket.addEventListener("close",e),r.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),r.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),r.Disposable.create((()=>this.socket.removeEventListener("end",e)))}onData(e){return this._onData.event(e)}}class c{constructor(e){this.socket=e}onClose(e){return this.socket.addEventListener("close",e),r.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),r.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),r.Disposable.create((()=>this.socket.removeEventListener("end",e)))}write(e,t){if("string"==typeof e){if(void 0!==t&&"utf-8"!==t)throw new Error(`In a Browser environments only utf-8 text encding is supported. But got encoding: ${t}`);this.socket.send(e)}else this.socket.send(e);return Promise.resolve()}end(){this.socket.close()}}const u=new TextEncoder,p=Object.freeze({messageBuffer:Object.freeze({create:e=>new a(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{if("utf-8"!==t.charset)throw new Error(`In a Browser environments only utf-8 text encding is supported. But got encoding: ${t.charset}`);return Promise.resolve(u.encode(JSON.stringify(e,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{if(!(e instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(t.charset).decode(e)))}})}),stream:Object.freeze({asReadableStream:e=>new l(e),asWritableStream:e=>new c(e)}),console,timer:Object.freeze({setTimeout:(e,t,...n)=>setTimeout(e,t,...n),clearTimeout(e){clearTimeout(e)},setImmediate:(e,...t)=>setTimeout(e,0,...t),clearImmediate(e){clearTimeout(e)}})});function d(){return p}!function(e){e.install=function(){i.default.install(p)}}(d||(d={})),t.default=d},7504:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.Trace=t.ProgressType=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=t.ConnectionStrategy=t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.RAL=void 0,t.CancellationStrategy=void 0;const i=n(9263);Object.defineProperty(t,"RequestType",{enumerable:!0,get:function(){return i.RequestType}}),Object.defineProperty(t,"RequestType0",{enumerable:!0,get:function(){return i.RequestType0}}),Object.defineProperty(t,"RequestType1",{enumerable:!0,get:function(){return i.RequestType1}}),Object.defineProperty(t,"RequestType2",{enumerable:!0,get:function(){return i.RequestType2}}),Object.defineProperty(t,"RequestType3",{enumerable:!0,get:function(){return i.RequestType3}}),Object.defineProperty(t,"RequestType4",{enumerable:!0,get:function(){return i.RequestType4}}),Object.defineProperty(t,"RequestType5",{enumerable:!0,get:function(){return i.RequestType5}}),Object.defineProperty(t,"RequestType6",{enumerable:!0,get:function(){return i.RequestType6}}),Object.defineProperty(t,"RequestType7",{enumerable:!0,get:function(){return i.RequestType7}}),Object.defineProperty(t,"RequestType8",{enumerable:!0,get:function(){return i.RequestType8}}),Object.defineProperty(t,"RequestType9",{enumerable:!0,get:function(){return i.RequestType9}}),Object.defineProperty(t,"ResponseError",{enumerable:!0,get:function(){return i.ResponseError}}),Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return i.ErrorCodes}}),Object.defineProperty(t,"NotificationType",{enumerable:!0,get:function(){return i.NotificationType}}),Object.defineProperty(t,"NotificationType0",{enumerable:!0,get:function(){return i.NotificationType0}}),Object.defineProperty(t,"NotificationType1",{enumerable:!0,get:function(){return i.NotificationType1}}),Object.defineProperty(t,"NotificationType2",{enumerable:!0,get:function(){return i.NotificationType2}}),Object.defineProperty(t,"NotificationType3",{enumerable:!0,get:function(){return i.NotificationType3}}),Object.defineProperty(t,"NotificationType4",{enumerable:!0,get:function(){return i.NotificationType4}}),Object.defineProperty(t,"NotificationType5",{enumerable:!0,get:function(){return i.NotificationType5}}),Object.defineProperty(t,"NotificationType6",{enumerable:!0,get:function(){return i.NotificationType6}}),Object.defineProperty(t,"NotificationType7",{enumerable:!0,get:function(){return i.NotificationType7}}),Object.defineProperty(t,"NotificationType8",{enumerable:!0,get:function(){return i.NotificationType8}}),Object.defineProperty(t,"NotificationType9",{enumerable:!0,get:function(){return i.NotificationType9}}),Object.defineProperty(t,"ParameterStructures",{enumerable:!0,get:function(){return i.ParameterStructures}});const r=n(4469);Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return r.Disposable}});const s=n(2479);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return s.Event}}),Object.defineProperty(t,"Emitter",{enumerable:!0,get:function(){return s.Emitter}});const o=n(6368);Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return o.CancellationTokenSource}}),Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return o.CancellationToken}});const a=n(5132);Object.defineProperty(t,"MessageReader",{enumerable:!0,get:function(){return a.MessageReader}}),Object.defineProperty(t,"AbstractMessageReader",{enumerable:!0,get:function(){return a.AbstractMessageReader}}),Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return a.ReadableStreamMessageReader}});const l=n(8633);Object.defineProperty(t,"MessageWriter",{enumerable:!0,get:function(){return l.MessageWriter}}),Object.defineProperty(t,"AbstractMessageWriter",{enumerable:!0,get:function(){return l.AbstractMessageWriter}}),Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return l.WriteableStreamMessageWriter}});const c=n(3467);Object.defineProperty(t,"ConnectionStrategy",{enumerable:!0,get:function(){return c.ConnectionStrategy}}),Object.defineProperty(t,"ConnectionOptions",{enumerable:!0,get:function(){return c.ConnectionOptions}}),Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return c.NullLogger}}),Object.defineProperty(t,"createMessageConnection",{enumerable:!0,get:function(){return c.createMessageConnection}}),Object.defineProperty(t,"ProgressType",{enumerable:!0,get:function(){return c.ProgressType}}),Object.defineProperty(t,"Trace",{enumerable:!0,get:function(){return c.Trace}}),Object.defineProperty(t,"TraceFormat",{enumerable:!0,get:function(){return c.TraceFormat}}),Object.defineProperty(t,"SetTraceNotification",{enumerable:!0,get:function(){return c.SetTraceNotification}}),Object.defineProperty(t,"LogTraceNotification",{enumerable:!0,get:function(){return c.LogTraceNotification}}),Object.defineProperty(t,"ConnectionErrors",{enumerable:!0,get:function(){return c.ConnectionErrors}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return c.ConnectionError}}),Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return c.CancellationReceiverStrategy}}),Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:!0,get:function(){return c.CancellationSenderStrategy}}),Object.defineProperty(t,"CancellationStrategy",{enumerable:!0,get:function(){return c.CancellationStrategy}});const u=n(9872);t.RAL=u.default},6368:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationTokenSource=t.CancellationToken=void 0;const i=n(9872),r=n(5306),s=n(2479);var o;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:s.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:s.Event.None}),e.is=function(t){const n=t;return n&&(n===e.None||n===e.Cancelled||r.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}}(o=t.CancellationToken||(t.CancellationToken={}));const a=Object.freeze((function(e,t){const n=i.default().timer.setTimeout(e.bind(t),0);return{dispose(){i.default().timer.clearTimeout(n)}}}));class l{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?a:(this._emitter||(this._emitter=new s.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new l),this._token}cancel(){this._token?this._token.cancel():this._token=o.Cancelled}dispose(){this._token?this._token instanceof l&&this._token.dispose():this._token=o.None}}},3467:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.ConnectionOptions=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.Trace=t.NullLogger=t.ProgressType=void 0;const i=n(9872),r=n(5306),s=n(9263),o=n(3820),a=n(2479),l=n(6368);var c,u,p,d,h,m,f,g,y,_,v,T,b;!function(e){e.type=new s.NotificationType("$/cancelRequest")}(c||(c={})),function(e){e.type=new s.NotificationType("$/progress")}(u||(u={})),t.ProgressType=class{constructor(){}},function(e){e.is=function(e){return r.func(e)}}(p||(p={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(d=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){if(!r.string(t))return e.Off;switch(t=t.toLowerCase()){case"off":return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose;default:return e.Off}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(d=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(h=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new s.NotificationType("$/setTrace")}(m=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new s.NotificationType("$/logTrace")}(f=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(g=t.ConnectionErrors||(t.ConnectionErrors={}));class I extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,I.prototype)}}t.ConnectionError=I,function(e){e.is=function(e){const t=e;return t&&r.func(t.cancelUndispatched)}}(y=t.ConnectionStrategy||(t.ConnectionStrategy={})),function(e){e.Message=Object.freeze({createCancellationTokenSource:e=>new l.CancellationTokenSource}),e.is=function(e){const t=e;return t&&r.func(t.createCancellationTokenSource)}}(_=t.CancellationReceiverStrategy||(t.CancellationReceiverStrategy={})),function(e){e.Message=Object.freeze({sendCancellation(e,t){e.sendNotification(c.type,{id:t})},cleanup(e){}}),e.is=function(e){const t=e;return t&&r.func(t.sendCancellation)&&r.func(t.cleanup)}}(v=t.CancellationSenderStrategy||(t.CancellationSenderStrategy={})),function(e){e.Message=Object.freeze({receiver:_.Message,sender:v.Message}),e.is=function(e){const t=e;return t&&_.is(t.receiver)&&v.is(t.sender)}}(T=t.CancellationStrategy||(t.CancellationStrategy={})),(t.ConnectionOptions||(t.ConnectionOptions={})).is=function(e){const t=e;return t&&(T.is(t.cancellationStrategy)||y.is(t.connectionStrategy))},function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(b||(b={})),t.createMessageConnection=function(e,n,y,_){const v=void 0!==y?y:t.NullLogger;let S=0,x=0,C=0;const w="2.0";let E;const k=Object.create(null);let D;const A=Object.create(null),P=new Map;let R,F,N=new o.LinkedMap,M=Object.create(null),O=Object.create(null),L=d.Off,U=h.Text,q=b.New;const V=new a.Emitter,B=new a.Emitter,W=new a.Emitter,j=new a.Emitter,z=new a.Emitter,$=_&&_.cancellationStrategy?_.cancellationStrategy:T.Message;function H(e){if(null===e)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+e.toString()}function G(e){}function K(){return q===b.Listening}function J(){return q===b.Closed}function Y(){return q===b.Disposed}function Q(){q!==b.New&&q!==b.Listening||(q=b.Closed,B.fire(void 0))}function Z(){R||0===N.size||(R=i.default().timer.setImmediate((()=>{R=void 0,function(){if(0===N.size)return;const e=N.shift();try{s.isRequestMessage(e)?function(e){if(Y())return;function t(t,i,r){const o={jsonrpc:w,id:e.id};t instanceof s.ResponseError?o.error=t.toJson():o.result=void 0===t?null:t,ee(o,i,r),n.write(o)}function i(t,i,r){const s={jsonrpc:w,id:e.id,error:t.toJson()};ee(s,i,r),n.write(s)}!function(e){if(L!==d.Off&&F)if(U===h.Text){let t;L===d.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),F.log(`Received request '${e.method} - (${e.id})'.`,t)}else te("receive-request",e)}(e);const o=k[e.method];let a,l;o&&(a=o.type,l=o.handler);const c=Date.now();if(l||E){const o=String(e.id),u=$.receiver.createCancellationTokenSource(o);O[o]=u;try{let p;if(l)if(void 0===e.params){if(void 0!==a&&0!==a.numberOfParams)return void i(new s.ResponseError(s.ErrorCodes.InvalidParams,`Request ${e.method} defines ${a.numberOfParams} params but recevied none.`),e.method,c);p=l(u.token)}else if(Array.isArray(e.params)){if(void 0!==a&&a.parameterStructures===s.ParameterStructures.byName)return void i(new s.ResponseError(s.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by name but received parameters by position`),e.method,c);p=l(...e.params,u.token)}else{if(void 0!==a&&a.parameterStructures===s.ParameterStructures.byPosition)return void i(new s.ResponseError(s.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by position but received parameters by name`),e.method,c);p=l(e.params,u.token)}else E&&(p=E(e.method,e.params,u.token));const d=p;p?d.then?d.then((n=>{delete O[o],t(n,e.method,c)}),(t=>{delete O[o],t instanceof s.ResponseError?i(t,e.method,c):t&&r.string(t.message)?i(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,c):i(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,c)})):(delete O[o],t(p,e.method,c)):(delete O[o],function(t,i,r){void 0===t&&(t=null);const s={jsonrpc:w,id:e.id,result:t};ee(s,i,r),n.write(s)}(p,e.method,c))}catch(n){delete O[o],n instanceof s.ResponseError?t(n,e.method,c):n&&r.string(n.message)?i(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${n.message}`),e.method,c):i(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,c)}}else i(new s.ResponseError(s.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,c)}(e):s.isNotificationMessage(e)?function(e){if(Y())return;let t,n;if(e.method===c.type.method)n=e=>{const t=e.id,n=O[String(t)];n&&n.cancel()};else{const i=A[e.method];i&&(n=i.handler,t=i.type)}if(n||D)try{!function(e){if(L!==d.Off&&F&&e.method!==f.type.method)if(U===h.Text){let t;L===d.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),F.log(`Received notification '${e.method}'.`,t)}else te("receive-notification",e)}(e),n?void 0===e.params?(void 0!==t&&0!==t.numberOfParams&&t.parameterStructures!==s.ParameterStructures.byName&&v.error(`Notification ${e.method} defines ${t.numberOfParams} params but recevied none.`),n()):Array.isArray(e.params)?(void 0!==t&&(t.parameterStructures===s.ParameterStructures.byName&&v.error(`Notification ${e.method} defines parameters by name but received parameters by position`),t.numberOfParams!==e.params.length&&v.error(`Notification ${e.method} defines ${t.numberOfParams} params but received ${e.params.length} argumennts`)),n(...e.params)):(void 0!==t&&t.parameterStructures===s.ParameterStructures.byPosition&&v.error(`Notification ${e.method} defines parameters by position but received parameters by name`),n(e.params)):D&&D(e.method,e.params)}catch(t){t.message?v.error(`Notification handler '${e.method}' failed with message: ${t.message}`):v.error(`Notification handler '${e.method}' failed unexpectedly.`)}else W.fire(e)}(e):s.isResponseMessage(e)?function(e){if(!Y())if(null===e.id)e.error?v.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):v.error("Received response message without id. No further error information provided.");else{const t=String(e.id),n=M[t];if(function(e,t){if(L!==d.Off&&F)if(U===h.Text){let n;if(L===d.Verbose&&(e.error&&e.error.data?n=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?n=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),t){const i=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";F.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${i}`,n)}else F.log(`Received response ${e.id} without active response promise.`,n)}else te("receive-response",e)}(e,n),n){delete M[t];try{if(e.error){const t=e.error;n.reject(new s.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");n.resolve(e.result)}}catch(e){e.message?v.error(`Response handler '${n.method}' failed with message: ${e.message}`):v.error(`Response handler '${n.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void v.error("Received empty message.");v.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);const t=e;if(r.string(t.id)||r.number(t.id)){const e=String(t.id),n=M[e];n&&n.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{Z()}}()})))}e.onClose(Q),e.onError((function(e){V.fire([e,void 0,void 0])})),n.onClose(Q),n.onError((function(e){V.fire(e)}));const X=e=>{try{if(s.isNotificationMessage(e)&&e.method===c.type.method){const t=H(e.params.id),i=N.get(t);if(s.isRequestMessage(i)){const r=null==_?void 0:_.connectionStrategy,s=r&&r.cancelUndispatched?r.cancelUndispatched(i,G):void 0;if(s&&(void 0!==s.error||void 0!==s.result))return N.delete(t),s.id=i.id,ee(s,e.method,Date.now()),void n.write(s)}}!function(e,t){var n;s.isRequestMessage(t)?e.set(H(t.id),t):s.isResponseMessage(t)?e.set(null===(n=t.id)?"res-unknown-"+(++C).toString():"res-"+n.toString(),t):e.set("not-"+(++x).toString(),t)}(N,e)}finally{Z()}};function ee(e,t,n){if(L!==d.Off&&F)if(U===h.Text){let i;L===d.Verbose&&(e.error&&e.error.data?i=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?i=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(i="No result returned.\n\n")),F.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-n}ms`,i)}else te("send-response",e)}function te(e,t){if(!F||L===d.Off)return;const n={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};F.log(n)}function ne(){if(J())throw new I(g.Closed,"Connection is closed.");if(Y())throw new I(g.Disposed,"Connection is disposed.")}function ie(e){return void 0===e?null:e}function re(e){return null===e?void 0:e}function se(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function oe(e,t){switch(e){case s.ParameterStructures.auto:return se(t)?re(t):[ie(t)];case s.ParameterStructures.byName:if(!se(t))throw new Error("Recevied parameters by name but param is not an object literal.");return re(t);case s.ParameterStructures.byPosition:return[ie(t)];default:throw new Error(`Unknown parameter structure ${e.toString()}`)}}function ae(e,t){let n;const i=e.numberOfParams;switch(i){case 0:n=void 0;break;case 1:n=oe(e.parameterStructures,t[0]);break;default:n=[];for(let e=0;e<t.length&&e<i;e++)n.push(ie(t[e]));if(t.length<i)for(let e=t.length;e<i;e++)n.push(null)}return n}const le={sendNotification:(e,...t)=>{let i,o;if(ne(),r.string(e)){i=e;const n=t[0];let r=0,a=s.ParameterStructures.auto;s.ParameterStructures.is(n)&&(r=1,a=n);let l=t.length;const c=l-r;switch(c){case 0:o=void 0;break;case 1:o=oe(a,t[r]);break;default:if(a===s.ParameterStructures.byName)throw new Error(`Recevied ${c} parameters for 'by Name' notification parameter structure.`);o=t.slice(r,l).map((e=>ie(e)))}}else{const n=t;i=e.method,o=ae(e,n)}const a={jsonrpc:w,method:i,params:o};!function(e){if(L!==d.Off&&F)if(U===h.Text){let t;L===d.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),F.log(`Sending notification '${e.method}'.`,t)}else te("send-notification",e)}(a),n.write(a)},onNotification:(e,t)=>{let n;return ne(),r.func(e)?D=e:t&&(r.string(e)?(n=e,A[e]={type:void 0,handler:t}):(n=e.method,A[e.method]={type:e,handler:t})),{dispose:()=>{void 0!==n?delete A[n]:D=void 0}}},onProgress:(e,t,n)=>{if(P.has(t))throw new Error(`Progress handler for token ${t} already registered`);return P.set(t,n),{dispose:()=>{P.delete(t)}}},sendProgress:(e,t,n)=>{le.sendNotification(u.type,{token:t,value:n})},onUnhandledProgress:j.event,sendRequest:(e,...t)=>{let i,o,a;if(ne(),function(){if(!K())throw new Error("Call listen() first.")}(),r.string(e)){i=e;const n=t[0],r=t[t.length-1];let c=0,u=s.ParameterStructures.auto;s.ParameterStructures.is(n)&&(c=1,u=n);let p=t.length;l.CancellationToken.is(r)&&(p-=1,a=r);const d=p-c;switch(d){case 0:o=void 0;break;case 1:o=oe(u,t[c]);break;default:if(u===s.ParameterStructures.byName)throw new Error(`Recevied ${d} parameters for 'by Name' request parameter structure.`);o=t.slice(c,p).map((e=>ie(e)))}}else{const n=t;i=e.method,o=ae(e,n);const r=e.numberOfParams;a=l.CancellationToken.is(n[r])?n[r]:void 0}const c=S++;let u;return a&&(u=a.onCancellationRequested((()=>{$.sender.sendCancellation(le,c)}))),new Promise(((e,t)=>{const r={jsonrpc:w,id:c,method:i,params:o};let a={method:i,timerStart:Date.now(),resolve:t=>{e(t),$.sender.cleanup(c),null==u||u.dispose()},reject:e=>{t(e),$.sender.cleanup(c),null==u||u.dispose()}};!function(e){if(L!==d.Off&&F)if(U===h.Text){let t;L===d.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),F.log(`Sending request '${e.method} - (${e.id})'.`,t)}else te("send-request",e)}(r);try{n.write(r)}catch(e){a.reject(new s.ResponseError(s.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),a=null}a&&(M[String(c)]=a)}))},onRequest:(e,t)=>{ne();let n=null;return p.is(e)?(n=void 0,E=e):r.string(e)?(n=null,void 0!==t&&(n=e,k[e]={handler:t,type:void 0})):void 0!==t&&(n=e.method,k[e.method]={type:e,handler:t}),{dispose:()=>{null!==n&&(void 0!==n?delete k[n]:E=void 0)}}},trace:(e,t,n)=>{let i=!1,s=h.Text;void 0!==n&&(r.boolean(n)?i=n:(i=n.sendNotification||!1,s=n.traceFormat||h.Text)),L=e,U=s,F=L===d.Off?void 0:t,!i||J()||Y()||le.sendNotification(m.type,{value:d.toString(e)})},onError:V.event,onClose:B.event,onUnhandledNotification:W.event,onDispose:z.event,end:()=>{n.end()},dispose:()=>{if(Y())return;q=b.Disposed,z.fire(void 0);const t=new Error("Connection got disposed.");Object.keys(M).forEach((e=>{M[e].reject(t)})),M=Object.create(null),O=Object.create(null),N=new o.LinkedMap,r.func(n.dispose)&&n.dispose(),r.func(e.dispose)&&e.dispose()},listen:()=>{ne(),function(){if(K())throw new I(g.AlreadyListening,"Connection is already listening")}(),q=b.Listening,e.listen(X)},inspect:()=>{i.default().console.log("inspect")}};return le.onNotification(f.type,(e=>{L!==d.Off&&F&&F.log(e.message,L===d.Verbose?e.verbose:void 0)})),le.onNotification(u.type,(e=>{const t=P.get(e.token);t?t(e.value):j.fire(e)})),le}},4469:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Disposable=void 0,(t.Disposable||(t.Disposable={})).create=function(e){return{dispose:e}}},2479:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Emitter=t.Event=void 0;const i=n(9872);!function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class r{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let n=!1;for(let i=0,r=this._callbacks.length;i<r;i++)if(this._callbacks[i]===e){if(this._contexts[i]===t)return this._callbacks.splice(i,1),void this._contexts.splice(i,1);n=!0}if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],n=this._callbacks.slice(0),r=this._contexts.slice(0);for(let s=0,o=n.length;s<o;s++)try{t.push(n[s].apply(r[s],e))}catch(e){i.default().console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class s{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{this._callbacks||(this._callbacks=new r),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=s._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(n)&&n.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=s,s._noop=function(){}},5306:(e,t)=>{"use strict";function n(e){return"string"==typeof e||e instanceof String}function i(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=i,t.stringArray=function(e){return i(e)&&e.every((e=>n(e)))}},3820:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=t.LinkedMap=t.Touch=void 0,function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last}(n=t.Touch||(t.Touch={}));class i{constructor(){this[Symbol.toStringTag]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return null===(e=this._head)||void 0===e?void 0:e.value}get last(){var e;return null===(e=this._tail)||void 0===e?void 0:e.value}has(e){return this._map.has(e)}get(e,t=n.None){const i=this._map.get(e);if(i)return t!==n.None&&this.touch(i,t),i.value}set(e,t,i=n.None){let r=this._map.get(e);if(r)r.value=t,i!==n.None&&this.touch(r,i);else{switch(r={key:e,value:t,next:void 0,previous:void 0},i){case n.None:this.addItemLast(r);break;case n.First:this.addItemFirst(r);break;case n.Last:default:this.addItemLast(r)}this._map.set(e,r),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const n=this._state;let i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this,t=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:n.key,done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return i}values(){const e=this,t=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:n.value,done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return i}entries(){const e=this,t=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:[n.key,n.value],done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return i}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e,this._state++}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===n.First||t===n.Last)if(t===n.First){if(e===this._head)return;const t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===n.Last){if(e===this._tail)return;const t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}toJSON(){const e=[];return this.forEach(((t,n)=>{e.push([n,t])})),e}fromJSON(e){this.clear();for(const[t,n]of e)this.set(t,n)}}t.LinkedMap=i,t.LRUCache=class extends i{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=n.AsNew){return super.get(e,t)}peek(e){return super.get(e,n.None)}set(e,t){return super.set(e,t,n.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}},9053:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractMessageBuffer=void 0,t.AbstractMessageBuffer=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t="string"==typeof e?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(){if(0===this._chunks.length)return;let e=0,t=0,n=0,i=0;e:for(;t<this._chunks.length;){const r=this._chunks[t];for(n=0;n<r.length;){switch(r[n]){case 13:switch(e){case 0:e=1;break;case 2:e=3;break;default:e=0}break;case 10:switch(e){case 1:e=2;break;case 3:e=4,n++;break e;default:e=0}break;default:e=0}n++}i+=r.byteLength,t++}if(4!==e)return;const r=this._read(i+n),s=new Map,o=this.toString(r,"ascii").split("\r\n");if(o.length<2)return s;for(let e=0;e<o.length-2;e++){const t=o[e],n=t.indexOf(":");if(-1===n)throw new Error("Message header must separate key and value using :");const i=t.substr(0,n),r=t.substr(n+1).trim();s.set(i,r)}return s}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(0===e)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const t=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(t)}if(this._chunks[0].byteLength>e){const t=this._chunks[0],n=this.asNative(t,e);return this._chunks[0]=t.slice(e),this._totalLength-=e,n}const t=this.allocNative(e);let n=0;for(;e>0;){const i=this._chunks[0];if(i.byteLength>e){const r=i.slice(0,e);t.set(r,n),n+=e,this._chunks[0]=i.slice(e),this._totalLength-=e,e-=e}else t.set(i,n),n+=i.byteLength,this._chunks.shift(),this._totalLength-=i.byteLength,e-=i.byteLength}return t}}},5132:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=void 0;const i=n(9872),r=n(5306),s=n(2479);var o;(t.MessageReader||(t.MessageReader={})).is=function(e){let t=e;return t&&r.func(t.listen)&&r.func(t.dispose)&&r.func(t.onError)&&r.func(t.onClose)&&r.func(t.onPartialMessage)};class a{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter,this.partialMessageEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${r.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=a,function(e){e.fromOptions=function(e){var t;let n,r;const s=new Map;let o;const a=new Map;if(void 0===e||"string"==typeof e)n=null!=e?e:"utf-8";else{if(n=null!==(t=e.charset)&&void 0!==t?t:"utf-8",void 0!==e.contentDecoder&&(r=e.contentDecoder,s.set(r.name,r)),void 0!==e.contentDecoders)for(const t of e.contentDecoders)s.set(t.name,t);if(void 0!==e.contentTypeDecoder&&(o=e.contentTypeDecoder,a.set(o.name,o)),void 0!==e.contentTypeDecoders)for(const t of e.contentTypeDecoders)a.set(t.name,t)}return void 0===o&&(o=i.default().applicationJson.decoder,a.set(o.name,o)),{charset:n,contentDecoder:r,contentDecoders:s,contentTypeDecoder:o,contentTypeDecoders:a}}}(o||(o={})),t.ReadableStreamMessageReader=class extends a{constructor(e,t){super(),this.readable=e,this.options=o.fromOptions(t),this.buffer=i.default().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData((e=>{this.onData(e)}));return this.readable.onError((e=>this.fireError(e))),this.readable.onClose((()=>this.fireClose())),t}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){const e=this.buffer.tryReadHeaders();if(!e)return;const t=e.get("Content-Length");if(!t)throw new Error("Header must provide a Content-Length property.");const n=parseInt(t);if(isNaN(n))throw new Error("Content-Length value must be a number.");this.nextMessageLength=n}const e=this.buffer.tryReadBody(this.nextMessageLength);if(void 0===e)return void this.setPartialMessageTimer();let t;this.clearPartialMessageTimer(),this.nextMessageLength=-1,t=void 0!==this.options.contentDecoder?this.options.contentDecoder.decode(e):Promise.resolve(e),t.then((e=>{this.options.contentTypeDecoder.decode(e,this.options).then((e=>{this.callback(e)}),(e=>{this.fireError(e)}))}),(e=>{this.fireError(e)}))}}clearPartialMessageTimer(){this.partialMessageTimer&&(i.default().timer.clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=i.default().timer.setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}},8633:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=void 0;const i=n(9872),r=n(5306),s=n(3360),o=n(2479);var a;(t.MessageWriter||(t.MessageWriter={})).is=function(e){let t=e;return t&&r.func(t.dispose)&&r.func(t.onClose)&&r.func(t.onError)&&r.func(t.write)};class l{constructor(){this.errorEmitter=new o.Emitter,this.closeEmitter=new o.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${r.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=l,function(e){e.fromOptions=function(e){var t,n;return void 0===e||"string"==typeof e?{charset:null!=e?e:"utf-8",contentTypeEncoder:i.default().applicationJson.encoder}:{charset:null!==(t=e.charset)&&void 0!==t?t:"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:null!==(n=e.contentTypeEncoder)&&void 0!==n?n:i.default().applicationJson.encoder}}}(a||(a={})),t.WriteableStreamMessageWriter=class extends l{constructor(e,t){super(),this.writable=e,this.options=a.fromOptions(t),this.errorCount=0,this.writeSemaphore=new s.Semaphore(1),this.writable.onError((e=>this.fireError(e))),this.writable.onClose((()=>this.fireClose()))}async write(e){return this.writeSemaphore.lock((async()=>this.options.contentTypeEncoder.encode(e,this.options).then((e=>void 0!==this.options.contentEncoder?this.options.contentEncoder.encode(e):e)).then((t=>{const n=[];return n.push("Content-Length: ",t.byteLength.toString(),"\r\n"),n.push("\r\n"),this.doWrite(e,n,t)}),(e=>{throw this.fireError(e),e}))))}async doWrite(e,t,n){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(n)}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}},9263:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isResponseMessage=t.isNotificationMessage=t.isRequestMessage=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType=t.RequestType0=t.AbstractMessageSignature=t.ParameterStructures=t.ResponseError=t.ErrorCodes=void 0;const i=n(5306);var r;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.jsonrpcReservedErrorRangeStart=-32099,e.serverErrorStart=e.jsonrpcReservedErrorRangeStart,e.MessageWriteError=-32099,e.MessageReadError=-32098,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.jsonrpcReservedErrorRangeEnd=-32e3,e.serverErrorEnd=e.jsonrpcReservedErrorRangeEnd}(r=t.ErrorCodes||(t.ErrorCodes={}));class s extends Error{constructor(e,t,n){super(t),this.code=i.number(e)?e:r.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,s.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}}t.ResponseError=s;class o{constructor(e){this.kind=e}static is(e){return e===o.auto||e===o.byName||e===o.byPosition}toString(){return this.kind}}t.ParameterStructures=o,o.auto=new o("auto"),o.byPosition=new o("byPosition"),o.byName=new o("byName");class a{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return o.auto}}t.AbstractMessageSignature=a,t.RequestType0=class extends a{constructor(e){super(e,0)}},t.RequestType=class extends a{constructor(e,t=o.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType1=class extends a{constructor(e,t=o.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType2=class extends a{constructor(e){super(e,2)}},t.RequestType3=class extends a{constructor(e){super(e,3)}},t.RequestType4=class extends a{constructor(e){super(e,4)}},t.RequestType5=class extends a{constructor(e){super(e,5)}},t.RequestType6=class extends a{constructor(e){super(e,6)}},t.RequestType7=class extends a{constructor(e){super(e,7)}},t.RequestType8=class extends a{constructor(e){super(e,8)}},t.RequestType9=class extends a{constructor(e){super(e,9)}},t.NotificationType=class extends a{constructor(e,t=o.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType0=class extends a{constructor(e){super(e,0)}},t.NotificationType1=class extends a{constructor(e,t=o.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType2=class extends a{constructor(e){super(e,2)}},t.NotificationType3=class extends a{constructor(e){super(e,3)}},t.NotificationType4=class extends a{constructor(e){super(e,4)}},t.NotificationType5=class extends a{constructor(e){super(e,5)}},t.NotificationType6=class extends a{constructor(e){super(e,6)}},t.NotificationType7=class extends a{constructor(e){super(e,7)}},t.NotificationType8=class extends a{constructor(e){super(e,8)}},t.NotificationType9=class extends a{constructor(e){super(e,9)}},t.isRequestMessage=function(e){const t=e;return t&&i.string(t.method)&&(i.string(t.id)||i.number(t.id))},t.isNotificationMessage=function(e){const t=e;return t&&i.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){const t=e;return t&&(void 0!==t.result||!!t.error)&&(i.string(t.id)||i.number(t.id)||null===t.id)}},9872:(e,t)=>{"use strict";let n;function i(){if(void 0===n)throw new Error("No runtime abstraction layer installed");return n}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.install=function(e){if(void 0===e)throw new Error("No runtime abstraction layer provided");n=e}}(i||(i={})),t.default=i},3360:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Semaphore=void 0;const i=n(9872);t.Semaphore=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise(((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()}))}get active(){return this._active}runNext(){0!==this._waiting.length&&this._active!==this._capacity&&i.default().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(0===this._waiting.length||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then((t=>{this._active--,e.resolve(t),this.runNext()}),(t=>{this._active--,e.reject(t),this.runNext()})):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}}},9290:(e,t,n)=>{"use strict";e.exports=n(2477)},2477:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const s=n(2797);r(n(2797),t),r(n(6156),t),t.createProtocolConnection=function(e,t,n,i){return s.createMessageConnection(e,t,n,i)}},6156:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.LSPErrorCodes=t.createProtocolConnection=void 0,r(n(3374),t),r(n(5269),t),r(n(9368),t),r(n(8253),t);var s,o=n(2213);Object.defineProperty(t,"createProtocolConnection",{enumerable:!0,get:function(){return o.createProtocolConnection}}),(s=t.LSPErrorCodes||(t.LSPErrorCodes={})).lspReservedErrorRangeStart=-32899,s.ContentModified=-32801,s.RequestCancelled=-32800,s.lspReservedErrorRangeEnd=-32800},2213:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const i=n(3374);t.createProtocolConnection=function(e,t,n,r){return i.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),i.createMessageConnection(e,t,n,r)}},9368:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolNotificationType=t.ProtocolNotificationType0=t.ProtocolRequestType=t.ProtocolRequestType0=t.RegistrationType=void 0;const i=n(3374);t.RegistrationType=class{constructor(e){this.method=e}};class r extends i.RequestType0{constructor(e){super(e)}}t.ProtocolRequestType0=r;class s extends i.RequestType{constructor(e){super(e,i.ParameterStructures.byName)}}t.ProtocolRequestType=s;class o extends i.NotificationType0{constructor(e){super(e)}}t.ProtocolNotificationType0=o;class a extends i.NotificationType{constructor(e){super(e,i.ParameterStructures.byName)}}t.ProtocolNotificationType=a},7350:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.CallHierarchyPrepareRequest=void 0;const i=n(9368);var r,s,o;(o=t.CallHierarchyPrepareRequest||(t.CallHierarchyPrepareRequest={})).method="textDocument/prepareCallHierarchy",o.type=new i.ProtocolRequestType(o.method),(s=t.CallHierarchyIncomingCallsRequest||(t.CallHierarchyIncomingCallsRequest={})).method="callHierarchy/incomingCalls",s.type=new i.ProtocolRequestType(s.method),(r=t.CallHierarchyOutgoingCallsRequest||(t.CallHierarchyOutgoingCallsRequest={})).method="callHierarchy/outgoingCalls",r.type=new i.ProtocolRequestType(r.method)},7994:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorPresentationRequest=t.DocumentColorRequest=void 0;const i=n(9368);var r;(r=t.DocumentColorRequest||(t.DocumentColorRequest={})).method="textDocument/documentColor",r.type=new i.ProtocolRequestType(r.method),(t.ColorPresentationRequest||(t.ColorPresentationRequest={})).type=new i.ProtocolRequestType("textDocument/colorPresentation")},6139:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationRequest=void 0;const i=n(9368);(t.ConfigurationRequest||(t.ConfigurationRequest={})).type=new i.ProtocolRequestType("workspace/configuration")},8746:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeclarationRequest=void 0;const i=n(9368);var r;(r=t.DeclarationRequest||(t.DeclarationRequest={})).method="textDocument/declaration",r.type=new i.ProtocolRequestType(r.method)},5580:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.DidRenameFilesNotification=t.WillRenameFilesRequest=t.DidCreateFilesNotification=t.WillCreateFilesRequest=t.FileOperationPatternKind=void 0;const i=n(9368);var r,s,o,a,l,c,u;(u=t.FileOperationPatternKind||(t.FileOperationPatternKind={})).file="file",u.folder="folder",(c=t.WillCreateFilesRequest||(t.WillCreateFilesRequest={})).method="workspace/willCreateFiles",c.type=new i.ProtocolRequestType(c.method),(l=t.DidCreateFilesNotification||(t.DidCreateFilesNotification={})).method="workspace/didCreateFiles",l.type=new i.ProtocolNotificationType(l.method),(a=t.WillRenameFilesRequest||(t.WillRenameFilesRequest={})).method="workspace/willRenameFiles",a.type=new i.ProtocolRequestType(a.method),(o=t.DidRenameFilesNotification||(t.DidRenameFilesNotification={})).method="workspace/didRenameFiles",o.type=new i.ProtocolNotificationType(o.method),(s=t.DidDeleteFilesNotification||(t.DidDeleteFilesNotification={})).method="workspace/didDeleteFiles",s.type=new i.ProtocolNotificationType(s.method),(r=t.WillDeleteFilesRequest||(t.WillDeleteFilesRequest={})).method="workspace/willDeleteFiles",r.type=new i.ProtocolRequestType(r.method)},3996:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FoldingRangeRequest=t.FoldingRangeKind=void 0;const i=n(9368);var r,s;(s=t.FoldingRangeKind||(t.FoldingRangeKind={})).Comment="comment",s.Imports="imports",s.Region="region",(r=t.FoldingRangeRequest||(t.FoldingRangeRequest={})).method="textDocument/foldingRange",r.type=new i.ProtocolRequestType(r.method)},487:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImplementationRequest=void 0;const i=n(9368);var r;(r=t.ImplementationRequest||(t.ImplementationRequest={})).method="textDocument/implementation",r.type=new i.ProtocolRequestType(r.method)},8253:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentLinkRequest=t.CodeLensRefreshRequest=t.CodeLensResolveRequest=t.CodeLensRequest=t.WorkspaceSymbolRequest=t.CodeActionResolveRequest=t.CodeActionRequest=t.DocumentSymbolRequest=t.DocumentHighlightRequest=t.ReferencesRequest=t.DefinitionRequest=t.SignatureHelpRequest=t.SignatureHelpTriggerKind=t.HoverRequest=t.CompletionResolveRequest=t.CompletionRequest=t.CompletionTriggerKind=t.PublishDiagnosticsNotification=t.WatchKind=t.FileChangeType=t.DidChangeWatchedFilesNotification=t.WillSaveTextDocumentWaitUntilRequest=t.WillSaveTextDocumentNotification=t.TextDocumentSaveReason=t.DidSaveTextDocumentNotification=t.DidCloseTextDocumentNotification=t.DidChangeTextDocumentNotification=t.TextDocumentContentChangeEvent=t.DidOpenTextDocumentNotification=t.TextDocumentSyncKind=t.TelemetryEventNotification=t.LogMessageNotification=t.ShowMessageRequest=t.ShowMessageNotification=t.MessageType=t.DidChangeConfigurationNotification=t.ExitNotification=t.ShutdownRequest=t.InitializedNotification=t.InitializeError=t.InitializeRequest=t.WorkDoneProgressOptions=t.TextDocumentRegistrationOptions=t.StaticRegistrationOptions=t.FailureHandlingKind=t.ResourceOperationKind=t.UnregistrationRequest=t.RegistrationRequest=t.DocumentSelector=t.DocumentFilter=void 0,t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.WillRenameFilesRequest=t.DidRenameFilesNotification=t.WillCreateFilesRequest=t.DidCreateFilesNotification=t.FileOperationPatternKind=t.LinkedEditingRangeRequest=t.ShowDocumentRequest=t.SemanticTokensRegistrationType=t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.TokenFormat=t.SemanticTokens=t.SemanticTokenModifiers=t.SemanticTokenTypes=t.CallHierarchyPrepareRequest=t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=t.SelectionRangeRequest=t.DeclarationRequest=t.FoldingRangeRequest=t.ColorPresentationRequest=t.DocumentColorRequest=t.ConfigurationRequest=t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=t.TypeDefinitionRequest=t.ImplementationRequest=t.ApplyWorkspaceEditRequest=t.ExecuteCommandRequest=t.PrepareRenameRequest=t.RenameRequest=t.PrepareSupportDefaultBehavior=t.DocumentOnTypeFormattingRequest=t.DocumentRangeFormattingRequest=t.DocumentFormattingRequest=t.DocumentLinkResolveRequest=void 0;const i=n(2524),r=n(9368),s=n(487);Object.defineProperty(t,"ImplementationRequest",{enumerable:!0,get:function(){return s.ImplementationRequest}});const o=n(4951);Object.defineProperty(t,"TypeDefinitionRequest",{enumerable:!0,get:function(){return o.TypeDefinitionRequest}});const a=n(1618);Object.defineProperty(t,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return a.WorkspaceFoldersRequest}}),Object.defineProperty(t,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return a.DidChangeWorkspaceFoldersNotification}});const l=n(6139);Object.defineProperty(t,"ConfigurationRequest",{enumerable:!0,get:function(){return l.ConfigurationRequest}});const c=n(7994);Object.defineProperty(t,"DocumentColorRequest",{enumerable:!0,get:function(){return c.DocumentColorRequest}}),Object.defineProperty(t,"ColorPresentationRequest",{enumerable:!0,get:function(){return c.ColorPresentationRequest}});const u=n(3996);Object.defineProperty(t,"FoldingRangeRequest",{enumerable:!0,get:function(){return u.FoldingRangeRequest}});const p=n(8746);Object.defineProperty(t,"DeclarationRequest",{enumerable:!0,get:function(){return p.DeclarationRequest}});const d=n(9998);Object.defineProperty(t,"SelectionRangeRequest",{enumerable:!0,get:function(){return d.SelectionRangeRequest}});const h=n(9784);Object.defineProperty(t,"WorkDoneProgress",{enumerable:!0,get:function(){return h.WorkDoneProgress}}),Object.defineProperty(t,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return h.WorkDoneProgressCreateRequest}}),Object.defineProperty(t,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return h.WorkDoneProgressCancelNotification}});const m=n(7350);Object.defineProperty(t,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return m.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(t,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return m.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(t,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return m.CallHierarchyPrepareRequest}});const f=n(7614);Object.defineProperty(t,"SemanticTokenTypes",{enumerable:!0,get:function(){return f.SemanticTokenTypes}}),Object.defineProperty(t,"SemanticTokenModifiers",{enumerable:!0,get:function(){return f.SemanticTokenModifiers}}),Object.defineProperty(t,"SemanticTokens",{enumerable:!0,get:function(){return f.SemanticTokens}}),Object.defineProperty(t,"TokenFormat",{enumerable:!0,get:function(){return f.TokenFormat}}),Object.defineProperty(t,"SemanticTokensRequest",{enumerable:!0,get:function(){return f.SemanticTokensRequest}}),Object.defineProperty(t,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return f.SemanticTokensDeltaRequest}}),Object.defineProperty(t,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return f.SemanticTokensRangeRequest}}),Object.defineProperty(t,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return f.SemanticTokensRefreshRequest}}),Object.defineProperty(t,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return f.SemanticTokensRegistrationType}});const g=n(5636);Object.defineProperty(t,"ShowDocumentRequest",{enumerable:!0,get:function(){return g.ShowDocumentRequest}});const y=n(7036);Object.defineProperty(t,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return y.LinkedEditingRangeRequest}});const _=n(5580);Object.defineProperty(t,"FileOperationPatternKind",{enumerable:!0,get:function(){return _.FileOperationPatternKind}}),Object.defineProperty(t,"DidCreateFilesNotification",{enumerable:!0,get:function(){return _.DidCreateFilesNotification}}),Object.defineProperty(t,"WillCreateFilesRequest",{enumerable:!0,get:function(){return _.WillCreateFilesRequest}}),Object.defineProperty(t,"DidRenameFilesNotification",{enumerable:!0,get:function(){return _.DidRenameFilesNotification}}),Object.defineProperty(t,"WillRenameFilesRequest",{enumerable:!0,get:function(){return _.WillRenameFilesRequest}}),Object.defineProperty(t,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return _.DidDeleteFilesNotification}}),Object.defineProperty(t,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return _.WillDeleteFilesRequest}});const v=n(2779);var T,b,I,S,x,C,w,E,k,D,A,P,R,F,N,M,O,L,U,q,V,B,W,j,z,$,H,G,K,J,Y,Q,Z,X,ee,te,ne,ie,re,se;Object.defineProperty(t,"UniquenessLevel",{enumerable:!0,get:function(){return v.UniquenessLevel}}),Object.defineProperty(t,"MonikerKind",{enumerable:!0,get:function(){return v.MonikerKind}}),Object.defineProperty(t,"MonikerRequest",{enumerable:!0,get:function(){return v.MonikerRequest}}),function(e){e.is=function(e){const t=e;return i.string(t.language)||i.string(t.scheme)||i.string(t.pattern)}}(T=t.DocumentFilter||(t.DocumentFilter={})),function(e){e.is=function(e){if(!Array.isArray(e))return!1;for(let t of e)if(!i.string(t)&&!T.is(t))return!1;return!0}}(b=t.DocumentSelector||(t.DocumentSelector={})),(t.RegistrationRequest||(t.RegistrationRequest={})).type=new r.ProtocolRequestType("client/registerCapability"),(t.UnregistrationRequest||(t.UnregistrationRequest={})).type=new r.ProtocolRequestType("client/unregisterCapability"),(se=t.ResourceOperationKind||(t.ResourceOperationKind={})).Create="create",se.Rename="rename",se.Delete="delete",(re=t.FailureHandlingKind||(t.FailureHandlingKind={})).Abort="abort",re.Transactional="transactional",re.TextOnlyTransactional="textOnlyTransactional",re.Undo="undo",(t.StaticRegistrationOptions||(t.StaticRegistrationOptions={})).hasId=function(e){const t=e;return t&&i.string(t.id)&&t.id.length>0},(t.TextDocumentRegistrationOptions||(t.TextDocumentRegistrationOptions={})).is=function(e){const t=e;return t&&(null===t.documentSelector||b.is(t.documentSelector))},(ie=t.WorkDoneProgressOptions||(t.WorkDoneProgressOptions={})).is=function(e){const t=e;return i.objectLiteral(t)&&(void 0===t.workDoneProgress||i.boolean(t.workDoneProgress))},ie.hasWorkDoneProgress=function(e){const t=e;return t&&i.boolean(t.workDoneProgress)},(t.InitializeRequest||(t.InitializeRequest={})).type=new r.ProtocolRequestType("initialize"),(t.InitializeError||(t.InitializeError={})).unknownProtocolVersion=1,(t.InitializedNotification||(t.InitializedNotification={})).type=new r.ProtocolNotificationType("initialized"),(t.ShutdownRequest||(t.ShutdownRequest={})).type=new r.ProtocolRequestType0("shutdown"),(t.ExitNotification||(t.ExitNotification={})).type=new r.ProtocolNotificationType0("exit"),(t.DidChangeConfigurationNotification||(t.DidChangeConfigurationNotification={})).type=new r.ProtocolNotificationType("workspace/didChangeConfiguration"),(ne=t.MessageType||(t.MessageType={})).Error=1,ne.Warning=2,ne.Info=3,ne.Log=4,(t.ShowMessageNotification||(t.ShowMessageNotification={})).type=new r.ProtocolNotificationType("window/showMessage"),(t.ShowMessageRequest||(t.ShowMessageRequest={})).type=new r.ProtocolRequestType("window/showMessageRequest"),(t.LogMessageNotification||(t.LogMessageNotification={})).type=new r.ProtocolNotificationType("window/logMessage"),(t.TelemetryEventNotification||(t.TelemetryEventNotification={})).type=new r.ProtocolNotificationType("telemetry/event"),(te=t.TextDocumentSyncKind||(t.TextDocumentSyncKind={})).None=0,te.Full=1,te.Incremental=2,(ee=t.DidOpenTextDocumentNotification||(t.DidOpenTextDocumentNotification={})).method="textDocument/didOpen",ee.type=new r.ProtocolNotificationType(ee.method),(X=t.TextDocumentContentChangeEvent||(t.TextDocumentContentChangeEvent={})).isIncremental=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)},X.isFull=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength},(Z=t.DidChangeTextDocumentNotification||(t.DidChangeTextDocumentNotification={})).method="textDocument/didChange",Z.type=new r.ProtocolNotificationType(Z.method),(Q=t.DidCloseTextDocumentNotification||(t.DidCloseTextDocumentNotification={})).method="textDocument/didClose",Q.type=new r.ProtocolNotificationType(Q.method),(Y=t.DidSaveTextDocumentNotification||(t.DidSaveTextDocumentNotification={})).method="textDocument/didSave",Y.type=new r.ProtocolNotificationType(Y.method),(J=t.TextDocumentSaveReason||(t.TextDocumentSaveReason={})).Manual=1,J.AfterDelay=2,J.FocusOut=3,(K=t.WillSaveTextDocumentNotification||(t.WillSaveTextDocumentNotification={})).method="textDocument/willSave",K.type=new r.ProtocolNotificationType(K.method),(G=t.WillSaveTextDocumentWaitUntilRequest||(t.WillSaveTextDocumentWaitUntilRequest={})).method="textDocument/willSaveWaitUntil",G.type=new r.ProtocolRequestType(G.method),(t.DidChangeWatchedFilesNotification||(t.DidChangeWatchedFilesNotification={})).type=new r.ProtocolNotificationType("workspace/didChangeWatchedFiles"),(H=t.FileChangeType||(t.FileChangeType={})).Created=1,H.Changed=2,H.Deleted=3,($=t.WatchKind||(t.WatchKind={})).Create=1,$.Change=2,$.Delete=4,(t.PublishDiagnosticsNotification||(t.PublishDiagnosticsNotification={})).type=new r.ProtocolNotificationType("textDocument/publishDiagnostics"),(z=t.CompletionTriggerKind||(t.CompletionTriggerKind={})).Invoked=1,z.TriggerCharacter=2,z.TriggerForIncompleteCompletions=3,(j=t.CompletionRequest||(t.CompletionRequest={})).method="textDocument/completion",j.type=new r.ProtocolRequestType(j.method),(W=t.CompletionResolveRequest||(t.CompletionResolveRequest={})).method="completionItem/resolve",W.type=new r.ProtocolRequestType(W.method),(B=t.HoverRequest||(t.HoverRequest={})).method="textDocument/hover",B.type=new r.ProtocolRequestType(B.method),(V=t.SignatureHelpTriggerKind||(t.SignatureHelpTriggerKind={})).Invoked=1,V.TriggerCharacter=2,V.ContentChange=3,(q=t.SignatureHelpRequest||(t.SignatureHelpRequest={})).method="textDocument/signatureHelp",q.type=new r.ProtocolRequestType(q.method),(U=t.DefinitionRequest||(t.DefinitionRequest={})).method="textDocument/definition",U.type=new r.ProtocolRequestType(U.method),(L=t.ReferencesRequest||(t.ReferencesRequest={})).method="textDocument/references",L.type=new r.ProtocolRequestType(L.method),(O=t.DocumentHighlightRequest||(t.DocumentHighlightRequest={})).method="textDocument/documentHighlight",O.type=new r.ProtocolRequestType(O.method),(M=t.DocumentSymbolRequest||(t.DocumentSymbolRequest={})).method="textDocument/documentSymbol",M.type=new r.ProtocolRequestType(M.method),(N=t.CodeActionRequest||(t.CodeActionRequest={})).method="textDocument/codeAction",N.type=new r.ProtocolRequestType(N.method),(F=t.CodeActionResolveRequest||(t.CodeActionResolveRequest={})).method="codeAction/resolve",F.type=new r.ProtocolRequestType(F.method),(R=t.WorkspaceSymbolRequest||(t.WorkspaceSymbolRequest={})).method="workspace/symbol",R.type=new r.ProtocolRequestType(R.method),(P=t.CodeLensRequest||(t.CodeLensRequest={})).method="textDocument/codeLens",P.type=new r.ProtocolRequestType(P.method),(A=t.CodeLensResolveRequest||(t.CodeLensResolveRequest={})).method="codeLens/resolve",A.type=new r.ProtocolRequestType(A.method),(D=t.CodeLensRefreshRequest||(t.CodeLensRefreshRequest={})).method="workspace/codeLens/refresh",D.type=new r.ProtocolRequestType0(D.method),(k=t.DocumentLinkRequest||(t.DocumentLinkRequest={})).method="textDocument/documentLink",k.type=new r.ProtocolRequestType(k.method),(E=t.DocumentLinkResolveRequest||(t.DocumentLinkResolveRequest={})).method="documentLink/resolve",E.type=new r.ProtocolRequestType(E.method),(w=t.DocumentFormattingRequest||(t.DocumentFormattingRequest={})).method="textDocument/formatting",w.type=new r.ProtocolRequestType(w.method),(C=t.DocumentRangeFormattingRequest||(t.DocumentRangeFormattingRequest={})).method="textDocument/rangeFormatting",C.type=new r.ProtocolRequestType(C.method),(x=t.DocumentOnTypeFormattingRequest||(t.DocumentOnTypeFormattingRequest={})).method="textDocument/onTypeFormatting",x.type=new r.ProtocolRequestType(x.method),(t.PrepareSupportDefaultBehavior||(t.PrepareSupportDefaultBehavior={})).Identifier=1,(S=t.RenameRequest||(t.RenameRequest={})).method="textDocument/rename",S.type=new r.ProtocolRequestType(S.method),(I=t.PrepareRenameRequest||(t.PrepareRenameRequest={})).method="textDocument/prepareRename",I.type=new r.ProtocolRequestType(I.method),(t.ExecuteCommandRequest||(t.ExecuteCommandRequest={})).type=new r.ProtocolRequestType("workspace/executeCommand"),(t.ApplyWorkspaceEditRequest||(t.ApplyWorkspaceEditRequest={})).type=new r.ProtocolRequestType("workspace/applyEdit")},7036:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeRequest=void 0;const i=n(9368);var r;(r=t.LinkedEditingRangeRequest||(t.LinkedEditingRangeRequest={})).method="textDocument/linkedEditingRange",r.type=new i.ProtocolRequestType(r.method)},2779:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=void 0;const i=n(9368);var r,s,o;(o=t.UniquenessLevel||(t.UniquenessLevel={})).document="document",o.project="project",o.group="group",o.scheme="scheme",o.global="global",(s=t.MonikerKind||(t.MonikerKind={})).import="import",s.export="export",s.local="local",(r=t.MonikerRequest||(t.MonikerRequest={})).method="textDocument/moniker",r.type=new i.ProtocolRequestType(r.method)},9784:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=void 0;const i=n(3374),r=n(9368);var s;(s=t.WorkDoneProgress||(t.WorkDoneProgress={})).type=new i.ProgressType,s.is=function(e){return e===s.type},(t.WorkDoneProgressCreateRequest||(t.WorkDoneProgressCreateRequest={})).type=new r.ProtocolRequestType("window/workDoneProgress/create"),(t.WorkDoneProgressCancelNotification||(t.WorkDoneProgressCancelNotification={})).type=new r.ProtocolNotificationType("window/workDoneProgress/cancel")},9998:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRangeRequest=void 0;const i=n(9368);var r;(r=t.SelectionRangeRequest||(t.SelectionRangeRequest={})).method="textDocument/selectionRange",r.type=new i.ProtocolRequestType(r.method)},7614:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.SemanticTokensRegistrationType=t.TokenFormat=t.SemanticTokens=t.SemanticTokenModifiers=t.SemanticTokenTypes=void 0;const i=n(9368);var r,s,o,a,l,c,u;(u=t.SemanticTokenTypes||(t.SemanticTokenTypes={})).namespace="namespace",u.type="type",u.class="class",u.enum="enum",u.interface="interface",u.struct="struct",u.typeParameter="typeParameter",u.parameter="parameter",u.variable="variable",u.property="property",u.enumMember="enumMember",u.event="event",u.function="function",u.method="method",u.macro="macro",u.keyword="keyword",u.modifier="modifier",u.comment="comment",u.string="string",u.number="number",u.regexp="regexp",u.operator="operator",(c=t.SemanticTokenModifiers||(t.SemanticTokenModifiers={})).declaration="declaration",c.definition="definition",c.readonly="readonly",c.static="static",c.deprecated="deprecated",c.abstract="abstract",c.async="async",c.modification="modification",c.documentation="documentation",c.defaultLibrary="defaultLibrary",(t.SemanticTokens||(t.SemanticTokens={})).is=function(e){const t=e;return void 0!==t&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])},(t.TokenFormat||(t.TokenFormat={})).Relative="relative",(l=t.SemanticTokensRegistrationType||(t.SemanticTokensRegistrationType={})).method="textDocument/semanticTokens",l.type=new i.RegistrationType(l.method),(a=t.SemanticTokensRequest||(t.SemanticTokensRequest={})).method="textDocument/semanticTokens/full",a.type=new i.ProtocolRequestType(a.method),(o=t.SemanticTokensDeltaRequest||(t.SemanticTokensDeltaRequest={})).method="textDocument/semanticTokens/full/delta",o.type=new i.ProtocolRequestType(o.method),(s=t.SemanticTokensRangeRequest||(t.SemanticTokensRangeRequest={})).method="textDocument/semanticTokens/range",s.type=new i.ProtocolRequestType(s.method),(r=t.SemanticTokensRefreshRequest||(t.SemanticTokensRefreshRequest={})).method="workspace/semanticTokens/refresh",r.type=new i.ProtocolRequestType0(r.method)},5636:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentRequest=void 0;const i=n(9368);var r;(r=t.ShowDocumentRequest||(t.ShowDocumentRequest={})).method="window/showDocument",r.type=new i.ProtocolRequestType(r.method)},4951:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeDefinitionRequest=void 0;const i=n(9368);var r;(r=t.TypeDefinitionRequest||(t.TypeDefinitionRequest={})).method="textDocument/typeDefinition",r.type=new i.ProtocolRequestType(r.method)},1618:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=void 0;const i=n(9368);(t.WorkspaceFoldersRequest||(t.WorkspaceFoldersRequest={})).type=new i.ProtocolRequestType0("workspace/workspaceFolders"),(t.DidChangeWorkspaceFoldersNotification||(t.DidChangeWorkspaceFoldersNotification={})).type=new i.ProtocolNotificationType("workspace/didChangeWorkspaceFolders")},2524:(e,t)=>{"use strict";function n(e){return"string"==typeof e||e instanceof String}function i(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.objectLiteral=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=i,t.stringArray=function(e){return i(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.objectLiteral=function(e){return null!==e&&"object"==typeof e}},5269:(e,t,n)=>{"use strict";var i,r,s,o,a,l,c,u,p,d,h,m,f,g,y,_,v,T,b,I,S,x,C,w,E,k;n.r(t),n.d(t,{integer:()=>i,uinteger:()=>r,Position:()=>s,Range:()=>o,Location:()=>a,LocationLink:()=>l,Color:()=>c,ColorInformation:()=>u,ColorPresentation:()=>p,FoldingRangeKind:()=>d,FoldingRange:()=>h,DiagnosticRelatedInformation:()=>m,DiagnosticSeverity:()=>f,DiagnosticTag:()=>g,CodeDescription:()=>y,Diagnostic:()=>_,Command:()=>v,TextEdit:()=>T,ChangeAnnotation:()=>b,ChangeAnnotationIdentifier:()=>I,AnnotatedTextEdit:()=>S,TextDocumentEdit:()=>x,CreateFile:()=>C,RenameFile:()=>w,DeleteFile:()=>E,WorkspaceEdit:()=>k,WorkspaceChange:()=>ae,TextDocumentIdentifier:()=>D,VersionedTextDocumentIdentifier:()=>A,OptionalVersionedTextDocumentIdentifier:()=>P,TextDocumentItem:()=>R,MarkupKind:()=>F,MarkupContent:()=>N,CompletionItemKind:()=>M,InsertTextFormat:()=>O,CompletionItemTag:()=>L,InsertReplaceEdit:()=>U,InsertTextMode:()=>q,CompletionItem:()=>V,CompletionList:()=>B,MarkedString:()=>W,Hover:()=>j,ParameterInformation:()=>z,SignatureInformation:()=>$,DocumentHighlightKind:()=>H,DocumentHighlight:()=>G,SymbolKind:()=>K,SymbolTag:()=>J,SymbolInformation:()=>Y,DocumentSymbol:()=>Q,CodeActionKind:()=>Z,CodeActionContext:()=>X,CodeAction:()=>ee,CodeLens:()=>te,FormattingOptions:()=>ne,DocumentLink:()=>ie,SelectionRange:()=>re,EOL:()=>ce,TextDocument:()=>le}),function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647}(i||(i={})),function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647}(r||(r={})),function(e){e.create=function(e,t){return e===Number.MAX_VALUE&&(e=r.MAX_VALUE),t===Number.MAX_VALUE&&(t=r.MAX_VALUE),{line:e,character:t}},e.is=function(e){var t=e;return ue.objectLiteral(t)&&ue.uinteger(t.line)&&ue.uinteger(t.character)}}(s||(s={})),function(e){e.create=function(e,t,n,i){if(ue.uinteger(e)&&ue.uinteger(t)&&ue.uinteger(n)&&ue.uinteger(i))return{start:s.create(e,t),end:s.create(n,i)};if(s.is(e)&&s.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments["+e+", "+t+", "+n+", "+i+"]")},e.is=function(e){var t=e;return ue.objectLiteral(t)&&s.is(t.start)&&s.is(t.end)}}(o||(o={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return ue.defined(t)&&o.is(t.range)&&(ue.string(t.uri)||ue.undefined(t.uri))}}(a||(a={})),function(e){e.create=function(e,t,n,i){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:i}},e.is=function(e){var t=e;return ue.defined(t)&&o.is(t.targetRange)&&ue.string(t.targetUri)&&(o.is(t.targetSelectionRange)||ue.undefined(t.targetSelectionRange))&&(o.is(t.originSelectionRange)||ue.undefined(t.originSelectionRange))}}(l||(l={})),function(e){e.create=function(e,t,n,i){return{red:e,green:t,blue:n,alpha:i}},e.is=function(e){var t=e;return ue.numberRange(t.red,0,1)&&ue.numberRange(t.green,0,1)&&ue.numberRange(t.blue,0,1)&&ue.numberRange(t.alpha,0,1)}}(c||(c={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return o.is(t.range)&&c.is(t.color)}}(u||(u={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){var t=e;return ue.string(t.label)&&(ue.undefined(t.textEdit)||T.is(t))&&(ue.undefined(t.additionalTextEdits)||ue.typedArray(t.additionalTextEdits,T.is))}}(p||(p={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(d||(d={})),function(e){e.create=function(e,t,n,i,r){var s={startLine:e,endLine:t};return ue.defined(n)&&(s.startCharacter=n),ue.defined(i)&&(s.endCharacter=i),ue.defined(r)&&(s.kind=r),s},e.is=function(e){var t=e;return ue.uinteger(t.startLine)&&ue.uinteger(t.startLine)&&(ue.undefined(t.startCharacter)||ue.uinteger(t.startCharacter))&&(ue.undefined(t.endCharacter)||ue.uinteger(t.endCharacter))&&(ue.undefined(t.kind)||ue.string(t.kind))}}(h||(h={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return ue.defined(t)&&a.is(t.location)&&ue.string(t.message)}}(m||(m={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(f||(f={})),function(e){e.Unnecessary=1,e.Deprecated=2}(g||(g={})),function(e){e.is=function(e){var t=e;return null!=t&&ue.string(t.href)}}(y||(y={})),function(e){e.create=function(e,t,n,i,r,s){var o={range:e,message:t};return ue.defined(n)&&(o.severity=n),ue.defined(i)&&(o.code=i),ue.defined(r)&&(o.source=r),ue.defined(s)&&(o.relatedInformation=s),o},e.is=function(e){var t,n=e;return ue.defined(n)&&o.is(n.range)&&ue.string(n.message)&&(ue.number(n.severity)||ue.undefined(n.severity))&&(ue.integer(n.code)||ue.string(n.code)||ue.undefined(n.code))&&(ue.undefined(n.codeDescription)||ue.string(null===(t=n.codeDescription)||void 0===t?void 0:t.href))&&(ue.string(n.source)||ue.undefined(n.source))&&(ue.undefined(n.relatedInformation)||ue.typedArray(n.relatedInformation,m.is))}}(_||(_={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r={title:e,command:t};return ue.defined(n)&&n.length>0&&(r.arguments=n),r},e.is=function(e){var t=e;return ue.defined(t)&&ue.string(t.title)&&ue.string(t.command)}}(v||(v={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return ue.objectLiteral(t)&&ue.string(t.newText)&&o.is(t.range)}}(T||(T={})),function(e){e.create=function(e,t,n){var i={label:e};return void 0!==t&&(i.needsConfirmation=t),void 0!==n&&(i.description=n),i},e.is=function(e){var t=e;return void 0!==t&&ue.objectLiteral(t)&&ue.string(t.label)&&(ue.boolean(t.needsConfirmation)||void 0===t.needsConfirmation)&&(ue.string(t.description)||void 0===t.description)}}(b||(b={})),function(e){e.is=function(e){return"string"==typeof e}}(I||(I={})),function(e){e.replace=function(e,t,n){return{range:e,newText:t,annotationId:n}},e.insert=function(e,t,n){return{range:{start:e,end:e},newText:t,annotationId:n}},e.del=function(e,t){return{range:e,newText:"",annotationId:t}},e.is=function(e){var t=e;return T.is(t)&&(b.is(t.annotationId)||I.is(t.annotationId))}}(S||(S={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return ue.defined(t)&&P.is(t.textDocument)&&Array.isArray(t.edits)}}(x||(x={})),function(e){e.create=function(e,t,n){var i={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){var t=e;return t&&"create"===t.kind&&ue.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||ue.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||ue.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||I.is(t.annotationId))}}(C||(C={})),function(e){e.create=function(e,t,n,i){var r={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(r.options=n),void 0!==i&&(r.annotationId=i),r},e.is=function(e){var t=e;return t&&"rename"===t.kind&&ue.string(t.oldUri)&&ue.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||ue.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||ue.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||I.is(t.annotationId))}}(w||(w={})),function(e){e.create=function(e,t,n){var i={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){var t=e;return t&&"delete"===t.kind&&ue.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||ue.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||ue.boolean(t.options.ignoreIfNotExists)))&&(void 0===t.annotationId||I.is(t.annotationId))}}(E||(E={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return ue.string(e.kind)?C.is(e)||w.is(e)||E.is(e):x.is(e)})))}}(k||(k={}));var D,A,P,R,F,N,M,O,L,U,q,V,B,W,j,z,$,H,G,K,J,Y,Q,Z,X,ee,te,ne,ie,re,se=function(){function e(e,t){this.edits=e,this.changeAnnotations=t}return e.prototype.insert=function(e,t,n){var i,r;if(void 0===n?i=T.insert(e,t):I.is(n)?(r=n,i=S.insert(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),r=this.changeAnnotations.manage(n),i=S.insert(e,t,r)),this.edits.push(i),void 0!==r)return r},e.prototype.replace=function(e,t,n){var i,r;if(void 0===n?i=T.replace(e,t):I.is(n)?(r=n,i=S.replace(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),r=this.changeAnnotations.manage(n),i=S.replace(e,t,r)),this.edits.push(i),void 0!==r)return r},e.prototype.delete=function(e,t){var n,i;if(void 0===t?n=T.del(e):I.is(t)?(i=t,n=S.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(t),n=S.del(e,i)),this.edits.push(n),void 0!==i)return i},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e.prototype.assertChangeAnnotations=function(e){if(void 0===e)throw new Error("Text edit change is not configured to manage change annotations.")},e}(),oe=function(){function e(e){this._annotations=void 0===e?Object.create(null):e,this._counter=0,this._size=0}return e.prototype.all=function(){return this._annotations},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.manage=function(e,t){var n;if(I.is(e)?n=e:(n=this.nextId(),t=e),void 0!==this._annotations[n])throw new Error("Id "+n+" is already in use.");if(void 0===t)throw new Error("No annotation provided for id "+n);return this._annotations[n]=t,this._size++,n},e.prototype.nextId=function(){return this._counter++,this._counter.toString()},e}(),ae=function(){function e(e){var t=this;this._textEditChanges=Object.create(null),void 0!==e?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new oe(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach((function(e){if(x.is(e)){var n=new se(e.edits,t._changeAnnotations);t._textEditChanges[e.textDocument.uri]=n}}))):e.changes&&Object.keys(e.changes).forEach((function(n){var i=new se(e.changes[n]);t._textEditChanges[n]=i}))):this._workspaceEdit={}}return Object.defineProperty(e.prototype,"edit",{get:function(){return this.initDocumentChanges(),void 0!==this._changeAnnotations&&(0===this._changeAnnotations.size?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),e.prototype.getTextEditChange=function(e){if(P.is(e)){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t={uri:e.uri,version:e.version};if(!(i=this._textEditChanges[t.uri])){var n={textDocument:t,edits:r=[]};this._workspaceEdit.documentChanges.push(n),i=new se(r,this._changeAnnotations),this._textEditChanges[t.uri]=i}return i}if(this.initChanges(),void 0===this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var i;if(!(i=this._textEditChanges[e])){var r=[];this._workspaceEdit.changes[e]=r,i=new se(r),this._textEditChanges[e]=i}return i},e.prototype.initDocumentChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._changeAnnotations=new oe,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},e.prototype.initChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._workspaceEdit.changes=Object.create(null))},e.prototype.createFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var i,r,s;if(b.is(t)||I.is(t)?i=t:n=t,void 0===i?r=C.create(e,n):(s=I.is(i)?i:this._changeAnnotations.manage(i),r=C.create(e,n,s)),this._workspaceEdit.documentChanges.push(r),void 0!==s)return s},e.prototype.renameFile=function(e,t,n,i){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var r,s,o;if(b.is(n)||I.is(n)?r=n:i=n,void 0===r?s=w.create(e,t,i):(o=I.is(r)?r:this._changeAnnotations.manage(r),s=w.create(e,t,i,o)),this._workspaceEdit.documentChanges.push(s),void 0!==o)return o},e.prototype.deleteFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var i,r,s;if(b.is(t)||I.is(t)?i=t:n=t,void 0===i?r=E.create(e,n):(s=I.is(i)?i:this._changeAnnotations.manage(i),r=E.create(e,n,s)),this._workspaceEdit.documentChanges.push(r),void 0!==s)return s},e}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return ue.defined(t)&&ue.string(t.uri)}}(D||(D={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return ue.defined(t)&&ue.string(t.uri)&&ue.integer(t.version)}}(A||(A={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return ue.defined(t)&&ue.string(t.uri)&&(null===t.version||ue.integer(t.version))}}(P||(P={})),function(e){e.create=function(e,t,n,i){return{uri:e,languageId:t,version:n,text:i}},e.is=function(e){var t=e;return ue.defined(t)&&ue.string(t.uri)&&ue.string(t.languageId)&&ue.integer(t.version)&&ue.string(t.text)}}(R||(R={})),function(e){e.PlainText="plaintext",e.Markdown="markdown"}(F||(F={})),function(e){e.is=function(t){var n=t;return n===e.PlainText||n===e.Markdown}}(F||(F={})),function(e){e.is=function(e){var t=e;return ue.objectLiteral(e)&&F.is(t.kind)&&ue.string(t.value)}}(N||(N={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(M||(M={})),function(e){e.PlainText=1,e.Snippet=2}(O||(O={})),function(e){e.Deprecated=1}(L||(L={})),function(e){e.create=function(e,t,n){return{newText:e,insert:t,replace:n}},e.is=function(e){var t=e;return t&&ue.string(t.newText)&&o.is(t.insert)&&o.is(t.replace)}}(U||(U={})),function(e){e.asIs=1,e.adjustIndentation=2}(q||(q={})),function(e){e.create=function(e){return{label:e}}}(V||(V={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(B||(B={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return ue.string(t)||ue.objectLiteral(t)&&ue.string(t.language)&&ue.string(t.value)}}(W||(W={})),function(e){e.is=function(e){var t=e;return!!t&&ue.objectLiteral(t)&&(N.is(t.contents)||W.is(t.contents)||ue.typedArray(t.contents,W.is))&&(void 0===e.range||o.is(e.range))}}(j||(j={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(z||(z={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r={label:e};return ue.defined(t)&&(r.documentation=t),ue.defined(n)?r.parameters=n:r.parameters=[],r}}($||($={})),function(e){e.Text=1,e.Read=2,e.Write=3}(H||(H={})),function(e){e.create=function(e,t){var n={range:e};return ue.number(t)&&(n.kind=t),n}}(G||(G={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(K||(K={})),function(e){e.Deprecated=1}(J||(J={})),function(e){e.create=function(e,t,n,i,r){var s={name:e,kind:t,location:{uri:i,range:n}};return r&&(s.containerName=r),s}}(Y||(Y={})),function(e){e.create=function(e,t,n,i,r,s){var o={name:e,detail:t,kind:n,range:i,selectionRange:r};return void 0!==s&&(o.children=s),o},e.is=function(e){var t=e;return t&&ue.string(t.name)&&ue.number(t.kind)&&o.is(t.range)&&o.is(t.selectionRange)&&(void 0===t.detail||ue.string(t.detail))&&(void 0===t.deprecated||ue.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))&&(void 0===t.tags||Array.isArray(t.tags))}}(Q||(Q={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(Z||(Z={})),function(e){e.create=function(e,t){var n={diagnostics:e};return null!=t&&(n.only=t),n},e.is=function(e){var t=e;return ue.defined(t)&&ue.typedArray(t.diagnostics,_.is)&&(void 0===t.only||ue.typedArray(t.only,ue.string))}}(X||(X={})),function(e){e.create=function(e,t,n){var i={title:e},r=!0;return"string"==typeof t?(r=!1,i.kind=t):v.is(t)?i.command=t:i.edit=t,r&&void 0!==n&&(i.kind=n),i},e.is=function(e){var t=e;return t&&ue.string(t.title)&&(void 0===t.diagnostics||ue.typedArray(t.diagnostics,_.is))&&(void 0===t.kind||ue.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||v.is(t.command))&&(void 0===t.isPreferred||ue.boolean(t.isPreferred))&&(void 0===t.edit||k.is(t.edit))}}(ee||(ee={})),function(e){e.create=function(e,t){var n={range:e};return ue.defined(t)&&(n.data=t),n},e.is=function(e){var t=e;return ue.defined(t)&&o.is(t.range)&&(ue.undefined(t.command)||v.is(t.command))}}(te||(te={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return ue.defined(t)&&ue.uinteger(t.tabSize)&&ue.boolean(t.insertSpaces)}}(ne||(ne={})),function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){var t=e;return ue.defined(t)&&o.is(t.range)&&(ue.undefined(t.target)||ue.string(t.target))}}(ie||(ie={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){var n=t;return void 0!==n&&o.is(n.range)&&(void 0===n.parent||e.is(n.parent))}}(re||(re={}));var le,ce=["\n","\r\n","\r"];!function(e){function t(e,n){if(e.length<=1)return e;var i=e.length/2|0,r=e.slice(0,i),s=e.slice(i);t(r,n),t(s,n);for(var o=0,a=0,l=0;o<r.length&&a<s.length;){var c=n(r[o],s[a]);e[l++]=c<=0?r[o++]:s[a++]}for(;o<r.length;)e[l++]=r[o++];for(;a<s.length;)e[l++]=s[a++];return e}e.create=function(e,t,n,i){return new pe(e,t,n,i)},e.is=function(e){var t=e;return!!(ue.defined(t)&&ue.string(t.uri)&&(ue.undefined(t.languageId)||ue.string(t.languageId))&&ue.uinteger(t.lineCount)&&ue.func(t.getText)&&ue.func(t.positionAt)&&ue.func(t.offsetAt))},e.applyEdits=function(e,n){for(var i=e.getText(),r=t(n,(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),s=i.length,o=r.length-1;o>=0;o--){var a=r[o],l=e.offsetAt(a.range.start),c=e.offsetAt(a.range.end);if(!(c<=s))throw new Error("Overlapping edit");i=i.substring(0,l)+a.newText+i.substring(c,i.length),s=l}return i}}(le||(le={}));var ue,pe=function(){function e(e,t,n,i){this._uri=e,this._languageId=t,this._version=n,this._content=i,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(void 0===this._lineOffsets){for(var e=[],t=this._content,n=!0,i=0;i<t.length;i++){n&&(e.push(i),n=!1);var r=t.charAt(i);n="\r"===r||"\n"===r,"\r"===r&&i+1<t.length&&"\n"===t.charAt(i+1)&&i++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,i=t.length;if(0===i)return s.create(0,e);for(;n<i;){var r=Math.floor((n+i)/2);t[r]>e?i=r:n=r+1}var o=n-1;return s.create(o,e-t[o])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.numberRange=function(e,n,i){return"[object Number]"===t.call(e)&&n<=e&&e<=i},e.integer=function(e){return"[object Number]"===t.call(e)&&-2147483648<=e&&e<=2147483647},e.uinteger=function(e){return"[object Number]"===t.call(e)&&0<=e&&e<=2147483647},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(ue||(ue={}))},8934:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=void 0;const s=n(8132);r(n(9290),t),r(n(8132),t);let o=!1;const a={initialize:e=>{},get shutdownReceived(){return o},set shutdownReceived(e){o=e},exit:e=>{}};t.createConnection=function(e,t,n,i){let r,o,l,c;return void 0!==e&&"features"===e.__brand&&(r=e,e=t,t=n,n=i),s.ConnectionStrategy.is(e)||s.ConnectionOptions.is(e)?c=e:(o=e,l=t,c=n),s.createConnection((e=>s.createProtocolConnection(o,l,e,c)),a,r)}},8132:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.ProposedFeatures=t.SemanticTokensBuilder=void 0;const s=n(6063);Object.defineProperty(t,"SemanticTokensBuilder",{enumerable:!0,get:function(){return s.SemanticTokensBuilder}}),r(n(2477),t),r(n(1486),t),(t.ProposedFeatures||(t.ProposedFeatures={})).all={__brand:"features"}},7522:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyFeature=void 0;const i=n(2477);t.CallHierarchyFeature=e=>class extends e{get callHierarchy(){return{onPrepare:e=>{this.connection.onRequest(i.CallHierarchyPrepareRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0)))},onIncomingCalls:e=>{const t=i.CallHierarchyIncomingCallsRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onOutgoingCalls:e=>{const t=i.CallHierarchyOutgoingCallsRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},2965:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationFeature=void 0;const i=n(2477),r=n(9079);t.ConfigurationFeature=e=>class extends e{getConfiguration(e){return e?r.string(e)?this._getConfiguration({section:e}):this._getConfiguration(e):this._getConfiguration({})}_getConfiguration(e){let t={items:Array.isArray(e)?e:[e]};return this.connection.sendRequest(i.ConfigurationRequest.type,t).then((t=>Array.isArray(e)?t:t[0]))}}},2027:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileOperationsFeature=void 0;const i=n(2477);t.FileOperationsFeature=e=>class extends e{onDidCreateFiles(e){this.connection.onNotification(i.DidCreateFilesNotification.type,(t=>{e(t)}))}onDidRenameFiles(e){this.connection.onNotification(i.DidRenameFilesNotification.type,(t=>{e(t)}))}onDidDeleteFiles(e){this.connection.onNotification(i.DidDeleteFilesNotification.type,(t=>{e(t)}))}onWillCreateFiles(e){return this.connection.onRequest(i.WillCreateFilesRequest.type,((t,n)=>e(t,n)))}onWillRenameFiles(e){return this.connection.onRequest(i.WillRenameFilesRequest.type,((t,n)=>e(t,n)))}onWillDeleteFiles(e){return this.connection.onRequest(i.WillDeleteFilesRequest.type,((t,n)=>e(t,n)))}}},7891:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeFeature=void 0;const i=n(2477);t.LinkedEditingRangeFeature=e=>class extends e{onLinkedEditingRange(e){this.connection.onRequest(i.LinkedEditingRangeRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0)))}}},6046:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerFeature=void 0;const i=n(2477);t.MonikerFeature=e=>class extends e{get moniker(){return{on:e=>{const t=i.MonikerRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},7256:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachPartialResult=t.ProgressFeature=t.attachWorkDone=void 0;const i=n(2477),r=n(5075);class s{constructor(e,t){this._connection=e,this._token=t,s.Instances.set(this._token,this)}begin(e,t,n,r){let s={kind:"begin",title:e,percentage:t,message:n,cancellable:r};this._connection.sendProgress(i.WorkDoneProgress.type,this._token,s)}report(e,t){let n={kind:"report"};"number"==typeof e?(n.percentage=e,void 0!==t&&(n.message=t)):n.message=e,this._connection.sendProgress(i.WorkDoneProgress.type,this._token,n)}done(){s.Instances.delete(this._token),this._connection.sendProgress(i.WorkDoneProgress.type,this._token,{kind:"end"})}}s.Instances=new Map;class o extends s{constructor(e,t){super(e,t),this._source=new i.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}}class a{constructor(){}begin(){}report(){}done(){}}class l extends a{constructor(){super(),this._source=new i.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}}var c;t.attachWorkDone=function(e,t){if(void 0===t||void 0===t.workDoneToken)return new a;const n=t.workDoneToken;return delete t.workDoneToken,new s(e,n)},t.ProgressFeature=e=>class extends e{constructor(){super(),this._progressSupported=!1}initialize(e){var t;!0===(null===(t=null==e?void 0:e.window)||void 0===t?void 0:t.workDoneProgress)&&(this._progressSupported=!0,this.connection.onNotification(i.WorkDoneProgressCancelNotification.type,(e=>{let t=s.Instances.get(e.token);(t instanceof o||t instanceof l)&&t.cancel()})))}attachWorkDoneProgress(e){return void 0===e?new a:new s(this.connection,e)}createWorkDoneProgress(){if(this._progressSupported){const e=r.generateUuid();return this.connection.sendRequest(i.WorkDoneProgressCreateRequest.type,{token:e}).then((()=>new o(this.connection,e)))}return Promise.resolve(new l)}},function(e){e.type=new i.ProgressType}(c||(c={}));class u{constructor(e,t){this._connection=e,this._token=t}report(e){this._connection.sendProgress(c.type,this._token,e)}}t.attachPartialResult=function(e,t){if(void 0===t||void 0===t.partialResultToken)return;const n=t.partialResultToken;return delete t.partialResultToken,new u(e,n)}},6063:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensBuilder=t.SemanticTokensFeature=void 0;const i=n(2477);t.SemanticTokensFeature=e=>class extends e{get semanticTokens(){return{on:e=>{const t=i.SemanticTokensRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onDelta:e=>{const t=i.SemanticTokensDeltaRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onRange:e=>{const t=i.SemanticTokensRangeRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}},t.SemanticTokensBuilder=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(e,t,n,i,r){let s=e,o=t;this._dataLen>0&&(s-=this._prevLine,0===s&&(o-=this._prevChar)),this._data[this._dataLen++]=s,this._data[this._dataLen++]=o,this._data[this._dataLen++]=n,this._data[this._dataLen++]=i,this._data[this._dataLen++]=r,this._prevLine=e,this._prevChar=t}get id(){return this._id.toString()}previousResult(e){this.id===e&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return void 0!==this._prevData}buildEdits(){if(void 0!==this._prevData){const e=this._prevData.length,t=this._data.length;let n=0;for(;n<t&&n<e&&this._prevData[n]===this._data[n];)n++;if(n<t&&n<e){let i=0;for(;i<t&&i<e&&this._prevData[e-1-i]===this._data[t-1-i];)i++;const r=this._data.slice(n,t-i);return{resultId:this.id,edits:[{start:n,deleteCount:e-i-n,data:r}]}}return n<t?{resultId:this.id,edits:[{start:n,deleteCount:0,data:this._data.slice(n)}]}:n<e?{resultId:this.id,edits:[{start:n,deleteCount:e-n}]}:{resultId:this.id,edits:[]}}return this.build()}}},1486:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=t.combineFeatures=t.combineLanguagesFeatures=t.combineWorkspaceFeatures=t.combineWindowFeatures=t.combineClientFeatures=t.combineTracerFeatures=t.combineTelemetryFeatures=t.combineConsoleFeatures=t._LanguagesImpl=t.BulkUnregistration=t.BulkRegistration=t.ErrorMessageTracker=t.TextDocuments=void 0;const i=n(2477),r=n(9079),s=n(5075),o=n(7256),a=n(2965),l=n(1252),c=n(7522),u=n(6063),p=n(736),d=n(2027),h=n(7891),m=n(6046);function f(e){if(null!==e)return e}t.TextDocuments=class{constructor(e){this._documents=Object.create(null),this._configuration=e,this._onDidChangeContent=new i.Emitter,this._onDidOpen=new i.Emitter,this._onDidClose=new i.Emitter,this._onDidSave=new i.Emitter,this._onWillSave=new i.Emitter}get onDidChangeContent(){return this._onDidChangeContent.event}get onDidOpen(){return this._onDidOpen.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._documents[e]}all(){return Object.keys(this._documents).map((e=>this._documents[e]))}keys(){return Object.keys(this._documents)}listen(e){e.__textDocumentSync=i.TextDocumentSyncKind.Full,e.onDidOpenTextDocument((e=>{let t=e.textDocument,n=this._configuration.create(t.uri,t.languageId,t.version,t.text);this._documents[t.uri]=n;let i=Object.freeze({document:n});this._onDidOpen.fire(i),this._onDidChangeContent.fire(i)})),e.onDidChangeTextDocument((e=>{let t=e.textDocument,n=e.contentChanges;if(0===n.length)return;let i=this._documents[t.uri];const{version:r}=t;if(null==r)throw new Error(`Received document change event for ${t.uri} without valid version identifier`);i=this._configuration.update(i,n,r),this._documents[t.uri]=i,this._onDidChangeContent.fire(Object.freeze({document:i}))})),e.onDidCloseTextDocument((e=>{let t=this._documents[e.textDocument.uri];t&&(delete this._documents[e.textDocument.uri],this._onDidClose.fire(Object.freeze({document:t})))})),e.onWillSaveTextDocument((e=>{let t=this._documents[e.textDocument.uri];t&&this._onWillSave.fire(Object.freeze({document:t,reason:e.reason}))})),e.onWillSaveTextDocumentWaitUntil(((e,t)=>{let n=this._documents[e.textDocument.uri];return n&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:n,reason:e.reason}),t):[]})),e.onDidSaveTextDocument((e=>{let t=this._documents[e.textDocument.uri];t&&this._onDidSave.fire(Object.freeze({document:t}))}))}},t.ErrorMessageTracker=class{constructor(){this._messages=Object.create(null)}add(e){let t=this._messages[e];t||(t=0),t++,this._messages[e]=t}sendErrors(e){Object.keys(this._messages).forEach((t=>{e.window.showErrorMessage(t)}))}};class g{constructor(){}rawAttach(e){this._rawConnection=e}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(e){}initialize(e){}error(e){this.send(i.MessageType.Error,e)}warn(e){this.send(i.MessageType.Warning,e)}info(e){this.send(i.MessageType.Info,e)}log(e){this.send(i.MessageType.Log,e)}send(e,t){this._rawConnection&&this._rawConnection.sendNotification(i.LogMessageNotification.type,{type:e,message:t})}}const y=p.ShowDocumentFeature(o.ProgressFeature(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}showErrorMessage(e,...t){let n={type:i.MessageType.Error,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(f)}showWarningMessage(e,...t){let n={type:i.MessageType.Warning,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(f)}showInformationMessage(e,...t){let n={type:i.MessageType.Info,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(f)}}));(t.BulkRegistration||(t.BulkRegistration={})).create=function(){return new _};class _{constructor(){this._registrations=[],this._registered=new Set}add(e,t){const n=r.string(e)?e:e.method;if(this._registered.has(n))throw new Error(`${n} is already added to this registration`);const i=s.generateUuid();this._registrations.push({id:i,method:n,registerOptions:t||{}}),this._registered.add(n)}asRegistrationParams(){return{registrations:this._registrations}}}(t.BulkUnregistration||(t.BulkUnregistration={})).create=function(){return new v(void 0,[])};class v{constructor(e,t){this._connection=e,this._unregistrations=new Map,t.forEach((e=>{this._unregistrations.set(e.method,e)}))}get isAttached(){return!!this._connection}attach(e){this._connection=e}add(e){this._unregistrations.set(e.method,e)}dispose(){let e=[];for(let t of this._unregistrations.values())e.push(t);let t={unregisterations:e};this._connection.sendRequest(i.UnregistrationRequest.type,t).then(void 0,(e=>{this._connection.console.info("Bulk unregistration failed.")}))}disposeSingle(e){const t=r.string(e)?e:e.method,n=this._unregistrations.get(t);if(!n)return!1;let s={unregisterations:[n]};return this._connection.sendRequest(i.UnregistrationRequest.type,s).then((()=>{this._unregistrations.delete(t)}),(e=>{this._connection.console.info(`Un-registering request handler for ${n.id} failed.`)})),!0}}class T{attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}register(e,t,n){return e instanceof _?this.registerMany(e):e instanceof v?this.registerSingle1(e,t,n):this.registerSingle2(e,t)}registerSingle1(e,t,n){const o=r.string(t)?t:t.method,a=s.generateUuid();let l={registrations:[{id:a,method:o,registerOptions:n||{}}]};return e.isAttached||e.attach(this.connection),this.connection.sendRequest(i.RegistrationRequest.type,l).then((t=>(e.add({id:a,method:o}),e)),(e=>(this.connection.console.info(`Registering request handler for ${o} failed.`),Promise.reject(e))))}registerSingle2(e,t){const n=r.string(e)?e:e.method,o=s.generateUuid();let a={registrations:[{id:o,method:n,registerOptions:t||{}}]};return this.connection.sendRequest(i.RegistrationRequest.type,a).then((e=>i.Disposable.create((()=>{this.unregisterSingle(o,n)}))),(e=>(this.connection.console.info(`Registering request handler for ${n} failed.`),Promise.reject(e))))}unregisterSingle(e,t){let n={unregisterations:[{id:e,method:t}]};return this.connection.sendRequest(i.UnregistrationRequest.type,n).then(void 0,(t=>{this.connection.console.info(`Un-registering request handler for ${e} failed.`)}))}registerMany(e){let t=e.asRegistrationParams();return this.connection.sendRequest(i.RegistrationRequest.type,t).then((()=>new v(this._connection,t.registrations.map((e=>({id:e.id,method:e.method}))))),(e=>(this.connection.console.info("Bulk registration failed."),Promise.reject(e))))}}const b=d.FileOperationsFeature(l.WorkspaceFoldersFeature(a.ConfigurationFeature(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}applyEdit(e){let t=(n=e)&&n.edit?e:{edit:e};var n;return this.connection.sendRequest(i.ApplyWorkspaceEditRequest.type,t)}})));class I{constructor(){this._trace=i.Trace.Off}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}set trace(e){this._trace=e}log(e,t){this._trace!==i.Trace.Off&&this.connection.sendNotification(i.LogTraceNotification.type,{message:e,verbose:this._trace===i.Trace.Verbose?t:void 0})}}class S{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}logEvent(e){this.connection.sendNotification(i.TelemetryEventNotification.type,e)}}class x{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return o.attachWorkDone(this.connection,e)}attachPartialResultProgress(e,t){return o.attachPartialResult(this.connection,t)}}t._LanguagesImpl=x;const C=m.MonikerFeature(h.LinkedEditingRangeFeature(u.SemanticTokensFeature(c.CallHierarchyFeature(x))));function w(e,t){return function(n){return t(e(n))}}function E(e,t){return function(n){return t(e(n))}}function k(e,t){return function(n){return t(e(n))}}function D(e,t){return function(n){return t(e(n))}}function A(e,t){return function(n){return t(e(n))}}function P(e,t){return function(n){return t(e(n))}}t.combineConsoleFeatures=w,t.combineTelemetryFeatures=E,t.combineTracerFeatures=k,t.combineClientFeatures=D,t.combineWindowFeatures=A,t.combineWorkspaceFeatures=P,t.combineLanguagesFeatures=function(e,t){return function(n){return t(e(n))}},t.combineFeatures=function(e,t){function n(e,t,n){return e&&t?n(e,t):e||t}return{__brand:"features",console:n(e.console,t.console,w),tracer:n(e.tracer,t.tracer,k),telemetry:n(e.telemetry,t.telemetry,E),client:n(e.client,t.client,D),window:n(e.window,t.window,A),workspace:n(e.workspace,t.workspace,P)}},t.createConnection=function(e,t,n){const s=n&&n.console?new(n.console(g)):new g,a=e(s);s.rawAttach(a);const l=n&&n.tracer?new(n.tracer(I)):new I,c=n&&n.telemetry?new(n.telemetry(S)):new S,u=n&&n.client?new(n.client(T)):new T,p=n&&n.window?new(n.window(y)):new y,d=n&&n.workspace?new(n.workspace(b)):new b,h=n&&n.languages?new(n.languages(C)):new C,m=[s,l,c,u,p,d,h];function f(e){return e instanceof Promise?e:r.thenable(e)?new Promise(((t,n)=>{e.then((e=>t(e)),(e=>n(e)))})):Promise.resolve(e)}let _,v,x,w={listen:()=>a.listen(),sendRequest:(e,...t)=>a.sendRequest(r.string(e)?e:e.method,...t),onRequest:(e,t)=>a.onRequest(e,t),sendNotification:(e,t)=>{const n=r.string(e)?e:e.method;1===arguments.length?a.sendNotification(n):a.sendNotification(n,t)},onNotification:(e,t)=>a.onNotification(e,t),onProgress:a.onProgress,sendProgress:a.sendProgress,onInitialize:e=>v=e,onInitialized:e=>a.onNotification(i.InitializedNotification.type,e),onShutdown:e=>_=e,onExit:e=>x=e,get console(){return s},get telemetry(){return c},get tracer(){return l},get client(){return u},get window(){return p},get workspace(){return d},get languages(){return h},onDidChangeConfiguration:e=>a.onNotification(i.DidChangeConfigurationNotification.type,e),onDidChangeWatchedFiles:e=>a.onNotification(i.DidChangeWatchedFilesNotification.type,e),__textDocumentSync:void 0,onDidOpenTextDocument:e=>a.onNotification(i.DidOpenTextDocumentNotification.type,e),onDidChangeTextDocument:e=>a.onNotification(i.DidChangeTextDocumentNotification.type,e),onDidCloseTextDocument:e=>a.onNotification(i.DidCloseTextDocumentNotification.type,e),onWillSaveTextDocument:e=>a.onNotification(i.WillSaveTextDocumentNotification.type,e),onWillSaveTextDocumentWaitUntil:e=>a.onRequest(i.WillSaveTextDocumentWaitUntilRequest.type,e),onDidSaveTextDocument:e=>a.onNotification(i.DidSaveTextDocumentNotification.type,e),sendDiagnostics:e=>a.sendNotification(i.PublishDiagnosticsNotification.type,e),onHover:e=>a.onRequest(i.HoverRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),void 0))),onCompletion:e=>a.onRequest(i.CompletionRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onCompletionResolve:e=>a.onRequest(i.CompletionResolveRequest.type,e),onSignatureHelp:e=>a.onRequest(i.SignatureHelpRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),void 0))),onDeclaration:e=>a.onRequest(i.DeclarationRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onDefinition:e=>a.onRequest(i.DefinitionRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onTypeDefinition:e=>a.onRequest(i.TypeDefinitionRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onImplementation:e=>a.onRequest(i.ImplementationRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onReferences:e=>a.onRequest(i.ReferencesRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onDocumentHighlight:e=>a.onRequest(i.DocumentHighlightRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onDocumentSymbol:e=>a.onRequest(i.DocumentSymbolRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onWorkspaceSymbol:e=>a.onRequest(i.WorkspaceSymbolRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onCodeAction:e=>a.onRequest(i.CodeActionRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onCodeActionResolve:e=>a.onRequest(i.CodeActionResolveRequest.type,((t,n)=>e(t,n))),onCodeLens:e=>a.onRequest(i.CodeLensRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onCodeLensResolve:e=>a.onRequest(i.CodeLensResolveRequest.type,((t,n)=>e(t,n))),onDocumentFormatting:e=>a.onRequest(i.DocumentFormattingRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),void 0))),onDocumentRangeFormatting:e=>a.onRequest(i.DocumentRangeFormattingRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),void 0))),onDocumentOnTypeFormatting:e=>a.onRequest(i.DocumentOnTypeFormattingRequest.type,((t,n)=>e(t,n))),onRenameRequest:e=>a.onRequest(i.RenameRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),void 0))),onPrepareRename:e=>a.onRequest(i.PrepareRenameRequest.type,((t,n)=>e(t,n))),onDocumentLinks:e=>a.onRequest(i.DocumentLinkRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onDocumentLinkResolve:e=>a.onRequest(i.DocumentLinkResolveRequest.type,((t,n)=>e(t,n))),onDocumentColor:e=>a.onRequest(i.DocumentColorRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onColorPresentation:e=>a.onRequest(i.ColorPresentationRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onFoldingRanges:e=>a.onRequest(i.FoldingRangeRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onSelectionRanges:e=>a.onRequest(i.SelectionRangeRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),o.attachPartialResult(a,t)))),onExecuteCommand:e=>a.onRequest(i.ExecuteCommandRequest.type,((t,n)=>e(t,n,o.attachWorkDone(a,t),void 0))),dispose:()=>a.dispose()};for(let e of m)e.attach(w);return a.onRequest(i.InitializeRequest.type,(e=>{t.initialize(e),r.string(e.trace)&&(l.trace=i.Trace.fromString(e.trace));for(let t of m)t.initialize(e.capabilities);if(v)return f(v(e,(new i.CancellationTokenSource).token,o.attachWorkDone(a,e),void 0)).then((e=>{if(e instanceof i.ResponseError)return e;let t=e;t||(t={capabilities:{}});let n=t.capabilities;n||(n={},t.capabilities=n),void 0===n.textDocumentSync||null===n.textDocumentSync?n.textDocumentSync=r.number(w.__textDocumentSync)?w.__textDocumentSync:i.TextDocumentSyncKind.None:r.number(n.textDocumentSync)||r.number(n.textDocumentSync.change)||(n.textDocumentSync.change=r.number(w.__textDocumentSync)?w.__textDocumentSync:i.TextDocumentSyncKind.None);for(let e of m)e.fillServerCapabilities(n);return t}));{let e={capabilities:{textDocumentSync:i.TextDocumentSyncKind.None}};for(let t of m)t.fillServerCapabilities(e.capabilities);return e}})),a.onRequest(i.ShutdownRequest.type,(()=>(t.shutdownReceived=!0,_?_((new i.CancellationTokenSource).token):void 0))),a.onNotification(i.ExitNotification.type,(()=>{try{x&&x()}finally{t.shutdownReceived?t.exit(0):t.exit(1)}})),a.onNotification(i.SetTraceNotification.type,(e=>{l.trace=i.Trace.fromString(e.value)})),w}},736:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentFeature=void 0;const i=n(2477);t.ShowDocumentFeature=e=>class extends e{showDocument(e){return this.connection.sendRequest(i.ShowDocumentRequest.type,e)}}},9079:(e,t)=>{"use strict";function n(e){return"string"==typeof e||e instanceof String}function i(e){return"function"==typeof e}function r(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.thenable=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=i,t.array=r,t.stringArray=function(e){return r(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.thenable=function(e){return e&&i(e.then)}},5075:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateUuid=t.parse=t.isUUID=t.v4=t.empty=void 0;class n{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class i extends n{constructor(){super([i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),"-",i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),"-","4",i._randomHex(),i._randomHex(),i._randomHex(),"-",i._oneOf(i._timeHighBits),i._randomHex(),i._randomHex(),i._randomHex(),"-",i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return i._oneOf(i._chars)}}function r(){return new i}i._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],i._timeHighBits=["8","9","a","b"],t.empty=new n("00000000-0000-0000-0000-000000000000"),t.v4=r;const s=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function o(e){return s.test(e)}t.isUUID=o,t.parse=function(e){if(!o(e))throw new Error("invalid uuid");return new n(e)},t.generateUuid=function(){return r().asHex()}},1252:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceFoldersFeature=void 0;const i=n(2477);t.WorkspaceFoldersFeature=e=>class extends e{initialize(e){let t=e.workspace;t&&t.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new i.Emitter,this.connection.onNotification(i.DidChangeWorkspaceFoldersNotification.type,(e=>{this._onDidChangeWorkspaceFolders.fire(e.event)})))}getWorkspaceFolders(){return this.connection.sendRequest(i.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return this._unregistration||(this._unregistration=this.connection.client.register(i.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}}},6395:e=>{"use strict";e.exports=JSON.parse('{"Diagnostic":{"annotatedParamCountMismatch":"Parameter annotation count mismatch: expected {expected} but received {received}","annotatedTypeArgMissing":"Expected one type argument and one or more annotations for \\"Annotated\\"","annotationFormatString":"Type annotations cannot use format string literals (f-strings)","annotationNotSupported":"Type annotation not supported for this type of expression","annotationSpansStrings":"Type annotations cannot span multiple string literals","annotationStringEscape":"Type annotations cannot contain escape characters","argAssignment":"Argument of type \\"{argType}\\" cannot be assigned to parameter of type \\"{paramType}\\"","argAssignmentFunction":"Argument of type \\"{argType}\\" cannot be assigned to parameter of type \\"{paramType}\\" in function \\"{functionName}\\"","argAssignmentParam":"Argument of type \\"{argType}\\" cannot be assigned to parameter \\"{paramName}\\" of type \\"{paramType}\\"","argAssignmentParamFunction":"Argument of type \\"{argType}\\" cannot be assigned to parameter \\"{paramName}\\" of type \\"{paramType}\\" in function \\"{functionName}\\"","argMissingForParam":"Argument missing for parameter {name}","argMissingForParams":"Arguments missing for parameters {names}","argMorePositionalExpectedCount":"Expected {expected} more positional arguments","argMorePositionalExpectedOne":"Expected 1 more positional argument","argPositional":"Expected positional argument","argPositionalExpectedCount":"Expected {expected} positional arguments","argPositionalExpectedOne":"Expected 1 positional argument","argTypePartiallyUnknown":"Argument type is partially unknown","argTypeUnknown":"Argument type is unknown","assertAlwaysTrue":"Assert expression always evaluates to true","assignmentExprContext":"Assignment expression must be within module, function or lambda","assignmentExprComprehension":"Assignment expression target \\"{name}\\" cannot use same name as comprehension for target","assignmentInProtocol":"Instance or class variables within a Protocol class must be explicitly declared within the class body","assignmentExprInSubscript":"Assignment expressions within a subscript are supported only in Python 3.10 and newer","assignmentTargetExpr":"Expression cannot be assignment target","asyncNotInAsyncFunction":"Use of \\"async\\" not allowed outside of async function","awaitIllegal":"Use of \\"await\\" requires Python 3.5 or newer","awaitNotInAsync":"\\"await\\" allowed only within async function","backticksIllegal":"Expressions surrounded by backticks are not supported in Python 3.x; use repr instead","baseClassCircular":"Class cannot derive from itself","baseClassFinal":"Base class \\"{type}\\" is marked final and cannot be subclassed","baseClassInvalid":"Argument to class must be a base class","baseClassMethodTypeIncompatible":"Base classes for class \\"{classType}\\" define method \\"{name}\\" in incompatible way","baseClassUnknown":"Base class type is unknown, obscuring type of derived class","bindTypeMismatch":"Could not bind method \\"{methodName}\\" because \\"{type}\\" is not assignable to parameter \\"{paramName}\\"","booleanIsLowerCase":"\\"{name}\\" is not defined, did you mean \\"{booleanName}\\"?","breakOutsideLoop":"\\"break\\" can be used only within a loop","callableExtraArgs":"Expected only two type arguments to \\"Callable\\"","callableFirstArg":"Expected parameter type list or \\"...\\"","callableSecondArg":"Expected return type as second type argument for \\"Callable\\"","casePatternIsIrrefutable":"Irrefutable pattern is allowed only for the last case statement","classAlreadySpecialized":"Type \\"{type}\\" is already specialized","classDecoratorTypeUnknown":"Untyped class decorator obscures type of class; ignoring decorator","classDefinitionCycle":"Class definition for \\"{name}\\" depends on itself","classGetItemClsParam":"__class_getitem__ override should take a \\"cls\\" parameter","classMethodClsParam":"Class methods should take a \\"cls\\" parameter","classNotRuntimeSubscriptable":"Subscript for class \\"{name}\\" will generate runtime exception; enclose type annotation in quotes","classPatternBuiltInArgCount":"Class pattern accepts at most 1 positional sub-pattern","classPatternBuiltInArgPositional":"Class pattern accepts only positional sub-pattern","classPatternTypeAlias":"\\"{type}\\" cannot be used in a class pattern because it is a specialized type alias","classVarNotAllowed":"\\"ClassVar\\" is not allowed in this context","classVarFirstArgMissing":"Expected a type argument after \\"ClassVar\\"","classVarOverridesInstanceVar":"Class variable \\"{name}\\" overrides instance variable of same name in class \\"{className}\\"","classVarTooManyArgs":"Expected only one type argument after \\"ClassVar\\"","classVarWithTypeVar":"\\"ClassVar\\" type cannot include type variables","clsSelfParamTypeMismatch":"Type of parameter \\"{name}\\" must be a supertype of its class \\"{classType}\\"","comparisonAlwaysFalse":"Condition will always evaluate to False since the types \\"{leftType}\\" and \\"{rightType}\\" have no overlap","comparisonAlwaysTrue":"Condition will always evaluate to True since the types \\"{leftType}\\" and \\"{rightType}\\" have no overlap","comprehensionInDict":"Comprehension cannot be used with other dictionary entries","comprehensionInSet":"Comprehension cannot be used with other set entries","concatenateParamSpecMissing":"Last type argument for \\"Concatenate\\" must be a ParamSpec","concatenateTypeArgsMissing":"\\"Concatenate\\" requires at least two type arguments","constantRedefinition":"\\"{name}\\" is constant (because it is uppercase) and cannot be redefined","constructorParametersMismatch":"Mismatch between signature of __new__ and __init__ in class \\"{classType}\\"","continueInFinally":"\\"continue\\" cannot be used within a finally clause","continueOutsideLoop":"\\"continue\\" can be used only within a loop","constructorNoArgs":"Expected no arguments to \\"{type}\\" constructor","dataClassBaseClassNotFrozen":"A frozen class cannot inherit from a class that is not frozen","dataClassFieldWithDefault":"Fields without default values cannot appear after fields with default values","dataClassPostInitParamCount":"Dataclass __post_init__ incorrect parameter count; number of InitVar fields is {expected}","dataClassPostInitType":"Dataclass __post_init__ method parameter type mismatch for field \\"{fieldName}\\"","dataClassSlotsOverwrite":"__slots__ is already defined in class","dataClassTransformExpectedBoolLiteral":"Expected expression that statically evaluates to True or False","dataClassTransformFieldDescriptor":"Expected tuple of classes or functions but received type \\"{type}\\"","dataClassTransformPositionalParam":"All arguments to \\"dataclass_transform\\" must be keyword arguments","dataClassTransformUnknownArgument":"Argument \\"{name}\\" is not supported by dataclass_transform","declaredReturnTypePartiallyUnknown":"Declared return type, \\"{returnType}\\", is partially unknown","declaredReturnTypeUnknown":"Declared return type is unknown","defaultValueContainsCall":"Function calls and mutable objects not allowed within parameter default value expression","defaultValueNotAllowed":"Parameter with \\"*\\" or \\"**\\" cannot have default value","defaultValueNotEllipsis":"Default values in stub files should be specified as \\"...\\"","deprecatedType":"This type is deprecated as of Python {version}; use \\"{replacement}\\" instead","delTargetExpr":"Expression cannot be deleted","dictExpandIllegalInComprehension":"Dictionary expansion not allowed in comprehension","dictInAnnotation":"Dictionary expression not allowed in type annotation","dictKeyValuePairs":"Dictionary entries must contain key/value pairs","dictUnpackIsNotMapping":"Expected mapping for dictionary unpack operator","dunderAllSymbolNotPresent":"\\"{name}\\" is specified in __all__ but is not present in module","duplicateArgsParam":"Only one \\"*\\" parameter allowed","duplicateBaseClass":"Duplicate base class not allowed","duplicateCatchAll":"Only one catch-all except clause allowed","duplicateEnumMember":"Enum member \\"{name}\\" is already declared","duplicateImport":"\\"{importName}\\" is imported more than once","duplicateKwargsParam":"Only one \\"**\\" parameter allowed","duplicateKeywordOnly":"Only one \\"*\\" separator allowed","duplicateParam":"Duplicate parameter \\"{name}\\"","duplicateCapturePatternTarget":"Capture target \\"{name}\\" cannot appear more than once within the same pattern","duplicateStarPattern":"Only one \\"*\\" pattern allowed in a pattern sequence","duplicateStarStarPattern":"Only one \\"**\\" entry allowed","duplicatePositionOnly":"Only one \\"/\\" parameter allowed","duplicateUnpack":"Only one unpack operation allowed in list","ellipsisContext":"\\"...\\" not allowed in this context","ellipsisSecondArg":"\\"...\\" allowed only as the second of two arguments","enumClassOverride":"Enum class \\"{name}\\" is final and cannot be subclassed","exceptionGroupIncompatible":"Exception group syntax (\\"except*\\") requires Python 3.11 or newer","exceptionTypeIncorrect":"\\"{type}\\" does not derive from BaseException","exceptionTypeNotClass":"\\"{type}\\" is not valid exception class","exceptionTypeNotInstantiable":"Constructor for exception type \\"{type}\\" requires one or more arguments","expectedAfterDecorator":"Expected function or class declaration after decorator","expectedArrow":"Expected \\"->\\" followed by return type annotation","expectedAsAfterException":"Expected \\"as\\" after exception type","expectedAssignRightHandExpr":"Expected expression to the right of \\"=\\"","expectedBinaryRightHandExpr":"Expected expression to the right of operator","expectedBoolLiteral":"Expected True or False","expectedCase":"Expected \\"case\\" statement","expectedClassName":"Expected class name","expectedCloseBrace":"\\"{\\" was not closed","expectedCloseBracket":"\\"[\\" was not closed","expectedCloseParen":"\\"(\\" was not closed","expectedColon":"Expected \\":\\"","expectedComplexNumberLiteral":"Expected complex number literal for pattern matching","expectedDecoratorExpr":"Expression form not supported for decorator prior to Python 3.9","expectedDecoratorName":"Expected decorator name","expectedDecoratorNewline":"Expected new line at end of decorator","expectedDelExpr":"Expected expression after \\"del\\"","expectedElse":"Expected \\"else\\"","expectedEqualityOperator":"Expected equality operator, did you mean \\"==\\"?","expectedExceptionClass":"Invalid exception class or object","expectedExceptionObj":"Expected exception object, exception class or None","expectedExpr":"Expected expression","expectedIdentifier":"Expected identifier","expectedImport":"Expected \\"import\\"","expectedImportAlias":"Expected symbol after \\"as\\"","expectedImportSymbols":"Expected one or more symbol names after import","expectedIndentedBlock":"Expected indented block","expectedInExpr":"Expected expression after \\"in\\"","expectedIn":"Expected \\"in\\"","expectedFunctionAfterAsync":"Expected function definition after \\"async\\"","expectedFunctionName":"Expected function name after \\"def\\"","expectedMemberName":"Expected member name after \\".\\"","expectedModuleName":"Expected module name","expectedNameAfterAs":"Expected symbol name after \\"as\\"","expectedNamedParameter":"Keyword parameter must follow \\"*\\"","expectedNewline":"Expected newline","expectedNewlineOrSemicolon":"Statements must be separated by newlines or semicolons","expectedOpenParen":"Expected \\"(\\"","expectedParamName":"Expected parameter name","expectedPatternExpr":"Expected pattern expression","expectedPatternSubjectExpr":"Expected pattern subject expression","expectedPatternValue":"Expected pattern value expression of the form \\"a.b\\"","expectedReturnExpr":"Expected expression after \\"return\\"","expectedSliceIndex":"Expected index or slice expression","expectedTypeNotString":"Expected type but received a string literal","expectedYieldExpr":"Expected expression in yield statement","finalClassIsAbstract":"Class \\"{type}\\" is marked final and must implement all abstract methods","finalContext":"\\"Final\\" not allowed in this context","finalMethodOverride":"Method \\"{name}\\" cannot override final method defined in class \\"{className}\\"","finalReassigned":"\\"{name}\\" is declared as Final and cannot be reassigned","finalRedeclaration":"\\"{name}\\" was previously declared as Final","finalRedeclarationBySubclass":"\\"{name}\\" cannot be redeclared because parent class \\"{className}\\" declares it as Final","finalTooManyArgs":"Expected a single type argument after \\"Final\\"","finalUnassigned":"\\"{name}\\" is declared Final, but value is not assigned","formatStringBrace":"Single close brace not allowed within f-string literal; use double close brace","formatStringBytes":"Format string literals (f-strings) cannot be binary","formatStringEscape":"Escape sequence (backslash) not allowed in expression portion of f-string","formatStringInPattern":"Format string not allowed in pattern","formatStringUnicode":"Format string literals (f-strings) cannot be unicode","formatStringIllegal":"Format string literals (f-strings) require Python 3.6 or newer","formatStringUnterminated":"Unterminated expression in f-string; missing close brace","functionDecoratorTypeUnknown":"Untyped function decorator obscures type of function; ignoring decorator","generatorAsyncReturnType":"Return type of async generator function must be \\"AsyncGenerator\\" or \\"AsyncIterable\\"","generatorNotParenthesized":"Generator expressions must be parenthesized if not sole argument","generatorSyncReturnType":"Return type of generator function must be \\"Generator\\" or \\"Iterable\\"","genericClassAssigned":"Generic class type cannot be assigned","genericClassDeleted":"Generic class type cannot be deleted","genericNotAllowed":"\\"Generic\\" is not valid in this context","genericTypeAliasBoundTypeVar":"Generic type alias within class cannot use bound type variables {names}","genericTypeArgMissing":"\\"Generic\\" requires at least one type argument","genericTypeArgTypeVar":"Type argument for \\"Generic\\" must be a type variable","genericTypeArgUnique":"Type arguments for \\"Generic\\" must be unique","globalReassignment":"\\"{name}\\" is assigned before global declaration","globalRedefinition":"\\"{name}\\" was already declared global","implicitStringConcat":"Implicit string concatenation not allowed","importCycleDetected":"Cycle detected in import chain","importDepthExceeded":"Import chain depth exceeded {depth}","importResolveFailure":"Import \\"{importName}\\" could not be resolved","importSourceResolveFailure":"Import \\"{importName}\\" could not be resolved from source","importSymbolUnknown":"\\"{name}\\" is unknown import symbol in module \\"{moduleName}\\"","incompatibleMethodOverride":"Method \\"{name}\\" overrides class \\"{className}\\" in an incompatible manner","inconsistentIndent":"Unindent amount does not match previous indent","initMustReturnNone":"Return type of \\"__init__\\" must be None","inconsistentTabs":"Inconsistent use of tabs and spaces in indentation","initSubclassClsParam":"__init_subclass__ override should take a \\"cls\\" parameter","instanceMethodSelfParam":"Instance methods should take a \\"self\\" parameter","instanceVarOverridesClassVar":"Instance variable \\"{name}\\" overrides class variable of same name in class \\"{className}\\"","instantiateAbstract":"Cannot instantiate abstract class \\"{type}\\"","instantiateProtocol":"Cannot instantiate protocol class \\"{type}\\"","internalBindError":"An internal error occurred while binding file \\"{file}\\": {message}","internalParseError":"An internal error occurred while parsing file \\"{file}\\": {message}","internalTypeCheckingError":"An internal error occurred while type checking file \\"{file}\\": {message}","invalidIdentifierChar":"Invalid character in identifier","invalidStubStatement":"Statement is meaningless within a type stub file","invalidTokenChars":"Invalid character \\"{text}\\" in token","isInstanceInvalidType":"Second argument to \\"isinstance\\" must be a class or tuple of classes","isSubclassInvalidType":"Second argument to \\"issubclass\\" must be a class or tuple of classes","keyValueInSet":"Key/value pairs are not allowed within a set","keywordArgInTypeArgument":"Keyword arguments cannot be used in type argument lists","keywordOnlyAfterArgs":"Keyword-only argument separator not allowed after \\"*\\" parameter","keywordSubscriptIllegal":"Keyword arguments within subscripts are not supported","lambdaReturnTypeUnknown":"Return type of lambda is unknown","lambdaReturnTypePartiallyUnknown":"Return type of lambda, \\"{returnType}\\", is partially unknown","listAssignmentMismatch":"Expression with type \\"{type}\\" cannot be assigned to target list","listInAnnotation":"List expression not allowed in type annotation","literalUnsupportedType":"Type arguments for \\"Literal\\" must be None, a literal value (int, bool, str, or bytes), or an enum value","literalEmptyArgs":"Expected one or more type arguments after \\"Literal\\"","literalNotCallable":"Literal type cannot be instantiated","matchIncompatible":"Match statements require Python 3.10 or newer","matchIsNotExhaustive":"Cases within match statement do not exhaustively handle all values","maxParseDepthExceeded":"Maximum parse depth exceeded; break expression into smaller sub-expressions","memberAccess":"Cannot access member \\"{name}\\" for type \\"{type}\\"","memberDelete":"Cannot delete member \\"{name}\\" for type \\"{type}\\"","memberSet":"Cannot assign member \\"{name}\\" for type \\"{type}\\"","metaclassConflict":"The metaclass of a derived class must be a subclass of the metaclasses of all its base classes","metaclassDuplicate":"Only one metaclass can be provided","metaclassIsGeneric":"Metaclass cannot be generic","methodNotDefined":"\\"{name}\\" method not defined","methodNotDefinedOnType":"\\"{name}\\" method not defined on type \\"{type}\\"","methodOrdering":"Cannot create consistent method ordering","methodOverridden":"\\"{name}\\" overrides method of same name in class \\"{className}\\" with incompatible type \\"{type}\\"","methodReturnsNonObject":"\\"{name}\\" method does not return an object","missingProtocolMembers":"Class derives from one or more protocol classes but does not implement all required members","missingSuperCall":"Method \\"{methodName}\\" does not call the method of the same name in parent class","moduleAsType":"Module cannot be used as a type","moduleNotCallable":"Module is not callable","moduleUnknownMember":"\\"{name}\\" is not a known member of module \\"{module}\\"","namedExceptAfterCatchAll":"A named except clause cannot appear after catch-all except clause","namedParamAfterParamSpecArgs":"Keyword parameter \\"{name}\\" cannot appear in signature after ParamSpec args parameter","namedTupleEmptyName":"Names within a named tuple cannot be empty","namedTupleMultipleInheritance":"Multiple inheritance with NamedTuple is not supported","namedTupleFirstArg":"Expected named tuple class name as first argument","namedTupleNameType":"Expected two-entry tuple specifying entry name and type","namedTupleNameUnique":"Names within a named tuple must be unique","namedTupleNoTypes":"\\"namedtuple\\" provides no types for tuple entries; use \\"NamedTuple\\" instead","namedTupleSecondArg":"Expected named tuple entry list as second argument","newClsParam":"__new__ override should take a \\"cls\\" parameter","newTypeLiteral":"NewType cannot be used with Literal type","newTypeNotAClass":"Expected class as second argument to NewType","newTypeProtocolClass":"NewType cannot be used with protocol class","nonDefaultAfterDefault":"Non-default argument follows default argument","noneNotCallable":"Object of type \\"None\\" cannot be called","noneNotIterable":"Object of type \\"None\\" cannot be used as iterable value","noneOperator":"Operator \\"{operator}\\" not supported for \\"None\\"","noneNotSubscriptable":"Object of type \\"None\\" is not subscriptable","noneNotUsableWith":"Object of type \\"None\\" cannot be used with \\"with\\"","noneUnknownMember":"\\"{name}\\" is not a known member of \\"None\\"","nonLocalNoBinding":"No binding for nonlocal \\"{name}\\" found","nonLocalReassignment":"\\"{name}\\" is assigned before nonlocal declaration","nonLocalRedefinition":"\\"{name}\\" was already declared nonlocal","nonLocalInModule":"Nonlocal declaration not allowed at module level","noOverload":"No overloads for \\"{name}\\" match the provided arguments","noReturnContainsReturn":"Function with declared return type \\"NoReturn\\" cannot include a return statement","noReturnContainsYield":"Function with declared return type \\"NoReturn\\" cannot include a yield statement","noReturnReturnsNone":"Function with declared type of \\"NoReturn\\" cannot return \\"None\\"","notRequiredArgCount":"Expected a single type argument after \\"NotRequired\\"","notRequiredNotInTypedDict":"\\"NotRequired\\" is not allowed in this context","objectNotCallable":"Object of type \\"{type}\\" is not callable","obscuredClassDeclaration":"Class declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredFunctionDeclaration":"Function declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredMethodDeclaration":"Method declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredParameterDeclaration":"Parameter declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredVariableDeclaration":"Declaration \\"{name}\\" is obscured by a declaration of the same name","operatorLessOrGreaterDeprecated":"Operator \\"<>\\" is not supported in Python 3; use \\"!=\\" instead","optionalExtraArgs":"Expected one type argument after \\"Optional\\"","orPatternIrrefutable":"Irrefutable pattern allowed only as the last subpattern in an \\"or\\" pattern","orPatternMissingName":"All subpatterns within an \\"or\\" pattern must target the same names","overlappingOverload":"Overload {obscured} for \\"{name}\\" will never be used because its parameters overlap overload {obscuredBy}","overloadAbstractMismatch":"Overloaded methods must all be abstract or not","overloadImplementationMismatch":"Overloaded function implementation is not consistent with signature of overload {index}","overloadReturnTypeMismatch":"Overload {prevIndex} for \\"{name}\\" overlaps overload {newIndex} and returns an incompatible type","overloadWithImplementation":"\\"{name}\\" is marked as overload, but it includes an implementation","overloadWithoutImplementation":"\\"{name}\\" is marked as overload, but no implementation is provided","paramAfterKwargsParam":"Parameter cannot follow \\"**\\" parameter","paramAlreadyAssigned":"Parameter \\"{name}\\" is already assigned","paramAnnotationMissing":"Type annotation is missing for parameter \\"{name}\\"","paramNameMissing":"No parameter named \\"{name}\\"","paramSpecArgsKwargsUsage":"\\"args\\" and \\"kwargs\\" members of ParamSpec must both appear within a function signature","paramSpecArgsUsage":"\\"args\\" member of ParamSpec is valid only when used with *args parameter","paramSpecAssignedName":"ParamSpec must be assigned to a variable named \\"{name}\\"","paramSpecContext":"ParamSpec not allowed in this context","paramSpecFirstArg":"Expected name of ParamSpec as first argument","paramSpecKwargsUsage":"\\"kwargs\\" member of ParamSpec is valid only when used with **kwargs parameter","paramSpecNotBound":"Param spec \\"{type}\\" has no bound value","paramSpecNotUsedByOuterScope":"ParamSpec \\"{name}\\" has no meaning in this context","paramSpecUnknownArg":"ParamSpec does not support more than one argument","paramSpecUnknownMember":"\\"{name}\\" is not a known member of ParamSpec","paramSpecUnknownParam":"\\"{name}\\" is unknown parameter to ParamSpec","paramAssignmentMismatch":"Expression of type \\"{sourceType}\\" cannot be assigned to parameter of type \\"{paramType}\\"","paramTypeCovariant":"Covariant type variable cannot be used in parameter type","paramTypeUnknown":"Type of parameter \\"{paramName}\\" is unknown","paramTypePartiallyUnknown":"Type of parameter \\"{paramName}\\" is partially unknown","parenthesizedContextManagerIllegal":"Parentheses within \\"with\\" statement requires Python 3.9 or newer","positionArgAfterNamedArg":"Positional argument cannot appear after keyword arguments","privateImportFromPyTypedModule":"\\"{name}\\" is not exported from module \\"{module}\\"","positionOnlyAfterArgs":"Position-only argument separator not allowed after \\"*\\" parameter","positionOnlyAfterKeywordOnly":"\\"/\\" parameter must appear before \\"*\\" parameter","positionOnlyIncompatible":"Position-only argument separator requires Python 3.8 or newer","positionOnlyFirstParam":"Position-only argument separator not allowed as first parameter","privateUsedOutsideOfClass":"\\"{name}\\" is private and used outside of the class in which it is declared","privateUsedOutsideOfModule":"\\"{name}\\" is private and used outside of the module in which it is declared","propertyOverridden":"\\"{name}\\" incorrectly overrides property of same name in class \\"{className}\\"","propertyStaticMethod":"Static methods not allowed for property getter, setter or deleter","protectedUsedOutsideOfClass":"\\"{name}\\" is protected and used outside of the class in which it is declared","protocolBaseClass":"Protocol class \\"{classType}\\" cannot derive from non-protocol class \\"{baseType}\\"","protocolIllegal":"Use of \\"Protocol\\" requires Python 3.7 or newer","protocolMemberNotClassVar":"Protocol class \\"{className}\\" does not define \\"{memberName}\\" as a ClassVar","protocolNotAllowedInTypeArgument":"\\"Protocol\\" cannot be used as a type argument","protocolVarianceContravariant":"Type variable \\"{variable}\\" used in generic protocol \\"{class}\\" should be contravariant","protocolVarianceCovariant":"Type variable \\"{variable}\\" used in generic protocol \\"{class}\\" should be covariant","protocolVarianceInvariant":"Type variable \\"{variable}\\" used in generic protocol \\"{class}\\" should be invariant","protocolUsedInCall":"Protocol class cannot be used in \\"{name}\\" call","relativeImportNotAllowed":"Relative imports cannot be used with \\"import .a\\" form; use \\"from . import a\\" instead","recursiveDefinition":"Type of \\"{name}\\" could not be determined because it refers to itself","requiredArgCount":"Expected a single type argument after \\"Required\\"","requiredNotInTypedDict":"\\"Required\\" is not allowed in this context","returnOutsideFunction":"\\"return\\" can be used only within a function","returnMissing":"Function with declared type of \\"{returnType}\\" must return value","returnTypeContravariant":"Contravariant type variable cannot be used in return type","returnTypeMismatch":"Expression of type \\"{exprType}\\" cannot be assigned to return type \\"{returnType}\\"","returnTypeUnknown":"Return type is unknown","returnTypePartiallyUnknown":"Return type, \\"{returnType}\\", is partially unknown","revealLocalsArgs":"Expected no arguments for \\"reveal_locals\\" call","revealLocalsNone":"No locals in this scope","revealTypeArgs":"Expected a single positional argument for \\"reveal_type\\" call","revealTypeExpectedTextArg":"The \\"expected_text\\" argument for function \\"reveal_type\\" must be a str literal value","revealTypeExpectedTextMismatch":"Type text mismatch; expected \\"{expected}\\" but received \\"{received}\\"","revealTypeExpectedTypeMismatch":"Type mismatch; expected \\"{expected}\\" but received \\"{received}\\"","selfTypeContext":"\\"Self\\" is not valid in this context","selfTypeWithTypedSelfOrCls":"\\"Self\\" cannot be used in a function with a `self` or `cls` parameter that has a type annotation other than \\"Self\\"","setterGetterTypeMismatch":"Property setter value type is not assignable to the getter return type","singleOverload":"\\"{name}\\" is marked as overload, but additional overloads are missing","slotsAttributeError":"\\"{name}\\" is not specified in __slots__","slotsClassVarConflict":"\\"{name}\\" conflicts with instance variable declared in __slots__","starPatternInAsPattern":"Star pattern cannot be used with \\"as\\" target","starPatternInOrPattern":"Star pattern cannot be ORed within other patterns","starStarWildcardNotAllowed":"** cannot be used with wildcard \\"_\\"","staticClsSelfParam":"Static methods should not take a \\"self\\" or \\"cls\\" parameter","strictTypeGuardReturnType":"Return type of StrictTypeGuard (\\"{returnType}\\") is not assignable to value parameter type (\\"{type}\\")","stringNonAsciiBytes":"Non-ASCII character not allowed in bytes string literal","stringNotSubscriptable":"String expression cannot be subscripted in type annotation; enclose entire annotation in quotes","stringUnsupportedEscape":"Unsupported escape sequence in string literal","stringUnterminated":"String literal is unterminated","stubFileMissing":"Stub file not found for \\"{importName}\\"","stubUsesGetAttr":"Type stub file is incomplete; \\"__getattr__\\" obscures type errors for module","sublistParamsIncompatible":"Sublist parameters are not supported in Python 3.x","superCallArgCount":"Expected no more than two arguments to \\"super\\" call","superCallFirstArg":"Expected class type as first argument to \\"super\\" call but received \\"{type}\\"","superCallSecondArg":"Second argument to \\"super\\" call must be object or class that derives from \\"{type}\\"","superCallZeroArgForm":"Zero-argument form of \\"super\\" call is valid only within a class","symbolIsUnbound":"\\"{name}\\" is unbound","symbolIsUndefined":"\\"{name}\\" is not defined","symbolIsPossiblyUnbound":"\\"{name}\\" is possibly unbound","symbolOverridden":"\\"{name}\\" overrides symbol of same name in class \\"{className}\\"","totalOrderingMissingMethod":"Class must define one of \\"__lt__\\", \\"__le__\\", \\"__gt__\\", or \\"__ge__\\" to use total_ordering","trailingCommaInFromImport":"Trailing comma not allowed without surrounding parentheses","tryWithoutExcept":"Try statement must have at least one except or finally clause","tupleAssignmentMismatch":"Expression with type \\"{type}\\" cannot be assigned to target tuple","tupleInAnnotation":"Tuple expression not allowed in type annotation","tupleIndexOutOfRange":"Index {index} is out of range for type {type}","typeAliasIsRecursiveDirect":"Type alias \\"{name}\\" cannot use itself in its definition","typeAliasIsRecursiveIndirect":"Type alias \\"{name}\\" cannot refer to itself indirectly in its definition","typeAliasNotInModuleOrClass":"A TypeAlias can be defined only within a module or class scope","typeAliasRedeclared":"\\"{name}\\" is declared as a TypeAlias and can be assigned only once","typeArgListExpected":"Expected ParamSpec, ellipsis, or list of types","typeArgListNotAllowed":"List expression not allowed for this type argument","typeAnnotationCall":"Illegal type annotation: call expression not allowed","typeAnnotationVariable":"Illegal type annotation: variable not allowed unless it is a type alias","typeArgsExpectingNone":"Expected no type arguments for class \\"{name}\\"","typeArgsMismatchOne":"Expected one type argument but received {received}","typeArgsMissingForAlias":"Expected type arguments for generic type alias \\"{name}\\"","typeArgsMissingForClass":"Expected type arguments for generic class \\"{name}\\"","typeArgsTooFew":"Too few type arguments provided for \\"{name}\\"; expected {expected} but received {received}","typeArgsTooMany":"Too many type arguments provided for \\"{name}\\"; expected {expected} but received {received}","typeAssignmentMismatch":"Expression of type \\"{sourceType}\\" cannot be assigned to declared type \\"{destType}\\"","typeCallNotAllowed":"type() call should not be used in type annotation","typedDictAccess":"Could not access item in TypedDict","typedDictBadVar":"TypedDict classes can contain only type annotations","typedDictBaseClass":"All base classes for \\"TypedDict\\" classes must also be \\"TypedDict\\" classes","typedDictDelete":"Could not delete item in TypedDict","typedDictEmptyName":"Names within a TypedDict cannot be empty","typedDictEntryName":"Expected string literal for dictionary entry name","typedDictEntryUnique":"Names within a dictionary must be unique","typedDictExtraArgs":"Extra TypedDict arguments not supported","typedDictFieldRedefinition":"Type of TypedDict field \\"{name}\\" cannot be redefined","typedDictFirstArg":"Expected TypedDict class name as first argument","typedDictSecondArgDict":"Expected dict or keyword parameter as second parameter","typedDictSecondArgDictEntry":"Expected simple dictionary entry","typedDictSet":"Could not assign item in TypedDict","typedDictTotalParam":"Expected \\"total\\" parameter to have a value of True or False","typeExpectedClass":"Expected class type but received \\"{type}\\"","typeGuardArgCount":"Expected a single type argument after \\"TypeGuard\\"","typeNotAwaitable":"\\"{type}\\" is not awaitable","typeNotCallable":"\\"{expression}\\" has type \\"{type}\\" and is not callable","typeNotIntantiable":"\\"{type}\\" cannot be instantiated","typeNotIterable":"\\"{type}\\" is not iterable","typeNotSpecializable":"Could not specialize type \\"{type}\\"","typeNotSubscriptable":"Object of type \\"{type}\\" is not subscriptable","typeNotUsableWith":"Object of type \\"{type}\\" cannot be used with \\"with\\" because it does not implement {method}","typeNotSupportBinaryOperator":"Operator \\"{operator}\\" not supported for types \\"{leftType}\\" and \\"{rightType}\\"","typeNotSupportBinaryOperatorBidirectional":"Operator \\"{operator}\\" not supported for types \\"{leftType}\\" and \\"{rightType}\\" when expected type is \\"{expectedType}\\"","typeNotSupportUnaryOperator":"Operator \\"{operator}\\" not supported for type \\"{type}\\"","typeNotSupportUnaryOperatorBidirectional":"Operator \\"{operator}\\" not supported for type \\"{type}\\" when expected type is \\"{expectedType}\\"","typePartiallyUnknown":"Type of \\"{name}\\" is partially unknown","typeUnknown":"Type of \\"{name}\\" is unknown","typeVarAssignedName":"TypeVar must be assigned to a variable named \\"{name}\\"","typeVarAssignmentMismatch":"Type \\"{type}\\" cannot be assigned to type variable \\"{name}\\"","typeVarBoundAndConstrained":"TypeVar cannot be both bound and constrained","typeVarFirstArg":"Expected name of TypeVar as first argument","typeVarGeneric":"TypeVar bound type cannot be generic","typeVarNoMember":"TypeVar \\"{type}\\" has no member \\"{name}\\"","typeVarNotSubscriptable":"TypeVar \\"{type}\\" is not subscriptable","typeVarNotUsedByOuterScope":"Type variable \\"{name}\\" has no meaning in this context","typeVarSingleConstraint":"TypeVar cannot have only a single constraint","typeVarsNotInGeneric":"Generic[] must include all type variables","typeVarTupleContext":"TypeVarTuple not allowed in this context","typeVarTupleMustBeUnpacked":"Unpack operator is required for TypeVarTuple value","typeVarUnknownParam":"\\"{name}\\" is unknown parameter to TypeVar","typeVarUsedByOuterScope":"TypeVar \\"{name}\\" is already in use by an outer scope","typeVarUsedOnlyOnce":"TypeVar \\"{name}\\" appears only once in generic function signature","typeVarVariance":"TypeVar cannot be both covariant and contravariant","unaccessedClass":"Class \\"{name}\\" is not accessed","unaccessedFunction":"Function \\"{name}\\" is not accessed","unaccessedImport":"Import \\"{name}\\" is not accessed","unaccessedSymbol":"\\"{name}\\" is not accessed","unaccessedVariable":"Variable \\"{name}\\" is not accessed","unexpectedAsyncToken":"Expected \\"def\\", \\"with\\" or \\"for\\" to follow \\"async\\"","unexpectedExprToken":"Unexpected token at end of expression","unexpectedIndent":"Unexpected indentation","unexpectedUnindent":"Unindent not expected","unionSyntaxIllegal":"Alternative syntax for unions requires Python 3.10 or newer","unionTypeArgCount":"Union requires two or more type arguments","uninitializedInstanceVariable":"Instance variable \\"{name}\\" is not initialized in the class body or __init__ method","unnecessaryCast":"Unnecessary \\"cast\\" call; type is already \\"{type}\\"","unnecessaryIsInstanceAlways":"Unnecessary isinstance call; \\"{testType}\\" is always an instance of \\"{classType}\\"","unnecessaryIsSubclassAlways":"Unnecessary issubclass call; \\"{testType}\\" is always a subclass of \\"{classType}\\"","unnecessaryTypeIgnore":"Unnecessary \'# type ignore\' comment","unpackArgCount":"Expected a single type argument after \\"Unpack\\"","unpackedArgInTypeArgument":"Unpacked arguments cannot be used in type argument lists","unpackedArgWithVariadicParam":"Unpacked argument cannot be used for TupleTypeVar parameter","unpackedDictArgumentNotMapping":"Argument expression after ** must be a mapping with a \\"str\\" key type","unpackedSubscriptIllegal":"Unpack operator in subscript requires Python 3.11 or newer","unpackedTypedDictArgument":"Unable to match unpacked TypedDict argument to parameters","unpackedTypeVarTupleExpected":"Expected unpacked TypeVarTuple; use Unpack[{name1}] or *{name2}","unpackExpectedTypedDict":"Expected TypedDict type argument for Unpack","unpackExpectedTypeVarTuple":"Expected TypeVarTuple or Tuple as type argument for Unpack","unpackIllegalInComprehension":"Unpack operation not allowed in comprehension","unpackInAnnotation":"Unpack operator not allowed in type annotation","unpackInDict":"Unpack operation not allowed in dictionaries","unpackInSet":"Unpack operator not allowed within a set","unpackNotAllowed":"Unpack not allowed in this context","unpackOperatorNotAllowed":"Unpack operation not allowed in this context","unpackTuplesIllegal":"Unpack operation not allowed in tuples prior to Python 3.8","unreachableCode":"Code is unreachable","unreachableExcept":"Except clause is unreachable because exception is already handled","unsupportedDunderAllOperation":"Operation on \\"__all__\\" is not supported, so exported symbol list may be incorrect","unusedCallResult":"Result of call expression is of type \\"{type}\\" and is not used; assign to variable \\"_\\" if this is intentional","unusedCoroutine":"Result of async function call is not used; use \\"await\\" or assign result to variable","varAnnotationIllegal":"Type annotations for variables requires Python 3.6 or newer; use type comment for compatibility with previous versions","variadicTypeArgsTooMany":"Type argument list can have at most one unpacked TypeVarTuple or Tuple","variadicTypeParamTooManyAlias":"Type alias can have at most one TypeVarTuple type parameter but received multiple ({names})","variadicTypeParamTooManyClass":"Generic class can have at most one TypeVarTuple type parameter but received multiple ({names})","walrusIllegal":"Operator \\":=\\" requires Python 3.8 or newer","walrusNotAllowed":"Operator \\":=\\" not allowed in this context","wildcardInFunction":"Wildcard import not allowed within a class or function","wildcardLibraryImport":"Wildcard import from a library not allowed","yieldFromIllegal":"Use of \\"yield from\\" requires Python 3.3 or newer","yieldFromOutsideAsync":"\\"yield from\\" not allowed in an async function","yieldOutsideFunction":"\\"yield\\" not allowed outside of a function or lambda","yieldTypeMismatch":"Expression of type \\"{exprType}\\" cannot be assigned to yield type \\"{yieldType}\\"","yieldWithinListCompr":"\\"yield\\" not allowed inside a list comprehension","zeroCaseStatementsFound":"Match statement must include at least one case statement","zeroLengthTupleNotAllowed":"Zero-length tuple not allowed in this context"},"DiagnosticAddendum":{"argParam":"Argument corresponds to parameter \\"{paramName}\\"","argParamFunction":"Argument corresponds to parameter \\"{paramName}\\" in function \\"{functionName}\\"","argsParamMissing":"Parameter \\"*{paramName}\\" has no corresponding parameter","argsPositionOnly":"Position-only parameter mismatch; expected {expected} but received {received}","argumentType":"Argument type is \\"{type}\\"","argumentTypes":"Argument types: ({types})","assignToNone":"Type cannot be assigned to type \\"None\\"","asyncHelp":"Did you mean \\"async with\\"?","baseClassProvidesType":"Base class \\"{baseClass}\\" provides type \\"{type}\\"","dataClassFieldLocation":"Field declaration","dataClassFrozen":"\\"{name}\\" is frozen","finalMethod":"Final method","keyNotRequired":"\\"{name}\\" is not a required key in \\"{type}\\", so access may result in runtime exception","keyRequiredDeleted":"\\"{name}\\" is a required key and cannot be deleted","keyUndefined":"\\"{name}\\" is not a defined key in \\"{type}\\"","functionParamDefaultMissing":"Parameter \\"{name}\\" is missing default argument","functionParamName":"Parameter name mismatch: \\"{destName}\\" versus \\"{srcName}\\"","functionReturnTypeMismatch":"Function return type \\"{sourceType}\\" is incompatible with type \\"{destType}\\"","functionTooFewParams":"Function accepts too few positional parameters; expected {expected} but received {received}","functionTooManyParams":"Function accepts too many positional parameters; expected {expected} but received {received}","incompatibleGetter":"Property getter method is incompatible","incompatibleSetter":"Property setter method is incompatible","initMethodLocation":"The __init__ method is defined in class \\"{type}\\"","incompatibleDeleter":"Property deleter method is incompatible","initMethodSignature":"Signature of __init__ is \\"{type}\\"","kwargsParamMissing":"Parameter \\"**{paramName}\\" has no corresponding parameter","listAssignmentMismatch":"Type \\"{type}\\" is incompatible with target list","literalAssignmentMismatch":"\\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","matchIsNotExhaustiveType":"Unhandled type: \\"{type}\\"","matchIsNotExhaustiveHint":"If exhaustive handling is not intended, add \\"case _: pass\\"","memberSetClassVar":"Member \\"{name}\\" cannot be assigned through a class instance because it is a ClassVar","memberAssignment":"Expression of type \\"{type}\\" cannot be assigned to member \\"{name}\\" of class \\"{classType}\\"","memberIsAbstract":"\\"{type}.{name}\\" is abstract","memberIsAbstractMore":"and {count} more...","memberIsFinalInProtocol":"\\"{name}\\" is marked Final in protocol","memberIsInitVar":"Member \\"{name}\\" is an init-only field","memberIsNotFinalInProtocol":"\\"{name}\\" is not marked Final in protocol","memberTypeMismatch":"\\"{name}\\" is an incompatible type","memberUnknown":"Member \\"{name}\\" is unknown","missingProtocolMember":"Member \\"{name}\\" is declared in protocol class \\"{classType}\\"","missingGetter":"Property getter method is missing","missingSetter":"Property setter method is missing","missingDeleter":"Property deleter method is missing","namedParamMissingInDest":"Keyword parameter \\"{name}\\" is missing in destination","namedParamMissingInSource":"Keyword parameter \\"{name}\\" is missing in source","namedParamTypeMismatch":"Keyword parameter \\"{name}\\" of type \\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","newMethodLocation":"The __new__ method is defined in class \\"{type}\\"","newMethodSignature":"Signature of __new__ is \\"{type}\\"","noOverloadAssignable":"No overloaded function matches type \\"{type}\\"","orPatternMissingName":"Missing names: {name}","overloadMethod":"Overload method is defined here","overloadNotAssignable":"One or more overloads of \\"{name}\\" is not assignable","overloadWithImplementation":"The body of a function overload should be \\"...\\"","overriddenMethod":"Overridden method","overriddenSymbol":"Overridden symbol","overrideParamCount":"Parameter count mismatch; base method has {baseCount}, but override has {overrideCount}","overrideParamName":"Parameter {index} name mismatch: base parameter is named \\"{baseName}\\", override parameter is named \\"{overrideName}\\"","overrideParamNamePositionOnly":"Parameter {index} name mismatch: base parameter is named \\"{baseName}\\", override parameter is position-only\\"","overrideParamType":"Parameter {index} type mismatch: base parameter is type \\"{baseType}\\", override parameter is type \\"{overrideType}\\"","overrideReturnType":"Return type mismatch: base method returns type \\"{baseType}\\", override returns type \\"{overrideType}\\"","overrideType":"Base class defines type as \\"{type}\\"","paramAssignment":"Parameter {index}: type \\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","paramSpecOverload":"ParamSpec cannot be used with overloaded function","paramType":"Parameter type is \\"{paramType}\\"","privateImportFromPyTypedSource":"Import from \\"{module}\\" instead","propertyAccessFromProtocolClass":"A property defined within a protocol class cannot be accessed as a class variable","propertyMethodIncompatible":"Property method \\"{name}\\" is incompatible","propertyMethodMissing":"Property method \\"{name}\\" is missing in override","propertyMissingDeleter":"Property \\"{name}\\" has no defined deleter","propertyMissingSetter":"Property \\"{name}\\" has no defined setter","protocolIncompatible":"\\"{sourceType}\\" is incompatible with protocol \\"{destType}\\"","protocolMemberClassVar":"\\"{name}\\" is not a class variable","protocolMemberMissing":"\\"{name}\\" is not present","protocolSourceIsNotConcrete":"\\"{sourceType}\\" is not a concrete class type and cannot be assigned to type \\"{destType}\\"","readOnlyAttribute":"Attribute \\"{name}\\" is read-only","seeDeclaration":"See declaration","seeClassDeclaration":"See class declaration","seeFunctionDeclaration":"See function declaration","seeMethodDeclaration":"See method declaration","seeParameterDeclaration":"See parameter declaration","seeVariableDeclaration":"See variable declaration","tupleEntryTypeMismatch":"Tuple entry {entry} is incorrect type","tupleAssignmentMismatch":"Type \\"{type}\\" is incompatible with target tuple","tupleSizeMismatch":"Element size mismatch; expected {expected} but received {received}","tupleSizeMismatchIndeterminate":"Tuple size mismatch; expected {expected} but received indeterminate number","typeAssignmentMismatch":"Type \\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","typeBound":"Type \\"{sourceType}\\" is incompatible with bound type \\"{destType}\\" for type variable \\"{name}\\"","typeConstrainedTypeVar":"Type \\"{type}\\" is incompatible with constrained type variable \\"{name}\\"","typedDictFieldMissing":"\\"{name}\\" is missing from \\"{type}\\"","typedDictFieldNotRequired":"\\"{name}\\" is not required in \\"{type}\\"","typedDictFieldRequired":"\\"{name}\\" is required in \\"{type}\\"","typedDictFieldTypeMismatch":"Type \\"{type}\\" is not assignable to field \\"{name}\\"","typedDictFieldRedefinition":"Type in parent class is \\"{parentType}\\" and type in child class is \\"{childType}\\"","typedDictFieldUndefined":"\\"{name}\\" is an undefined field in type \\"{type}\\"","typedDictFinalMismatch":"\\"{sourceType}\\" is incompatible with \\"{destType}\\" because of a @final mismatch","typeIncompatible":"\\"{sourceType}\\" is incompatible with \\"{destType}\\"","typeNotCallable":"Type \\"{type}\\" is not callable","typeNotClass":"\\"{type}\\" is not a class","typeParamSpec":"Type \\"{type}\\" is incompatible with ParamSpec \\"{name}\\"","typeNotStringLiteral":"\\"{type}\\" is not a string literal","typeOfSymbol":"Type of \\"{name}\\" is \\"{type}\\"","typeUnsupported":"Type \\"{type}\\" is unsupported","typeVarIsContravariant":"TypeVar \\"{name}\\" is contravariant","typeVarIsCovariant":"TypeVar \\"{name}\\" is covariant","typeVarIsInvariant":"TypeVar \\"{name}\\" is invariant","typeVarNotAllowed":"TypeVar or generic type with type arguments not allowed","typeVarsMissing":"Missing type variables: {names}","typeVarTupleRequiresKnownLength":"TypeVarTuple cannot be bound to a tuple of unknown length","unreachableExcept":"\\"{exceptionType}\\" is a subclass of \\"{parentType}\\"","useDictInstead":"Use Dict[T1, T2] to indicate a dictionary type","useListInstead":"Use List[T] to indicate a list type or Union[T1, T2] to indicate a union type","useTupleInstead":"Use Tuple[T1, ..., Tn] to indicate a tuple type or Union[T1, T2] to indicate a union type","useTypeInstead":"Use Type[T] instead"},"CodeAction":{"addOptionalToAnnotation":"Add \\"Optional\\" to Type Annotation","createTypeStub":"Create Type Stub","createTypeStubFor":"Create Type Stub For \\"{moduleName}\\"","executingCommand":"Executing command","filesToAnalyzeOne":"1 file to analyze","filesToAnalyzeCount":"{count} files to analyze","findingReferences":"Finding references","organizeImports":"Organize Imports"},"Refactoring":{"moveFile":"Do you want to update all import references for \\"{oldModuleName}\\" to \\"{newModuleName}\\"?","moveFileLabel":"Update all import references for \\"{oldModuleName}\\" to \\"{newModuleName}\\"?","moveFileDescription":"Update all import references for \\"{oldModuleName}\\" to \\"{newModuleName}\\"?"}}')},9191:()=>{},2016:()=>{},6341:()=>{},198:()=>{}},__webpack_module_cache__={},leafPrototypes,getProto;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=Object.create(null);__webpack_require__.r(n);var i={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var r=2&t&&e;"object"==typeof r&&!~leafPrototypes.indexOf(r);r=getProto(r))Object.getOwnPropertyNames(r).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,__webpack_require__.d(n,i),n},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,n)=>(__webpack_require__.f[n](e,t),t)),[])),__webpack_require__.u=e=>"pyright-locale-"+e+"-"+{101:"c121083e2a7a54d431db",131:"ab4e388ba76ce41a9bbe",162:"52858c93d4cbe348333a",244:"93121a06520a592814db",372:"2f2f20ca0313ae5dd1d6",416:"213af665ac61b39bb90a",753:"025cc0f8d4b408b3f912",846:"49df54db2b702b64a1c6"}[e]+".worker.js",__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;__webpack_require__.g.importScripts&&(e=__webpack_require__.g.location+"");var t=__webpack_require__.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=e})(),(()=>{var e={885:1};__webpack_require__.f.i=(t,n)=>{e[t]||importScripts(__webpack_require__.p+__webpack_require__.u(t))};var t=self.webpackChunkbrowser_pyright=self.webpackChunkbrowser_pyright||[],n=t.push.bind(t);t.push=t=>{var[i,r,s]=t;for(var o in r)__webpack_require__.o(r,o)&&(__webpack_require__.m[o]=r[o]);for(s&&s(__webpack_require__);i.length;)e[i.pop()]=1;n(t)}})();var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(3984);function t(e){return e}function n(e,t){return e===t}function i(e,t){return e===t?0:void 0===e?-1:void 0===t?1:e<t?-1:1}function r(e){return"string"==typeof e}function s(e){return"number"==typeof e}function o(){const e=[].join();return e.includes("inspect")||e.includes("debug")}function a(e){return void 0!==e}function l(e,t){return t<0?e.length+t:t}function c(e,t,n,i){if(void 0===t||0===t.length)return e;if(void 0===e)return t.slice(n,i);n=void 0===n?0:l(t,n),i=void 0===i?t.length:l(t,i);for(let r=n;r<i&&r<t.length;r++)void 0!==t[r]&&e.push(t[r]);return e}function u(e,t,n){if(0===t)e.unshift(n);else if(t===e.length)e.push(n);else{for(let n=e.length;n>t;n--)e[n]=e[n-1];e[t]=n}return e}function p(e,t){return!!e&&(t?e.some(t):e.length>0)}function d(e,t,n,i,r){return function(e,t,n,i,r){if(!p(e))return-1;let s=r||0,o=e.length-1;for(;s<=o;){const r=s+(o-s>>1);switch(i(n(e[r]),t)){case-1:s=r+1;break;case 0:return r;case 1:o=r-1}}return~s}(e,n(t),n,i,r)}function h(e,t,n){const i=e.get(t);if(void 0!==i)return i;const r=n();return e.set(t,r),r}function m(e,t){for(let n=0;n<e.length;n++)t(e[n])&&(e.splice(n,1),n--);return e}function f(e,t){return e.map((e=>t(e))).reduce(((t,n,i)=>(t.set(n,(t.get(n)||[]).concat(e[i])),t)),new Map)}Object.prototype.hasOwnProperty;const g="typeshed-fallback",y="lib",_="Lib",v="lib64",T="site-packages",b="-stubs";var I,S=__webpack_require__(6470);I=(()=>{var e={470:e=>{function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function n(e,t){for(var n,i="",r=0,s=-1,o=0,a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(47===n)break;n=47}if(47===n){if(s===a-1||1===o);else if(s!==a-1&&2===o){if(i.length<2||2!==r||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){var l=i.lastIndexOf("/");if(l!==i.length-1){-1===l?(i="",r=0):r=(i=i.slice(0,l)).length-1-i.lastIndexOf("/"),s=a,o=0;continue}}else if(2===i.length||1===i.length){i="",r=0,s=a,o=0;continue}t&&(i.length>0?i+="/..":i="..",r=2)}else i.length>0?i+="/"+e.slice(s+1,a):i=e.slice(s+1,a),r=a-s-1;s=a,o=0}else 46===n&&-1!==o?++o:o=-1}return i}var i={resolve:function(){for(var e,i="",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var o;s>=0?o=arguments[s]:(void 0===e&&(e="/"),o=e),t(o),0!==o.length&&(i=o+"/"+i,r=47===o.charCodeAt(0))}return i=n(i,!r),r?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(e){if(t(e),0===e.length)return".";var i=47===e.charCodeAt(0),r=47===e.charCodeAt(e.length-1);return 0!==(e=n(e,!i)).length||i||(e="."),e.length>0&&r&&(e+="/"),i?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,n=0;n<arguments.length;++n){var r=arguments[n];t(r),r.length>0&&(void 0===e?e=r:e+="/"+r)}return void 0===e?".":i.normalize(e)},relative:function(e,n){if(t(e),t(n),e===n)return"";if((e=i.resolve(e))===(n=i.resolve(n)))return"";for(var r=1;r<e.length&&47===e.charCodeAt(r);++r);for(var s=e.length,o=s-r,a=1;a<n.length&&47===n.charCodeAt(a);++a);for(var l=n.length-a,c=o<l?o:l,u=-1,p=0;p<=c;++p){if(p===c){if(l>c){if(47===n.charCodeAt(a+p))return n.slice(a+p+1);if(0===p)return n.slice(a+p)}else o>c&&(47===e.charCodeAt(r+p)?u=p:0===p&&(u=0));break}var d=e.charCodeAt(r+p);if(d!==n.charCodeAt(a+p))break;47===d&&(u=p)}var h="";for(p=r+u+1;p<=s;++p)p!==s&&47!==e.charCodeAt(p)||(0===h.length?h+="..":h+="/..");return h.length>0?h+n.slice(a+u):(a+=u,47===n.charCodeAt(a)&&++a,n.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var n=e.charCodeAt(0),i=47===n,r=-1,s=!0,o=e.length-1;o>=1;--o)if(47===(n=e.charCodeAt(o))){if(!s){r=o;break}}else s=!1;return-1===r?i?"/":".":i&&1===r?"//":e.slice(0,r)},basename:function(e,n){if(void 0!==n&&"string"!=typeof n)throw new TypeError('"ext" argument must be a string');t(e);var i,r=0,s=-1,o=!0;if(void 0!==n&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return"";var a=n.length-1,l=-1;for(i=e.length-1;i>=0;--i){var c=e.charCodeAt(i);if(47===c){if(!o){r=i+1;break}}else-1===l&&(o=!1,l=i+1),a>=0&&(c===n.charCodeAt(a)?-1==--a&&(s=i):(a=-1,s=l))}return r===s?s=l:-1===s&&(s=e.length),e.slice(r,s)}for(i=e.length-1;i>=0;--i)if(47===e.charCodeAt(i)){if(!o){r=i+1;break}}else-1===s&&(o=!1,s=i+1);return-1===s?"":e.slice(r,s)},extname:function(e){t(e);for(var n=-1,i=0,r=-1,s=!0,o=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(47!==l)-1===r&&(s=!1,r=a+1),46===l?-1===n?n=a:1!==o&&(o=1):-1!==n&&(o=-1);else if(!s){i=a+1;break}}return-1===n||-1===r||0===o||1===o&&n===r-1&&n===i+1?"":e.slice(n,r)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+i:n+"/"+i:i}(0,e)},parse:function(e){t(e);var n={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return n;var i,r=e.charCodeAt(0),s=47===r;s?(n.root="/",i=1):i=0;for(var o=-1,a=0,l=-1,c=!0,u=e.length-1,p=0;u>=i;--u)if(47!==(r=e.charCodeAt(u)))-1===l&&(c=!1,l=u+1),46===r?-1===o?o=u:1!==p&&(p=1):-1!==o&&(p=-1);else if(!c){a=u+1;break}return-1===o||-1===l||0===p||1===p&&o===l-1&&o===a+1?-1!==l&&(n.base=n.name=0===a&&s?e.slice(1,l):e.slice(a,l)):(0===a&&s?(n.name=e.slice(1,o),n.base=e.slice(1,l)):(n.name=e.slice(a,o),n.base=e.slice(a,l)),n.ext=e.slice(o,l)),a>0?n.dir=e.slice(0,a-1):s&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};i.posix=i,e.exports=i},447:(e,t,n)=>{var i;if(n.r(t),n.d(t,{URI:()=>f,Utils:()=>w}),"object"==typeof{env:{},execArgv:[],cwd:()=>"/",memoryUsage:()=>({heapUsed:0,rss:1})})i="win32"==={env:{},execArgv:[],cwd:()=>"/",memoryUsage:()=>({heapUsed:0,rss:1})}.platform;else if("object"==typeof navigator){var r=navigator.userAgent;i=r.indexOf("Windows")>=0}var s,o,a=(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=/^\w[\w\d+.-]*$/,c=/^\//,u=/^\/\//;function p(e,t){if(!e.scheme&&t)throw new Error('[UriError]: Scheme is missing: {scheme: "", authority: "'.concat(e.authority,'", path: "').concat(e.path,'", query: "').concat(e.query,'", fragment: "').concat(e.fragment,'"}'));if(e.scheme&&!l.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(e.path)if(e.authority){if(!c.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(u.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}var d="",h="/",m=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,f=function(){function e(e,t,n,i,r,s){void 0===s&&(s=!1),"object"==typeof e?(this.scheme=e.scheme||d,this.authority=e.authority||d,this.path=e.path||d,this.query=e.query||d,this.fragment=e.fragment||d):(this.scheme=function(e,t){return e||t?e:"file"}(e,s),this.authority=t||d,this.path=function(e,t){switch(e){case"https":case"http":case"file":t?t[0]!==h&&(t=h+t):t=h}return t}(this.scheme,n||d),this.query=i||d,this.fragment=r||d,p(this,s))}return e.isUri=function(t){return t instanceof e||!!t&&"string"==typeof t.authority&&"string"==typeof t.fragment&&"string"==typeof t.path&&"string"==typeof t.query&&"string"==typeof t.scheme&&"string"==typeof t.fsPath&&"function"==typeof t.with&&"function"==typeof t.toString},Object.defineProperty(e.prototype,"fsPath",{get:function(){return b(this,!1)},enumerable:!1,configurable:!0}),e.prototype.with=function(e){if(!e)return this;var t=e.scheme,n=e.authority,i=e.path,r=e.query,s=e.fragment;return void 0===t?t=this.scheme:null===t&&(t=d),void 0===n?n=this.authority:null===n&&(n=d),void 0===i?i=this.path:null===i&&(i=d),void 0===r?r=this.query:null===r&&(r=d),void 0===s?s=this.fragment:null===s&&(s=d),t===this.scheme&&n===this.authority&&i===this.path&&r===this.query&&s===this.fragment?this:new y(t,n,i,r,s)},e.parse=function(e,t){void 0===t&&(t=!1);var n=m.exec(e);return n?new y(n[2]||d,C(n[4]||d),C(n[5]||d),C(n[7]||d),C(n[9]||d),t):new y(d,d,d,d,d)},e.file=function(e){var t=d;if(i&&(e=e.replace(/\\/g,h)),e[0]===h&&e[1]===h){var n=e.indexOf(h,2);-1===n?(t=e.substring(2),e=h):(t=e.substring(2,n),e=e.substring(n)||h)}return new y("file",t,e,d,d)},e.from=function(e){var t=new y(e.scheme,e.authority,e.path,e.query,e.fragment);return p(t,!0),t},e.prototype.toString=function(e){return void 0===e&&(e=!1),I(this,e)},e.prototype.toJSON=function(){return this},e.revive=function(t){if(t){if(t instanceof e)return t;var n=new y(t);return n._formatted=t.external,n._fsPath=t._sep===g?t.fsPath:null,n}return t},e}(),g=i?1:void 0,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._formatted=null,t._fsPath=null,t}return a(t,e),Object.defineProperty(t.prototype,"fsPath",{get:function(){return this._fsPath||(this._fsPath=b(this,!1)),this._fsPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(e){return void 0===e&&(e=!1),e?I(this,!0):(this._formatted||(this._formatted=I(this,!1)),this._formatted)},t.prototype.toJSON=function(){var e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=g),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e},t}(f),_=((o={})[58]="%3A",o[47]="%2F",o[63]="%3F",o[35]="%23",o[91]="%5B",o[93]="%5D",o[64]="%40",o[33]="%21",o[36]="%24",o[38]="%26",o[39]="%27",o[40]="%28",o[41]="%29",o[42]="%2A",o[43]="%2B",o[44]="%2C",o[59]="%3B",o[61]="%3D",o[32]="%20",o);function v(e,t){for(var n=void 0,i=-1,r=0;r<e.length;r++){var s=e.charCodeAt(r);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||45===s||46===s||95===s||126===s||t&&47===s)-1!==i&&(n+=encodeURIComponent(e.substring(i,r)),i=-1),void 0!==n&&(n+=e.charAt(r));else{void 0===n&&(n=e.substr(0,r));var o=_[s];void 0!==o?(-1!==i&&(n+=encodeURIComponent(e.substring(i,r)),i=-1),n+=o):-1===i&&(i=r)}}return-1!==i&&(n+=encodeURIComponent(e.substring(i))),void 0!==n?n:e}function T(e){for(var t=void 0,n=0;n<e.length;n++){var i=e.charCodeAt(n);35===i||63===i?(void 0===t&&(t=e.substr(0,n)),t+=_[i]):void 0!==t&&(t+=e[n])}return void 0!==t?t:e}function b(e,t){var n;return n=e.authority&&e.path.length>1&&"file"===e.scheme?"//".concat(e.authority).concat(e.path):47===e.path.charCodeAt(0)&&(e.path.charCodeAt(1)>=65&&e.path.charCodeAt(1)<=90||e.path.charCodeAt(1)>=97&&e.path.charCodeAt(1)<=122)&&58===e.path.charCodeAt(2)?t?e.path.substr(1):e.path[1].toLowerCase()+e.path.substr(2):e.path,i&&(n=n.replace(/\//g,"\\")),n}function I(e,t){var n=t?T:v,i="",r=e.scheme,s=e.authority,o=e.path,a=e.query,l=e.fragment;if(r&&(i+=r,i+=":"),(s||"file"===r)&&(i+=h,i+=h),s){var c=s.indexOf("@");if(-1!==c){var u=s.substr(0,c);s=s.substr(c+1),-1===(c=u.indexOf(":"))?i+=n(u,!1):(i+=n(u.substr(0,c),!1),i+=":",i+=n(u.substr(c+1),!1)),i+="@"}-1===(c=(s=s.toLowerCase()).indexOf(":"))?i+=n(s,!1):(i+=n(s.substr(0,c),!1),i+=s.substr(c))}if(o){if(o.length>=3&&47===o.charCodeAt(0)&&58===o.charCodeAt(2))(p=o.charCodeAt(1))>=65&&p<=90&&(o="/".concat(String.fromCharCode(p+32),":").concat(o.substr(3)));else if(o.length>=2&&58===o.charCodeAt(1)){var p;(p=o.charCodeAt(0))>=65&&p<=90&&(o="".concat(String.fromCharCode(p+32),":").concat(o.substr(2)))}i+=n(o,!0)}return a&&(i+="?",i+=n(a,!1)),l&&(i+="#",i+=t?l:v(l,!1)),i}function S(e){try{return decodeURIComponent(e)}catch(t){return e.length>3?e.substr(0,3)+S(e.substr(3)):e}}var x=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function C(e){return e.match(x)?e.replace(x,(function(e){return S(e)})):e}var w,E=n(470),k=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,s=t.length;r<s;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},D=E.posix||E;!function(e){e.joinPath=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.with({path:D.join.apply(D,k([e.path],t,!1))})},e.resolvePath=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=e.path||"/";return e.with({path:D.resolve.apply(D,k([i],t,!1))})},e.dirname=function(e){var t=D.dirname(e.path);return 1===t.length&&46===t.charCodeAt(0)?e:e.with({path:t})},e.basename=function(e){return D.basename(e.path)},e.extname=function(e){return D.extname(e.path)}}(w||(w={}))}},t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}return n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(447)})();const{URI:x,Utils:C}=I;function w(e,t,n,i){e||(n&&(t+="\r\nVerbose Debug Information: "+("string"==typeof n?n:n())),E(t?"False expression: "+t:"False expression.",i||w))}function E(e,t){const n=new Error(e?`Debug Failure. ${e}`:"Debug Failure.");throw Error.captureStackTrace&&Error.captureStackTrace(n,t||E),n}function k(e,t="Illegal value:",n){E(`${t} ${JSON.stringify(e)}`,n||k)}function D(e){if(e)return JSON.stringify(e).length>2?e:{name:e.name&&r(e.name)?e.name:"noname",message:e.message&&r(e.message)?e.message:"nomessage",stack:e.stack&&r(e.stack)?e.stack:void 0}}let A;try{A=__webpack_require__(2016),(null==A?void 0:A.randomBytes)||(A=void 0)}catch{}function P(e){if(A)return A.randomBytes(e).toString("hex");if(crypto){return t=crypto.getRandomValues(new Uint8Array(e)),[...t].map((e=>e.toString(16).padStart(2,"0"))).join("")}var t;E("crypto library not found")}var R=__webpack_require__(7588),F=__webpack_require__.n(R);function N(e,t){const n=e.toLocaleLowerCase(),i=t.toLocaleLowerCase(),r=n.length,s=i.length;let o=0,a=0;for(;o<r&&a<s;)n[o]===i[a]&&(o+=1),a+=1;return o===r}function M(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return t}function O(e,t){return e===t?0:void 0===e?-1:void 0===t?1:i(e.toUpperCase(),t.toUpperCase())}function L(e,t){return i(e,t)}function U(e){return e?O:L}function q(e,t){return 0===O(e,t)}function V(e,t){return 0===L(e,t)}function B(e,t){let n=0;for(let i=0;i<e.length;i++)e[i]===t&&n++;return n}let W;var j;function z(e,t){for(;;){const n=t(e);if(void 0!==n)return n;const i=$(e);if(i===e)return;e=i}}function $(e){return e.substr(0,Math.max(H(e),e.lastIndexOf(S.sep)))}function H(e){if(e.charAt(0)===S.sep){if(e.charAt(1)!==S.sep)return 1;const t=e.indexOf(S.sep,2);if(t<0)return 2;const n=e.indexOf(S.sep,t+1);return n<0?t+1:n+1}return":"===e.charAt(1)&&e.charAt(2)===S.sep?3:0}function G(e){const t=X(e),n=H(t),i=t.substring(0,n),r=t.substring(n).split(S.sep);return r.length>0&&!r[r.length-1]&&r.pop(),K([i,...r])}function K(e){if(!p(e))return[];const t=[e[0]];for(let n=1;n<e.length;n++){const i=e[n];if(i&&"."!==i){if(".."===i)if(t.length>1){if(".."!==t[t.length-1]){t.pop();continue}}else if(t[0])continue;t.push(i)}}return t}function J(e){return 0===e.length?"":X((e[0]&&le(e[0]))+e.slice(1).join(S.sep))}function Y(e,t){if(!e.startsWith(le(t)))return;const n=G(e);let i=".";for(let e=G(t).length;e<n.length;e++)i+=S.sep+n[e];return i}function Q(e,t,n){if(!t.startsWith(n))return;const i=G(t);let r=n;for(let t=G(n).length;t<i.length;t++)r=te(r,i[t]),e.existsSync(r)||e.mkdirSync(r)}!function(e){e.is=function(e){const t=e;return t&&!!t.wildcardRoot&&!!t.regExp}}(j||(j={}));const Z="/"===S.sep?"\\":"/";function X(e){if(e.includes(Z)){const t=/[\\/]/g;return e.replace(t,S.sep)}return e}function ee(e,...t){return me(p(t)?te(e,...t):X(e))}function te(e,...t){e&&(e=X(e));for(let n of t)n&&(n=X(n),e=e&&0===H(n)?le(e)+n:n);return e}function ne(e,t,n,i){if("string"==typeof n?(e=te(n,e),t=te(n,t)):"boolean"==typeof n&&(i=n),void 0===e||void 0===t)return!1;if(e===t)return!0;const r=G(e),s=G(t);if(s.length<r.length)return!1;const o=i?q:V;for(let e=0;e<r.length;e++)if(!(0===e?q:o)(r[e],s[e]))return!1;return!0}function ie(e,t,n,i){const r=void 0!==n&&void 0!==i?re(e,n,i):re(e);return r?e.slice(0,e.length-r.length)+(t.startsWith(".")?t:"."+t):e}function re(e,t,n){if(t)return function(e,t,n){if("string"==typeof t)return Ce(e,t,n)||"";for(const i of t){const t=Ce(e,i,n);if(t)return t}return""}(ue(e),t,n?q:V);const i=function(e,t,n){if(H(e=X(e))===e.length)return"";const i=(e=ue(e)).slice(Math.max(H(e),e.lastIndexOf(S.sep)+1));return i}(e),r=i.lastIndexOf(".");return r>=0?i.substring(r):""}function se(e,n,i){return w(H(e)>0==H(n)>0,"Paths must either both be absolute or both be relative"),function(e,t,n,i){const r=G(e),s=G(t);let o;for(o=0;o<r.length&&o<s.length&&(0===o?q:n)(i(r[o]),i(s[o]));o++);if(0===o)return s;const a=s.slice(o),l=[];for(;o<r.length;o++)l.push("..");return["",...l,...a]}(e,n,"boolean"==typeof i&&i?q:V,"function"==typeof i?i:t)}function oe(e,t){return xe(e,t,L)}function ae(e,t){return xe(e,t,O)}function le(e){return ce(e)?e:e+S.sep}function ce(e){if(0===e.length)return!1;const t=e.charCodeAt(e.length-1);return 47===t||92===t}function ue(e){return ce(e)?e.substr(0,e.length-1):e}function pe(e,t=!1){if(!t)return S.extname(e);const n=(e=de(e)).indexOf(".");return e.substr(n)}function de(e){return S.basename(e)}function he(e,t=!1){const n=pe(e,t);return e.substr(0,e.length-n.length)}function me(e){return X(S.normalize(e))}function fe(e,t){var n,i;return null!==(i=null===(n=ye(e,t))||void 0===n?void 0:n.isDirectory())&&void 0!==i&&i}function ge(e,t){var n,i;return null!==(i=null===(n=ye(e,t))||void 0===n?void 0:n.isFile())&&void 0!==i&&i}function ye(e,t){try{return e.statSync(t)}catch(e){return}}function _e(e,t){try{return e.realpathSync(t)}catch(e){return}}function ve(e,t){try{return Te(e.readdirEntriesSync(t||"."),e,t)}catch(e){return{files:[],directories:[]}}}function Te(e,t,n){const i=e.sort(((e,t)=>e.name<t.name?-1:e.name>t.name?1:0)),r=[],s=[];for(const e of i)if("."!==e.name&&".."!==e.name)if(e.isFile())r.push(e.name);else if(e.isDirectory())s.push(e.name);else if(e.isSymbolicLink()){const i=ye(t,te(n,e.name));(null==i?void 0:i.isFile())?r.push(e.name):(null==i?void 0:i.isDirectory())&&s.push(e.name)}return{files:r,directories:s}}function be(e,t){let n=function(e,t){let n=me(te(e,t));n.endsWith(".py")||n.endsWith(".pyi")||(n=le(n));const i=G(n),r=Ie(),s=`(${r}[^${r}.][^${r}]*)*?`,o=new RegExp(`[^\\w\\s${r}]`,"g");i.length>0&&(i[0]=ue(i[0]));let a="",l=!0;for(let e of i)"**"===e?a+=s:(l||(e=r+e),a+=e.replace(o,(e=>"*"===e?`[^${r}]*`:"?"===e?`[^${r}]`:"\\"+e)),l=!1);return a}(e,t);n=`^(${n})($|${Ie()})`;const i=new RegExp(n);return{wildcardRoot:function(e,t){let n=me(te(e,t));n.endsWith(".py")||n.endsWith(".pyi")||(n=le(n));const i=G(n);if(i.length>0&&(i[0]=ue(i[0])),1===i.length&&!i[0])return S.sep;let r="",s=!0;for(let e of i){if("**"===e)break;if(e.match(/[*?]/))break;s||(e=S.sep+e),r+=e,s=!1}return r}(e,t),regExp:i}}function Ie(){return"/"===S.sep?"/":"\\\\"}function Se(e){const t=H(e);return t>0&&t===e.length}function xe(e,t,n){if(e===t)return 0;if(void 0===e)return-1;if(void 0===t)return 1;const r=e.substring(0,H(e)),s=t.substring(0,H(t)),o=O(r,s);if(0!==o)return o;const a=Ie(),l=new RegExp(`(^|${a}).{0,2}($|${a})`),c=e.substring(r.length),u=t.substring(s.length);if(!l.test(c)&&!l.test(u))return n(c,u);const p=G(e),d=G(t),h=Math.min(p.length,d.length);for(let e=1;e<h;e++){const t=n(p[e],d[e]);if(0!==t)return t}return function(e,t){return i(e,t)}(p.length,d.length)}function Ce(e,t,n){if(t.startsWith(".")||(t="."+t),e.length>=t.length&&46===e.charCodeAt(e.length-t.length)){const i=e.slice(e.length-t.length);if(n(i,t))return i}}function we(e,t){return e.getMappedFilePath(function(e){let t=me(x.parse(e).path);return t.match(/^\\[a-zA-Z]:\\/)&&(t=t.substr(1)),t}(t))}function Ee(e,t){return e.getUri(e.getOriginalFilePath(t))}function ke(e,t){return function(e){return void 0!==W||(W=function(e){let t;try{let n,i;do{n=`${P(21)}-a`,t=S.join(e.tmpdir(),n),i=S.join(e.tmpdir(),n.toUpperCase())}while(e.existsSync(t)||e.existsSync(i));return e.writeFileSync(t,"","utf8"),!e.existsSync(i)}catch(e){return!1}finally{t&&e.unlinkSync(t)}}(e)),W}(e)?t:t.toLowerCase()}var De;!function(e){e[e.V3_0=768]="V3_0",e[e.V3_1=769]="V3_1",e[e.V3_2=770]="V3_2",e[e.V3_3=771]="V3_3",e[e.V3_4=772]="V3_4",e[e.V3_5=773]="V3_5",e[e.V3_6=774]="V3_6",e[e.V3_7=775]="V3_7",e[e.V3_8=776]="V3_8",e[e.V3_9=777]="V3_9",e[e.V3_10=778]="V3_10",e[e.V3_11=779]="V3_11"}(De||(De={}));const Ae=De.V3_10;function Pe(e){return`${e>>8&255}.${255&e}`}function Re(e){const t=e.split(".");if(!(t.length<2))return function(e,t){if(isNaN(e)||isNaN(t))return;if(e>255||t>255)return;const n=256*e+t;if(void 0!==De[n]&&n>>8==3)return n}(parseInt(t[0],10),parseInt(t[1],10))}var Fe;!function(e){e[e.NotIdentifierChar=0]="NotIdentifierChar",e[e.StartIdentifierChar=1]="StartIdentifierChar",e[e.IdentifierChar=2]="IdentifierChar",e[e.SurrogateChar=3]="SurrogateChar"}(Fe||(Fe={}));const Ne=256,Me=new Array(Ne),Oe={},Le={};let Ue=!1;function qe(e,t){if(e<Ne)return Me[e]===Fe.StartIdentifierChar;let n;return Ue||(Ze(!1),Ue=!0),n=void 0!==t?$e(e,t):Oe[e],n===Fe.StartIdentifierChar}function Ve(e,t){return e<Ne?Me[e]===Fe.StartIdentifierChar||Me[e]===Fe.IdentifierChar:(Ue||(Ze(!1),Ue=!0),void 0!==t?$e(e,t):Oe[e]===Fe.StartIdentifierChar||Oe[e]===Fe.IdentifierChar)}function Be(e){return e>=48&&e<=57||95===e}function We(e){return Be(e)||e>=97&&e<=102||e>=65&&e<=70||95===e}function je(e){return e>=48&&e<=55||95===e}function ze(e){return 48===e||49===e||95===e}function $e(e,t){if(Oe[e]!==Fe.SurrogateChar)return Fe.NotIdentifierChar;const n=Le[e];return n?n[t]:Fe.NotIdentifierChar}const He=[[95,6277,6278,8472,8494,12443,12444],[[65,90],[192,214],[216,222],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,306,308,310,313,315,317,319,321,323,325,327,330,332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,452,455,458,461,463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,497,500,[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,880,882,886,895,902,[904,906],908,[910,911],[913,929],[931,939],975,[978,980],984,986,988,990,992,994,996,998,1e3,1002,1004,1006,1012,1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],[4256,4293],4295,4301,[5024,5109],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],[8120,8123],[8136,8139],[8152,8155],[8168,8172],[8184,8187],8450,8455,[8459,8461],[8464,8466],8469,[8473,8477],8484,8486,8488,[8490,8493],[8496,8499],[8510,8511],8517,8579,[11264,11310],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11390,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,[65313,65338],[66560,66599],[66736,66771],[68736,68786],[71840,71871],[119808,119833],[119860,119885],[119912,119937],119964,[119966,119967],119970,[119973,119974],[119977,119980],[119982,119989],[120016,120041],[120068,120069],[120071,120074],[120077,120084],[120086,120092],[120120,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120172,120197],[120224,120249],[120276,120301],[120328,120353],[120380,120405],[120432,120457],[120488,120512],[120546,120570],[120604,120628],[120662,120686],[120720,120744],120778,[125184,125217]],[[97,122],181,[223,246],[248,255],257,259,261,263,265,267,269,271,273,275,277,279,281,283,285,287,289,291,293,295,297,299,301,303,305,307,309,[311,312],314,316,318,320,322,324,326,[328,329],331,333,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,378,380,[382,384],387,389,392,[396,397],402,405,[409,411],414,417,419,421,424,[426,427],429,432,436,438,[441,442],[445,447],454,457,460,462,464,466,468,470,472,474,[476,477],479,481,483,485,487,489,491,493,[495,496],499,501,505,507,509,511,513,515,517,519,521,523,525,527,529,531,533,535,537,539,541,543,545,547,549,551,553,555,557,559,561,[563,569],572,[575,576],578,583,585,587,589,[591,659],[661,687],881,883,887,[891,893],912,[940,974],[976,977],[981,983],985,987,989,991,993,995,997,999,1001,1003,1005,[1007,1011],1013,1016,[1019,1020],[1072,1119],1121,1123,1125,1127,1129,1131,1133,1135,1137,1139,1141,1143,1145,1147,1149,1151,1153,1163,1165,1167,1169,1171,1173,1175,1177,1179,1181,1183,1185,1187,1189,1191,1193,1195,1197,1199,1201,1203,1205,1207,1209,1211,1213,1215,1218,1220,1222,1224,1226,1228,[1230,1231],1233,1235,1237,1239,1241,1243,1245,1247,1249,1251,1253,1255,1257,1259,1261,1263,1265,1267,1269,1271,1273,1275,1277,1279,1281,1283,1285,1287,1289,1291,1293,1295,1297,1299,1301,1303,1305,1307,1309,1311,1313,1315,1317,1319,1321,1323,1325,1327,[1377,1415],[5112,5117],[7296,7304],[7424,7467],[7531,7543],[7545,7578],7681,7683,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7705,7707,7709,7711,7713,7715,7717,7719,7721,7723,7725,7727,7729,7731,7733,7735,7737,7739,7741,7743,7745,7747,7749,7751,7753,7755,7757,7759,7761,7763,7765,7767,7769,7771,7773,7775,7777,7779,7781,7783,7785,7787,7789,7791,7793,7795,7797,7799,7801,7803,7805,7807,7809,7811,7813,7815,7817,7819,7821,7823,7825,7827,[7829,7837],7839,7841,7843,7845,7847,7849,7851,7853,7855,7857,7859,7861,7863,7865,7867,7869,7871,7873,7875,7877,7879,7881,7883,7885,7887,7889,7891,7893,7895,7897,7899,7901,7903,7905,7907,7909,7911,7913,7915,7917,7919,7921,7923,7925,7927,7929,7931,7933,[7935,7943],[7952,7957],[7968,7975],[7984,7991],[8e3,8005],[8016,8023],[8032,8039],[8048,8061],[8064,8071],[8080,8087],[8096,8103],[8112,8116],[8118,8119],8126,[8130,8132],[8134,8135],[8144,8147],[8150,8151],[8160,8167],[8178,8180],[8182,8183],8458,[8462,8463],8467,8495,8500,8505,[8508,8509],[8518,8521],8526,8580,[11312,11358],11361,[11365,11366],11368,11370,11372,11377,[11379,11380],[11382,11387],11393,11395,11397,11399,11401,11403,11405,11407,11409,11411,11413,11415,11417,11419,11421,11423,11425,11427,11429,11431,11433,11435,11437,11439,11441,11443,11445,11447,11449,11451,11453,11455,11457,11459,11461,11463,11465,11467,11469,11471,11473,11475,11477,11479,11481,11483,11485,11487,11489,[11491,11492],11500,11502,11507,[11520,11557],11559,11565,42561,42563,42565,42567,42569,42571,42573,42575,42577,42579,2581,42583,42585,42587,42589,42591,42593,42595,42597,42599,42601,42603,42605,42625,42627,42629,42631,42633,42635,42637,42639,42641,42643,42645,42647,42649,42651,42787,42789,42791,42793,42795,42797,[42799,42801],42803,42805,42807,42809,42811,42813,42815,42817,42819,42821,42823,42825,42827,42829,42831,42833,42835,42837,42839,42841,42843,42845,42847,42849,42851,42853,42855,42857,42859,42861,42863,[42865,42872],42874,42876,42879,42881,42883,42885,42887,42892,42894,42897,[42899,42901],42903,42905,42907,42909,42911,42913,42915,42917,42919,42921,42933,42935,43002,[43824,43866],[43872,43877],[43888,43967],[64256,64262],[64275,64279],[65345,65370],[66600,66639],[66776,66811],[68800,68850],[71872,71903],[119834,119859],[119886,119892],[119894,119911],[119938,119963],[119990,119993],119995,[119997,120003],[120005,120015],[120042,120067],[120094,120119],[120146,120171],[120198,120223],[120250,120275],[120302,120327],[120354,120379],[120406,120431],[120458,120485],[120514,120538],[120540,120545],[120572,120596],[120598,120603],[120630,120654],[120656,120661],[120688,120712],[120714,120719],[120746,120770],[120772,120777],120779,[125218,125251]],[453,456,459,498,[8072,8079],[8088,8095],[8104,8111],8124,8140,8188],[170,186,443,[448,451],660,[1488,1514],[1520,1522],[1568,1599],[1601,1610],[1646,1647],[1649,1747],1749,[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2048,2069],[2112,2136],[2144,2154],[2208,2228],[2230,2237],[2308,2361],2365,2384,[2392,2401],[2418,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,3294,[3296,3297],[3313,3314],[3333,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3585,3632],[3634,3635],[3648,3653],[3713,3714],3716,[3719,3720],3722,3725,[3732,3735],[3737,3743],[3745,3747],3749,3751,[3754,3755],[3757,3760],[3762,3763],3773,[3776,3780],[3804,3807],3840,[3904,3911],[3913,3948],[3976,3980],[4096,4138],4159,[4176,4181],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4304,4346],[4349,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5873,5880],[5888,5900],[5902,5905],[5920,5937],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6108,[6176,6210],[6212,6263],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6678],[6688,6740],[6917,6963],[6981,6987],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7287],[7401,7404],[7406,7409],[7413,7414],[8501,8504],[11568,11623],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],12294,12348,[12353,12438],12447,[12449,12538],12543,[12549,12590],[12593,12686],[12704,12730],[12784,12799],[13312,19893],[19968,40938],[40960,40980],[40982,42124],[42192,42231],[42240,42507],[42512,42527],[42538,42539],42606,[42656,42725],42895,42999,[43003,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,43261,[43274,43301],[43312,43334],[43360,43388],[43396,43442],[43488,43492],[43495,43503],[43514,43518],[43520,43560],[43584,43586],[43588,43595],[43616,43631],[43633,43638],43642,[43646,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43740],[43744,43754],43762,[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43968,44002],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65382,65391],[65393,65437],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[66176,66204],[66208,66256],[66304,66335],[66349,66368],[66370,66377],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66640,66717],[66816,66855],[66864,66915],[67072,67382],[67392,67413],[67424,67431],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68147],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[69635,69687],[69763,69807],[69840,69864],[69891,69926],[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],[71424,71449],71935,72192,[72203,72242],72250,72272,[72284,72323],[72326,72329],[72384,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73728,74649],[74880,75075],[77824,78894],[82944,83526],[92160,92728],[92736,92766],[92880,92909],[92928,92975],[93027,93047],[93053,93071],[93952,94020],94032,[94208,100332],[100352,101106],[110592,110878],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[124928,125124],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[131072,173782],[173824,177972],[177984,178205],[178208,183969],[183984,191456],[194560,195101]],[[688,705],[710,721],[736,740],748,750,884,890,1369,1600,[1765,1766],[2036,2037],2042,2074,2084,2088,2417,3654,3782,4348,6103,6211,6823,[7288,7293],[7468,7530],7544,[7579,7615],8305,8319,[8336,8348],[11388,11389],11631,11823,12293,[12337,12341],12347,[12445,12446],[12540,12542],40981,[42232,42237],42508,42623,[42652,42653],[42775,42783],42864,42888,[43e3,43001],43471,43494,43632,43741,[43763,43764],[43868,43871],65392,[65438,65439],[92992,92995],[94099,94111],[94176,94177]],[[5870,5872],[8544,8578],[8581,8584],12295,[12321,12329],[12344,12346],[42726,42735],[65856,65908],66369,66378,[66513,66517],[74752,74862]]],Ge=[{55297:[[56320,56359],[56496,56531]],55299:[[56448,56498]],55302:[[56480,56511]],55323:[[56896,56927]],55349:[[56320,56345],[56372,56397],[56424,56449],56476,[56478,56479],56482,[56485,56486],[56489,56492],[56494,56501],[56528,56553],[56580,56581],[56583,56586],[56589,56596],[56598,56604],[56632,56633],[56635,56638],[56640,56644],56646,[56650,56656],[56684,56709],[56736,56761],[56788,56813],[56840,56865],[56892,56917],[56944,56969],[57e3,57024],[57058,57082],[57116,57140],[57174,57198],[57232,57256],[57290,57290]],55354:[[56576,56609]]},{55297:[[56360,56399],[56536,56571]],55299:[[56512,56562]],55302:[[56512,56543]],55323:[[56928,56959]],55349:[[56346,56371],[56398,56404],[56406,56423],[56450,56475],[56502,56505],56507,[56509,56515],[56517,56527],[56554,56579],[56606,56631],[56658,56683],[56710,56735],[56762,56787],[56814,56839],[56866,56891],[56918,56943],[56970,56997],[57026,57050],[57052,57057],[57084,57108],[57110,57115],[57142,57166],[57168,57173],[57200,57224],[57226,57231],[57258,57282],[57284,57289],[57291,57291]],55354:[[56610,56643]]},{55296:[[56320,56331],[56333,56358],[56360,56378],[56380,56381],[56383,56397],[56400,56413],[56448,56570],[56960,56988],[56992,57040],[57088,57119],[57133,57152],[57154,57161],[57168,57205],[57216,57245],[57248,57283],[57288,57295]],55297:[[56400,56477],[56576,56615],[56624,56675],[56832,57142],[57152,57173],[57184,57191]],55298:[[56320,56325],[56328,56328],[56330,56373],[56375,56376],[56380,56380],[56383,56405],[56416,56438],[56448,56478],[56544,56562],[56564,56565],[56576,56597],[56608,56633],[56704,56759],[56766,56767],[56832,56832],[56848,56851],[56853,56855],[56857,56885],[56928,56956],[56960,56988],[57024,57031],[57033,57060],[57088,57141],[57152,57173],[57184,57202],[57216,57233]],55299:[[56320,56392],[56576,56611],[56960,57001],[57008,57009],[57088,57116],57127,[57136,57157],[57264,57284],[57312,57334]],55300:[[56323,56375],[56451,56495],[56528,56552],[56579,56614],56644,56647,[56656,56690],56694,[56707,56754],[56769,56772],56794,56796,[56832,56849],[56851,56875],[56960,56966],56968,[56970,56973],[56975,56989],[56991,57e3],[57008,57054],[57093,57100],[57103,57104],[57107,57128],[57130,57136],[57138,57139],[57141,57145],57149,57168,[57181,57185]],55301:[[56320,56372],[56391,56394],[56415,56417],[56448,56495],[56516,56517],56519,[56704,56750],[56792,56795],[56832,56879],56900,[56960,57002],57016,[57088,57114]],55302:[[56320,56363],[56575,56582],56585,[56588,56595],[56597,56598],[56600,56623],56639,56641,[56736,56743],[56746,56784],56801,56803,56832,[56843,56882],56890,56912,[56924,56969],56989,[57024,57080]],55303:[[56320,56328],[56330,56366],56384,56434,[56576,56582],[56584,56585],[56587,56624],56646,[56672,56677],[56679,56680],[56682,56713],56728,[57056,57074],57264],55304:[[56320,57241]],55305:[[56448,56643]],55308:[[56320,57343]],55309:[[56320,56366]],55313:[[56320,56902]],55322:[[56320,56888],[56896,56926],[57040,57069],[57088,57135],[57187,57207],[57213,57231]],55323:[[57088,57162],57168],55324:[56320],55329:[57335],55330:[[56320,57343]],55331:[[56320,56533],[56576,56576],[56584,56584]],55340:[[56320,56606],[56656,56658],[56676,56679],[56688,57083]],55343:[[56320,56426],[56432,56444],[56448,56456],[56464,56473]],55352:[[56576,56620],56654,[57024,57067]],55354:[[56320,56516]],55355:[[56832,56835],[56837,56863],[56865,56866],56868,56871,[56873,56882],[56884,56887],56889,56891,56898,56903,56905,56907,[56909,56911],[56913,56914],56916,56919,56921,56923,56925,56927,[56929,56930],56932,[56935,56938],[56940,56946],[56948,56951],[56953,56956],56958,[56960,56969],[56971,56987],[56993,56995],[56997,57001],[57003,57019]],55360:[56320],55401:[57053,57088],55405:[57140,57152],55406:[56349,56352],55411:[56993,57008],55418:[57312],55422:[[56320,56861]],55424:[56320],55428:[57162]},{55322:[[57152,57155]],55323:[[57235,57247],[57312,57313],57315],55352:[[56631,56637]],55354:[56651]},{55296:[[56640,56692],57153,57162,[57297,57301]],55305:[[56320,56430]]}],Ke=[[183,903,4969,4970,4971,4972,4973,4974,4975,4976,4977,6618],[[768,879],[1155,1159],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2260,2273],[2275,2306],2362,2364,[2369,2376],2381,[2385,2391],[2402,2403],2433,2492,[2497,2500],2509,[2530,2531],[2561,2562],2620,[2625,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2690],2748,[2753,2757],[2759,2760],2765,[2786,2787],[2810,2815],2817,2876,2879,[2881,2884],2893,2902,[2914,2915],2946,3008,3021,3072,[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],3201,3260,3263,3270,[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],3405,[3426,3427],3530,[3538,3540],3542,3633,[3636,3642],[3655,3662],3761,[3764,3769],[3771,3772],[3784,3789],[3864,3865],3893,3895,3897,[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],4226,[4229,4230],4237,4253,[4957,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],6086,[6089,6099],6109,[6155,6157],[6277,6278],6313,[6432,6434],[6439,6440],6450,[6457,6459],[6679,6680],6683,6742,[6744,6750],6752,6754,[6757,6764],[6771,6780],6783,[6832,6845],[6912,6915],6964,[6966,6970],6972,6978,[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],7142,[7144,7145],7149,[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7616,7673],[7675,7679],[8400,8412],8417,[8421,8432],[11503,11505],11647,[11744,11775],[12330,12333],[12441,12442],42607,[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43045,43046],[43204,43205],[43232,43249],[43302,43309],[43335,43345],[43392,43394],43443,[43446,43449],43452,43493,[43561,43566],[43569,43570],[43573,43574],43587,43596,43644,43696,[43698,43700],[43703,43704],[43710,43711],43713,[43756,43757],43766,44005,44008,44013,64286,[65024,65039],[65056,65071],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],69633,[69688,69702],[69759,69761],[69811,69814],[69817,69818],[69888,69890],[69927,69931],[69933,69940],70003,[70016,70017],[70070,70078],[70090,70092],[70191,70193],70196,[70198,70199],70206,70367,[70371,70378],[70400,70401],70460,70464,[70502,70508],[70512,70516],[70712,70719],[70722,70724],70726,[70835,70840],70842,[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],71229,[71231,71232],71339,71341,[71344,71349],71351,[71453,71455],[71458,71461],[71463,71467],[72193,72198],[72201,72202],[72243,72248],[72251,72254],72263,[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],72767,[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[92912,92916],[92976,92982],[94095,94098],[113821,113822],[119143,119145],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[125136,125142],[125252,125258],[917760,917999]],[2307,2363,[2366,2368],[2377,2380],[2382,2383],[2434,2435],[2494,2496],[2503,2504],[2507,2508],2519,2563,[2622,2624],2691,[2750,2752],2761,[2763,2764],[2818,2819],2878,2880,[2887,2888],[2891,2892],2903,[3006,3007],[3009,3010],[3014,3016],[3018,3020],3031,[3073,3075],[3137,3140],[3202,3203],3262,[3264,3268],[3271,3272],[3274,3275],[3285,3286],[3330,3331],[3390,3392],[3398,3400],[3402,3404],3415,[3458,3459],[3535,3537],[3544,3551],[3570,3571],[3902,3903],3967,[4139,4140],4145,4152,[4155,4156],[4182,4183],[4194,4196],[4199,4205],[4227,4228],[4231,4236],4239,[4250,4252],6070,[6078,6085],[6087,6088],[6435,6438],[6441,6443],[6448,6449],[6451,6456],[6681,6682],6741,6743,6753,[6755,6756],[6765,6770],6916,6965,6971,[6973,6977],[6979,6980],7042,7073,[7078,7079],7082,7143,[7146,7148],7150,[7154,7155],[7204,7211],[7220,7221],7393,[7410,7411],7415,[12334,12335],[43043,43044],43047,[43136,43137],[43188,43203],[43346,43347],43395,[43444,43445],[43450,43451],[43453,43456],[43567,43568],[43571,43572],43597,43643,43645,43755,[43758,43759],43765,[44003,44004],[44006,44007],[44009,44010],44012,69632,69634,69762,[69808,69810],[69815,69816],69932,70018,[70067,70069],[70079,70080],[70188,70190],[70194,70195],70197,[70368,70370],[70402,70403],[70462,70463],[70465,70468],[70471,70472],[70475,70477],70487,[70498,70499],[70709,70711],[70720,70721],70725,[70832,70834],70841,[70843,70846],70849,[71087,71089],[71096,71099],71102,[71216,71218],[71227,71228],71230,71340,[71342,71343],71350,[71456,71457],71462,[72199,72200],72249,[72279,72280],72343,72751,72766,72873,72881,72884,[94033,94078],[119141,119142],[119149,119154]],[[48,57],[1632,1641],[1776,1785],[1984,1993],[2406,2415],[2534,2543],[2662,2671],[2790,2799],[2918,2927],[3046,3055],[3174,3183],[3302,3311],[3430,3439],[3558,3567],[3664,3673],[3792,3801],[3872,3881],[4160,4169],[4240,4249],[6112,6121],[6160,6169],[6470,6479],[6608,6617],[6784,6793],[6800,6809],[6992,7001],[7088,7097],[7232,7241],[7248,7257],[42528,42537],[43216,43225],[43264,43273],[43472,43481],[43504,43513],[43600,43609],[44016,44025],[65296,65305],[66720,66729],[69734,69743],[69872,69881],[69942,69951],[70096,70105],[70384,70393],[70736,70745],[70864,70873],[71248,71257],[71360,71369],[71472,71481],[71904,71913],[72784,72793],[73040,73049],[92768,92777],[93008,93017],[120782,120831],[125264,125273]],[95,[8255,8256],8276,[65075,65076],[65101,65103],65343]],Je=[{55296:[56829,57056,[57206,57210]],55298:[[56833,56835],[56837,56838],[56844,56847],[56888,56890],56895,[57061,57062]],55299:[[56612,56615],[57003,57004],[57158,57168]],55300:[56321,[56376,56390],[56447,56449],[56499,56502],[56505,56506],[56576,56578],[56615,56619],[56621,56628],56691,[56704,56705],[56758,56766],[56777,56780],56783,[56879,56881],56884,[56886,56887],56894,57055,[57059,57066],[57088,57089],[57147,57148],57152,[57190,57196],[57200,57204]],55301:[[56376,56383],[56386,56388],56390,56414,[56499,56504],56506,[56511,56512],[56514,56515],[56754,56757],[56764,56765],[56767,56768],[56796,56797],[56883,56890],56893,[56895,56896],57003,57005,[57008,57013],57015,[57117,57119],[57122,57125],[57127,57131]],55302:[[56367,56375],[56377,56378],[56635,56636],56638,56643,[56788,56791],[56794,56795],56800,[56833,56842],[56883,56888],[56891,56894],56903,[56913,56918],[56921,56923],[56970,56982],[56984,56985]],55303:[[56368,56374],[56376,56381],56383,[56466,56487],[56490,56496],[56498,56499],[56501,56502],[56625,56630],56634,[56636,56637],[56639,56645],56647,[56720,56721],56725,56727,[57075,57076]],55322:[[57072,57076],[57136,57142]],55323:[57167,[57231,57234],57316],55343:[[56477,56478]],55348:[[56679,56681],[56699,56706],[56709,56715],[56746,56749],[56898,56900]],55350:[[56832,56886],[56891,56940],56949,56964,[56987,56991],[56993,57007]],55352:[[56320,56326],[56328,56344],[56347,56353],[56355,56356],[56358,56362],[56624,56630],[57068,57071]],55354:[[56528,56534],[56644,56650]],56128:[[56576,56815]]},{55300:[56320,56322,56450,[56496,56498],[56503,56504],56620,[56645,56646],56706,[56755,56757],[56767,56768],56782,[56876,56878],[56882,56883],56885,[57056,57058],[57090,57091],[57150,57151],[57153,57156],[57159,57160],[57163,57165],57175,[57186,57187]],55301:[[56373,56375],[56384,56385],56389,[56496,56498],56505,[56507,56510],56513,[56751,56753],[56760,56763],56766,[56880,56882],[56891,56892],56894,57004,[57006,57007],57014,[57120,57121],57126],55302:[[56364,56366],56376,[56624,56629],[56631,56632],56637,56640,56642,[56785,56787],[56796,56799],56804,56889,[56919,56920],56983],55303:[56367,56382,56489,56497,56500,[56714,56718],[56723,56724],56726,[57077,57078]],55323:[[57169,57223],[57328,57329]],55348:[[56677,56678],[56685,56690]]},{55297:[[56480,56489]],55299:[[56624,56633]],55300:[[56422,56431],[56560,56569],[56630,56639],[56784,56793],[57072,57081]],55301:[[56400,56409],[56528,56537],[56912,56921],[57024,57033],[57136,57145]],55302:[[56544,56553],56656],55303:[[56400,56409],[56656,56665],[56736,56745]],55322:[[56928,56937],[57168,57177]],55349:[[57294,57343]],55352:[[56640,56649],[57072,57081]],55354:[[56656,56665]],55358:[[57328,57337]]}];function Ye(e,t,n,i,r){for(let s=0;s<e.length;s++){const o=e[s];let a,l;Array.isArray(o)?(a=o[0],l=o[1]):a=l=o;for(let e=a;e<=l;e++)e<Ne?i[e]=t:r[e]=t;if(n&&a>=Ne)break}}function Qe(e,t){for(const n in e)Le[n]||(Le[n]={},Oe[n]=Fe.SurrogateChar),Ye(e[n],t,!1,Le[n],Le[n])}function Ze(e){if(Me.fill(Fe.NotIdentifierChar),Ke.forEach((t=>{Ye(t,Fe.IdentifierChar,e,Me,Oe)})),He.forEach((t=>{Ye(t,Fe.StartIdentifierChar,e,Me,Oe)})),!e){for(const e of Je)Qe(e,Fe.IdentifierChar);for(const e of Ge)Qe(e,Fe.StartIdentifierChar)}}function Xe(e,t){if(!e.existsSync(t)||!fe(e,t))return;let n=!1;const i=te(t,"py.typed");if(!e.existsSync(t)||!ge(e,i))return;const r=e.statSync(i);if(r.size>0&&r.size<65536){const t=e.readFileSync(i,"utf8");(t.match(/partial\n/)||t.match(/partial\r\n/))&&(n=!0)}return{pyTypedPath:i,isPartiallyTyped:n}}function et(e){const t=e.map((e=>e.toLowerCase()));return e=>{if(!e||e.indexOf("__pycache__")>=0)return!0;const n=e.toLowerCase();return t.every((e=>n.indexOf(e)<0))}}Ze(!0);const tt={close(){}},nt={createFileWatcher:(e,t)=>tt,onFileChange(e,t){}};class it{constructor(e,t){this.name=e,this._file=t}isFile(){return this._file}isDirectory(){return!this._file}isBlockDevice(){return!1}isCharacterDevice(){return!1}isSymbolicLink(){return!1}isFIFO(){return!1}isSocket(){return!1}}class rt extends class{constructor(e){this._realFS=e,this._entryMap=new Map,this._reverseEntryMap=new Map,this._folderMap=new Map}existsSync(e){return!this._isMovedEntry(e)&&this._realFS.existsSync(this._getOriginalPath(e))}mkdirSync(e,t){throw new Error("Operation is not allowed.")}chdir(e){throw new Error("Operation is not allowed.")}readdirEntriesSync(e){const t=le(e),n=[],i=this._folderMap.get(t);return i&&!this._realFS.existsSync(e)||n.push(...this._realFS.readdirEntriesSync(e).filter((t=>!this._isMovedEntry(te(e,t.name))))),i?n.concat(i.map((e=>new it(e.name,e.isFile)))):n}readdirSync(e){return this.readdirEntriesSync(e).map((e=>e.name))}readFileSync(e,t){return this._realFS.readFileSync(this._getOriginalPath(e),t)}writeFileSync(e,t,n){throw new Error("Operation is not allowed.")}statSync(e){return this._realFS.statSync(this._getOriginalPath(e))}unlinkSync(e){throw new Error("Operation is not allowed.")}realpathSync(e){return this._entryMap.has(e)?e:this._realFS.realpathSync(e)}getModulePath(){return this._realFS.getModulePath()}createFileSystemWatcher(e,t){return this._realFS.createFileSystemWatcher(e,t)}createReadStream(e){return this._realFS.createReadStream(this._getOriginalPath(e))}createWriteStream(e){throw new Error("Operation is not allowed.")}copyFileSync(e,t){throw new Error("Operation is not allowed.")}readFile(e){return this._realFS.readFile(this._getOriginalPath(e))}readFileText(e,t){return this._realFS.readFileText(this._getOriginalPath(e),t)}tmpdir(){return this._realFS.tmpdir()}tmpfile(e){return this._realFS.tmpfile(e)}realCasePath(e){return this._realFS.realCasePath(e)}getUri(e){return this._realFS.getUri(e)}isMappedFilePath(e){return this._entryMap.has(e)||this._realFS.isMappedFilePath(e)}getOriginalFilePath(e){return this._realFS.getOriginalFilePath(this._getOriginalPath(e))}getMappedFilePath(e){var t;const n=this._realFS.getMappedFilePath(e);return null!==(t=this._reverseEntryMap.get(n))&&void 0!==t?t:n}isInZipOrEgg(e){return this._realFS.isInZipOrEgg(e)}_recordMovedEntry(e,t,n=!0,i=!0){this._entryMap.set(e,t),n&&this._reverseEntryMap.set(t,e);const r=le($(e)),s=h(this._folderMap,r,(()=>[])),o=de(e);s.some((e=>e.name===o))||s.push({name:o,isFile:i})}_getOriginalPath(e){var t;return null!==(t=this._entryMap.get(e))&&void 0!==t?t:e}_isMovedEntry(e){return this._reverseEntryMap.has(e)}_clear(){this._entryMap.clear(),this._reverseEntryMap.clear(),this._folderMap.clear()}}{constructor(e){super(e),this._rootSearched=new Set,this._partialStubPackagePaths=new Set,this._conflictMap=new Map,this._customUriMap=new Map}mkdirSync(e,t){this._realFS.mkdirSync(e,t)}chdir(e){this._realFS.chdir(e)}writeFileSync(e,t,n){this._realFS.writeFileSync(this._getOriginalPath(e),t,n)}unlinkSync(e){this._realFS.unlinkSync(this._getOriginalPath(e))}createWriteStream(e){return this._realFS.createWriteStream(this._getOriginalPath(e))}copyFileSync(e,t){this._realFS.copyFileSync(this._getOriginalPath(e),this._getOriginalPath(t))}getUri(e){const t=this._customUriMap.get(this.getMappedFilePath(e));return t?t.uri:this._realFS.getUri(e)}hasUriMapEntry(e,t){const n=this._customUriMap.get(t);return!(!n||n.uri!==e)}addUriMap(e,t){const n=this._customUriMap.get(t);return n?n.uri===e&&(n.closed=!1,!0):(this._customUriMap.set(t,{uri:e,closed:!1,hasPendingRequest:!1}),!0)}removeUriMap(e,t){const n=this._customUriMap.get(t);return!(!n||n.uri!==e||(n.hasPendingRequest?(n.closed=!0,0):(this._customUriMap.delete(t),0)))}pendingRequest(e,t){const n=this._customUriMap.get(e);n&&(t||!n.closed?n.hasPendingRequest=t:this._customUriMap.delete(e))}isPartialStubPackagesScanned(e){var t;return this.isPathScanned(null!==(t=e.root)&&void 0!==t?t:"")}isPathScanned(e){return this._rootSearched.has(e)}processPartialStubPackages(e,t){var n;for(const i of e)if(this._rootSearched.add(i),this._realFS.existsSync(i)&&fe(this._realFS,i))for(const e of this._realFS.readdirEntriesSync(i)){const r=te(i,e.name);if(!(e.isSymbolicLink()?null===(n=ye(this._realFS,r))||void 0===n?void 0:n.isDirectory():e.isDirectory())||!e.name.endsWith(b))continue;const s=Xe(this._realFS,r);if(!s||!s.isPartiallyTyped)continue;let o;this._partialStubPackagePaths.add(r);const a=e.name.substr(0,e.name.length-b.length);for(const e of t){const t=te(e,a);try{const e=ye(this._realFS,t);if(!(null==e?void 0:e.isDirectory()))continue;const n=Xe(this._realFS,t);if(n&&!n.isPartiallyTyped)continue;o=null!=o?o:this._getRelativePathPartialStubs(r);for(const e of o){const n=te(r,e),i=te(t,e);if(this.existsSync(i)){const t=ie(i,"py"),r=ie(te(this.tmpdir(),"conflictFiles",a,e),"py");this._conflictMap.has(i)||this.existsSync(t)||this.existsSync(r)||(this._recordMovedEntry(r,n,!1),this._conflictMap.set(i,r))}else this._recordMovedEntry(i,n)}}catch{}}}}clearPartialStubs(){super._clear(),this._rootSearched.clear(),this._partialStubPackagePaths.clear(),this._conflictMap.clear()}getConflictedFile(e){return this._conflictMap.get(e)}_getRelativePathPartialStubs(e){const t=[],n=le(e).length,i=e=>{for(const r of this._realFS.readdirEntriesSync(e)){const s=te(e,r.name);let o=r.isDirectory(),a=r.isFile();if(r.isSymbolicLink()){const e=ye(this._realFS,s);e&&(o=e.isDirectory(),a=e.isFile())}if(o&&i(s),a&&r.name.endsWith(".pyi")){const e=s.substring(n);e&&t.push(e)}}};return i(e),t}_isMovedEntry(e){return this._partialStubPackagePaths.has(e)||super._isMovedEntry(e)}}var st=__webpack_require__(3374),ot=__webpack_require__(8934);let at;class lt extends ot.ResponseError{constructor(){super(ot.LSPErrorCodes.RequestCancelled,"request cancelled")}static is(e){return e.code===ot.LSPErrorCodes.RequestCancelled}}function ct(e){if(!o()&&e.isCancellationRequested)throw new lt}function ut(...e){const t=new st.CancellationTokenSource,n=[];for(const i of e)n.push(i.onCancellationRequested((e=>{t.cancel()})));return n.push(t.token.onCancellationRequested((e=>{n.forEach((e=>e.dispose()))}))),t}class pt{createCancellationTokenSource(){return new st.CancellationTokenSource}}var dt,ht,mt,ft;function gt(e,t){return e.line<t.line?-1:e.line>t.line?1:e.character<t.character?-1:e.character>t.character?1:0}function yt(e,t){return!(gt(t.start,e.end)>0||gt(e.start,t.end)>0)}function _t(e,t){return ht.is(t)?gt(e.start,t)<=0&&gt(e.end,t)>=0:_t(e,t.start)&&_t(e,t.end)}function vt(e,t){return 0===gt(e,t)}function Tt(e,t){return vt(e.start,t.start)&&vt(e.end,t.end)}function bt(e,t){t&&(Array.isArray(t)?t.forEach((t=>{bt(e,t)})):(gt(t.start,e.start)<0&&(e.start=t.start),gt(t.end,e.end)>0&&(e.end=t.end)))}function It(e,t){if(0===t.end)return{line:0,character:0};let n=0;e>=t.end&&(e=t.end-1,n=1);const i=t.getItemContaining(e);w(i>=0&&i<=t.length);const r=t.getItemAt(i);return w(void 0!==r),{line:i,character:e-r.start+n}}function St(e,t,n){return{start:It(e,n),end:It(t,n)}}function xt(e,t){if(!(e.line>=t.count))return t.getItemAt(e.line).start+e.character}function Ct(e,t){const n=xt(e.start,t);if(void 0===n)return;const i=xt(e.end,t);return void 0!==i?dt.fromBounds(n,i):void 0}function wt(e,t){return St(e.start,dt.getEnd(e),t)}!function(e){function t(e,t){if(e<0)throw new Error("start must be non-negative");if(t<0)throw new Error("length must be non-negative");return{start:e,length:t}}function n(e){return e.start+e.length}function i(e,t){return t>=e.start&&t<=n(e)}function r(e,t){t&&(Array.isArray(t)?t.forEach((t=>{r(e,t)})):(t.start<e.start&&(e.length+=e.start-t.start,e.start=t.start),n(t)>n(e)&&(e.length+=n(t)-n(e))))}e.create=t,e.fromBounds=function(e,n){if(e<0)throw new Error("start must be non-negative");if(e>n)throw new Error("end must be greater than or equal to start");return t(e,n-e)},e.getEnd=n,e.contains=function(e,t){return t>=e.start&&t<n(e)},e.containsRange=function(e,t){return t.start>=e.start&&n(t)<=n(e)},e.overlaps=i,e.overlapsRange=function(e,t){return i(e,t.start)||i(t,e.start)},e.extend=r,e.combine=function(e){if(0===e.length)return;const t=e[0];for(let n=1;n<e.length;n++)r(t,e[n]);return t}}(dt||(dt={})),function(e){e.is=function(e){const t=e;return t&&void 0!==t.line&&void 0!==t.character},e.print=function(e){return`(${e.line}:${e.character})`}}(ht||(ht={})),function(e){e.is=function(e){const t=e;return t&&void 0!==t.start&&void 0!==t.end},e.print=function(e){return`${ht.print(e.start)}-${ht.print(e.end)}`}}(mt||(mt={})),function(e){e[e.Unreachable=1]="Unreachable",e[e.Start=2]="Start",e[e.BranchLabel=4]="BranchLabel",e[e.LoopLabel=8]="LoopLabel",e[e.Assignment=16]="Assignment",e[e.Unbind=32]="Unbind",e[e.WildcardImport=64]="WildcardImport",e[e.TrueCondition=128]="TrueCondition",e[e.FalseCondition=512]="FalseCondition",e[e.Call=1024]="Call",e[e.PreFinallyGate=2048]="PreFinallyGate",e[e.PostFinally=4096]="PostFinally",e[e.VariableAnnotation=16384]="VariableAnnotation",e[e.PostContextManager=32768]="PostContextManager",e[e.TrueNeverCondition=65536]="TrueNeverCondition",e[e.FalseNeverCondition=131072]="FalseNeverCondition",e[e.NarrowForPattern=262144]="NarrowForPattern",e[e.ExhaustedMatch=524288]="ExhaustedMatch"}(ft||(ft={}));let Et=1;function kt(){return Et++}function Dt(e){if(38===e.nodeType)return!0;if(35===e.nodeType)return Dt(e.leftExpression);if(24===e.nodeType){if(1!==e.items.length||e.trailingComma||void 0!==e.items[0].name||0!==e.items[0].argumentCategory)return!1;const t=e.items[0].valueExpression,n=40===t.nodeType&&!t.isImaginary&&t.isInteger,i=48===t.nodeType&&1===t.strings.length&&49===t.strings[0].nodeType;return!(!n&&!i)&&Dt(e.baseExpression)}return!1}function At(e){let t;if(38===e.nodeType)t=e.value;else if(35===e.nodeType)t=`${At(e.leftExpression)}.${e.memberName.value}`;else if(24===e.nodeType){const n=At(e.baseExpression);if(w(1===e.items.length),40===e.items[0].valueExpression.nodeType)t=`${n}[${e.items[0].valueExpression.value.toString()}]`;else if(48===e.items[0].valueExpression.nodeType){const i=e.items[0].valueExpression;w(1===i.strings.length&&49===i.strings[0].nodeType),t=`${n}["${i.strings[0].value}"]`}else E("createKeyForReference received unexpected index type")}else E("createKeyForReference received unexpected expression type");return t}function Pt(e){return 38===e.nodeType?[At(e)]:35===e.nodeType?[...Pt(e.leftExpression),At(e)]:24===e.nodeType?[...Pt(e.baseExpression),At(e)]:void E("createKeyForReference received unexpected expression type")}function Rt(e){return e.importInfo}function Ft(e){return e.scope}function Nt(e,t){e.scope=t}function Mt(e){return e.declaration}function Ot(e,t){e.declaration=t}function Lt(e){return e.flowNode}function Ut(e,t){e.flowNode=t}function qt(e,t){e.afterFlowNode=t}function Vt(e){for(;36!==e.nodeType;)e=e.parent;return e.fileInfo}function Bt(e,t){e.codeFlowExpressions=t}function Wt(e){return e.dunderAllInfo}function jt(e,t){e.dunderAllInfo=t}function zt(e){let t=e;for(;t;){const e=Lt(t);if(e)return!!(e.flags&ft.Unreachable);t=t.parent}return!1}const $t=/^[A-Z0-9_]+$/,Ht=/^[_]+$/,Gt=/^_{0,2}[A-Z][A-Za-z0-9_]+$/;function Kt(e){return e.length>2&&e.startsWith("__")&&!e.endsWith("__")}function Jt(e){return e.length>1&&e.startsWith("_")&&!e.startsWith("__")}function Yt(e){return Kt(e)||Jt(e)}function Qt(e){return e.length>4&&e.startsWith("__")&&e.endsWith("__")}function Zt(e){return!!e.match($t)&&!e.match(Ht)}function Xt(e){return!!e.match(Gt)}function en(e){return e.importResult?0===e.importResult.importType?0:1===e.importResult.importType||e.importResult.isLocalTypingsFile?1:e.importResult.isRelative?3:2:2}function tn(e,t=!1){const n={orderedImports:[],mapByFilePath:new Map};let i=!1,r=!1;return e.statements.forEach((e=>{47===e.nodeType?e.statements.forEach((e=>{20===e.nodeType?(r=!0,function(e,t,n){e.list.forEach((i=>{const r=Rt(i.module);let s;r&&r.isImportFound&&(s=r.resolvedPaths[r.resolvedPaths.length-1]);const o={node:e,subnode:i,importResult:r,resolvedPath:s,moduleName:ln(i.module),followsNonImportStatement:n};t.orderedImports.push(o),s&&(t.mapByFilePath.has(s)||t.mapByFilePath.set(s,o))}))}(e,n,i),i=!1):22===e.nodeType?(r=!0,function(e,t,n,i){var r;const s=Rt(e.module);let o;if(s&&s.isImportFound&&(o=s.resolvedPaths[s.resolvedPaths.length-1]),i&&s){t.implicitImports=null!==(r=t.implicitImports)&&void 0!==r?r:new Map;for(const n of s.implicitImports){const i=e.imports.find((e=>e.name.value===n.name));i&&t.implicitImports.set(n.path,i)}}const a={node:e,importResult:s,resolvedPath:o,moduleName:ln(e.module),followsNonImportStatement:n};if(t.orderedImports.push(a),o){const e=t.mapByFilePath.get(o);(!e||20===e.node.nodeType||e.moduleName.length>a.moduleName.length)&&t.mapByFilePath.set(o,a)}}(e,n,i,t),i=!1):i=r})):i=r})),n}function nn(e){return Zt(e)?0:Xt(e)?1:2}function rn(e,t,n){const i=[];if(!t.node||22!==t.node.nodeType||t.node.isWildcardImport)return i;const r=t.node;if(0===(e=(Array.isArray(e)?e:[e]).filter((e=>!!e.name&&!r.imports.some((t=>t.name.value===e.name&&t.alias===e.alias))))).length)return i;for(const r of e)i.push(on(r.name,r.alias,t.node,n));const s=f(i,(e=>mt.print(e.range))),o=[];for(const e of s.values())1===e.length?o.push(e[0]):o.push({range:e[0].range,replacementText:e.sort(((e,t)=>sn(e.importName,t.importName))).map((e=>e.replacementText)).join("")});return o}function sn(e,t){const n=nn(e)-nn(t);return 0!==n?n:L(e.replace(/_/g,"="),t.replace(/_/g,"="))}function on(e,t,n,i){let r;for(const t of n.imports){if(sn(t.name.value,e)>0)break;r=t}let s=!1,o="";if(n.imports.length>0){const e=It(n.start,i.tokenizerOutput.lines),t=It(n.imports[0].start,i.tokenizerOutput.lines),r=n.imports.length>1?It(n.imports[1].start,i.tokenizerOutput.lines):void 0;if(t.line>e.line&&(void 0===r||r.line>t.line)){const e=i.tokenizerOutput.lines.getItemAt(t.line);o=i.text.substr(e.start,t.character),/^\s*$/.test(o)&&(s=!0)}}const a=It(r?dt.getEnd(r):n.imports.length>0?n.imports[0].start:n.start+n.length,i.tokenizerOutput.lines),l=t?`${e} as ${t}`:`${e}`;let c;if(s){const e=i.tokenizerOutput.predominantEndOfLineSequence;c=r?`,${e}${o}${l}`:`${l},${e}${o}`}else c=r?`, ${l}`:`${l}, `;return{range:{start:a,end:a},importName:e,replacementText:c}}function an(e,t,i,r,s,o){return function(e,t){if(t.length<2)return t.map((e=>r(e)));const n=[...f(t,(e=>`${e.importGroup} ${mt.print(e.range)}`))].sort(((e,t)=>L(e[0],t[0]))).map((e=>e[1])),i=[];for(const t of n)1===t.length?i.push(r(t[0])):i.push({range:t[0].range,replacementText:t[0].preChange+t.map((e=>e.importStatement)).sort(((e,t)=>s(e,t))).join(e.tokenizerOutput.predominantEndOfLineSequence)+t[0].postChange});return i;function r(e){return{range:e.range,replacementText:e.preChange+e.importStatement+e.postChange}}function s(e,t){const n=e.startsWith("import");return n===t.startsWith("import")?e<t?-1:1:n?-1:1}}(s,function(e,t,i,r,s,o){const a=[];0===(e=Array.isArray(e)?e:[e]).length&&e.push({});const l=f(e,(e=>e.name?"from":"import")),c=l.get("import");c&&p(c,(e=>`import ${e.join(", ")}`));const u=l.get("from");return u&&p(u,(e=>`from ${i} import ${e.join(", ")}`)),a;function p(e,l){const c=e.map((e=>function(e,t){const n=e.name?e.name:t;return{sortText:n,text:e.alias?`${n} as ${e.alias}`:n}}(e,i))).sort(((e,t)=>sn(e.sortText,t.sortText))).reduce(((e,t)=>function(e,t,i=n){return function(e,t,i=n){if(e)for(const n of e)if(i(n,t))return!0;return!1}(e,t,i)||e.push(t),e}(e,t.text)),[]);a.push(function(e,t,n,i,r,s){let o,a="",l="";const c=xt(s,r.tokenizerOutput.lines);if(t.orderedImports.length>0&&c>t.orderedImports[0].node.start){let e=!0,s=t.orderedImports[0],c=0;for(const o of t.orderedImports){const l=o.importResult?en(o):c;if(i<l){!e&&c<i&&(a=r.tokenizerOutput.predominantEndOfLineSequence+a);break}if(i===l&&o.moduleName>n)break;if(o.followsNonImportStatement){i>c&&(a=r.tokenizerOutput.predominantEndOfLineSequence+a);break}o===t.orderedImports[t.orderedImports.length-1]&&i>l&&(a=r.tokenizerOutput.predominantEndOfLineSequence+a),e=!e&&i<c&&i===l,c=l,s=o}s?(e?l+=r.tokenizerOutput.predominantEndOfLineSequence:a=r.tokenizerOutput.predominantEndOfLineSequence+a,o=It(e?s.node.start:dt.getEnd(s.node),r.tokenizerOutput.lines)):o={line:0,character:0}}else{o={line:0,character:0};let e=!1;for(const t of r.parseTree.statements){let n=!0;if(47===t.nodeType&&1===t.statements.length){const e=t.statements[0];(48===e.nodeType||3===e.nodeType&&38===e.leftExpression.nodeType&&Qt(e.leftExpression.value))&&(n=!1)}if(n){o=It(t.start,r.tokenizerOutput.lines),e=!1;break}o=It(t.start+t.length,r.tokenizerOutput.lines),e=!0}l=l+r.tokenizerOutput.predominantEndOfLineSequence+r.tokenizerOutput.predominantEndOfLineSequence,e?a=r.tokenizerOutput.predominantEndOfLineSequence+a:l+=r.tokenizerOutput.predominantEndOfLineSequence}return{range:{start:o,end:o},preChange:a,importStatement:e,postChange:l,importGroup:i}}(l(c),t,i,r,s,o))}}(e,t,i,r,s,o))}function ln(e){let t="";for(let n=0;n<e.leadingDots;n++)t+=".";return t+=e.nameParts.map((e=>e.value)).join("."),t}function cn(e){let t=2;return e.isLocalTypingsFile||1===e.importType?t=1:0===e.importType&&(t=0),t}function un(e,t,n,i=!1,r){let s,o=t;(r=void 0!==r?r:ge(e,t))&&(o=$(t));let a=n;if(r){a=$(n);const e=he(de(n));"__init__"!==e?s=e:i&&(s=de(a),a=$(a))}const l=se(o,a,(t=>e.realCasePath(t)));let c=".";for(let e=1;e<l.length;e++){const t=l[e];c+=".."===t?".":t,".."!==t&&e!==l.length-1&&(c+=".")}return s&&(c="."===c[c.length-1]?c+s:c+"."+s),c}function pn(e,t){let n=e;for(let e=1;e<t;e++){if(""===n)return;n=$(n)}return n}class dn{constructor(e){this._importRootGetter=e,this._importChecked=new Map,this._cachedResults=new Map,this._libPathCache=void 0}getImportResult(e,t,n){var i,r,s,o;const a=null===(i=this._cachedResults.get(t))||void 0===i?void 0:i.get(e);if(a)return null!=a?a:n;const l=null===(r=this._importChecked.get(t))||void 0===r?void 0:r.get(e);return l?l.importPath&&null!==(o=null===(s=this._cachedResults.get(t))||void 0===s?void 0:s.get(l.importPath))&&void 0!==o?o:n:void 0}checkValidPath(e,t,n){var i;return!!t.startsWith(n)&&(this._libPathCache=null!==(i=this._libPathCache)&&void 0!==i?i:this._importRootGetter().map((t=>le(ke(e,me(t))))).filter((e=>e!==n)).filter((e=>e.startsWith(n))),!this._libPathCache.some((e=>t.startsWith(e))))}checked(e,t,n){h(this._importChecked,t,(()=>new Map)).set(e,n)}add(e){h(this._cachedResults,e.importName,(()=>new Map)).set(e.path,e.importResult)}reset(){this._importChecked.clear(),this._cachedResults.clear(),this._libPathCache=void 0}}const hn="stdlib",mn="stubs";function fn(e,t,n,i,r,s){if(i.push("Finding python search paths"),void 0!==t.venvPath&&t.venv){const n=t.venv,r=te(t.venvPath,n),s=[],o=[];if([y,v,_].forEach((t=>{const n=function(e,t,n){if(!e.existsSync(t))return void n.push(`Did not find '${t}'`);n.push(`Found path '${t}'; looking for site-packages`);const i=te(t,T);if(e.existsSync(i))return n.push(`Found path '${i}'`),i;n.push(`Did not find '${i}', so looking for python subdirectory`);const r=ve(e,t);for(let i=0;i<r.directories.length;i++){const s=r.directories[i];if(s.startsWith("python")){const i=te(t,s,T);if(e.existsSync(i))return n.push(`Found path '${i}'`),i;n.push(`Path '${i}' is not a valid directory`)}}}(e,te(r,t),i);n&&(_n(s,n),o.push(n))})),o.forEach((t=>{yn(e,t).forEach((e=>{_n(s,e)}))})),s.length>0)return i.push("Found the following 'site-packages' dirs"),s.forEach((e=>{i.push(`  ${e}`)})),s;i.push("Did not find any 'site-packages' dirs. Falling back on python interpreter.")}const o=n.getPythonSearchPaths(t.pythonPath,i);return r&&s?o.paths.filter((e=>!ne(s,e,!0)||ne(o.prefix,e,!0))):o.paths}function gn(e){return"python"===(e=e.trim())||"python3"===e}function yn(e,t){const n=[];return e.readdirEntriesSync(t).filter((e=>(e.isFile()||e.isSymbolicLink())&&e.name.endsWith(".pth"))).sort(((e,t)=>i(e.name,t.name))).forEach((i=>{const r=te(t,i.name),s=ye(e,r);(null==s?void 0:s.isFile())&&s.size>0&&s.size<65536&&e.readFileSync(r,"utf8").split(/\r?\n/).forEach((i=>{const r=i.trim();if(r.length>0&&!r.startsWith("#")&&!r.match(/^import\s/)){const i=te(t,r);e.existsSync(i)&&fe(e,i)&&n.push(i)}}))})),n}function _n(e,t){return!e.some((e=>e===t))&&(e.push(t),!0)}function vn(e){return{leadingDots:0,nameParts:e.split("."),importedSymbols:[]}}const Tn=[".pyd",".so",".dylib"],bn=[".py",".pyi",...Tn];class In{constructor(e,t,n){this.fileSystem=e,this._configOptions=t,this.host=n,this._cachedImportResults=new Map,this._cachedModuleNameResults=new Map,this._cachedEntriesForPath=new Map,this.cachedParentImportResults=new dn((()=>this.getPythonSearchPaths([])))}invalidateCache(){this._cachedImportResults=new Map,this._cachedModuleNameResults=new Map,this.cachedParentImportResults.reset(),this._invalidateFileSystemCache(),this.fileSystem instanceof rt&&this.fileSystem.clearPartialStubs()}resolveImport(e,t,n){return this._resolveImport(e,t,n)}_resolveImport(e,t,n){const i=this.formatImportName(n),r=this._resolveImportStrict(i,e,t,n,[]);if(r.isImportFound||n.leadingDots>0)return r;const s=le($(e=ke(this.fileSystem,me(e)))),o=this.cachedParentImportResults.getImportResult(s,i,r);if(o)return this.filterImplicitImports(o,n.importedSymbols);const a=this.getParentImportResolutionRoot(e,t.root);if(!this.cachedParentImportResults.checkValidPath(this.fileSystem,e,a))return r;const l={importPath:void 0};let c=s;for(;this._shouldWalkUp(c,a,t);){const e=this.resolveAbsoluteImport(c,t,n,i,[],void 0,void 0,!1,!0);if(this.cachedParentImportResults.checked(c,i,l),e.isImportFound)return l.importPath=c,this.cachedParentImportResults.add({importResult:e,path:c,importName:i}),this.filterImplicitImports(e,n.importedSymbols);let r;if([r,c]=this._tryWalkUp(c),!r)break}return this.cachedParentImportResults.checked(c,i,l),r}_resolveImportStrict(e,t,n,i,r){const s={importName:e,isRelative:!1,isImportFound:!1,isPartlyResolved:!1,isNamespacePackage:!1,isStubPackage:!1,importFailureInfo:r,resolvedPaths:[],importType:2,isStubFile:!1,isNativeLib:!1,implicitImports:[],filteredImplicitImports:[],nonStubImportResult:void 0};if(this.ensurePartialStubPackages(n),i.leadingDots>0){const s=this._resolveRelativeImport(t,n,i,e,r);if(s)return s.isRelative=!0,s}else{const r=this._lookUpResultsInCache(n,e,i.importedSymbols);if(r&&(!r.isImportFound||!r.isNamespacePackage||this._isNamespacePackageResolved(i,r.implicitImports)))return r;const o=this._resolveBestAbsoluteImport(t,n,i,!0);if(o)return o.isStubFile&&(o.nonStubImportResult=this._resolveBestAbsoluteImport(t,n,i,!1)||s),this.addResultsToCache(n,e,o,i.importedSymbols)}return this.addResultsToCache(n,e,s,void 0)}getCompletionSuggestions(e,t,n){const i=this._getCompletionSuggestionsStrict(e,t,n);if(n.leadingDots>0)return i;const r=this.getParentImportResolutionRoot(e,t.root);let s=le($(ke(this.fileSystem,me(e))));for(;this._shouldWalkUp(s,r,t);){let r;if(this._getCompletionSuggestionsAbsolute(e,t,s,n,i,!1),[r,s]=this._tryWalkUp(s),!r)break}return i}_getCompletionSuggestionsStrict(e,t,n){const i=[],r=new Set;if(n.leadingDots>0)this._getCompletionSuggestionsRelative(e,t,n,r);else{n.nameParts.length>0&&this._getCompletionSuggestionsTypeshedPath(e,t,n,!0,r),t.root&&this._getCompletionSuggestionsAbsolute(e,t,t.root,n,r);for(const i of t.extraPaths)this._getCompletionSuggestionsAbsolute(e,t,i,n,r);this._configOptions.stubPath&&this._getCompletionSuggestionsAbsolute(e,t,this._configOptions.stubPath,n,r),this._getCompletionSuggestionsTypeshedPath(e,t,n,!1,r);const s=this.getPythonSearchPaths(i);for(const i of s)this._getCompletionSuggestionsAbsolute(e,t,i,n,r)}return r}getSourceFilesFromStub(e,t,n){const i=[];if(this._cachedImportResults.forEach((t=>{t.forEach((t=>{if(t.isStubFile&&t.isImportFound&&t.nonStubImportResult&&t.resolvedPaths[t.resolvedPaths.length-1]===e&&t.nonStubImportResult.isImportFound){const e=t.nonStubImportResult.resolvedPaths[t.nonStubImportResult.resolvedPaths.length-1];(e.endsWith(".py")||e.endsWith(".pyi"))&&i.push(e)}}))})),0===i.length){const t=ie(e,".py");this.dirExistsCached(t)&&i.push(t)}if(0===i.length){const n=this.getImportRoots(t),r=[];for(const t of n)if(ne(t,e,!0)){const n=se(t,e,!0);if(n.length>1){n[1].endsWith(b)&&(n[1]=n[1].substr(0,n[1].length-b.length));const e=J(n);e&&r.push(e)}}for(const e of r)for(const t of n){let n=ie(ee(t,e),".py");if(this.fileExistsCached(n))i.push(n);else{const e=he(n);e.endsWith("__init__")?(n=e.substr(0,e.length-9)+".py",this.fileExistsCached(n)&&i.push(n)):(n=te(e,"__init__.py"),this.fileExistsCached(n)&&i.push(n))}}}return i}getModuleNameForImport(e,t){const n=h(this._cachedModuleNameResults,t.root,(()=>new Map));return h(n,e,(()=>this._getModuleNameForImport(e,t)))}_getModuleNameForImport(e,t){let n,i=0,r=!1;const s=[],o=this._getStdlibTypeshedPath(t,s);if(o&&(n=this.getModuleNameFromPath(o,e),n)){const e={leadingDots:0,nameParts:n.split("."),importedSymbols:void 0};if(this._isStdlibTypeshedStubValidForVersion(e,t,[]))return{moduleName:n,importType:i,isLocalTypingsFile:r}}t.root&&(n=this.getModuleNameFromPath(t.root,e),i=2);for(const r of t.extraPaths){const t=this.getModuleNameFromPath(r,e);(!n||t&&t.length<n.length)&&(n=t,i=2)}if(this._configOptions.stubPath){const t=this.getModuleNameFromPath(this._configOptions.stubPath,e);(!n||t&&t.length<n.length)&&(n=t,i=2,r=!0)}const a=this._getThirdPartyTypeshedPath(t,s);if(a){const t=this.getModuleNameFromPath(a,e,!0);(!n||t&&t.length<n.length)&&(n=t,i=1)}const l=this.getTypeshedPathEx(t,s);if(l){const t=this.getModuleNameFromPath(l,e);(!n||t&&t.length<n.length)&&(n=t,i=1)}const c=this.getPythonSearchPaths(s);for(const t of c){const r=this.getModuleNameFromPath(t,e);(!n||r&&r.length<n.length)&&(n=r,i=1)}return n?{moduleName:n,importType:i,isLocalTypingsFile:r}:{moduleName:"",importType:2,isLocalTypingsFile:r}}getTypeshedStdLibPath(e){return this._getStdlibTypeshedPath(e,[])}getImportRoots(e,t=!1){const n=[],i=[],r=this._getStdlibTypeshedPath(e,n);if(r&&i.push(r),e.root&&i.push(e.root),i.push(...e.extraPaths),this._configOptions.stubPath&&i.push(this._configOptions.stubPath),t){const t=this._getThirdPartyTypeshedPath(e,n);t&&i.push(te(t,"..."))}else{const t=this._getThirdPartyTypeshedPackageRoots(e,n);i.push(...t)}const s=this.getTypeshedPathEx(e,n);s&&i.push(s);const o=this.getPythonSearchPaths(n);return o.length>0&&i.push(...o),i}readdirEntriesCached(e){const t=this._cachedEntriesForPath.get(e);if(t)return t;let n;try{n=this.fileSystem.readdirEntriesSync(e)}catch{n=[]}return this._cachedEntriesForPath.set(e,n),n}fileExistsCached(e){var t,n;const i=this._splitPath(e);if(!i[0]||!i[1])return!!this.fileSystem.existsSync(e)&&null!==(n=null===(t=ye(this.fileSystem,e))||void 0===t?void 0:t.isFile())&&void 0!==n&&n;const r=this.readdirEntriesCached(i[0]).find((e=>e.name===i[1]));if(null==r?void 0:r.isFile())return!0;if(null==r?void 0:r.isSymbolicLink()){const t=_e(this.fileSystem,e);if(t&&this.fileSystem.existsSync(t)&&ge(this.fileSystem,t))return!0}return!1}dirExistsCached(e){var t,n;const i=this._splitPath(e);if(!i[0]||!i[1])return!!this.fileSystem.existsSync(e)&&null!==(n=null===(t=ye(this.fileSystem,e))||void 0===t?void 0:t.isDirectory())&&void 0!==n&&n;const r=this.readdirEntriesCached(i[0]).find((e=>e.name===i[1]));if(null==r?void 0:r.isDirectory())return!0;if(null==r?void 0:r.isSymbolicLink()){const t=_e(this.fileSystem,e);if(t&&this.fileSystem.existsSync(t)&&fe(this.fileSystem,t))return!0}return!1}ensurePartialStubPackages(e){if(!(this.fileSystem instanceof rt))return!1;if(this.fileSystem.isPartialStubPackagesScanned(e))return!1;const t=this.fileSystem,n=[],i=[];return r(this._configOptions.stubPath),r(e.root),e.extraPaths.forEach((e=>r(e))),r(this.getTypeshedPathEx(e,n)),this.getPythonSearchPaths(n).forEach((e=>r(e))),this.fileSystem.processPartialStubPackages(i,this.getImportRoots(e)),this._invalidateFileSystemCache(),!0;function r(e){e&&!t.isPathScanned(e)&&i.push(e)}}addResultsToCache(e,t,n,i){return h(this._cachedImportResults,e.root,(()=>new Map)).set(t,n),this.filterImplicitImports(n,i)}resolveAbsoluteImport(e,t,n,i,r,s=!1,o=!1,a=!1,l=!0,c=!1){if(l&&a){const o=this._resolveAbsoluteImport(e,t,n,i,r,s,!1,!0,!0,!0);if(o.packageDirectory&&(!o.isNamespacePackage||o.isImportFound))return o}return this._resolveAbsoluteImport(e,t,n,i,r,s,o,!1,l,c)}_invalidateFileSystemCache(){this._cachedEntriesForPath.clear()}_splitPath(e){const t=G(e);return t.length<=1?[e,""]:[J(t.slice(0,-1)),t[t.length-1]]}_resolveAbsoluteImport(e,t,n,i,r,s,o,a,l,c){a?r.push(`Attempting to resolve stub package using root path '${e}'`):r.push(`Attempting to resolve using root path '${e}'`);const u=[];let p,d,h,m=e,f=!1,g=!1,y=!1,_=!1,v=[];if(0===n.nameParts.length){const e="__init__",t=te(m,e+".py"),n=te(m,e+".pyi");l&&this.fileExistsCached(n)?(r.push(`Resolved import with file '${n}'`),u.push(n),y=!0):this.fileExistsCached(t)?(r.push(`Resolved import with file '${t}'`),u.push(t)):(r.push(`Partially resolved import with directory '${m}'`),u.push(""),f=!0),v=this._findImplicitImports(i,m,[t,n])}else for(let e=0;e<n.nameParts.length;e++){const s=0===e,h=e===n.nameParts.length-1;m=te(m,n.nameParts[e]),a&&s&&(m+=b,g=!0);const T=this.dirExistsCached(m);if(T){s&&(p=m);const e="__init__",t=te(m,e+".py"),i=te(m,e+".pyi");let o=!1;if(l&&this.fileExistsCached(i)?(r.push(`Resolved import with file '${i}'`),u.push(i),h&&(y=!0),o=!0):this.fileExistsCached(t)&&(r.push(`Resolved import with file '${t}'`),u.push(t),o=!0),o&&!d&&c&&this.fileExistsCached(te(m,"py.typed"))&&(d=Xe(this.fileSystem,m)),!h){o||(u.push(""),f=!0,d=void 0);continue}if(o){v=this._findImplicitImports(n.nameParts.join("."),m,[t,i]);break}}let I=ue(m);const S=de(I);I=$(I);const x=te(I,S+".py"),C=te(I,S+".pyi");if(l&&this.fileExistsCached(C))r.push(`Resolved import with file '${C}'`),u.push(C),h&&(y=!0);else if(this.fileExistsCached(x))r.push(`Resolved import with file '${x}'`),u.push(x);else{if(o&&this.dirExistsCached(I)){const e=this._getFilesInDirectory(I).find((e=>this._isNativeModuleFileName(S,e)));if(e){const s=te(I,e);_=this._resolveNativeModuleStub(s,t,i,n,r,u)}}!_&&T?(r.push(`Partially resolved import with directory '${m}'`),u.push(""),h&&(v=this._findImplicitImports(i,m,[x,C]),f=!0)):_&&r.push(`Did not find file '${C}' or '${x}'`)}break}const T=u.length>0&&u.length<n.nameParts.length;return h=s?u.length>0:u.length>=n.nameParts.length,{importName:i,isRelative:!1,isNamespacePackage:f,isStubPackage:g,isImportFound:h,isPartlyResolved:T,importFailureInfo:r,importType:2,resolvedPaths:u,searchPath:e,isStubFile:y,isNativeLib:_,implicitImports:v,pyTypedInfo:d,filteredImplicitImports:v,packageDirectory:p}}getTypeshedPathEx(e,t){}resolveImportEx(e,t,n,i,r=[],s=!0){}resolveNativeImportEx(e,t,n=[]){}getNativeModuleName(e){const t=pe(e,!1).toLowerCase();if(this._isNativeModuleFileExtension(t))return he(he(e))}_lookUpResultsInCache(e,t,n){const i=this._cachedImportResults.get(e.root);if(!i)return;const r=i.get(t);return r?this.filterImplicitImports(r,n):void 0}_isNamespacePackageResolved(e,t){if(e.importedSymbols){if(!e.importedSymbols.some((e=>t.some((t=>t.name===e)))))return!1}else if(0===t.length)return!1;return!0}getModuleNameFromPath(e,t,n=!1){e=le(e);let i=he(t);if(this._isNativeModuleFileExtension(pe(t))&&(i=he(i)),!i.startsWith(e))return;i.endsWith("__init__")&&(i=i.substr(0,i.length-9));const r=G(i.substr(e.length));if(r.shift(),n){if(0===r.length)return;r.shift()}return 0===r.length||(r[0].endsWith(b)&&(r[0]=r[0].substr(0,r[0].length-b.length)),r.some((e=>!this._isIdentifier(e))))?void 0:r.join(".")}_resolveBestAbsoluteImport(e,t,n,i){const r=this.formatImportName(n),s=[];if(i&&this._configOptions.stubPath){s.push(`Looking in stubPath '${this._configOptions.stubPath}'`);const e=this.resolveAbsoluteImport(this._configOptions.stubPath,t,n,r,s,void 0,!1,!0,i,!1);if(e.isImportFound)return e.importType=2,e.isLocalTypingsFile=!0,e}let o,a;t.root&&(s.push(`Looking in root directory of execution environment '${t.root}'`),a=this.resolveAbsoluteImport(t.root,t,n,r,s,void 0,!0,!0,i,!1),o=a);for(const e of t.extraPaths)s.push(`Looking in extraPath '${e}'`),a=this.resolveAbsoluteImport(e,t,n,r,s,void 0,!0,!0,i,!1),o=this._pickBestImport(o,a,n);const l=this.getPythonSearchPaths(s);if(l.length>0)for(const e of l){s.push(`Looking in python search path '${e}'`);const a=this.resolveAbsoluteImport(e,t,n,r,s,!1,!0,!0,i,!0);if(a){if(a.importType=1,a.isImportFound&&a.isStubFile)return a;o=this._pickBestImport(o,a,n)}}else s.push("No python interpreter search path");if(t.root!==this._getTypeshedRoot(t,s)&&(null==o?void 0:o.pyTypedInfo)&&!o.isPartlyResolved)return o;const c=this.resolveImportEx(e,t,n,r,s,i);if(c)return c;if(i&&n.nameParts.length>0){s.push("Looking for typeshed stdlib path");const e=this._findTypeshedPath(t,n,r,!0,s);if(e)return e.isTypeshedFile=!0,e;s.push("Looking for typeshed third-party path");const i=this._findTypeshedPath(t,n,r,!1,s);i&&(i.isTypeshedFile=!0,o=this._pickBestImport(o,i,n))}return o}_pickBestImport(e,t,n){if(!e)return t;if(!t)return e;if(t.isImportFound){if(!e.isImportFound)return t;if(e.isNamespacePackage&&!t.isNamespacePackage)return t;if(2===e.importType&&!e.isNamespacePackage)return e;if(e.isNamespacePackage&&t.isNamespacePackage&&n.importedSymbols&&!this._isNamespacePackageResolved(n,e.implicitImports)&&this._isNamespacePackageResolved(n,t.implicitImports))return t;if(e.pyTypedInfo&&!t.pyTypedInfo)return e;if(!e.pyTypedInfo&&t.pyTypedInfo)return t;if(e.isStubFile&&!t.isStubFile)return e;if(!e.isStubFile&&t.isStubFile)return t;if(e.resolvedPaths.length>t.resolvedPaths.length)return t}else if(t.isPartlyResolved&&e.isNamespacePackage&&!t.isNamespacePackage)return t;return e}_isIdentifier(e){for(let t=0;t<e.length;t++)if(0===t?!qe(e.charCodeAt(t)):!Ve(e.charCodeAt(t)))return!1;return!0}getPythonSearchPaths(e){if(!this._cachedPythonSearchPaths){const t=(fn(this.fileSystem,this._configOptions,this.host,e)||[]).map((e=>this.fileSystem.realCasePath(e)));this._cachedPythonSearchPaths=[...new Set(t)]}return this._cachedPythonSearchPaths}_findTypeshedPath(e,t,n,i,r){let s;if(r.push(`Looking for typeshed ${i?hn:mn} path`),i){const n=this._getStdlibTypeshedPath(e,r,t);n&&(s=[n])}else s=this._getThirdPartyTypeshedPackagePaths(t,e,r);if(s)for(const o of s)if(this.dirExistsCached(o)){const s=this.resolveAbsoluteImport(o,e,t,n,r);if(s.isImportFound)return s.importType=i?0:1,s}r.push("Typeshed path not found")}_buildTypeshedThirdPartyPackageMap(e){this._cachedTypeshedThirdPartyPackagePaths=new Map,e&&this.readdirEntriesCached(e).forEach((t=>{if(t.isDirectory()){const n=te(e,t.name);this.readdirEntriesCached(n).forEach((e=>{if("@python2"!==e.name)if(e.isDirectory()){const t=this._cachedTypeshedThirdPartyPackagePaths.get(e.name);t?t.push(n):this._cachedTypeshedThirdPartyPackagePaths.set(e.name,[n])}else if(e.isFile()&&e.name.endsWith(".pyi")){const t=he(e.name),i=this._cachedTypeshedThirdPartyPackagePaths.get(t);i?i.push(n):this._cachedTypeshedThirdPartyPackagePaths.set(t,[n])}}))}})),this._cachedTypeshedThirdPartyPackageRoots=[...new Set(...this._cachedTypeshedThirdPartyPackagePaths.values())].sort()}_getCompletionSuggestionsTypeshedPath(e,t,n,i,r){const s=[];let o;if(i){const e=this._getStdlibTypeshedPath(t,s,n);e&&(o=[e])}else{o=this._getThirdPartyTypeshedPackagePaths(n,t,s,!1);const e=this.getTypeshedPathEx(t,s);e&&(o=null!=o?o:[],o.push(e))}o&&o.forEach((i=>{this.dirExistsCached(i)&&this._getCompletionSuggestionsAbsolute(e,t,i,n,r)}))}_getStdlibTypeshedPath(e,t,n){const i=this._getTypeshedSubdirectory(!0,e,t);if(!i||!n||this._isStdlibTypeshedStubValidForVersion(n,e,t))return i}_getThirdPartyTypeshedPath(e,t){return this._getTypeshedSubdirectory(!1,e,t)}_isStdlibTypeshedStubValidForVersion(e,t,n){this._cachedTypeshedStdLibModuleVersions||(this._cachedTypeshedStdLibModuleVersions=this._readTypeshedStdLibVersions(t,n));for(let n=1;n<=e.nameParts.length;n++){const i=e.nameParts.slice(0,n),r=this._cachedTypeshedStdLibModuleVersions.get(i.join("."));if(r){if(t.pythonVersion<r.min)return!1;if(void 0!==r.max&&t.pythonVersion>r.max)return!1}}return!0}_readTypeshedStdLibVersions(e,t){const n=new Map,i=this._getTypeshedSubdirectory(!0,e,t);if(i){const e=te(i,"VERSIONS");try{const i=this.fileSystem.statSync(e);i.size>0&&i.size<262144?this.fileSystem.readFileSync(e,"utf8").split(/\r?\n/).forEach((e=>{const t=e.split("#")[0].split(":");if(2!==t.length)return;const i=t[1].split("-");if(i.length>2)return;const r=t[0].trim();if(!r)return;let s=i[0].trim();s.endsWith("+")&&(s=s.substr(0,s.length-1));let o,a=Re(s);a||(a=De.V3_0),i.length>1&&(o=Re(i[1].trim())),n.set(r,{min:a,max:o})})):t.push("Typeshed stdlib VERSIONS file is unexpectedly large")}catch(e){t.push(`Could not read typeshed stdlib VERSIONS file: '${JSON.stringify(e)}'`)}}return n}_getThirdPartyTypeshedPackagePaths(e,t,n,i=!0){const r=this._getThirdPartyTypeshedPath(t,n);this._cachedTypeshedThirdPartyPackagePaths||this._buildTypeshedThirdPartyPackageMap(r);const s=e.nameParts.length>0?e.nameParts[0]:"";return i?this._cachedTypeshedThirdPartyPackagePaths.get(s):s?function(e){const t=[];for(const i of e)i&&(n=i,(Array.isArray?Array.isArray(n):n instanceof Array)?c(t,i):t.push(i));var n;return t}(function(e,t){const n=[];return e.forEach(((e,t)=>{(e=>e.startsWith(s))(t)&&n.push(e)})),n}(this._cachedTypeshedThirdPartyPackagePaths)):[]}_getThirdPartyTypeshedPackageRoots(e,t){const n=this._getThirdPartyTypeshedPath(e,t);return this._cachedTypeshedThirdPartyPackagePaths||this._buildTypeshedThirdPartyPackageMap(n),this._cachedTypeshedThirdPartyPackageRoots}_getTypeshedRoot(e,t){if(void 0!==this._cachedTypeshedRoot)return this._cachedTypeshedRoot;let n="";if(this._configOptions.typeshedPath){const e=this._configOptions.typeshedPath;this.dirExistsCached(e)&&(n=e)}else{const e=this.getPythonSearchPaths(t);for(const t of e){const e=te(t,"typeshed");if(this.dirExistsCached(e)){n=e;break}}}return n||(n=function(e){let t=e.getModulePath();if(!t)return;t=$(le(me(t)));const n=te(t,g);if(e.existsSync(n))return n;const i=te($(t),g);return e.existsSync(i)?i:void 0}(this.fileSystem)||""),this._cachedTypeshedRoot=n,n}_getTypeshedSubdirectory(e,t,n){if(e){if(void 0!==this._cachedTypeshedStdLibPath)return this._cachedTypeshedStdLibPath}else if(void 0!==this._cachedTypeshedThirdPartyPath)return this._cachedTypeshedThirdPartyPath;let i=this._getTypeshedRoot(t,n);if(i=function(e,t){return te(e,t?hn:mn)}(i,e),this.dirExistsCached(i))return e?this._cachedTypeshedStdLibPath=i:this._cachedTypeshedThirdPartyPath=i,i}_resolveRelativeImport(e,t,n,i,r){r.push("Attempting to resolve relative import");const s=pn($(e),n.leadingDots);if(!s)return void r.push(`Invalid relative path '${i}'`);const o=this.resolveAbsoluteImport(s,t,n,i,r,!1,!0);return this.filterImplicitImports(o,n.importedSymbols)}_getCompletionSuggestionsRelative(e,t,n,i){const r=pn($(e),n.leadingDots);r&&this._getCompletionSuggestionsAbsolute(e,t,r,n,i)}_getFilesInDirectory(e){const t=this.readdirEntriesCached(e),n=t.filter((e=>e.isFile())).map((e=>e.name));return t.forEach((t=>{var i;const r=te(e,t.name);t.isSymbolicLink()&&(null===(i=ye(this.fileSystem,r))||void 0===i?void 0:i.isFile())&&n.push(t.name)})),n}_getCompletionSuggestionsAbsolute(e,t,n,i,r,s=!0){let o=n;const a=i.nameParts.map((e=>e));i.hasTrailingDot&&a.push("");const l=i.leadingDots,c=a.slice(0,-1);if(0===a.length)this._addFilteredSuggestionsAbsolute(e,t,o,"",r,l,c,s);else for(let n=0;n<a.length&&(n===a.length-1&&this._addFilteredSuggestionsAbsolute(e,t,o,a[n],r,l,c,s),o=te(o,a[n]),this.dirExistsCached(o));n++);}_addFilteredSuggestionsAbsolute(e,t,n,i,r,s,o,a){const l=Te(this.readdirEntriesCached(n),this.fileSystem,n);l.files.forEach((n=>{const l=pe(n,!1).toLowerCase(),c=he(n,!0);if(bn.some((e=>e===l))){if("__init__"===c)return;if(i&&!N(i,c))return;if(!this._isUniqueValidSuggestion(c,r)||!this._isResolvableSuggestion(c,s,o,e,t,a))return;r.add(c)}})),l.directories.forEach((n=>{i&&!n.startsWith(i)||this._isUniqueValidSuggestion(n,r)&&this._isResolvableSuggestion(n,s,o,e,t,a)&&r.add(n)}))}_isResolvableSuggestion(e,t,n,i,r,s){const o={leadingDots:t,nameParts:[...n,e],importedSymbols:[]};if(s){const e=this.formatImportName(o),t=[];return this._resolveImportStrict(e,i,r,o,t).isImportFound}return this._resolveImport(i,r,o).isImportFound}_isUniqueValidSuggestion(e,t){return!(t.has(e)||/[.-]/.test(e)||Qt(e)&&"__future__"!==e)}filterImplicitImports(e,t){if(void 0===t){const t=Object.assign({},e);return t.filteredImplicitImports=[],t}if(0===t.length)return e;if(0===e.implicitImports.length)return e;const n=e.implicitImports.filter((e=>t.some((t=>t===e.name))));if(n.length===e.implicitImports.length)return e;const i=Object.assign({},e);return i.filteredImplicitImports=n,i}_findImplicitImports(e,t,n){const i=new Map,r=Te(this.readdirEntriesCached(t),this.fileSystem,t);for(const s of r.files){const r=pe(s);let o,a=!1;if(".py"===r||".pyi"===r)o=he(s);else{if(!this._isNativeModuleFileExtension(r)||this.fileExistsCached(`${s}.py`)||this.fileExistsCached(`${s}.pyi`))continue;o=s.substr(0,s.indexOf(".")),a=!0}const l=te(t,s);if(!n.find((e=>e===l))){const n={isStubFile:s.endsWith(".pyi"),isNativeLib:a,name:o,path:l},r=i.get(n.name);if(!r||!r.isStubFile){if(a){const i=te(t,s),r=this.resolveNativeImportEx(i,`${e}.${o}`,[]);r&&(n.path=r,n.isNativeLib=!1)}i.set(n.name,n)}}}for(const e of r.directories){const r=te(t,e,"__init__.py"),s=r+"i";let o=!1,a="";if(this.fileExistsCached(s)?(o=!0,a=s):this.fileExistsCached(r)&&(a=r),a&&!n.find((e=>e===a))){const t={isStubFile:o,isNativeLib:!1,name:e,path:a};i.set(t.name,t)}}return[...i.values()]}formatImportName(e){return".".repeat(e.leadingDots)+e.nameParts.join(".")}_resolveNativeModuleStub(e,t,n,i,r,s){let o=n;if(i.leadingDots>0){const n=this.getModuleNameForImport(e,t);o=n.moduleName.length>0?n.moduleName:o}const a=this.resolveNativeImportEx(e,o,r);return a?(r.push(`Resolved native import ${n} with stub '${a}'`),s.push(a),!1):(r.push(`Resolved import with file '${e}'`),s.push(e),!0)}_isNativeModuleFileName(e,t){const n=pe(t,!1).toLowerCase(),i=he(t,!0);return this._isNativeModuleFileExtension(n)&&q(e,i)}_isNativeModuleFileExtension(e){return Tn.some((t=>t===e))}_tryWalkUp(e){return Se(e)?[!1,""]:[!0,le(ke(this.fileSystem,me(te(e,".."))))]}_shouldWalkUp(e,t,n){return e.length>t.length||e===t&&!n.root}getParentImportResolutionRoot(e,t){return le(t?ke(this.fileSystem,me(t)):$(e))}}const Sn=new(__webpack_require__(2477).ProtocolRequestType)("pyright/apidocs");let xn;function Cn(e){xn=e}function wn(){if(!xn)throw new Error("Host must be initialized");return xn}function En(){return wn().createMessageChannel()}function kn(){return wn().parentPort()}function Dn(){return wn().threadId()}function An(e,t){if(Array.isArray(e))return e.map(t);if(n=e,"[object Object]"===Object.prototype.toString.call(n)){const n=Object.create(null);return Object.entries(e).forEach((([e,i])=>{n[e]=t(i)})),n}var n;return t(e)}class Pn{constructor(){this._startTime=Date.now()}getDurationInMilliseconds(){return Date.now()-this._startTime}getDurationInSeconds(){return this.getDurationInMilliseconds()/1e3}}class Rn{constructor(){this.totalTime=0,this.callCount=0,this.isTiming=!1}timeOperation(e){if(this.callCount++,this.isTiming)return e();{this.isTiming=!0;const t=new Pn,n=e();return this.totalTime+=t.getDurationInMilliseconds(),this.isTiming=!1,n}}subtractFromTime(e){if(this.isTiming){this.isTiming=!1;const t=new Pn;e(),this.totalTime-=t.getDurationInMilliseconds(),this.isTiming=!0}else e()}printTime(){const e=this.totalTime/1e3;return(Math.round(100*e)/100).toString()+"sec"}}const Fn=new class{constructor(){this.totalDuration=new Pn,this.findFilesTime=new Rn,this.readFileTime=new Rn,this.tokenizeFileTime=new Rn,this.parseFileTime=new Rn,this.resolveImportsTime=new Rn,this.cycleDetectionTime=new Rn,this.bindTime=new Rn,this.typeCheckerTime=new Rn,this.typeEvaluationTime=new Rn}printSummary(e){e.info(`Completed in ${this.totalDuration.getDurationInSeconds()}sec`)}printDetails(e){e.info(""),e.info("Timing stats"),e.info("Find Source Files:    "+this.findFilesTime.printTime()),e.info("Read Source Files:    "+this.readFileTime.printTime()),e.info("Tokenize:             "+this.tokenizeFileTime.printTime()),e.info("Parse:                "+this.parseFileTime.printTime()),e.info("Resolve Imports:      "+this.resolveImportsTime.printTime()),e.info("Bind:                 "+this.bindTime.printTime()),e.info("Check:                "+this.typeCheckerTime.printTime()),e.info("Detect Cycles:        "+this.cycleDetectionTime.printTime())}getTotalDuration(){return this.totalDuration.getDurationInSeconds()}},Nn=e=>{};function Mn(e,t,n,i,r,s){let o=!1;i=null!=i?i:Nn;try{ct(s);const r=new Pn;o=e.analyze(t,s);const a=e.getFilesToAnalyzeCount(),l=e.getDiagnostics(n),c=l.length,u=r.getDurationInSeconds();(c>0||!o)&&i({diagnostics:l,filesInProgram:e.getFileCount(),filesRequiringAnalysis:a,checkingOnlyOpenFiles:e.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:u})}catch(e){if(lt.is(e))return!1;const t=((a=e).stack?a.stack.toString():void 0)||("string"==typeof a.message?a.message:void 0)||JSON.stringify(a);r.error("Error performing analysis: "+t),i({diagnostics:[],filesInProgram:0,filesRequiringAnalysis:0,checkingOnlyOpenFiles:!0,fatalErrorOccurred:!0,configParseErrorOccurred:!1,elapsedTime:0,error:D(e)})}var a;return o}var On,Ln=__webpack_require__(5269);!function(e){e.Error="error",e.Warn="warn",e.Info="info",e.Log="log"}(On||(On={}));class Un{log(e){console.info(e)}info(e){console.info(e)}warn(e){console.warn(e)}error(e){console.error(e)}}class qn{constructor(e,t=""){this._console=e,this._name=t,this._levelMap=new Map([[On.Error,0],[On.Warn,1],[On.Info,2],[On.Log,3]]),this._maxLevel=2}get level(){switch(this._maxLevel){case 0:return On.Error;case 1:return On.Warn;case 2:return On.Info}return On.Log}set level(e){let t=this._levelMap.get(e);void 0===t&&(t=this._levelMap.get(On.Info)),this._maxLevel=t}error(e){this._log(On.Error,`${this._prefix}${e}`)}warn(e){this._log(On.Warn,`${this._prefix}${e}`)}info(e){this._log(On.Info,`${this._prefix}${e}`)}log(e){this._log(On.Log,`${this._prefix}${e}`)}get _prefix(){return this._name?`(${this._name}) `:""}_log(e,t){this._getNumericalLevel(e)>this._maxLevel||Vn(this._console,e,t)}_getNumericalLevel(e){const t=this._levelMap.get(e);return w(void 0!==t,"Logger: unknown log level."),void 0!==t?t:2}}function Vn(e,t,n){switch(t){case On.Log:e.log(n);break;case On.Info:e.info(n);break;case On.Warn:e.warn(n);break;case On.Error:e.error(n);break;default:E(`${t} is not expected`)}}class Bn{constructor(e,t){this._console=e,this._prefix=t,this._dummyState=new Wn,this._indentation="",this._previousTitles=[]}log(e,t,n=-1,i=!1){if(void 0===this._console)return t(this._dummyState);const r=this._console.level;if(void 0===r||r!==On.Log&&r!==On.Info)return t(this._dummyState);const s=this._indentation;this._previousTitles.push(`${s}${e} ...`),this._indentation+="  ";const o=new Wn;try{return t(o)}finally{const t=o.duration;if(this._indentation=s,this._previousTitles.length>0&&(o.isSuppressed()||t<=n))this._previousTitles.pop();else{this._printPreviousTitles();let n=`[${this._prefix}] ${this._indentation}${e}${o.get()} (${t}ms)`;i&&o.fileReadTotal+o.tokenizeTotal+o.parsingTotal+o.resolveImportsTotal+o.bindingTotal>0&&(n+=` [f:${o.fileReadTotal}, t:${o.tokenizeTotal}, p:${o.parsingTotal}, i:${o.resolveImportsTotal}, b:${o.bindingTotal}]`),this._console.log(n),t>=2e3&&this._console.info(`[${this._prefix}] Long operation: ${e} (${t}ms)`)}}}_printPreviousTitles(){if(this._previousTitles.pop(),!(this._previousTitles.length<=0)){for(const e of this._previousTitles)this._console.log(`[${this._prefix}] ${e}`);this._previousTitles.length=0}}}class Wn{constructor(){this._start=new Pn,this._startFile=Fn.readFileTime.totalTime,this._startToken=Fn.tokenizeFileTime.totalTime,this._startParse=Fn.parseFileTime.totalTime,this._startImport=Fn.resolveImportsTime.totalTime,this._startBind=Fn.bindTime.totalTime}get duration(){return this._start.getDurationInMilliseconds()}get fileReadTotal(){return Fn.readFileTime.totalTime-this._startFile}get tokenizeTotal(){return Fn.tokenizeFileTime.totalTime-this._startToken}get parsingTotal(){return Fn.parseFileTime.totalTime-this._startParse}get resolveImportsTotal(){return Fn.resolveImportsTime.totalTime-this._startImport}get bindingTotal(){return Fn.bindTime.totalTime-this._startBind}add(e){e&&(this._addendum=e)}get(){return this._addendum?` [${this._addendum}]`:""}suppress(){this._suppress=!0}isSuppressed(){return!!this._suppress}}function jn(e){return 3===e.type}function zn(e){return 4===e.type}function $n(e){return 2===e.type}function Hn(e){return 1===e.type}function Gn(e){return 6===e.type}let Kn=1;function Jn(e,t){t.start<e.start&&(e.length+=e.start-t.start,e.start=t.start),dt.getEnd(t)>dt.getEnd(e)&&(e.length=dt.getEnd(t)-e.start)}var Yn,Qn,Zn,Xn,ei,ti,ni,ii,ri,si,oi,ai,li,ci,ui,pi,di,hi,mi,fi,gi,yi,_i,vi,Ti,bi,Ii,Si,xi,Ci,wi,Ei,ki,Di,Ai,Pi,Ri,Fi,Ni,Mi,Oi,Li,Ui,qi,Vi,Bi,Wi,ji,zi,$i,Hi,Gi,Ki,Ji,Yi,Qi,Zi,Xi,er,tr,nr,ir,rr,sr,or,ar,lr,cr,ur,pr,dr,hr,mr,fr,gr;function yr(e){switch(e.nodeType){case 0:case 55:case 7:case 4:case 54:case 6:case 51:case 56:case 52:case 9:case 32:case 24:case 46:case 60:case 61:case 35:case 30:case 38:case 11:case 18:case 40:case 49:case 27:case 48:case 15:case 16:case 31:case 45:return!0;default:return!1}}!function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:36,id:Kn++,statements:[]}}}(Yn||(Yn={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:50,id:Kn++,statements:[]}}}(Qn||(Qn={})),function(e){e.create=function(e,t,n,i){const r={start:e.start,length:e.length,nodeType:19,id:Kn++,testExpression:t,ifSuite:n,elseSuite:i};return t.parent=r,n.parent=r,Jn(r,t),Jn(r,n),i&&(Jn(r,i),i.parent=r),r}}(Zn||(Zn={})),function(e){e.create=function(e,t,n){const i={start:e.start,length:e.length,nodeType:57,id:Kn++,testExpression:t,whileSuite:n};return t.parent=i,n.parent=i,Jn(i,n),i}}(Xn||(Xn={})),function(e){e.create=function(e,t,n,i){const r={start:e.start,length:e.length,nodeType:26,id:Kn++,targetExpression:t,iterableExpression:n,forSuite:i};return t.parent=r,n.parent=r,i.parent=r,Jn(r,i),r}}(ei||(ei={})),function(e){e.create=function(e,t,n){const i={start:e.start,length:e.length,nodeType:33,id:Kn++,targetExpression:t,iterableExpression:n};return t.parent=i,n.parent=i,Jn(i,t),Jn(i,n),i}}(ti||(ti={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:34,id:Kn++,testExpression:t};return t.parent=n,Jn(n,t),n}}(ni||(ni={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:53,id:Kn++,trySuite:t,exceptClauses:[]};return t.parent=n,Jn(n,t),n}}(ii||(ii={})),function(e){e.create=function(e,t,n){const i={start:e.start,length:e.length,nodeType:25,id:Kn++,exceptSuite:t,isExceptGroup:n};return t.parent=i,Jn(i,t),i}}(ri||(ri={})),function(e){e.create=function(e,t,n){const i={start:e.start,length:e.length,nodeType:28,id:Kn++,decorators:[],name:t,parameters:[],suite:n};return t.parent=i,n.parent=i,Jn(i,n),i}}(si||(si={})),function(e){e.create=function(e,t){return{start:e.start,length:e.length,nodeType:41,id:Kn++,category:t}}}(oi||(oi={})),function(e){e.create=function(e,t,n){const i={start:e.start,length:e.length,nodeType:10,id:Kn++,decorators:[],name:t,arguments:[],suite:n};return t.parent=i,n.parent=i,Jn(i,n),i},e.createDummyForDecorators=function(e){const t={start:e[0].start,length:0,nodeType:10,id:Kn++,decorators:e,name:{start:e[0].start,length:0,id:0,nodeType:38,token:{type:7,start:0,length:0,comments:[],value:""},value:""},arguments:[],suite:{start:e[0].start,length:0,id:0,nodeType:50,statements:[]}};return e.forEach((e=>{e.parent=t,Jn(t,e)})),t.name.parent=t,t.suite.parent=t,t}}(ai||(ai={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:58,id:Kn++,withItems:[],suite:t};return t.parent=n,Jn(n,t),n}}(li||(li={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:59,id:Kn++,expression:e};return e.parent=t,t}}(ci||(ci={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:13,id:Kn++,expression:t};return t.parent=n,Jn(n,t),n}}(ui||(ui={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:47,id:Kn++,statements:[]}}}(pi||(pi={})),function(e){e.create=function(e,t,n,i){const r={start:e.start,length:e.length,nodeType:0,id:Kn++,category:t,child:n,decorators:i};return n&&(n.parent=r,Jn(r,n)),i&&(i.forEach((e=>{e.parent=r})),i.length>0&&Jn(r,i[0])),r}}(di||(di={})),function(e){e.create=function(e,t,n){var i;const r={start:e.start,length:e.length,nodeType:55,id:Kn++,operator:n,operatorToken:e,expression:t};return t.parent=r,r.maxChildDepth=1+(null!==(i=t.maxChildDepth)&&void 0!==i?i:0),Jn(r,t),r}}(hi||(hi={})),function(e){e.create=function(e,t,n,i){var r,s;const o={start:e.start,length:e.length,nodeType:7,id:Kn++,leftExpression:e,operatorToken:n,operator:i,rightExpression:t};return e.parent=o,t.parent=o,o.maxChildDepth=1+Math.max(null!==(r=e.maxChildDepth)&&void 0!==r?r:0,null!==(s=t.maxChildDepth)&&void 0!==s?s:0),Jn(o,t),o}}(mi||(mi={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:4,id:Kn++,name:e,rightExpression:t};return e.parent=n,t.parent=n,Jn(n,t),n}}(fi||(fi={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:3,id:Kn++,leftExpression:e,rightExpression:t};return e.parent=n,t.parent=n,Jn(n,t),n}}(gi||(gi={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:54,id:Kn++,valueExpression:e,typeAnnotation:t};return e.parent=n,t.parent=n,Jn(n,t),n}}(yi||(yi={})),function(e){e.create=function(e,t,n,i){const r={start:e.start,length:e.length,nodeType:62,id:Kn++,isParamListEllipsis:t,paramTypeAnnotations:n,returnTypeAnnotation:i};return n.forEach((e=>{e.parent=r})),i.parent=r,Jn(r,i),r}}(_i||(_i={})),function(e){e.create=function(e,t,n,i){const r={start:e.start,length:e.length,nodeType:5,id:Kn++,leftExpression:e,operator:n,rightExpression:t,destExpression:i};return e.parent=r,t.parent=r,i.parent=r,Jn(r,t),r}}(vi||(vi={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:6,id:Kn++,expression:t};return t.parent=n,Jn(n,t),n}}(Ti||(Ti={})),function(e){e.create=function(e,t,n){const i={start:e.start,length:e.length,nodeType:51,id:Kn++,ifExpression:e,testExpression:t,elseExpression:n};return e.parent=i,t.parent=i,n.parent=i,Jn(i,n),i}}(bi||(bi={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:56,id:Kn++,expression:t};return t.parent=n,Jn(n,t),n}}(Ii||(Ii={})),function(e){e.create=function(e,t){return{start:e.start,length:e.length,nodeType:52,id:Kn++,expressions:[],enclosedInParens:t}}}(Si||(Si={})),function(e){e.create=function(e,t,n){var i;const r={start:e.start,length:e.length,nodeType:9,id:Kn++,leftExpression:e,arguments:t,trailingComma:n};return e.parent=r,r.maxChildDepth=1+(null!==(i=e.maxChildDepth)&&void 0!==i?i:0),t.length>0&&(t.forEach((e=>{e.parent=r})),Jn(r,t[t.length-1])),r}}(xi||(xi={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:32,id:Kn++,expression:e,forIfNodes:[]};return e.parent=t,t}}(Ci||(Ci={})),function(e){e.create=function(e,t,n,i){var r;const s={start:e.start,length:e.length,nodeType:24,id:Kn++,baseExpression:e,items:t,trailingComma:n};return e.parent=s,t.forEach((e=>{e.parent=s})),Jn(s,i),s.maxChildDepth=1+(null!==(r=e.maxChildDepth)&&void 0!==r?r:0),s}}(wi||(wi={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:46,id:Kn++}}}(Ei||(Ei={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:60,id:Kn++,expression:t};return t&&(t.parent=n,Jn(n,t)),n}}(ki||(ki={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:61,id:Kn++,expression:t};return t.parent=n,Jn(n,t),n}}(Di||(Di={})),function(e){e.create=function(e,t){var n;const i={start:e.start,length:e.length,nodeType:35,id:Kn++,leftExpression:e,memberName:t};return e.parent=i,t.parent=i,Jn(i,t),i.maxChildDepth=1+(null!==(n=e.maxChildDepth)&&void 0!==n?n:0),i}}(Ai||(Ai={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:30,id:Kn++,parameters:[],expression:t};return t.parent=n,Jn(n,t),n}}(Pi||(Pi={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:38,id:Kn++,token:e,value:e.value}}}(Ri||(Ri={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:11,id:Kn++,constType:e.keywordType}}}(Fi||(Fi={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:18,id:Kn++}}}(Ni||(Ni={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:40,id:Kn++,value:e.value,isInteger:e.isInteger,isImaginary:e.isImaginary}}}(Mi||(Mi={})),function(e){e.create=function(e,t,n){return{start:e.start,length:e.length,nodeType:49,id:Kn++,token:e,value:t,hasUnescapeErrors:n}}}(Oi||(Oi={})),function(e){e.create=function(e,t,n,i){const r={start:e.start,length:e.length,nodeType:27,id:Kn++,token:e,value:t,hasUnescapeErrors:n,expressions:i};return i.forEach((e=>{e.parent=r})),r}}(Li||(Li={})),function(e){e.create=function(e){const t={start:e[0].start,length:e[0].length,nodeType:48,id:Kn++,strings:e};return e.length>0&&(e.forEach((e=>{e.parent=t})),Jn(t,e[e.length-1])),t}}(Ui||(Ui={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:15,id:Kn++,entries:[]}}}(qi||(qi={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:17,id:Kn++,keyExpression:e,valueExpression:t};return e.parent=n,t.parent=n,Jn(n,t),n}}(Vi||(Vi={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:16,id:Kn++,expandExpression:e};return e.parent=t,t}}(Bi||(Bi={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:45,id:Kn++,entries:[]}}}(Wi||(Wi={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:31,id:Kn++,entries:[]}}}(ji||(ji={})),function(e){e.create=function(e,t,n){const i={start:e?e.start:t.start,length:e?e.length:t.length,nodeType:1,id:Kn++,valueExpression:t,argumentCategory:n};return t.parent=i,Jn(i,t),i}}(zi||(zi={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:14,id:Kn++,expressions:[]}}}($i||($i={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:42,id:Kn++}}}(Hi||(Hi={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:20,id:Kn++,list:[]}}}(Gi||(Gi={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:37,id:Kn++,leadingDots:0,nameParts:[]}}}(Ki||(Ki={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:21,id:Kn++,module:e};return e.parent=t,t}}(Ji||(Ji={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:22,id:Kn++,module:t,imports:[],isWildcardImport:!1,usesParens:!1};return t.parent=n,Jn(n,t),n}}(Yi||(Yi={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:23,id:Kn++,name:e};return e.parent=t,t}}(Qi||(Qi={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:29,id:Kn++,nameList:[]}}}(Zi||(Zi={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:39,id:Kn++,nameList:[]}}}(Xi||(Xi={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:2,id:Kn++,testExpression:t};return t.parent=n,Jn(n,t),n}}(er||(er={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:8,id:Kn++}}}(tr||(tr={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:12,id:Kn++}}}(nr||(nr={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:44,id:Kn++}}}(ir||(ir={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:43,id:Kn++}}}(rr||(rr={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:63,id:Kn++,subjectExpression:t,cases:[]};return t.parent=n,Jn(n,t),n}}(sr||(sr={})),function(e){e.create=function(e,t,n,i,r){const s={start:e.start,length:e.length,nodeType:64,id:Kn++,pattern:t,isIrrefutable:n,guardExpression:i,suite:r};return Jn(s,r),t.parent=s,r.parent=s,i&&(i.parent=s),s}}(or||(or={})),function(e){e.create=function(e,t){const n=t.findIndex((e=>1===e.orPatterns.length&&69===e.orPatterns[0].nodeType&&e.orPatterns[0].isStar)),i={start:e.start,length:e.length,nodeType:65,id:Kn++,entries:t,starEntryIndex:n>=0?n:void 0};return t.length>0&&Jn(i,t[t.length-1]),t.forEach((e=>{e.parent=i})),i}}(ar||(ar={})),function(e){e.create=function(e,t){const n={start:e[0].start,length:e[0].length,nodeType:66,id:Kn++,orPatterns:e,target:t};return e.length>1&&Jn(n,e[e.length-1]),e.forEach((e=>{e.parent=n})),t&&(Jn(n,t),t.parent=n),n}}(lr||(lr={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:67,id:Kn++,expression:e};return e.parent=t,t}}(cr||(cr={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:68,id:Kn++,className:e,arguments:t};return e.parent=n,t.forEach((e=>{e.parent=n})),t.length>0&&Jn(n,t[t.length-1]),n}}(ur||(ur={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:74,id:Kn++,pattern:e,name:t};return e.parent=n,t&&(Jn(n,t),t.parent=n),n}}(pr||(pr={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:69,id:Kn++,target:e,isStar:void 0!==t,isWildcard:"_"===e.value};return e.parent=n,t&&Jn(n,t),n}}(dr||(dr={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:70,id:Kn++,entries:t};return t.length>0&&Jn(n,t[t.length-1]),t.forEach((e=>{e.parent=n})),n}}(hr||(hr={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:71,id:Kn++,keyPattern:e,valuePattern:t};return e.parent=n,t.parent=n,Jn(n,t),n}}(mr||(mr={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:72,id:Kn++,target:t};return t.parent=n,Jn(n,t),n}}(fr||(fr={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:73,id:Kn++,expression:e};return e.parent=t,t}}(gr||(gr={}));class _r{walk(e){const t=this.visitNode(e);t.length>0&&this.walkMultiple(t)}walkMultiple(e){e.forEach((e=>{e&&this.walk(e)}))}visitNode(e){var t;switch(e.nodeType){case 0:if(this.visitError(e))return[e.child,...null!==(t=e.decorators)&&void 0!==t?t:[]];break;case 1:if(this.visitArgument(e))return[e.name,e.valueExpression];break;case 2:if(this.visitAssert(e))return[e.testExpression,e.exceptionExpression];break;case 3:if(this.visitAssignment(e))return[e.leftExpression,e.rightExpression,e.typeAnnotationComment];break;case 4:if(this.visitAssignmentExpression(e))return[e.name,e.rightExpression];break;case 5:if(this.visitAugmentedAssignment(e))return[e.leftExpression,e.rightExpression];break;case 6:if(this.visitAwait(e))return[e.expression];break;case 7:if(this.visitBinaryOperation(e))return[e.leftExpression,e.rightExpression];break;case 8:if(this.visitBreak(e))return[];break;case 9:if(this.visitCall(e))return[e.leftExpression,...e.arguments];break;case 10:if(this.visitClass(e))return[...e.decorators,e.name,...e.arguments,e.suite];break;case 11:if(this.visitConstant(e))return[];break;case 12:if(this.visitContinue(e))return[];break;case 13:if(this.visitDecorator(e))return[e.expression];break;case 14:if(this.visitDel(e))return e.expressions;break;case 15:if(this.visitDictionary(e))return e.entries;break;case 16:if(this.visitDictionaryExpandEntry(e))return[e.expandExpression];break;case 17:if(this.visitDictionaryKeyEntry(e))return[e.keyExpression,e.valueExpression];break;case 18:if(this.visitEllipsis(e))return[];break;case 19:if(this.visitIf(e))return[e.testExpression,e.ifSuite,e.elseSuite];break;case 20:if(this.visitImport(e))return e.list;break;case 21:if(this.visitImportAs(e))return[e.module,e.alias];break;case 22:if(this.visitImportFrom(e))return[e.module,...e.imports];break;case 23:if(this.visitImportFromAs(e))return[e.name,e.alias];break;case 24:if(this.visitIndex(e))return[e.baseExpression,...e.items];break;case 25:if(this.visitExcept(e))return[e.typeExpression,e.name,e.exceptSuite];break;case 26:if(this.visitFor(e))return[e.targetExpression,e.iterableExpression,e.forSuite,e.elseSuite];break;case 27:if(this.visitFormatString(e))return e.expressions;break;case 28:if(this.visitFunction(e))return[...e.decorators,e.name,...e.parameters,e.returnTypeAnnotation,e.functionAnnotationComment,e.suite];break;case 29:if(this.visitGlobal(e))return e.nameList;break;case 30:if(this.visitLambda(e))return[...e.parameters,e.expression];break;case 31:if(this.visitList(e))return e.entries;break;case 32:if(this.visitListComprehension(e))return[e.expression,...e.forIfNodes];break;case 33:if(this.visitListComprehensionFor(e))return[e.targetExpression,e.iterableExpression];break;case 34:if(this.visitListComprehensionIf(e))return[e.testExpression];break;case 35:if(this.visitMemberAccess(e))return[e.leftExpression,e.memberName];break;case 36:if(this.visitModule(e))return[...e.statements];break;case 37:if(this.visitModuleName(e))return e.nameParts;break;case 38:if(this.visitName(e))return[];break;case 39:if(this.visitNonlocal(e))return e.nameList;break;case 40:if(this.visitNumber(e))return[];break;case 41:if(this.visitParameter(e))return[e.name,e.typeAnnotation,e.typeAnnotationComment,e.defaultValue];break;case 42:if(this.visitPass(e))return[];break;case 43:if(this.visitRaise(e))return[e.typeExpression,e.valueExpression,e.tracebackExpression];break;case 44:if(this.visitReturn(e))return[e.returnExpression];break;case 45:if(this.visitSet(e))return e.entries;break;case 46:if(this.visitSlice(e))return[e.startValue,e.endValue,e.stepValue];break;case 47:if(this.visitStatementList(e))return e.statements;break;case 48:if(this.visitStringList(e))return[e.typeAnnotation,...e.strings];break;case 49:if(this.visitString(e))return[];break;case 50:if(this.visitSuite(e))return[...e.statements];break;case 51:if(this.visitTernary(e))return[e.ifExpression,e.testExpression,e.elseExpression];break;case 52:if(this.visitTuple(e))return e.expressions;break;case 53:if(this.visitTry(e))return[e.trySuite,...e.exceptClauses,e.elseSuite,e.finallySuite];break;case 54:if(this.visitTypeAnnotation(e))return[e.valueExpression,e.typeAnnotation];break;case 55:if(this.visitUnaryOperation(e))return[e.expression];break;case 56:if(this.visitUnpack(e))return[e.expression];break;case 57:if(this.visitWhile(e))return[e.testExpression,e.whileSuite,e.elseSuite];break;case 58:if(this.visitWith(e))return[...e.withItems,e.suite];break;case 59:if(this.visitWithItem(e))return[e.expression,e.target];break;case 60:if(this.visitYield(e))return[e.expression];break;case 61:if(this.visitYieldFrom(e))return[e.expression];break;case 62:if(this.visitFunctionAnnotation(e))return[...e.paramTypeAnnotations,e.returnTypeAnnotation];break;case 63:if(this.visitMatch(e))return[e.subjectExpression,...e.cases];break;case 64:if(this.visitCase(e))return[e.pattern,e.guardExpression,e.suite];break;case 65:if(this.visitPatternSequence(e))return[...e.entries];break;case 66:if(this.visitPatternAs(e))return[...e.orPatterns,e.target];break;case 67:if(this.visitPatternLiteral(e))return[e.expression];break;case 68:if(this.visitPatternClass(e))return[e.className,...e.arguments];break;case 69:if(this.visitPatternCapture(e))return[e.target];break;case 70:if(this.visitPatternMapping(e))return[...e.entries];break;case 71:if(this.visitPatternMappingKeyEntry(e))return[e.keyPattern,e.valuePattern];break;case 72:if(this.visitPatternMappingExpandEntry(e))return[e.target];break;case 73:if(this.visitPatternValue(e))return[e.expression];break;case 74:if(this.visitPatternClassArgument(e))return[e.name,e.pattern];break;default:E("Unexpected node type")}return[]}visitArgument(e){return!0}visitAssert(e){return!0}visitAssignment(e){return!0}visitAssignmentExpression(e){return!0}visitAugmentedAssignment(e){return!0}visitAwait(e){return!0}visitBinaryOperation(e){return!0}visitBreak(e){return!0}visitCall(e){return!0}visitCase(e){return!0}visitClass(e){return!0}visitTernary(e){return!0}visitContinue(e){return!0}visitConstant(e){return!0}visitDecorator(e){return!0}visitDel(e){return!0}visitDictionary(e){return!0}visitDictionaryKeyEntry(e){return!0}visitDictionaryExpandEntry(e){return!0}visitError(e){return!0}visitEllipsis(e){return!0}visitIf(e){return!0}visitImport(e){return!0}visitImportAs(e){return!0}visitImportFrom(e){return!0}visitImportFromAs(e){return!0}visitIndex(e){return!0}visitExcept(e){return!0}visitFor(e){return!0}visitFormatString(e){return!0}visitFunction(e){return!0}visitFunctionAnnotation(e){return!0}visitGlobal(e){return!0}visitLambda(e){return!0}visitList(e){return!0}visitListComprehension(e){return!0}visitListComprehensionFor(e){return!0}visitListComprehensionIf(e){return!0}visitMatch(e){return!0}visitMemberAccess(e){return!0}visitModule(e){return!0}visitModuleName(e){return!0}visitName(e){return!0}visitNonlocal(e){return!0}visitNumber(e){return!0}visitParameter(e){return!0}visitPass(e){return!0}visitPatternCapture(e){return!0}visitPatternClass(e){return!0}visitPatternClassArgument(e){return!0}visitPatternAs(e){return!0}visitPatternLiteral(e){return!0}visitPatternMappingExpandEntry(e){return!0}visitPatternSequence(e){return!0}visitPatternValue(e){return!0}visitPatternMappingKeyEntry(e){return!0}visitPatternMapping(e){return!0}visitRaise(e){return!0}visitReturn(e){return!0}visitSet(e){return!0}visitSlice(e){return!0}visitStatementList(e){return!0}visitString(e){return!0}visitStringList(e){return!0}visitSuite(e){return!0}visitTuple(e){return!0}visitTry(e){return!0}visitTypeAnnotation(e){return!0}visitUnaryOperation(e){return!0}visitUnpack(e){return!0}visitWhile(e){return!0}visitWith(e){return!0}visitWithItem(e){return!0}visitYield(e){return!0}visitYieldFrom(e){return!0}}function vr(e){let t=0,n=e;for(;n;)t++,n=n.parent;return t}function Tr(e,t){if(t<e.start||t>dt.getEnd(e))return;const n=(new _r).visitNode(e);for(const e of n)if(e){const n=Tr(e,t);if(n)return n}return e}function br(e,t,n){const i=[n];let r=e;for(;r;)r=Er(r),r&&i.push(r.name.value);return i.push(t),i.reverse().join(".")}function Ir(e){return e.start}function Sr(e,t){let n="";return 1===e.argumentCategory?n="*":2===e.argumentCategory&&(n="**"),e.name&&(n+=e.name.value+"="),n+=xr(e.valueExpression,t),n}function xr(e,t=0){switch(e.nodeType){case 38:return e.value;case 35:return xr(e.leftExpression,t)+"."+e.memberName.value;case 9:return xr(e.leftExpression,t)+"("+e.arguments.map((e=>Sr(e,t))).join(", ")+")";case 24:return xr(e.baseExpression,t)+"["+e.items.map((e=>Sr(e,t))).join(", ")+"]"+(e.trailingComma?",":"");case 55:return Cr(e.operator)+xr(e.expression,t);case 7:{const n=xr(e.leftExpression,t)+" "+Cr(e.operator)+" "+xr(e.rightExpression,t);return e.parenthesized?`(${n})`:n}case 40:{let t=e.value.toString();return t.endsWith("n")&&(t=t.substring(0,t.length-1)),e.isImaginary&&(t+="j"),t}case 48:return 1&t&&e.typeAnnotation?xr(e.typeAnnotation,t):e.strings.map((e=>xr(e,t))).join(" ");case 49:{let t="";return 8&e.token.flags&&(t+="r"),16&e.token.flags&&(t+="u"),32&e.token.flags&&(t+="b"),64&e.token.flags&&(t+="f"),4&e.token.flags?1&e.token.flags?t+=`'''${e.token.escapedValue}'''`:t+=`"""${e.token.escapedValue}"""`:1&e.token.flags?t+=`'${e.token.escapedValue}'`:t+=`"${e.token.escapedValue}"`,t}case 3:return xr(e.leftExpression,t)+" = "+xr(e.rightExpression,t);case 4:return xr(e.name,t)+" := "+xr(e.rightExpression,t);case 54:return xr(e.valueExpression,t)+": "+xr(e.typeAnnotation,t);case 5:return xr(e.leftExpression,t)+" "+Cr(e.operator)+" "+xr(e.rightExpression,t);case 6:return"await "+xr(e.expression,t);case 51:return xr(e.ifExpression,t)+" if "+xr(e.testExpression,t)+" else "+xr(e.elseExpression,t);case 31:return`[${e.entries.map((e=>xr(e,t))).join(", ")}]`;case 56:return"*"+xr(e.expression,t);case 52:{const n=e.expressions.map((e=>xr(e,t)));return 1===n.length?`(${n[0]}, )`:`(${n.join(", ")})`}case 60:return e.expression?"yield "+xr(e.expression,t):"yield";case 61:return"yield from "+xr(e.expression,t);case 18:return"...";case 32:{let n="<ListExpression>";return yr(e.expression)?n=xr(e.expression,t):17===e.expression.nodeType&&(n=`${xr(e.expression.keyExpression,t)}: ${xr(e.expression.valueExpression,t)}`),n=n+" "+e.forIfNodes.map((e=>33===e.nodeType?(e.isAsync?"async ":"")+"for "+xr(e.targetExpression,t)+` in ${xr(e.iterableExpression,t)}`:`if ${xr(e.testExpression,t)}`)).join(" "),e.isParenthesized?`(${n}})`:n}case 46:{let n="";return e.startValue&&(n+=xr(e.startValue,t)),e.endValue&&(n+=": "+xr(e.endValue,t)),e.stepValue&&(n+=": "+xr(e.stepValue,t)),n}case 30:return"lambda "+e.parameters.map((e=>{let n="";return 1===e.category?n+="*":2===e.category&&(n+="**"),e.name&&(n+=e.name.value),e.defaultValue&&(n+=" = "+xr(e.defaultValue,t)),n})).join(", ")+": "+xr(e.expression,t);case 11:if(33===e.constType)return"True";if(15===e.constType)return"False";if(9===e.constType)return"__debug__";if(26===e.constType)return"None";break;case 15:{const n=`${e.entries.map((e=>17===e.nodeType?`${xr(e.keyExpression,t)}: ${xr(e.valueExpression,t)}`:xr(e,t)))}`;return n?`{ ${n} }`:"{}"}case 16:return`**${xr(e.expandExpression,t)}`;case 45:return e.entries.map((e=>xr(e,t))).join(", ")}return"<Expression>"}function Cr(e){const t={0:"+",1:"+=",2:"=",3:"&",4:"&=",5:"~",6:"|",7:"|=",8:"^",9:"^=",10:"/",11:"/=",12:"==",13:"//",14:"//=",15:">",16:">=",17:"<<",18:"<<=",19:"<>",20:"<",21:"<=",22:"@",23:"@=",24:"%",25:"%=",26:"*",27:"*=",28:"!=",29:"**",30:"**=",31:">>",32:">>=",33:"-",34:"-=",36:"and",37:"or",38:"not",39:"is",40:"is not",41:"in",42:"not in"};return t[e]?t[e]:"unknown"}function wr(e){let t=e.parent;for(;t;){if(50===t.nodeType)return t;t=t.parent}}function Er(e,t=!1){let n=e.parent;for(;n;){if(10===n.nodeType)return n;if(36===n.nodeType)return;if(28===n.nodeType&&t)return;n=n.parent}}function kr(e){let t,n=e.parent;for(;n;){if(28===n.nodeType&&!n.decorators.some((e=>e===t)))return n;if(10===n.nodeType)return;t=n,n=n.parent}}function Dr(e){let t=e.parent;for(;t;){if(28===t.nodeType)return t;if(10===t.nodeType)return t;t=t.parent}}function Ar(e){let t,n,i=e,r=!1;for(;i;){switch(41===i.nodeType&&t===i.name&&(r=!0),i.nodeType){case 28:if(i.parameters.some((e=>e===t))){if(r&&void 0!==Ft(i))return i}else if(t===i.suite&&void 0!==Ft(i))return i;break;case 30:if(i.parameters.some((e=>e===t))){if(r&&void 0!==Ft(i))return i}else if((!t||t===i.expression)&&void 0!==Ft(i))return i;break;case 10:if(t===i.suite&&void 0!==Ft(i))return i;break;case 32:if(void 0!==Ft(i)&&(t!==i.forIfNodes[0]||33!==i.forIfNodes[0].nodeType||i.forIfNodes[0].iterableExpression!==n))return i;break;case 36:if(void 0!==Ft(i))return i}n=t,t=i,i=i.parent}E("Did not find evaluation scope")}function Pr(e,t=!1){let n,i=e;for(;i;){switch(i.nodeType){case 28:if((n===i.suite||t)&&!i.decorators.some((e=>e===n)))return i;break;case 10:if(n===i.suite&&!i.decorators.some((e=>e===n)))return i}n=i,i=i.parent}}function Rr(e){let t=Ar(e);for(;10===t.nodeType||32===t.nodeType;)t=Ar(t.parent);return t}function Fr(e){if(38===e.nodeType)return!0;if(35===e.nodeType){if(38!==e.leftExpression.nodeType)return!1;if(!Er(e))return!1;const t=kr(e);return!!t&&"__init__"===t.name.value}return!1}function Nr(e){return!!Er(e,!0)}function Mr(e,t){let n=e;for(;n;){if(n===t)return!0;n=n.parent}return!1}function Or(e){let t=!1;for(const n of e.statements){if(47!==n.nodeType)return!1;for(const e of n.statements)if(18===e.nodeType)t=!0;else if(48!==e.nodeType)return!1}return t}function Lr(e,t){if(38===e.nodeType)return 38===t.nodeType?e.value===t.value:4===t.nodeType&&e.value===t.name.value;if(35===e.nodeType&&35===t.nodeType)return Lr(e.leftExpression,t.leftExpression)&&e.memberName.value===t.memberName.value;if(24===e.nodeType&&24===t.nodeType){if(!Lr(e.baseExpression,t.baseExpression))return!1;if(1!==t.items.length||t.trailingComma||t.items[0].name||0!==t.items[0].argumentCategory)return!1;if(40===e.items[0].valueExpression.nodeType){const n=e.items[0].valueExpression,i=t.items[0].valueExpression;return!(40!==i.nodeType||i.isImaginary||!i.isInteger)&&n.value===i.value}if(48===e.items[0].valueExpression.nodeType){const n=e.items[0].valueExpression,i=t.items[0].valueExpression;if(1===n.strings.length&&49===n.strings[0].nodeType&&48===i.nodeType&&1===i.strings.length&&49===i.strings[0].nodeType)return n.strings[0].value===i.strings[0].value}return!1}return!1}function Ur(e,t){return 35===e.nodeType?Lr(e.leftExpression,t)||Ur(e.leftExpression,t):24===e.nodeType&&(Lr(e.baseExpression,t)||Ur(e.baseExpression,t))}function qr(e){if(0===e.length)return;if(47!==e[0].nodeType)return;if(!Vr(e[0]))return;const t=e[0].statements[0].strings;return 1===t.length?t[0].value:t.map((e=>e.value)).join("")}function Vr(e){if(0===e.statements.length||48!==e.statements[0].nodeType)return!1;const t=e.statements[0].strings;return 0!==t.length&&!t.some((e=>0!=(64&e.token.flags)))}class Br extends _r{constructor(e){super(),this._callback=e}visitName(e){return this._callback(e,this._subscriptIndex,this._baseExpression),!0}visitIndex(e){this.walk(e.baseExpression);const t=this._subscriptIndex,n=this._baseExpression;return this._baseExpression=e.baseExpression,e.items.forEach(((e,t)=>{this._subscriptIndex=t,this.walk(e)})),this._subscriptIndex=t,this._baseExpression=n,!1}}class Wr extends _r{constructor(e){super(),this._callback=e}visitCall(e){return this._callback(e),!0}}function jr(e){let t=e;for(;t;){if(41===t.nodeType)return t;t=t.parent}}function zr(e,t,n){let i,r=e;for(;void 0!==r;){if(9===r.nodeType&&u(r)){i=r;break}r=r.parent}if(!i||!i.arguments)return;const s=dt.getEnd(i);if(t>s)return;const o=function(e,t){const n=e.getItemAtPosition(t);if(!(n<0))return e.getItemAt(n)}(n,s-1);if(t===s&&14===(null==o?void 0:o.type))return;let a=!1,l=-1,c=!1;return i.arguments.forEach(((e,i)=>{if(a)return;let r=e.start;const s=n.getItemAtPosition(r);s>=0&&(r=dt.getEnd(n.getItemAt(s-1)));let o=dt.getEnd(e);const u=n.getItemAtPosition(o);if(u>=0)for(let e=u;e<n.count;e++){const t=n.getItemAt(e);switch(t.type){case 12:case 14:break;default:continue}o=dt.getEnd(t);break}t<o&&(l=i,c=t>=r,a=!0)})),a||(l=i.arguments.length+1),{callNode:i,activeIndex:l,activeOrFake:c};function u(e,i){let r=!0;const s=e.leftExpression.length>0?dt.getEnd(e.leftExpression)-1:e.leftExpression.start,o=n.getItemAtPosition(s);if(o>=0&&o+1<n.count){const e=n.getItemAt(o+1);13===e.type&&t<dt.getEnd(e)&&(r=!1)}return r}}function $r(e){let t=e,n=t.parent;for(;n;){switch(n.nodeType){case 3:case 5:return t===n.leftExpression;case 4:return t===n.name;case 14:return!0;case 26:return t===n.targetExpression;case 21:return t===n.alias||n.module.nameParts.length>0&&t===n.module.nameParts[0];case 23:return t===n.alias||!n.alias&&t===n.name;case 35:if(t!==n.memberName)return!1;break;case 25:return t===n.name;case 58:return n.withItems.some((e=>e===t));case 33:return t===n.targetExpression;case 54:if(t===n.typeAnnotation)return!1;break;case 28:case 10:case 36:return!1}t=n,n=n.parent}return!1}function Hr(e){let t=e;for(;t&&36!==t.nodeType;)t=t.parent;return t}function Gr(e){const t=Hr(e);return t?Vt(t):void 0}function Kr(e){var t,n;return 21===(null===(n=null===(t=es(e,37))||void 0===t?void 0:t.parent)||void 0===n?void 0:n.nodeType)}function Jr(e){var t;return 21===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.alias===e}function Yr(e){var t,n;return 22===(null===(n=null===(t=es(e,37))||void 0===t?void 0:t.parent)||void 0===n?void 0:n.nodeType)}function Qr(e){var t;return 23===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.name===e}function Zr(e){var t;return 23===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.alias===e}function Xr(e){var t;if(37!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType))return!1;const n=e.parent;return 0!==n.nameParts.length&&n.nameParts[n.nameParts.length-1]===e}function es(e,t){return function(e,n){for(const n of function*(e){for(;void 0!==e;)yield e,e=e.parent}(e))if(n.nodeType===t)return n}(e)}function ts(e){var t;return 35!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType)||e.parent.leftExpression===e?e:e.parent}function ns(e){switch(e.type){case 0:case 4:case 5:case 3:return!0;case 2:{if(e.node.typeAnnotation||e.node.typeAnnotationComment)return!0;const t=e.node.parent;if(28===(null==t?void 0:t.nodeType)&&t.functionAnnotationComment&&!t.functionAnnotationComment.isParamListEllipsis){const n=t.functionAnnotationComment.paramTypeAnnotations;return!(t.parameters.length>n.length&&e.node===t.parameters[0])}return!1}case 1:return!!e.typeAnnotationNode;case 6:return!1}}function is(e,t,n=!1){if(e.type!==t.type)return!1;if(e.path!==t.path)return!1;if(e.range.start.line!==t.range.start.line||e.range.start.character!==t.range.start.character)return!1;if(6===e.type&&6===t.type){if(e.symbolName!==t.symbolName||e.usesLocalName!==t.usesLocalName)return!1;if(n)return!0;if(e.firstNamePart!==t.firstNamePart)return!1}return!0}function rs(e){return 1===e.type&&!!e.isFinal}function ss(e){return 1===e.type&&!!e.typeAliasAnnotation}function os(e){var t;if(1!==e.type||!e.typeAliasName||e.typeAnnotationNode)return!1;if(3!==(null===(t=e.node.parent)||void 0===t?void 0:t.nodeType))return!1;switch(e.node.parent.rightExpression.nodeType){case 0:case 55:case 4:case 54:case 6:case 51:case 56:case 52:case 9:case 32:case 46:case 60:case 61:case 30:case 40:case 15:case 31:case 45:return!1}return!0}function as(e){var t;switch(e.type){case 6:return e.symbolName;case 4:case 3:return e.node.name.value;case 2:return null===(t=e.node.name)||void 0===t?void 0:t.value;case 1:return 38===e.node.nodeType?e.node.value:void 0;case 0:case 5:return}throw new Error("Shouldn't reach here")}function ls(e){return e.map((e=>{if(6!==e.type)return e;const t={...e};return t.usesLocalName=!1,t}))}function cs(e){return{type:6,node:void 0,path:e,loadSymbolsFromPath:!1,range:{start:{line:0,character:0},end:{line:0,character:0}},implicitImports:new Map,usesLocalName:!1,moduleName:"",isInExceptSuite:!1}}function us(e){const t=e.replace(/\r/g,"").replace(/\t/g,"        ").split("\n");let n=Number.MAX_VALUE;t.forEach(((e,i)=>{if(t.length<=1||i>0){const t=e.trimLeft();t&&(n=Math.min(n,e.length-t.length))}})),n>=Number.MAX_VALUE&&(n=0);const i=[];for(t.forEach(((e,t)=>{0===t?i.push(e.trim()):i.push(e.substr(n).trimRight())}));i.length>0&&0===i[0].length;)i.shift();for(;i.length>0&&0===i[i.length-1].length;)i.pop();return i}function ps(e,t){if(!e||!t)return;const n=us(e);for(const e of n){const n=e.trim();let i=n.indexOf("@param "+t);if(i>=0)return n.substr(i+7);if(i=n.indexOf(":param "+t),i>=0)return n.substr(i+7);if(i=n.indexOf(t+": "),i>=0)return n.substr(i);if(i=n.indexOf(t+" ("),i>=0)return n.substr(i)}}function ds(e){return new Vs(e).convert()}function hs(e){const t=us(e),n=[];for(const e of t){const t=n.length>0?n[n.length-1]:void 0;Ws(e)&&Ws(t)||n.push(e)}return n.join("\n").trimEnd()}const ms=/\S|$/,fs=/\S/,gs=/^\s*~~~+$/,ys=/^\s*\+\+\++$/,_s=/^\s*===+\s+===+$/,vs=/^\s*---+\s+---+$/,Ts=/^(\s*)-\s/,bs=/^(\s*)\*\s/,Is=/^(\s*)\d+\.\s/,Ss=/^(\s+\* )(.*)$/,xs=/^\s*\.\. /,Cs=/^\s*\.\.\s+(\w+)::\s*(.*)$/,ws=/ *>>> /,Es=/^\s*:(param|arg|type|return|rtype|raise|except|var|ivar|cvar|copyright|license)/,ks=/^[.\s\t]+(@\w+)/,Ds=/^(\.\s{3})|^(\.)/,As=[{exp:/^\s*=+(\s+=+)+$/,replacement:"="},{exp:/^\s*-+(\s+-+)+$/,replacement:"-"},{exp:/^\s*~+(\s+-+)+$/,replacement:"~"},{exp:/^\s*\++(\s+\++)+$/,replacement:"+"}],Ps=/\s/g,Rs=/``/g,Fs=/~/g,Ns=/\+/g,Ms=/[_*~[\]]/g,Os=/(\[.*\]\(.*\))/g,Ls=[{exp:/</g,replacement:"&lt;"},{exp:/>/g,replacement:"&gt;"}],Us=/^\s*::$/,qs=[{exp:/\s+::$/g,replacement:""},{exp:/(\S)\s*::$/g,replacement:"$1:"},{exp:/:[\w_\-+:.]+:`/g,replacement:"`"},{exp:/`:[\w_\-+:.]+:/g,replacement:"`"}];class Vs{constructor(e){this._builder="",this._skipAppendEmptyLine=!0,this._insideInlineCode=!1,this._appendDirectiveBlock=!1,this._stateStack=[],this._lineNum=0,this._blockIndent=0,this._state=this._parseText,this._lines=us(e)}convert(){for(this._lines.some((e=>ks.exec(e)))&&(this._lines=this._lines.map((e=>e.replace(Ds,""))));void 0!==this._currentLineOrUndefined();){const e=this._state,t=this._lineNum;if(this._state(),this._state===e&&this._lineNum===t)break}return this._state===this._parseBacktickBlock||this._state===this._parseDocTest||this._state===this._parseLiteralBlock?this._trimOutputAndAppendLine("```"):this._insideInlineCode&&this._trimOutputAndAppendLine("`",!0),this._builder.trim()}_eatLine(){this._lineNum++}_currentLineOrUndefined(){return this._lineNum<this._lines.length?this._lines[this._lineNum]:void 0}_currentLine(){return this._currentLineOrUndefined()||""}_currentIndent(){return Bs(this._currentLine())}_prevIndent(){var e;return Bs(null!==(e=this._lineAt(this._lineNum-1))&&void 0!==e?e:"")}_lineAt(e){return e<this._lines.length?this._lines[e]:void 0}_nextBlockIndent(){return Bs(this._lines.slice(this._lineNum+1).find((e=>!Ws(e)))||"")}_currentLineIsOutsideBlock(){return this._currentIndent()<this._blockIndent}_currentLineWithinBlock(){return this._currentLine().substr(this._blockIndent)}_pushAndSetState(e){this._state===this._parseText&&(this._insideInlineCode=!1),this._stateStack.push(this._state),this._state=e}_popState(){this._state=this._stateStack.splice(0,1)[0],this._state===this._parseText&&(this._insideInlineCode=!1)}_parseText(){if(Ws(this._currentLineOrUndefined()))return void(this._state=this._parseEmpty);if(this._beginBacktickBlock())return;if(this._beginLiteralBlock())return;if(this._beginDocTest())return;if(this._beginDirective())return;if(this._beginList())return;if(this._beginFieldList())return;if(this._beginTableBlock())return;const e=this._formatPlainTextIndent(this._currentLine());this._appendTextLine(e),this._eatLine()}_formatPlainTextIndent(e){const t=this._lineAt(this._lineNum-1),n=this._prevIndent(),i=this._currentIndent();return!(i>n)||Ws(t)||this._builder.endsWith("\\\n")||this._builder.endsWith("\n\n")||js(t)||(this._builder=this._builder.slice(0,-1)+"\\\n"),n>i&&!Ws(t)&&!this._builder.endsWith("\\\n")&&!this._builder.endsWith("\n\n")&&(this._builder=this._builder.slice(0,-1)+"\\\n"),0===n||this._builder.endsWith("\\\n")||this._builder.endsWith("\n\n")?this._convertIndent(e):e.trimStart()}_convertIndent(e){return e.replace(/^([ \t]+)(.+)$/g,((e,t,n)=>"&nbsp;".repeat(t.length)+n))}_escapeHtml(e){return Ls.forEach((t=>{e=e.replace(t.exp,t.replacement)})),e}_appendTextLine(e){const t=(e=this._preprocessTextLine(e)).split("`");for(let e=0;e<t.length;e++){let n=t[e];if(e>0&&(this._insideInlineCode=!this._insideInlineCode,this._append("`")),this._insideInlineCode)this._append(n);else{if(n=this._escapeHtml(n),0===e){if(1===t.length){for(const e of As)if(e.exp.test(n)){n=n.replace(Ps,e.replacement);break}if(gs.test(n)){this._append(n.replace(Fs,"-"));continue}if(ys.test(n)){this._append(n.replace(Ns,"-"));continue}}const e=Ss.exec(n);null!==e&&3===e.length&&(this._append(e[1]),n=e[2])}n.split(Os).forEach((e=>{Os.test(e)?this._append(e):this._append(e.replace(Ms,((e,t,n)=>"\\"===n.charAt(t-1)?e:"\\"+e)))}))}}this._builder+="\n"}_preprocessTextLine(e){return Us.test(e)?"":(qs.forEach((t=>e=e.replace(t.exp,t.replacement))),e=e.replace(Rs,"`"))}_parseEmpty(){if(Ws(this._currentLineOrUndefined()))return this._appendLine(),void this._eatLine();this._state=this._parseText}_beginMinIndentCodeBlock(e){this._appendLine("```"),this._pushAndSetState(e),this._blockIndent=this._currentIndent()}_beginBacktickBlock(){return!!this._currentLine().startsWith("```")&&(this._appendLine(this._currentLine()),this._pushAndSetState(this._parseBacktickBlock),this._eatLine(),!0)}_parseBacktickBlock(){this._currentLine().startsWith("```")?(this._appendLine("```"),this._appendLine(),this._popState()):this._appendLine(this._currentLine()),this._eatLine()}_beginDocTest(){return!!ws.test(this._currentLine())&&(this._beginMinIndentCodeBlock(this._parseDocTest),this._appendLine(this._currentLineWithinBlock()),this._eatLine(),!0)}_parseDocTest(){if(this._currentLineIsOutsideBlock()||Ws(this._currentLine()))return this._trimOutputAndAppendLine("```"),this._appendLine(),void this._popState();this._appendLine(this._currentLineWithinBlock()),this._eatLine()}_beginLiteralBlock(){const e=this._lineAt(this._lineNum-1);if(void 0===e)return!1;if(!Ws(e))return!1;let t=this._lineNum-2;for(;t>=0;t--){const e=this._lineAt(t);if(!Ws(e)){if(e.endsWith("::"))break;return!1}}return!(t<0||(0===this._currentIndent()?(this._appendLine("```"),this._pushAndSetState(this._parseLiteralBlockSingleLine),0):(this._beginMinIndentCodeBlock(this._parseLiteralBlock),0)))}_parseLiteralBlock(){return Ws(this._currentLineOrUndefined())?(this._appendLine(),void this._eatLine()):this._currentLineIsOutsideBlock()?(this._trimOutputAndAppendLine("```"),this._appendLine(),void this._popState()):(this._appendLine(this._currentLineWithinBlock()),void this._eatLine())}_parseLiteralBlockSingleLine(){this._appendLine(this._currentLine()),this._appendLine("```"),this._appendLine(),this._popState(),this._eatLine()}_beginDirective(){return!!xs.test(this._currentLine())&&(this._pushAndSetState(this._parseDirective),this._blockIndent=this._nextBlockIndent(),this._appendDirectiveBlock=!1,!0)}_beginFieldList(){var e,t;if(this._insideInlineCode)return!1;let n=this._currentLine();if(n.startsWith("@"))return this._appendLine(),this._appendTextLine(n),this._eatLine(),!0;const i=!(null==n?void 0:n.endsWith(":"))&&!(null==n?void 0:n.endsWith("::"))&&(null!==(t=null===(e=n.match(/:/g))||void 0===e?void 0:e.length)&&void 0!==t?t:0)%2==1,r=Es.test(n);if(i||r){const e=this._lineAt(this._lineNum-1);return this._builder.endsWith("\\\n")||this._builder.endsWith("\n\n")||js(e)||(this._builder=this._builder.slice(0,-1)+"\\\n"),n=this._convertIndent(n),this._appendTextLine(n),this._eatLine(),!0}return!1}_beginTableBlock(){if(this._insideInlineCode)return!1;const e=this._currentLine();return!!_s.test(e)&&(this._tableState={header:e.trimStart(),inHeader:!0},this._eatLine(),this._pushAndSetState(this._parseTableBlock),!0)}_parseTableBlock(){if(Ws(this._currentLineOrUndefined())||!this._tableState)return this._tableState=void 0,void this._popState();let e=this._currentLine();if(_s.test(e))return this._eatLine(),this._appendLine("\n<br/>\n"),this._popState(),void(this._tableState=void 0);{let t="|";const n=this._tableState.header.split(" "),i=[];if(this._tableState.inHeader){do{let t=0;for(let r=0;r<n.length;r++){const s=n[r].length+1,o=e.slice(t,t+s);void 0===i[r]?i[r]=`${o} `:i[r]=i[r].concat(`<br>${o} `),t+=s}this._eatLine(),e=this._currentLine()}while(!Ws(this._currentLineOrUndefined())&&!vs.test(e)&&!_s.test(e));this._tableState.inHeader=!1,i.forEach((e=>{t+=`${e}|`})),this._appendLine(t);const r=e.trimStart().replace(/=/g,"-").replace(" ","|");this._appendLine(`|${r}|`),this._eatLine()}else{let i=0;n.forEach((n=>{const r=n.length+1,s=e.slice(i,i+r);t+=`${s}|`,i+=r})),this._appendLine(t),this._eatLine()}}}_beginList(){if(this._insideInlineCode)return!1;let e=this._currentLine();const t=Ts.exec(e);if(2===(null==t?void 0:t.length))return t[1].length>=4&&(e=" ".repeat(t[1].length/2)+e.trimLeft()),this._appendTextLine(e),this._eatLine(),this._state!==this._parseList&&this._pushAndSetState(this._parseList),!0;const n=bs.exec(e);if(2===(null==n?void 0:n.length))return 0===n[1].length?e=e=" "+e:n[1].length>=4&&(e=" ".repeat(n[1].length/2)+e.trimLeft()),this._appendTextLine(e),this._eatLine(),this._state!==this._parseList&&this._pushAndSetState(this._parseList),!0;const i=Is.exec(e);return 2===(null==i?void 0:i.length)&&(this._appendTextLine(e),this._eatLine(),!0)}_parseList(){if(Ws(this._currentLineOrUndefined())||this._currentLineIsOutsideBlock())this._popState();else if(!this._beginList()){const e=this._currentLine().trimStart();this._appendTextLine(e),this._eatLine()}}_parseDirective(){const e=Cs.exec(this._currentLine());if(null!==e&&3===e.length){const t=e[1],n=e[2];"class"===t&&(this._appendDirectiveBlock=!0,this._appendLine(),this._appendLine("```"),this._appendLine(n),this._appendLine("```"),this._appendLine())}0===this._blockIndent?this._popState():this._state=this._parseDirectiveBlock,this._eatLine()}_parseDirectiveBlock(){Ws(this._currentLineOrUndefined())||!this._currentLineIsOutsideBlock()?(this._appendDirectiveBlock&&this._appendTextLine(this._currentLine().trimLeft()),this._eatLine()):this._popState()}_appendLine(e){Ws(e)?this._skipAppendEmptyLine||(this._builder+="\n",this._skipAppendEmptyLine=!0):(this._builder+=e+"\n",this._skipAppendEmptyLine=!1)}_append(e){this._builder+=e,this._skipAppendEmptyLine=!1}_trimOutputAndAppendLine(e,t=!1){this._builder=this._builder.trimRight(),this._skipAppendEmptyLine=!1,t||this._appendLine(),this._appendLine(e)}}function Bs(e){return e.search(ms)}function Ws(e){return void 0===e||!fs.test(e)}function js(e){var t,n;return void 0!==e&&(null!==(n=null===(t=e.match(/^\s*[#`~=-]{3,}/))||void 0===t?void 0:t.length)&&void 0!==n?n:0)>0}function zs(e){return Ft(Ar(e))}const $s="*";class Hs{constructor(e,t,n){this.className=e,this.itemName=t,this.itemType=n}}const Gs=14;var Ks,Js,Ys,Qs,Zs,Xs,eo,to,no,io,ro,so,oo;function ao(e){return 4===e.category}function lo(e){return 3===e.category&&Ks.isInstance(e)}function co(e){return 3===e.category&&Ks.isInstantiable(e)}function uo(e){return 2===e.category}function po(e){return 1===e.category}function ho(e){return 2===e.category||1===e.category||!!fo(e)&&void 0===e.subtypes.find((e=>!ho(e)))}function mo(e){return 0===e.category}function fo(e){return 9===e.category}function go(e){return!!mo(e)||!!fo(e)&&void 0!==e.subtypes.find((e=>go(e)))}function yo(e){return 7===e.category}function _o(e){return 7===e.category&&Ks.isInstantiable(e)}function vo(e){return 7===e.category&&Ks.isInstance(e)}function To(e){return 8===e.category}function bo(e){return 10===e.category}function Io(e){return 10===e.category&&e.details.isVariadic}function So(e){return fo(e)&&1===e.subtypes.length&&(e=e.subtypes[0]),10===e.category&&e.details.isVariadic&&!!e.isVariadicUnpacked}function xo(e){return!(!yo(e)||!e.isUnpacked)}function Co(e){return So(e)||xo(e)}function wo(e){return 10===e.category&&e.details.isParamSpec}function Eo(e){return 5===e.category}function ko(e){return 6===e.category}function Do(e){return e.typeAliasInfo?e.typeAliasInfo:bo(e)&&e.details.recursiveTypeAliasName&&e.details.boundType&&e.details.boundType.typeAliasInfo?e.details.boundType.typeAliasInfo:void 0}function Ao(e,t,n=!1,i=!1,r=0){var s,o;if(e===t)return!0;if(e.category!==t.category)return!1;if(!i&&e.flags!==t.flags)return!1;if(r>Gs)return!0;switch(r++,e.category){case 7:{const i=t;if(!Zs.isSameGenericClass(e,i,r))return!1;if(!ro.isSame(e.condition,t.condition))return!1;if(!n||!Zs.isPseudoGenericClass(e))if(e.tupleTypeArguments&&i.tupleTypeArguments){const t=e.tupleTypeArguments||[],s=i.tupleTypeArguments||[];if(t.length!==s.length)return!1;for(let e=0;e<t.length;e++){if(!Ao(t[e].type,s[e].type,n,!1,r))return!1;if(t[e].isUnbounded!==s[e].isUnbounded)return!1}}else{const t=e.typeArguments||[],s=i.typeArguments||[],o=Math.max(t.length,s.length);for(let e=0;e<o;e++)if(!Ao(e<t.length?t[e]:io.create(),e<s.length?s[e]:io.create(),n,!1,r))return!1}return!!Zs.isLiteralValueSame(e,i)}case 5:{const i=t,s=e.details.parameters,o=i.details.parameters;if(s.length!==o.length)return!1;const a=s.findIndex((e=>0===e.category&&!e.name)),l=o.findIndex((e=>0===e.category&&!e.name));for(let t=0;t<s.length;t++){const c=s[t],u=o[t];if(c.category!==u.category)return!1;const p=void 0!==a&&t>=a;if(p!==(void 0!==l&&t>=l))return!1;if(p&&c.name!==u.name)return!1;if(!Ao(Xs.getEffectiveParameterType(e,t),Xs.getEffectiveParameterType(i,t),n,!1,r))return!1}let c=e.details.declaredReturnType;e.specializedTypes&&e.specializedTypes.returnType&&(c=e.specializedTypes.returnType),!c&&e.inferredReturnType&&(c=e.inferredReturnType);let u=i.details.declaredReturnType;return i.specializedTypes&&i.specializedTypes.returnType&&(u=i.specializedTypes.returnType),!u&&i.inferredReturnType&&(u=i.inferredReturnType),!!(!c&&!u||c&&u&&Ao(c,u,n,!1,r))}case 6:{const s=t;if(e.overloads.length!==s.overloads.length)return!1;for(let t=0;t<e.overloads.length;t++)if(!Ao(e.overloads[t],s.overloads[t],n,i,r))return!1;return!0}case 9:{const n=t,i=e.subtypes,s=n.subtypes;return i.length===s.length&&void 0===Mo(e,(e=>!so.containsType(n,e,r)))}case 10:{const i=t;if(e.scopeId!==i.scopeId)return!1;if(e.details.recursiveTypeParameters&&i.details.recursiveTypeParameters){const i=(null===(s=null==e?void 0:e.typeAliasInfo)||void 0===s?void 0:s.typeArguments)||[],a=(null===(o=null==t?void 0:t.typeAliasInfo)||void 0===o?void 0:o.typeArguments)||[],l=Math.max(i.length,a.length);for(let e=0;e<l;e++)if(!Ao(e<i.length?i[e]:io.create(),e<a.length?a[e]:io.create(),n,!1,r))return!1}if(e.details===i.details)return!0;if(e.details.name!==i.details.name||e.details.isParamSpec!==i.details.isParamSpec||e.details.isVariadic!==i.details.isVariadic||e.details.isSynthesized!==i.details.isSynthesized||e.details.variance!==i.details.variance||e.scopeId!==i.scopeId)return!1;const a=e.details.boundType,l=i.details.boundType;if(a){if(!l||!Ao(a,l,n,!1,r))return!1}else if(l)return!1;const c=e.details.constraints,u=i.details.constraints;if(c.length!==u.length)return!1;for(let e=0;e<c.length;e++)if(!Ao(c[e],u[e],n,!1,r))return!1;return!0}case 8:{const n=t;return e.fields===n.fields||0===e.fields.size&&0===n.fields.size}}return!0}function Po(e){return No(e,(e=>po(e)))}function Ro(e){return fo(e)?No(e,(e=>mo(e))):mo(e)?Ys.create():e}function Fo(e){return No(e,(e=>lo(e)))}function No(e,t){if(fo(e)){const n=e.subtypes.filter((e=>!t(e)));if(n.length<e.subtypes.length){const t=Oo(n);return fo(t)&&so.addTypeAliasSource(t,e),t}}return e}function Mo(e,t){return fo(e)?e.subtypes.find((e=>t(e))):t(e)?e:void 0}function Oo(e,t){let n=!1;if(0===(e=e.filter((e=>(4===e.category&&e.isNoReturn&&(n=!0),4!==e.category)))).length)return n?no.createNoReturn():no.createNever();let i=!0;for(let t=1;t<e.length;t++)if(e[t]!==e[0]){i=!1;break}if(i)return e[0];let r=[];const s=[];for(const t of e)fo(t)?(r.push(...t.subtypes),t.typeAliasInfo?s.push(t):t.typeAliasSources&&s.push(...t.typeAliasSources)):r.push(t);if(r=r.sort(((e,t)=>vo(e)&&void 0!==e.literalValue||_o(e)&&void 0!==e.literalValue?1:vo(t)&&void 0!==t.literalValue||_o(t)&&void 0!==t.literalValue?-1:vo(e)&&e.isEmptyContainer?1:vo(t)&&t.isEmptyContainer?-1:0)),0===r.length)return Ys.create();const o=so.create();s.length>0&&(o.typeAliasSources=new Set,s.forEach((e=>{o.typeAliasSources.add(e)})));let a=!1;return r.forEach(((e,n)=>{0===n?so.addType(o,e):void 0===t||o.subtypes.length<t?function(e,t){if(vo(t)&&void 0===t.condition){if(Zs.isBuiltIn(t,"str")&&void 0!==t.literalValue&&void 0!==e.literalStrMap)return void(e.literalStrMap.has(t.literalValue)||so.addType(e,t));if(Zs.isBuiltIn(t,"int")&&void 0!==t.literalValue&&void 0!==e.literalIntMap)return void(e.literalIntMap.has(t.literalValue)||so.addType(e,t))}for(let n=0;n<e.subtypes.length;n++){const i=e.subtypes[n];if(Ao(i,t))return;if(vo(i)&&vo(t)){if(Lo(i,t)&&void 0===i.literalValue)return;if(Zs.isBuiltIn(i,"bool")&&!i.condition&&Zs.isBuiltIn(t,"bool")&&!t.condition&&void 0!==t.literalValue&&!t.literalValue===i.literalValue)return void(e.subtypes[n]=Zs.cloneWithLiteral(i,void 0))}if(vo(t)&&t.isEmptyContainer&&vo(i)&&Zs.isSameGenericClass(i,t))return}so.addType(e,t)}(o,e):a=!0})),a?io.create():1===o.subtypes.length?o.subtypes[0]:o}function Lo(e,t){return!!Ao(e,t)||(_o(t)&&void 0!==t.literalValue||!(!vo(t)||void 0===t.literalValue))&&Ao(e,t=Zs.cloneWithLiteral(t,void 0))}!function(e){function t(e){return{...e}}e.isInstantiable=function(e){return 0!=(1&e.flags)},e.isInstance=function(e){return 0!=(2&e.flags)},e.isAnnotated=function(e){return 0!=(4&e.flags)},e.isSpecialForm=function(e){return 0!=(8&e.flags)},e.setSpecialForm=function(e){return e.flags|=8},e.isAmbiguous=function(e){return!!e.isAmbiguous},e.cloneType=t,e.cloneForTypeAlias=function(e,n,i,r,s,o){const a=t(e);return a.typeAliasInfo={name:n,fullName:i,typeParameters:s,typeArguments:o,typeVarScopeId:r},a},e.cloneForAnnotated=function(e){const n=t(e);return n.flags|=4,n},e.cloneForCondition=function(e,n){if(void 0===e.condition&&void 0===n)return e;const i=t(e);return i.condition=n,i},e.cloneForAmbiguousType=function(e){if(e.isAmbiguous)return e;const n=t(e);return n.isAmbiguous=!0,n}}(Ks||(Ks={})),function(e){const t={category:0,flags:3};e.create=function(){return t}}(Js||(Js={})),function(e){const t={category:1,flags:3};e.create=function(){return t}}(Ys||(Ys={})),function(e){e.create=function(e,t,n){return{category:8,fields:n||new Map,loaderFields:new Map,flags:1,moduleName:e,filePath:t}},e.getField=function(e,t){let n=e.fields.get(t);if(e.loaderFields)if(n){if(n.isExternallyHidden()){const i=e.loaderFields.get(t);i&&!i.isExternallyHidden()&&(n=i)}}else n=e.loaderFields.get(t);return n}}(Qs||(Qs={})),function(e){function t(e){if(Ks.isInstantiable(e))return e;const t=Ks.cloneType(e);return t.flags&=-3,t.flags|=1,t}function n(e,t){if(!(1&e.details.flags))return!1;if(void 0!==t){const n=Array.isArray(t)?t:[t];return n.some((t=>t===e.details.name))||n.some((t=>t===e.aliasName))}return!0}function i(t,n,i=0){if(i>Gs)return!0;if(i++,t.details===n.details)return!0;const r=t.details,s=n.details;if(r===s)return!0;if(r.fullName!==s.fullName||r.flags!==s.flags||r.typeSourceId!==s.typeSourceId||r.baseClasses.length!==s.baseClasses.length||r.typeParameters.length!==s.typeParameters.length)return!1;if(e.isBuiltIn(t,"NamedTuple")&&e.isBuiltIn(n,"NamedTuple"))return!0;if(e.isBuiltIn(t,"tuple")&&e.isBuiltIn(n,"tuple"))return!0;for(let e=0;e<r.baseClasses.length;e++)if(!Ao(r.baseClasses[e],s.baseClasses[e],!0,void 0,i))return!1;if((r.declaredMetaclass||s.declaredMetaclass)&&(!r.declaredMetaclass||!s.declaredMetaclass||!Ao(r.declaredMetaclass,s.declaredMetaclass,!0,void 0,i)))return!1;for(let e=0;e<r.typeParameters.length;e++)if(!Ao(r.typeParameters[e],s.typeParameters[e],!0,void 0,i))return!1;return!0}e.createInstantiable=function(e,t,n,i,r,s,o,a,l){return{category:7,details:{name:e,fullName:t,moduleName:n,filePath:i,flags:r,typeSourceId:s,baseClasses:[],declaredMetaclass:o,effectiveMetaclass:a,mro:[],fields:new Map,typeParameters:[],docString:l},flags:1}},e.cloneAsInstance=function(e){if(Ks.isInstance(e))return e;const t=Ks.cloneType(e);return t.flags&=~9,t.flags|=2,t.includeSubclasses=!0,t},e.cloneAsInstantiable=t,e.cloneForSpecialization=function(e,t,n,i=!1,r,s){const o=Ks.cloneType(e);return o.typeArguments=t?t.map((e=>ao(e)&&!e.isNoReturn?Ys.create():e)):void 0,o.isTypeArgumentExplicit=n,i&&(o.includeSubclasses=!0),o.tupleTypeArguments=r?r.map((e=>ao(e.type)?{type:Ys.create(),isUnbounded:e.isUnbounded}:e)):void 0,void 0!==s&&(o.isEmptyContainer=s),o},e.cloneWithLiteral=function(e,t){const n=Ks.cloneType(e);return n.literalValue=t,n},e.cloneForTypingAlias=function(e,t){const n=Ks.cloneType(e);return n.aliasName=t,n},e.cloneForNarrowedTypedDictEntries=function(e,t){const n=Ks.cloneType(e);return n.typedDictNarrowedEntries=t,n},e.cloneWithNewTypeParameters=function(e,t){const n=Ks.cloneType(e);return n.details={...n.details},n.details.typeParameters=t,n},e.cloneForTypeGuard=function(e,t,n){const i=Ks.cloneType(e);return i.typeGuardType=t,i.isStrictTypeGuard=n,i},e.cloneForSymbolTableUpdate=function(e){const n=Ks.cloneType(e);return n.details={...n.details},n.details.fields=new Map(n.details.fields),n.details.mro=[...n.details.mro],n.details.mro[0]=t(n),n},e.cloneForUnpacked=function(e,t=!0){const n=Ks.cloneType(e);return n.isUnpacked=t,n},e.isLiteralValueSame=function(e,t){return void 0===e.literalValue?void 0===t.literalValue:void 0!==t.literalValue&&(e.literalValue instanceof Hs?t.literalValue instanceof Hs&&e.literalValue.itemName===t.literalValue.itemName:e.literalValue===t.literalValue)},e.isUnspecialized=function(e){return e.details.typeParameters.length>0&&void 0===e.typeArguments},e.isSpecialBuiltIn=function(e,t){return!!(2&e.details.flags||e.aliasName)&&(void 0===t||e.details.name===t)},e.isBuiltIn=n,e.supportsAbstractMethods=function(e){return!!(512&e.details.flags)},e.isDataClass=function(e){return!!(4&e.details.flags)},e.isSkipSynthesizedDataClassInit=function(e){return!!(16&e.details.flags)},e.isSkipSynthesizedDataClassEq=function(e){return!!(32&e.details.flags)},e.isFrozenDataClass=function(e){return!!(8&e.details.flags)},e.isSynthesizedDataclassOrder=function(e){return!!(64&e.details.flags)},e.isDataClassKeywordOnlyParams=function(e){return!!(2097152&e.details.flags)},e.isGeneratedDataClassSlots=function(e){return!!(33554432&e.details.flags)},e.isSynthesizeDataClassUnsafeHash=function(e){return!!(67108864&e.details.flags)},e.isTypedDictClass=function(e){return!!(128&e.details.flags)},e.isCanOmitDictValues=function(e){return!!(256&e.details.flags)},e.isEnumClass=function(e){return!!(1048576&e.details.flags)},e.isPropertyClass=function(e){return!!(2048&e.details.flags)},e.isClassProperty=function(e){return!!(4194304&e.details.flags)},e.isFinal=function(e){return!!(4096&e.details.flags)},e.isProtocolClass=function(e){return!!(8192&e.details.flags)},e.isDefinedInStub=function(e){return!!(8388608&e.details.flags)},e.isPseudoGenericClass=function(e){return!!(16384&e.details.flags)},e.getDataClassEntries=function(e){return e.details.dataClassEntries||[]},e.isRuntimeCheckable=function(e){return!!(32768&e.details.flags)},e.isTypingExtensionClass=function(e){return!!(65536&e.details.flags)},e.isPartiallyConstructed=function(e){return!!(131072&e.details.flags)},e.hasCustomClassGetItem=function(e){return!!(262144&e.details.flags)},e.isTupleClass=function(e){return!!(524288&e.details.flags)},e.isReadOnlyInstanceVariables=function(e){return!!(16777216&e.details.flags)},e.getTypeParameters=function(e){return e.details.typeParameters},e.hasUnknownBaseClass=function(e){return e.details.mro.some((e=>ho(e)))},e.isSameGenericClass=i,e.isDerivedFrom=function e(t,r,s){if(i(t,r))return s&&s.push(t),!0;if(n(t)&&n(r,"object"))return s&&s.push(r),!0;for(const n of t.details.baseClasses)if(_o(n)){if(e(n,r,s))return s&&s.push(t),!0}else if(ho(n))return s&&s.push(Ys.create()),!0;return!1}}(Zs||(Zs={})),function(e){function t(e,t,n,i,r,s){return{category:5,details:{name:e,fullName:t,moduleName:n,flags:i,parameters:[],docString:s},flags:r}}function n(e,t){return w(t<e.details.parameters.length,"Parameter types array overflow"),e.specializedTypes&&t<e.specializedTypes.parameterTypes.length?e.specializedTypes.parameterTypes[t]:e.details.parameters[t].type}e.createInstance=function(e,n,i,r,s){return t(e,n,i,r,2,s)},e.createInstantiable=function(e,n,i,r,s){return t(e,n,i,r,1,s)},e.clone=function(e,i=!1,r,s){const o=t(e.details.name,e.details.fullName,e.details.moduleName,e.details.flags,e.flags,e.details.docString);return o.details={...e.details},o.boundToType=r,o.preBoundFlags=o.details.flags,i&&(e.details.parameters.length>0&&0===e.details.parameters[0].category?(e.details.parameters.length>0&&!e.details.parameters[0].isTypeInferred&&(o.strippedFirstParamType=n(e,0)),o.details.parameters=e.details.parameters.slice(1)):i=!1,o.details.flags&=-4,o.details.flags|=4),void 0!==e.typeAliasInfo&&(o.typeAliasInfo=e.typeAliasInfo),e.specializedTypes&&(o.specializedTypes={parameterTypes:i?e.specializedTypes.parameterTypes.slice(1):e.specializedTypes.parameterTypes,returnType:e.specializedTypes.returnType}),o.inferredReturnType=e.inferredReturnType,o.boundTypeVarScopeId=s,o},e.cloneAsInstance=function(e){w(Ks.isInstantiable(e));const t=Ks.cloneType(e);return t.flags&=~9,t.flags|=2,t},e.cloneAsInstantiable=function(e){w(Ks.isInstance(e));const t=Ks.cloneType(e);return t.flags&=-11,t.flags|=1,t},e.cloneForSpecialization=function(e,n,i){const r=t(e.details.name,e.details.fullName,e.details.moduleName,e.details.flags,e.flags,e.details.docString);return r.details=e.details,w(n.parameterTypes.length===e.details.parameters.length),r.specializedTypes=n,i&&(r.inferredReturnType=i),r},e.cloneForParamSpec=function(n,i){const r=t(n.details.name,n.details.fullName,n.details.moduleName,n.details.flags,n.flags,n.details.docString);return r.specializedTypes=n.specializedTypes,r.details={...n.details},delete r.details.paramSpec,i&&(r.details.parameters=[...n.details.parameters,...i.parameters.map((e=>({category:e.category,name:e.name,hasDefault:e.hasDefault,isNameSynthesized:e.isNameSynthesized,hasDeclaredType:!0,type:e.type})))],r.details.docString||(r.details.docString=i.docString),r.details.flags=98311&i.flags|64,e.isParamSpecValue(n)&&(r.details.flags|=65536),r.specializedTypes&&i.parameters.forEach((e=>{r.specializedTypes.parameterTypes.push(e.type)})),r.details.paramSpec=i.paramSpec),r},e.cloneWithNewFlags=function(e,t){const n=Ks.cloneType(e);return n.details={...e.details},n.details.flags=t,n},e.cloneForParamSpecApplication=function(e,t){const n=Ks.cloneType(e);if(n.details={...e.details},n.details.parameters=n.details.parameters.slice(0,n.details.parameters.length-2),t.parameters.some((e=>0===e.category&&!e.name))&&n.details.parameters.length>0){const e=n.details.parameters[n.details.parameters.length-1];0!==e.category||e.name||n.details.parameters.pop()}return t.parameters.forEach((e=>{n.details.parameters.push({category:e.category,name:e.name,hasDefault:e.hasDefault,isNameSynthesized:e.isNameSynthesized,hasDeclaredType:!0,type:e.type})})),n.details.paramSpec=t.paramSpec,n.details.docString||(n.details.docString=t.docString),n},e.cloneRemoveParamSpecVariadics=function(e,n){const i=t(e.details.name,e.details.fullName,e.details.moduleName,e.details.flags,e.flags,e.details.docString);return i.details={...e.details},i.details.parameters=i.details.parameters.slice(0,i.details.parameters.length-2),e.specializedTypes&&(i.specializedTypes={...e.specializedTypes},i.specializedTypes.parameterTypes=i.specializedTypes.parameterTypes.slice(0,i.specializedTypes.parameterTypes.length-2)),i.details.paramSpec||(i.details.paramSpec=n),i},e.addDefaultParameters=function(t,n=!1){e.addParameter(t,{category:1,name:"args",type:n?Ys.create():io.create(),hasDeclaredType:!n}),e.addParameter(t,{category:2,name:"kwargs",type:n?Ys.create():io.create(),hasDeclaredType:!n})},e.hasDefaultParameters=function(t){let n=!1,i=!1;for(let r=0;r<t.details.parameters.length;r++){const s=t.details.parameters[r];if(s.name){if(0===s.category)return!1;if(1===s.category?n=!0:2===s.category&&(i=!0),!ho(e.getEffectiveParameterType(t,r)))return!1}}return n&&i},e.isInstanceMethod=function(e){return 0==(7&e.details.flags)},e.isConstructorMethod=function(e){return 0!=(1&e.details.flags)},e.isStaticMethod=function(e){return 0!=(4&e.details.flags)},e.isClassMethod=function(e){return 0!=(2&e.details.flags)},e.isAbstractMethod=function(e){return 0!=(8&e.details.flags)},e.isGenerator=function(e){return 0!=(16&e.details.flags)},e.isSynthesizedMethod=function(e){return 0!=(64&e.details.flags)},e.isSkipConstructorCheck=function(e){return 0!=(128&e.details.flags)},e.isOverloaded=function(e){return 0!=(256&e.details.flags)},e.isDefaultParameterCheckDisabled=function(e){return 0!=(32&e.details.flags)},e.isAsync=function(e){return 0!=(512&e.details.flags)},e.isWrapReturnTypeInAwait=function(e){return 0!=(1024&e.details.flags)},e.isStubDefinition=function(e){return 0!=(2048&e.details.flags)},e.isPyTypedDefinition=function(e){return 0!=(4096&e.details.flags)},e.isFinal=function(e){return 0!=(8192&e.details.flags)},e.hasUnannotatedParams=function(e){return 0!=(16384&e.details.flags)},e.shouldSkipArgsKwargsCompatibilityCheck=function(e){return 0!=(32768&e.details.flags)},e.isParamSpecValue=function(e){return 0!=(65536&e.details.flags)},e.getEffectiveParameterType=n,e.addParameter=function(e,t){e.details.parameters.push(t)},e.getSpecializedReturnType=function(e){return e.specializedTypes&&e.specializedTypes.returnType?e.specializedTypes.returnType:e.details.declaredReturnType}}(Xs||(Xs={})),function(e){e.create=function(e){return{category:6,overloads:e,flags:2}},e.addOverload=function(e,t){e.overloads.push(t)}}(eo||(eo={})),function(e){const t={category:3,flags:2},n={category:3,flags:1};e.createInstance=function(){return t},e.createType=function(){return n}}(to||(to={})),function(e){const t={category:4,flags:3,isNoReturn:!1},n={category:4,flags:3,isNoReturn:!0};e.createNever=function(){return t},e.createNoReturn=function(){return n}}(no||(no={})),function(e){const t={category:2,isEllipsis:!1,flags:3},n={category:2,isEllipsis:!0,flags:3};e.create=function(e=!1){return e?n:t}}(io||(io={})),function(e){function t(e,t){return e.typeVarName<t.typeVarName?-1:e.typeVarName>t.typeVarName?1:e.constraintIndex<t.constraintIndex?-1:e.constraintIndex>t.constraintIndex?1:0}e.combine=function(e,n){if(!e)return n;if(!n)return e;const i=[...e];return n.forEach((e=>{i.some((n=>0===t(e,n)))||i.push(e)})),i.sort(t)},e.isSame=function(e,t){return e?!(!t||e.length!==t.length)&&void 0===e.find(((e,n)=>e.typeVarName!==t[n].typeVarName||e.constraintIndex!==t[n].constraintIndex)):!t},e.isCompatible=function(e,t){if(!e||!t)return!0;for(const n of e){let e=!1;const i=t.find((t=>n.typeVarName===t.typeVarName&&(e=!0,n.constraintIndex===t.constraintIndex)));if(e&&!i)return!1}return!0}}(ro||(ro={})),function(e){e.create=function(){return{category:9,subtypes:[],flags:3}},e.addType=function(e,t){vo(t)&&Zs.isBuiltIn(t,"str")&&void 0!==t.literalValue&&void 0===t.condition?(void 0===e.literalStrMap&&(e.literalStrMap=new Map),e.literalStrMap.set(t.literalValue,t)):vo(t)&&Zs.isBuiltIn(t,"int")&&void 0!==t.literalValue&&void 0===t.condition&&(void 0===e.literalIntMap&&(e.literalIntMap=new Map),e.literalIntMap.set(t.literalValue,t)),e.flags&=t.flags,e.subtypes.push(t)},e.containsType=function(e,t,n=0){if(vo(t)&&void 0===t.condition){if(Zs.isBuiltIn(t,"str")&&void 0!==t.literalValue&&void 0!==e.literalStrMap)return e.literalStrMap.has(t.literalValue);if(Zs.isBuiltIn(t,"int")&&void 0!==t.literalValue&&void 0!==e.literalIntMap)return e.literalIntMap.has(t.literalValue)}return void 0!==e.subtypes.find((e=>Ao(e,t,void 0,void 0,n)))},e.addTypeAliasSource=function(e,t){if(9===t.category){const n=t.typeAliasInfo?[t]:t.typeAliasSources;n&&(e.typeAliasSources||(e.typeAliasSources=new Set),n.forEach((t=>{e.typeAliasSources.add(t)})))}}}(so||(so={})),function(e){function t(e,t){return`${e}.${t}`}function n(e,t,n){return{category:10,details:{name:e,constraints:[],variance:0,isParamSpec:t,isVariadic:!1,isSynthesized:!1},flags:n}}e.createInstance=function(e){return n(e,!1,2)},e.createInstantiable=function(e,t=!1){return n(e,t,1)},e.cloneAsInstance=function(e){w(Ks.isInstantiable(e));const t=Ks.cloneType(e);return t.flags&=~9,t.flags|=2,t},e.cloneAsInstantiable=function(e){w(Ks.isInstance(e));const t=Ks.cloneType(e);return t.flags&=-11,t.flags|=1,t},e.cloneForScopeId=function(e,n,i,r){const s=Ks.cloneType(e);return s.nameWithScope=t(e.details.name,n),s.scopeId=n,s.scopeName=i,s.scopeType=r,s},e.cloneForUnpacked=function(e,t=!1){w(e.details.isVariadic);const n=Ks.cloneType(e);return n.isVariadicUnpacked=!0,n.isVariadicInUnion=t,n},e.cloneForPacked=function(e){w(e.details.isVariadic);const t=Ks.cloneType(e);return t.isVariadicUnpacked=!1,t.isVariadicInUnion=!1,t},e.cloneAsInvariant=function(e){if(e.details.isParamSpec||e.details.isVariadic)return e;if(0===e.details.variance&&void 0===e.details.boundType&&0===e.details.constraints.length)return e;const t=Ks.cloneType(e);return t.details={...t.details},t.details.variance=0,t.details.boundType=void 0,t.details.constraints=[],t},e.cloneForParamSpecAccess=function(e,t){const n=Ks.cloneType(e);return n.paramSpecAccess=t,n},e.cloneAsSpecializedSelf=function(e,t){w(e.details.isSynthesizedSelf);const n=Ks.cloneType(e);return n.details={...n.details},n.details.boundType=t,n},e.makeNameWithScope=t,e.addConstraint=function(e,t){e.details.constraints.push(t)},e.getNameWithScope=function(e){return e.nameWithScope||e.details.name},e.getReadableName=function(e){return e.scopeName?`${e.details.name}@${e.scopeName}`:e.details.name}}(oo||(oo={}));let Uo=1;class qo{constructor(e=4){this.id=Uo++,this._flags=e}static createWithType(e,t){const n=new qo(e);return n._synthesizedType=t,n}isInitiallyUnbound(){return!!(1&this._flags)}setIsExternallyHidden(){this._flags|=2}isExternallyHidden(){return!!(2&this._flags)}setIsIgnoredForProtocolMatch(){this._flags|=64}isIgnoredForProtocolMatch(){return!!(64&this._flags)}setIsClassMember(){this._flags|=4}isClassMember(){return!!(4&this._flags)}setIsInstanceMember(){this._flags|=8}isInstanceMember(){return!!(8&this._flags)}setIsClassVar(){this._flags|=128}isClassVar(){return!!(128&this._flags)}setIsInitVar(){this._flags|=1024}isInitVar(){return!!(1024&this._flags)}setIsInDunderAll(){this._flags|=256}isInDunderAll(){return!!(256&this._flags)}setIsPrivateMember(){this._flags|=32}isPrivateMember(){return!!(32&this._flags)}setPrivatePyTypedImport(){this._flags|=512}isPrivatePyTypedImport(){return!!(512&this._flags)}addDeclaration(e){if(this._declarations){const t=this._declarations.findIndex((t=>is(t,e)));if(t<0)this._declarations.push(e),this._declarations.forEach((e=>{1===e.type&&e.typeAliasName&&delete e.typeAliasName}));else{const n=this._declarations[t];ns(e)?(this._declarations[t]=e,1===n.type&&1===e.type&&!e.inferredTypeSource&&n.inferredTypeSource&&(e.inferredTypeSource=n.inferredTypeSource)):1===e.type&&1===n.type&&(e.isFinal&&(n.isFinal=!0),e.typeAliasAnnotation&&(n.typeAliasAnnotation=e.typeAliasAnnotation,n.typeAliasName=e.typeAliasName),!n.inferredTypeSource&&e.inferredTypeSource&&(n.inferredTypeSource=e.inferredTypeSource))}}else this._declarations=[e]}hasDeclarations(){return!!this._declarations&&this._declarations.length>0}getDeclarations(){return this._declarations?this._declarations:[]}hasTypedDeclarations(){return!!this._synthesizedType||this.getDeclarations().some((e=>ns(e)))}getTypedDeclarations(){return this.getDeclarations().filter((e=>ns(e)))}getSynthesizedType(){return this._synthesizedType}}function Vo(e){const t=e.getTypedDeclarations();if(t.length>0)return t[t.length-1]}function Bo(e){const t=e.getTypedDeclarations();return t.length>0&&1===t[t.length-1].type}function Wo(e){return e.getDeclarations().some((e=>rs(e)))}class jo{constructor(e){this._isLocked=!1,Array.isArray(e)?this._solveForScopes=e:this._solveForScopes=void 0!==e?[e]:void 0,this._typeVarMap=new Map,this._paramSpecMap=new Map}clone(){const e=new jo;return this._solveForScopes&&(e._solveForScopes=[...this._solveForScopes]),this._typeVarMap.forEach((t=>{e.setTypeVarType(t.typeVar,t.narrowBound,t.wideBound,t.retainLiteral)})),this._paramSpecMap.forEach((t=>{e.setParamSpec(t.paramSpec,t.type)})),this._variadicTypeVarMap&&this._variadicTypeVarMap.forEach((t=>{e.setVariadicTypeVar(t.typeVar,t.types)})),e._isLocked=this._isLocked,e}copyFromClone(e){this._typeVarMap=e._typeVarMap,this._paramSpecMap=e._paramSpecMap,this._variadicTypeVarMap=e._variadicTypeVarMap,this._isLocked=e._isLocked}getSolveForScopes(){return this._solveForScopes}hasSolveForScope(e){return void 0!==e&&void 0!==this._solveForScopes&&this._solveForScopes.some((t=>t===e||t===$s))}setSolveForScopes(e){this._solveForScopes=e}addSolveForScope(e){void 0===e||this.hasSolveForScope(e)||(this._solveForScopes||(this._solveForScopes=[]),this._solveForScopes.push(e))}isEmpty(){return 0===this._typeVarMap.size&&0===this._paramSpecMap.size}getScore(){let e=0;return this._typeVarMap.forEach((t=>{e+=1;const n=this.getTypeVarType(t.typeVar);e+=1-this._getComplexityScoreForType(n)})),e+=this._paramSpecMap.size,e}hasTypeVar(e){return this._typeVarMap.has(this._getKey(e))}getTypeVarType(e,t=!1){const n=this._typeVarMap.get(this._getKey(e));if(n)return n.narrowBound?n.narrowBound:t?void 0:n.wideBound}setTypeVarType(e,t,n,i){w(!this._isLocked);const r=this._getKey(e);this._typeVarMap.set(r,{typeVar:e,narrowBound:t,wideBound:n,retainLiteral:i})}getVariadicTypeVar(e){var t,n;return null===(n=null===(t=this._variadicTypeVarMap)||void 0===t?void 0:t.get(this._getKey(e)))||void 0===n?void 0:n.types}setVariadicTypeVar(e,t){w(!this._isLocked);const n=this._getKey(e);this._variadicTypeVarMap||(this._variadicTypeVarMap=new Map),this._variadicTypeVarMap.set(n,{typeVar:e,types:t})}getTypeVar(e){const t=this._getKey(e);return this._typeVarMap.get(t)}getTypeVars(){const e=[];return this._typeVarMap.forEach((t=>{e.push(t)})),e}hasParamSpec(e){return this._paramSpecMap.has(this._getKey(e))}getParamSpec(e){var t;return null===(t=this._paramSpecMap.get(this._getKey(e)))||void 0===t?void 0:t.type}setParamSpec(e,t){w(!this._isLocked),this._paramSpecMap.set(this._getKey(e),{paramSpec:e,type:t})}typeVarCount(){return this._typeVarMap.size}getWideTypeBound(e){const t=this._typeVarMap.get(this._getKey(e));if(t)return t.wideBound}getRetainLiterals(e){const t=this._typeVarMap.get(this._getKey(e));return!!(null==t?void 0:t.retainLiteral)}lock(){w(!this._isLocked),this._isLocked=!0}unlock(){this._isLocked=!1}isLocked(){return this._isLocked}_getKey(e){return oo.getNameWithScope(e)}_getComplexityScoreForType(e,t=0){if(t>Gs)return 1;switch(t++,e.category){case 1:case 2:case 3:case 5:case 6:case 10:return.5;case 0:case 4:return 1;case 9:{let n=0;return e.subtypes.length<16&&Jo(e,(e=>{const i=this._getComplexityScoreForType(e,t);n=Math.max(n,i)})),.75+n/4}case 7:return this._getComplexityScoreForClass(e,t)}return 0}_getComplexityScoreForClass(e,t){let n=0,i=0;return e.tupleTypeArguments?e.tupleTypeArguments.forEach((e=>{n+=this._getComplexityScoreForType(e.type,t),i++})):e.typeArguments?e.typeArguments.forEach((e=>{n+=this._getComplexityScoreForType(e,t),i++})):e.details.typeParameters&&e.details.typeParameters.forEach((e=>{n+=this._getComplexityScoreForType(io.create(),t),i++})),.5+.25*(i>0?n/i:0)}}var zo,$o;function Ho(e){const t={firstPositionOrKeywordIndex:0,positionParamCount:0,positionOnlyParamCount:0,params:[],hasUnpackedVariadicTypeVar:!1};let n=e.details.parameters.findIndex((e=>0===e.category&&!e.name));if(n<0)for(let t=0;t<e.details.parameters.length;t++){const i=e.details.parameters[t];if(0!==i.category)break;if(!i.name)break;if(Qt(i.name)||!i.name.startsWith("__"))break;n=t+1}n>=0&&(t.firstPositionOrKeywordIndex=n);for(let i=0;i<n&&!e.details.parameters[i].hasDefault;i++)t.positionOnlyParamCount++,t.positionParamCount++;let i=!1;const r=(r,s,o)=>{if(r.name){let a;a=1===r.category?zo.PositionOnly:i?zo.KeywordOnly:n>=0&&s<n?zo.PositionOnly:zo.PositionOrKeyword,t.params.push({param:r,index:s,type:null!=o?o:Xs.getEffectiveParameterType(e,s),source:a})}};return e.details.parameters.forEach(((e,s)=>{1===e.category?e.name&&xo(e.type)&&e.type.tupleTypeArguments?e.type.tupleTypeArguments.forEach(((n,i)=>{const s=Io(n.type)||n.isUnbounded?1:0;1===s&&(t.argsIndex=t.params.length),Io(e.type)&&(t.hasUnpackedVariadicTypeVar=!0),r({category:s,name:`${e.name}[${i.toString()}]`,type:n.type,hasDeclaredType:!0},i,n.type)})):(e.name&&void 0===t.argsIndex&&(t.argsIndex=t.params.length,Io(e.type)&&(t.hasUnpackedVariadicTypeVar=!0)),!i&&(n<0||s>=n)&&(t.firstKeywordOnlyIndex=t.params.length,e.name&&t.firstKeywordOnlyIndex++,i=!0),r(e,s)):2===e.category?(i=!0,vo(e.type)&&xo(e.type)&&e.type.details.typedDictEntries?(void 0===t.firstKeywordOnlyIndex&&(t.firstKeywordOnlyIndex=t.params.length),e.type.details.typedDictEntries.forEach(((e,t)=>{r({category:0,name:t,type:e.valueType,hasDeclaredType:!0,hasDefault:!e.isRequired},s,e.valueType)}))):e.name&&(void 0===t.kwargsIndex&&(t.kwargsIndex=t.params.length),void 0===t.firstKeywordOnlyIndex&&(t.firstKeywordOnlyIndex=t.params.length),r(e,s))):0===e.category&&(e.name&&!i&&t.positionParamCount++,r(e,s))})),t}function Go(e){return!!fo(e)&&void 0!==Mo(e,(e=>lo(e)))}function Ko(e,t){if(fo(e)){const n=[];let i=!1;if(e.subtypes.forEach((r=>{const s=t(r);s?s!==r?(n.push(Zo(s,Xo(e))),i=!0):n.push(r):i=!0})),!i)return e;const r=Oo(n);return 9===r.category&&so.addTypeAliasSource(r,e),r}return t(e)||no.createNever()}function Jo(e,t){fo(e)?e.subtypes.forEach(((e,n)=>{t(e,n)})):t(e,0)}function Yo(e,t){if(e.length<2)return!0;for(let n=1;n<e.length;n++)if(!Ao(e[0],e[n],t))return!1;return!0}function Qo(e){return yo(e)?(void 0!==e.literalValue&&(e=Zs.cloneWithLiteral(e,void 0)),e):fo(e)?Ko(e,(e=>Qo(e))):e}function Zo(e,t){if(!t)return e;switch(e.category){case 0:case 1:case 2:case 4:case 8:case 10:return e;case 3:case 5:return Ks.cloneForCondition(e,ro.combine(e.condition,t));case 6:return eo.create(e.overloads.map((e=>Zo(e,t))));case 7:return Ks.cloneForCondition(e,ro.combine(e.condition,t));case 9:return Oo(e.subtypes.map((e=>Zo(e,t))))}}function Xo(e){switch(e.category){case 0:case 1:case 2:case 4:case 8:case 10:case 6:case 9:return;case 3:case 7:case 5:return e.condition}}function ea(e){return!!bo(e)&&!!e.details.recursiveTypeAliasName&&!e.details.boundType}function ta(e){var t;if(e&&bo(e)&&e.details.recursiveTypeAliasName&&e.details.boundType){const n=Ks.isInstance(e)?Fa(e.details.boundType):e.details.boundType;return(null===(t=e.typeAliasInfo)||void 0===t?void 0:t.typeArguments)&&e.details.recursiveTypeParameters?fa(n,Ea(e.details.recursiveTypeParameters,e.typeAliasInfo.typeArguments,na(e))):n}return e}function na(e){return yo(e)||Eo(e)?e.details.typeVarScopeId:bo(e)?e.scopeId:void 0}function ia(e){let t;if(_o(e)?t=e:vo(e)&&(t=Zs.cloneAsInstantiable(e)),!t)return;const n=t.details.mro.find((e=>_o(e)&&pa(e)));return n&&_o(n)?Zs.isSameGenericClass(t,n)?t:fa(n,wa(t)):void 0}function ra(e){return Ks.isInstance(e)&&void 0!==e.literalValue}function sa(e){return vo(e)?void 0!==e.literalValue:!!fo(e)&&!Mo(e,(e=>!vo(e)||void 0===e.literalValue))}function oa(e,t=!1,n=0){var i;if(n>Gs)return!1;if(n++,vo(e)&&ra(e))return!0;if(t&&yo(e)){const r=(null===(i=e.tupleTypeArguments)||void 0===i?void 0:i.map((e=>e.type)))||e.typeArguments;if(r)return r.some((e=>oa(e,t,n)))}if(fo(e))return e.subtypes.some((e=>oa(e,t,n)));if(ko(e))return e.overloads.some((e=>oa(e,t,n)));if(Eo(e)){const i=Xs.getSpecializedReturnType(e);if(i&&oa(i,t,n))return!0;for(let i=0;i<e.details.parameters.length;i++)if(oa(Xs.getEffectiveParameterType(e,i),t,n))return!0}return!1}function aa(e){if(vo(e))return void 0!==e.literalValue&&Zs.isBuiltIn(e)?e.details.name:void 0;if(fo(e)){let t,n=!1;return Jo(e,(e=>{const i=aa(e);i?t||(t=i):n=!0})),n?void 0:t}}function la(e){return fo(e)?e.subtypes.length:1}function ca(e){return uo(e)&&e.isEllipsis}function ua(e){return vo(e)&&Zs.isPropertyClass(e)}function pa(e){return Zs.isBuiltIn(e,"tuple")}function da(e){return e.tupleTypeArguments&&e.tupleTypeArguments.some((e=>e.isUnbounded))}function ha(e,t,n){if(Zs.isUnspecialized(t))return e;const i=wa(t,void 0);return n&&ma(i,t,n),fa(e,i)}function ma(e,t,n){const i=Aa(t,!1);e.setTypeVarType(i,Fa(n))}function fa(e,t,n=!1,i=!1,r=!1){return!t.isEmpty()||n||r?new Qa(t,n,i,r).apply(e):e}function ga(e){const t=new Map;return Zs.isProtocolClass(e)&&ya(e,t),t}function ya(e,t,n=0){n>Gs||(e.details.baseClasses.forEach((e=>{yo(e)&&Zs.isProtocolClass(e)&&ya(e,t,n+1)})),e.details.fields.forEach(((n,i)=>{n.isIgnoredForProtocolMatch()||t.set(i,{symbol:n,classType:e,isInstanceMember:n.isInstanceMember(),isClassVar:n.isClassVar(),isTypeDeclared:n.hasTypedDeclarations(),skippedUndeclaredType:!1})})))}function _a(e,t,n=0){if(vo(e))return va(e,t,n)}function va(e,t,n=0){var i;return null===(i=Ta(e,t,n).next())||void 0===i?void 0:i.value}function*Ta(e,t,n=0){const i=0!=(16&n);let r=!1;if(yo(e)){let s=0;1&n&&(s|=1),2&n&&(s|=2),4&n&&(s|=4),32&n&&(s|=8);const o=ba(e,s);for(const[e,s]of o){if(!_o(e)){if(!i){const e={symbol:qo.createWithType(0,Ys.create()),isInstanceMember:!1,isClassVar:!0,classType:Ys.create(),isTypeDeclared:!1,skippedUndeclaredType:!1};yield e}continue}if(!_o(s))continue;const o=s.details.fields;if(0==(8&n)){const e=o.get(t);if(e&&e.isInstanceMember()){const t=e.hasTypedDeclarations();if(!i||t){const n={symbol:e,isInstanceMember:!0,isClassVar:e.isClassVar(),classType:s,isTypeDeclared:t,skippedUndeclaredType:r};yield n}else r=!0}}const a=o.get(t);if(a&&a.isClassMember()){const e=a.hasTypedDeclarations();if(!i||e){let t=!1;if(Zs.isDataClass(s)||Zs.isTypedDictClass(s)){const e=a.getDeclarations();e.length>0&&1===e[0].type&&(t=!0)}const n={symbol:a,isInstanceMember:t,isClassVar:a.isClassVar(),classType:s,isTypeDeclared:e,skippedUndeclaredType:r};yield n}else r=!0}}}else if(ho(e)){const e={symbol:qo.createWithType(0,Ys.create()),isInstanceMember:!1,isClassVar:!0,classType:Ys.create(),isTypeDeclared:!1,skippedUndeclaredType:!1};yield e}}function*ba(e,t=0){if(yo(e)){let n=0!=(1&t);for(const i of e.details.mro){if(n){n=!1;continue}const r=ha(i,e);if(4&t&&_o(r)&&Zs.isBuiltIn(r,"object"))break;if(8&t&&_o(r)&&Zs.isBuiltIn(r,"type"))break;if(yield[i,r],0!=(2&t))break}}}function Ia(e,t){for(const n of t)e.find((e=>Ao(Fa(e),Fa(n))))||e.push(n)}function Sa(e,t=0){var n,i;if(t>Gs)return[];if(t++,null===(n=e.typeAliasInfo)||void 0===n?void 0:n.typeArguments){const n=[];return null===(i=e.typeAliasInfo)||void 0===i||i.typeArguments.forEach((e=>{Ia(n,Sa(e,t))})),n}if(bo(e))return e.details.recursiveTypeAliasName||wo(e)&&e.paramSpecAccess?[]:[Ks.isInstantiable(e)?oo.cloneAsInstance(e):e];if(yo(e))return(e=>{const n=[];return e.typeArguments&&e.typeArguments.forEach((e=>{Ia(n,Sa(e,t))})),n})(e);if(fo(e)){const n=[];return Jo(e,(e=>{Ia(n,Sa(e,t))})),n}if(Eo(e)){const n=[];for(let i=0;i<e.details.parameters.length;i++)Ia(n,Sa(Xs.getEffectiveParameterType(e,i),t));e.details.paramSpec&&Ia(n,[e.details.paramSpec]);const i=Xs.getSpecializedReturnType(e);return i&&Ia(n,Sa(i,t)),n}return[]}function xa(e){const t=new jo(na(e));return Zs.getTypeParameters(e).forEach((e=>{t.setTypeVarType(e,Ys.create())})),fa(e,t)}function Ca(e,t,n,i=0){if(!(i>Gs||(i++,n.isLocked())))switch(e.category){case 9:Jo(e,(e=>{Ca(e,t,n,i)}));break;case 7:e.typeArguments&&e.typeArguments.forEach((e=>{Ca(e,t,n,i)})),e.tupleTypeArguments&&e.tupleTypeArguments.forEach((e=>{Ca(e.type,t,n,i)}));break;case 5:e.specializedTypes?(e.specializedTypes.parameterTypes.forEach((e=>{Ca(e,t,n,i)})),e.specializedTypes.returnType&&Ca(e.specializedTypes.returnType,t,n,i)):(e.details.parameters.forEach((e=>{Ca(e.type,t,n,i)})),e.details.declaredReturnType&&Ca(e.details.declaredReturnType,t,n,i));break;case 6:e.overloads.forEach((e=>{Ca(e,t,n,i)}));break;case 10:n.hasTypeVar(e)||n.setTypeVarType(e,t)}}function wa(e,t=!0){const n=Zs.getTypeParameters(e);let i=e.typeArguments;i||t||(i=n);const r=Ea(n,i,na(e));return Zs.isTupleClass(e)&&e.tupleTypeArguments&&n.length>=1&&r.setVariadicTypeVar(n[0],e.tupleTypeArguments),r}function Ea(e,t,n){const i=new jo(n);return e.forEach(((e,n)=>{let r;if(t)if(wo(e)){if(n<t.length)if(r=t[n],Eo(r)&&Xs.isParamSpecValue(r)){const t=[],n=r;r.details.parameters.forEach(((e,i)=>{t.push({category:e.category,name:e.name,hasDefault:!!e.hasDefault,isNameSynthesized:e.isNameSynthesized,type:Xs.getEffectiveParameterType(n,i)})})),i.setParamSpec(e,{parameters:t,typeVarScopeId:r.details.typeVarScopeId,flags:r.details.flags,docString:r.details.docString,paramSpec:r.details.paramSpec})}else wo(r)&&i.setParamSpec(e,{flags:0,parameters:[],typeVarScopeId:void 0,docString:void 0,paramSpec:r})}else r=n>=t.length?io.create():t[n],i.setTypeVarType(e,r,r,!0)})),i}function ka(e,t){if(0===Zs.getTypeParameters(t).length)return t;const n=fa(t,wa(e));return w(_o(n)),n}function Da(e,t,n){if(Zs.isSameGenericClass(e,t))return!0;for(const i of e.details.baseClasses)if(_o(i)){if(Da(i,t,n))return!0}else if(!n&&ho(i))return!0;return!1}function Aa(e,t){var n;const i=oo.createInstance("__type_of_self__"),r=null!==(n=na(e))&&void 0!==n?n:"";i.details.isSynthesized=!0,i.details.isSynthesizedSelf=!0,i.nameWithScope=oo.makeNameWithScope(i.details.name,r),i.scopeId=r;const s=Zs.cloneForSpecialization(e,Zs.getTypeParameters(e),!1,!0);return i.details.boundType=Zs.cloneAsInstance(s),t?oo.cloneAsInstantiable(i):i}function Pa(e){const t=Xs.getSpecializedReturnType(e);if(t){const e=za(t);if(e)return e.length>=3?e[2]:Ys.create()}}function Ra(e){return!!Ks.isInstantiable(e)||!(!vo(e)||!Zs.isBuiltIn(e,"type"))||!!fo(e)&&e.subtypes.every((e=>Ra(e)))}function Fa(e){let t=Ko(e,(e=>{switch(e.category){case 7:return Zs.isBuiltIn(e,"Type")?!e.typeArguments||e.typeArguments.length<1?Ys.create():Na(e.typeArguments[0]):Zs.cloneAsInstance(e);case 3:return to.createInstance();case 5:if(Ks.isInstantiable(e))return Xs.cloneAsInstance(e);break;case 10:if(Ks.isInstantiable(e))return oo.cloneAsInstance(e)}return e}));return e.typeAliasInfo&&e!==t&&(t=Ks.cloneForTypeAlias(t,e.typeAliasInfo.name,e.typeAliasInfo.fullName,e.typeAliasInfo.typeVarScopeId,e.typeAliasInfo.typeParameters,e.typeAliasInfo.typeArguments)),t}function Na(e){let t=Ko(e,(e=>{switch(e.category){case 7:if(Ks.isInstance(e))return Zs.cloneAsInstantiable(e);break;case 3:return to.createType();case 5:if(Ks.isInstance(e))return Xs.cloneAsInstantiable(e);break;case 10:if(Ks.isInstance(e))return oo.cloneAsInstantiable(e)}return e}));return e.typeAliasInfo&&e!==t&&(t=Ks.cloneForTypeAlias(t,e.typeAliasInfo.name,e.typeAliasInfo.fullName,e.typeAliasInfo.typeVarScopeId,e.typeAliasInfo.typeParameters,e.typeAliasInfo.typeArguments)),t}function Ma(e,t,n){for(let i=0;i<e.details.mro.length;i++){const r=e.details.mro[i];if(_o(r)){const e=Zs.isTypedDictClass(r);r.details.fields.forEach(((i,r)=>{if((i.isClassMember()||n&&i.isInstanceMember())&&!(e&&Bo(i)||i.isInitVar())){const e=t.get(r);e?!e.hasTypedDeclarations()&&i.hasTypedDeclarations()&&t.set(r,i):t.set(r,i)}}))}}if(!n){const n=e.details.effectiveMetaclass;if(n&&_o(n))for(const e of n.details.mro){if(!_o(e))break;e.details.fields.forEach(((e,n)=>{const i=t.get(n);i?!i.hasTypedDeclarations()&&e.hasTypedDeclarations()&&t.set(n,e):t.set(n,e)}))}}}function Oa(e){let t=!1;return Jo(e,(e=>{po(e)&&(t=!0)})),t}function La(e,t=!1,n=0){var i,r;if(n>Gs)return!1;if(n++,po(e))return!0;if((null===(i=e.typeAliasInfo)||void 0===i?void 0:i.typeArguments)&&e.typeAliasInfo.typeArguments.some((e=>La(e,t,n))))return!0;if(fo(e))return void 0!==Mo(e,(e=>La(e,t,n)));if(yo(e)){if(Ks.isInstance(e)&&(t=!1),!t&&!Zs.isPseudoGenericClass(e)){const i=(null===(r=e.tupleTypeArguments)||void 0===r?void 0:r.map((e=>e.type)))||e.typeArguments;if(i)for(const e of i)if(La(e,t,n))return!0}return!1}if(ko(e))return e.overloads.some((e=>La(e,!1,n)));if(Eo(e)){for(let t=0;t<e.details.parameters.length;t++)if(e.details.parameters[t].name&&La(Xs.getEffectiveParameterType(e,t),!1,n))return!0;return!(!e.details.declaredReturnType||Xs.isParamSpecValue(e)||!La(e.details.declaredReturnType,!1,n))}return!1}function Ua(e){return e.typeArguments&&1===e.typeArguments.length&&fo(e.typeArguments[0])?Oo(e.typeArguments[0].subtypes.map((t=>Zs.cloneForSpecialization(e,[t],!0)))):e}function qa(e,t){if(!t||!_o(t)||da(t))return;let n,i=!0;return Jo(e,(e=>{if(vo(e)){let t;yo(e)&&pa(e)&&!da(e)&&(t=e),t||(t=e.details.mro.find((e=>yo(e)&&pa(e)&&!da(e)))),t&&yo(t)&&t.tupleTypeArguments?n?n.length===t.tupleTypeArguments.length?t.tupleTypeArguments.forEach(((e,t)=>{n[t].push(e.type)})):i=!1:n=t.tupleTypeArguments.map((e=>[e.type])):i=!1}else i=!1})),i&&n?Fa(Va(t,n.map((e=>({type:Oo(e),isUnbounded:!1}))))):void 0}function Va(e,t,n=!0,i=!0,r=!1){let s=Oo(t.map((e=>e.type)));i&&(s=Qo(s)),ao(s)&&(s=io.create());const o=Zs.cloneForSpecialization(e,[s],n,void 0,t);return r&&(o.isUnpacked=!0),o}function Ba(e){if(Eo(e))return Wa(e);const t=[];let n=!1;for(const i of e.overloads){const e=Wa(i);t.push(e),e!==i&&(n=!0)}return n?eo.create(t):e}function Wa(e){const t=e.details.parameters.length;if(t<2)return e;const n=e.details.parameters[t-2],i=e.details.parameters[t-1];return 1===n.category&&2===i.category&&wo(n.type)&&wo(i.type)&&Ao(n.type,i.type)?Xs.cloneRemoveParamSpecVariadics(e,n.type):e}function ja(e){return vo(e)&&pa(e)&&e.tupleTypeArguments&&e.isUnpacked?Oo(e.tupleTypeArguments.map((e=>e.type))):e}function za(e){var t;if(vo(e)){if(Zs.isBuiltIn(e,["Generator","AsyncGenerator"]))return e.typeArguments;if(Zs.isBuiltIn(e,"AwaitableGenerator"))return null===(t=e.typeArguments)||void 0===t?void 0:t.slice(1)}}function $a(e,t=!1,n=!1,i=0){var r;if(i>Gs)return!1;switch(i++,e.category){case 7:return(!Zs.isPseudoGenericClass(e)||!t)&&(e.typeArguments?void 0!==e.typeArguments.find((e=>$a(e,t,n,i))):Zs.getTypeParameters(e).length>0);case 5:{if(e.details.paramSpec)return!0;for(let r=0;r<e.details.parameters.length;r++)if($a(Xs.getEffectiveParameterType(e,r),t,n,i))return!0;const r=e.specializedTypes&&e.specializedTypes.returnType?e.specializedTypes.returnType:e.details.declaredReturnType;if(r){if($a(r,t,n,i))return!0}else if(e.inferredReturnType&&$a(e.inferredReturnType,t,n,i))return!0;return!1}case 6:return void 0!==e.overloads.find((e=>$a(e,t,n,i)));case 9:return void 0!==Mo(e,(e=>$a(e,t,n,i)));case 10:if(!e.details.recursiveTypeAliasName)return!e.details.isSynthesizedSelf||!n;if(null===(r=e.typeAliasInfo)||void 0===r?void 0:r.typeArguments)return e.typeAliasInfo.typeArguments.some((e=>$a(e,t,n,i)))}return!1}function Ha(e){let t=!0;const n=e.details.baseClasses.filter(((t,n)=>{if(_o(t)&&Zs.isBuiltIn(t,"Generic")){if(Zs.isProtocolClass(e))return!1;if(e.details.baseClasses.some(((e,t)=>t>n&&_o(e)&&e.typeArguments&&e.isTypeArgumentExplicit)))return!1}return!0})),i=[];n.forEach(((e,t)=>{if(_o(e)){const t=wa(e,!1);i.push(e.details.mro.map((e=>fa(e,t))))}else i.push([e])})),i.push(n.map((t=>fa(t,wa(e,!1)))));const r=wa(e,!1);e.details.mro.push(fa(e,r));const s=(e,t)=>t.some((t=>t.findIndex((t=>_o(t)&&Zs.isSameGenericClass(t,e)))>0)),o=(e,t)=>{for(let n=0;n<t.length;n++)t[n]=t[n].filter((t=>!_o(t)||!Zs.isSameGenericClass(t,e)))};for(;;){let n,r=!1;for(let t=0;t<i.length;t++){const a=i[t];if(a.length>0){if(void 0===n&&(n=a),!_o(a[0])){r=!0,e.details.mro.push(a[0]),a.shift();break}if(!s(a[0],i)){r=!0,e.details.mro.push(a[0]),o(a[0],i);break}}}if(!n)break;r||(t=!1,_o(n[0])?(e.details.mro.push(n[0]),o(n[0],i)):(e.details.mro.push(n[0]),n.shift()))}return t}function Ga(e){const t=[];return Ka(e,t),t}function Ka(e,t,n=0){if(n>Gs)return;n++;const i=e=>{e&&!t.some((t=>t===e))&&t.push(e)};switch(e.category){case 7:case 5:i(e.details.moduleName);break;case 6:e.overloads.forEach((e=>{Ka(e,t,n)}));break;case 9:Jo(e,(e=>{Ka(e,t,n)}));break;case 8:i(e.moduleName)}}function Ja(e){let t=e.parameters.length>0;if(1===e.parameters.length){const n=e.parameters[0];0!==n.category||n.name||(t=!1)}if(t||!e.paramSpec){const t=Xs.createInstance("","","",65536);return e.parameters.forEach((e=>{Xs.addParameter(t,{category:e.category,name:e.name,hasDefault:e.hasDefault,isNameSynthesized:e.isNameSynthesized,hasDeclaredType:!0,type:e.type})})),t.details.paramSpec=e.paramSpec,t.details.docString=e.docString,t}return e.paramSpec}!function(e){e[e.PositionOnly=0]="PositionOnly",e[e.PositionOrKeyword=1]="PositionOrKeyword",e[e.KeywordOnly=2]="KeywordOnly"}(zo||(zo={}));class Ya{constructor(){this._isTransformingTypeArg=!1}apply(e,t=new Set,n=0){var i;if(n>Gs)return e;if(n++,!$a(e))return e;if(ho(e))return e;if(lo(e))return e;if(bo(e)){if(e.details.recursiveTypeAliasName){if(!(null===(i=e.typeAliasInfo)||void 0===i?void 0:i.typeArguments))return e;let r=!1;const s=e.typeAliasInfo.typeArguments.map((e=>{const i=this.apply(e,t,n);return i!==e&&(r=!0),i}));return r?Ks.cloneForTypeAlias(e,e.typeAliasInfo.name,e.typeAliasInfo.fullName,e.typeAliasInfo.typeVarScopeId,e.typeAliasInfo.typeParameters,s):e}let r=e;const s=oo.getNameWithScope(e);return t.has(s)||(r=this.transformTypeVar(e),this._isTransformingTypeArg||(t.add(s),r=this.apply(r,t,n),t.delete(s)),Io(e)&&e.isVariadicInUnion&&(r=ja(r))),r}if(fo(e)){const i=Ko(e,(e=>{let i=this.apply(e,t,n);if(Io(e)&&!Io(i)){const e=[];Jo(i,(t=>{e.push(ja(t))})),i=Oo(e)}return i}));return this.transformUnion&&fo(i)?this.transformUnion(i):i}if(yo(e))return this._transformTypeVarsInClassType(e,t,n);if(Eo(e))return this._transformTypeVarsInFunctionType(e,t,n);if(ko(e)){let i=!1;const r=[];return e.overloads.forEach((e=>{const s=this._transformTypeVarsInFunctionType(e,t,n);r.push(s),s!==e&&(i=!0)})),i?eo.create(r):e}return e}transformTypeVar(e){return e}transformVariadicTypeVar(e){}transformParamSpec(e){}transformUnion(e){return e}_transformTypeVarsInClassType(e,t,n){if(0===Zs.getTypeParameters(e).length&&!Zs.isSpecialBuiltIn(e))return e;let i,r=[],s=!1;const o=Zs.getTypeParameters(e),a=e=>{const t=this.transformParamSpec(e);return t?(s=!0,Ja(t)):e},l=this._isTransformingTypeArg;return this._isTransformingTypeArg=!0,e.typeArguments?r=e.typeArguments.map((e=>{if(bo(e)&&e.details.isParamSpec)return a(e);let i=this.apply(e,t,n);return i!==e&&(s=!0,bo(e)&&Io(e)&&e.isVariadicInUnion&&(i=ja(i))),i})):o.forEach((e=>{let i=e;if(e.details.isParamSpec)i=a(e),i!==e&&(s=!0);else{const r=oo.getNameWithScope(e);t.has(r)||(i=this.transformTypeVar(e),i!==e&&(this._isTransformingTypeArg||(t.add(r),i=this.apply(i,t,n),t.delete(r)),s=!0))}r.push(i)})),Zs.isTupleClass(e)&&(e.tupleTypeArguments?(i=[],e.tupleTypeArguments.forEach((e=>{const r=this.apply(e.type,t,n);r!==e.type&&(s=!0),Io(e.type)&&vo(r)&&pa(r)&&r.tupleTypeArguments?i.push(...r.tupleTypeArguments):i.push({type:r,isUnbounded:e.isUnbounded})}))):o.length>0&&(i=this.transformVariadicTypeVar(o[0]),i&&(s=!0))),this._isTransformingTypeArg=l,s?Zs.cloneForSpecialization(e,r,!0,void 0,i):e}_transformTypeVarsInFunctionType(e,t,n){let i=e;if(i.details.paramSpec){const e=this.transformParamSpec(i.details.paramSpec);e&&(i=Xs.cloneForParamSpec(i,e))}const r=Xs.getSpecializedReturnType(i),s=r?this.apply(r,t,n):void 0;let o=r!==s;const a={parameterTypes:[],returnType:s};if(i.details.parameters.length>=2){const e=i.details.parameters[i.details.parameters.length-2],t=i.details.parameters[i.details.parameters.length-1],n=Xs.getEffectiveParameterType(i,i.details.parameters.length-2),r=Xs.getEffectiveParameterType(i,i.details.parameters.length-1);if(1===e.category&&2===t.category&&wo(n)&&wo(r)&&Ao(n,r)){const e=this.transformParamSpec(n);e&&(i=Xs.cloneForParamSpecApplication(i,e))}}let l,c,u;for(let e=0;e<i.details.parameters.length;e++){const r=Xs.getEffectiveParameterType(i,e),s=this.apply(r,t,n);a.parameterTypes.push(s),void 0===l&&Io(r)&&1===i.details.parameters[e].category&&(l=e,vo(s)&&pa(s)&&s.isUnpacked&&(c=s.tupleTypeArguments)),r!==s&&(o=!0)}if(!o)return i;if(i.inferredReturnType&&(u=this.apply(i.inferredReturnType,t,n)),!c)return Xs.cloneForSpecialization(i,a,u);const p=Xs.createInstance("","","",64);let d=!1,h=!1;return a.parameterTypes.forEach(((e,t)=>{if(t===l){let e=!1;c.forEach((t=>{Xs.addParameter(p,{category:t.isUnbounded?1:0,name:`__p${p.details.parameters.length}`,isNameSynthesized:!0,type:t.type,hasDeclaredType:!0}),t.isUnbounded&&(e=!0)})),e?h=!0:d=!0}else{const n={...i.details.parameters[t]};1!==n.category||n.name?2===n.category&&(d=!1):d=!1,0===n.category&&n.name&&d&&(Xs.addParameter(p,{category:1,type:Ys.create()}),d=!1),n.type=e,n.name&&n.isNameSynthesized&&(n.name=`__p${p.details.parameters.length}`),0===n.category&&!n.name&&h||Xs.addParameter(p,n)}})),p.details.declaredReturnType=a.returnType,p}}class Qa extends Ya{constructor(e,t=!1,n=!1,i=!1){super(),this._typeVarMap=e,this._unknownIfNotFound=t,this._useNarrowBoundOnly=n,this._eliminateUnsolvedInUnions=i}transformTypeVar(e){if(e.scopeId&&this._typeVarMap.hasSolveForScope(e.scopeId)){let t=this._typeVarMap.getTypeVarType(e,this._useNarrowBoundOnly);if(!t&&this._useNarrowBoundOnly){const n=this._typeVarMap.getTypeVarType(e);n&&oa(n,!0)&&(t=n)}if(t)return Ks.isInstantiable(e)&&(t=Na(t)),t;if(this._unknownIfNotFound)return Ys.create()}return e}transformUnion(e){if(this._eliminateUnsolvedInUnions){const t=Ko(e,(e=>{if(!bo(e)||void 0===e.scopeId||!this._typeVarMap.hasSolveForScope(e.scopeId))return e}));return ao(t)?e:t}return e}transformVariadicTypeVar(e){if(e.scopeId&&this._typeVarMap.hasSolveForScope(e.scopeId))return this._typeVarMap.getVariadicTypeVar(e)}transformParamSpec(e){if(e.scopeId&&this._typeVarMap.hasSolveForScope(e.scopeId))return this._typeVarMap.getParamSpec(e)}}class Za extends Ya{constructor(e,t){super(),this._typeVarMap=e,this._liveTypeVarScopes=t,this.dummyScopeId="__expected_type_scope_id",this.dummyTypeVarPrefix="__expected_type_",this._typeVarMap.addSolveForScope(this.dummyScopeId)}_isTypeVarLive(e){return this._liveTypeVarScopes.some((t=>e.scopeId===t))}_createDummyTypeVar(e){if(e.details.isSynthesized&&e.details.name.startsWith(this.dummyTypeVarPrefix))return e;const t=Ks.isInstance(e);let n=oo.createInstance(`__expected_type_${Za.synthesizedTypeVarIndexForExpectedType}`);return n.details.isSynthesized=!0,n.scopeId=this.dummyScopeId,n.nameWithScope=oo.makeNameWithScope(n.details.name,this.dummyScopeId),t||(n=Na(n)),n.details.boundType=e.details.boundType,n.details.constraints=e.details.constraints,n.details.variance=e.details.variance,Za.synthesizedTypeVarIndexForExpectedType++,n}transformTypeVar(e){return this._isTypeVarLive(e)?e:this._createDummyTypeVar(e)}}Za.synthesizedTypeVarIndexForExpectedType=1;class Xa{constructor(e,t,n,i,r,s,o){this._importResolver=e,this._execEnv=t,this._evaluator=n,this._fileBinder=i,this._boundSourceGetter=r,this._mapCompiled=s,this._preferStubs=o}findModules(e){return this._getBoundSourceFilesFromStubFile(e).map((e=>{var t;return null===(t=e.getParseResults())||void 0===t?void 0:t.parseTree})).filter(a)}findDeclarations(e){return zn(e)?this._findClassOrTypeAliasDeclarations(e):jn(e)?this._findFunctionOrTypeAliasDeclarations(e):Hn(e)?this._findVariableDeclarations(e):$n(e)?this._findParameterDeclarations(e):5===e.type?this._findSpecialBuiltInClassDeclarations(e):[]}findClassDeclarations(e){return this._findClassOrTypeAliasDeclarations(e).filter((e=>zn(e))).map((e=>e))}findClassDeclarationsByType(e,t){const n=[];return this._addClassTypeDeclarations(e,t,n,new Set),n.filter((e=>zn(e))).map((e=>e))}findFunctionDeclarations(e){return this._findFunctionOrTypeAliasDeclarations(e).filter((e=>jn(e))).map((e=>e))}_findSpecialBuiltInClassDeclarations(e,t=new Set){if(38===e.node.valueExpression.nodeType){const n=e.node.valueExpression.value;return this._getBoundSourceFilesFromStubFile(e.path).flatMap((e=>this._findClassDeclarationsByName(e,n,t)))}return[]}_findClassOrTypeAliasDeclarations(e,t=new Set){const n=this._getFullClassName(e.node);return this._getBoundSourceFilesFromStubFile(e.path).flatMap((e=>this._findClassDeclarationsByName(e,n,t)))}_findFunctionOrTypeAliasDeclarations(e,t=new Set){const n=e.node.name.value,i=this._getBoundSourceFilesFromStubFile(e.path);if(e.isMethod){const r=Er(e.node);if(void 0===r)return[];const s=this._getFullClassName(r);return i.flatMap((e=>this._findMethodDeclarationsByName(e,s,n,t)))}return i.flatMap((e=>this._findFunctionDeclarationsByName(e,n,t)))}_findVariableDeclarations(e,t=new Set){if(38!==e.node.nodeType)return[];const n=e.node.value,i=this._getBoundSourceFilesFromStubFile(e.path),r=Er(e.node);if(r){const e=this._getFullClassName(r);return i.flatMap((i=>this._findFieldDeclarationsByName(i,e,n,t)))}return i.flatMap((e=>this._findVariableDeclarationsByName(e,n,t)))}_findParameterDeclarations(e){const t=[];if(!e.node.name)return t;const n=kr(e.node);if(!n)return t;const i=this._evaluator.getDeclarationsForNameNode(n.name);if(!i)return t;const r=new Set;for(const n of i)for(const i of this._findFunctionOrTypeAliasDeclarations(n,r))t.push(...this._lookUpSymbolDeclarations(i.node,e.node.name.value).filter((e=>$n(e))).map((e=>e)));return t}_findMemberDeclarationsByName(e,t,n,i,r){const s=[],o=this._findClassDeclarationsByName(e,t,r);for(const e of o.filter((e=>zn(e))).map((e=>e))){const t=this._evaluator.getTypeOfClass(e.node);if(!t)continue;const o=va(t.classType,n);if(o)for(const e of o.symbol.getDeclarations())i(e,r,s)}return s}_findFieldDeclarationsByName(e,t,n,i){let r=[];const s=`@${e.getFilePath()}/c/${t}/v/${n}`;return i.has(s)||(i.add(s),r=this._findMemberDeclarationsByName(e,t,n,((e,t,n)=>{if(Hn(e))if(this._isStubThatShouldBeMappedToImplementation(e.path))for(const i of this._findVariableDeclarations(e,t))Hn(i)&&n.push(i);else n.push(e)}),i),i.delete(s)),r}_findMethodDeclarationsByName(e,t,n,i){let r=[];const s=`@${e.getFilePath()}/c/${t}/f/${n}`;return i.has(s)||(i.add(s),r=this._findMemberDeclarationsByName(e,t,n,((e,t,n)=>{jn(e)&&(this._isStubThatShouldBeMappedToImplementation(e.path)?n.push(...this._findFunctionOrTypeAliasDeclarations(e,t)):n.push(e))}),i),i.delete(s)),r}_findVariableDeclarationsByName(e,t,n){var i;const r=[],s=`@${e.getFilePath()}/v/${t}`;if(n.has(s))return r;n.add(s);const o=null===(i=e.getParseResults())||void 0===i?void 0:i.parseTree;if(!o)return r;const a=this._lookUpSymbolDeclarations(o,t);if(0===a.length)this._addDeclarationsFollowingWildcardImports(o,t,r,n);else for(const e of a)this._addVariableDeclarations(e,r,n);return n.delete(s),r}_findFunctionDeclarationsByName(e,t,n){var i;const r=[],s=`@${e.getFilePath()}/f/${t}`;if(n.has(s))return r;n.add(s);const o=null===(i=e.getParseResults())||void 0===i?void 0:i.parseTree;if(!o)return r;const a=this._lookUpSymbolDeclarations(o,t);if(0===a.length)this._addDeclarationsFollowingWildcardImports(o,t,r,n);else for(const e of a)this._addClassOrFunctionDeclarations(e,r,n);return n.delete(s),r}_findClassDeclarationsByName(e,t,n){var i;let r=[];const s=null===(i=e.getParseResults())||void 0===i?void 0:i.parseTree;if(s){let i=t.split(".");i.length>0&&(r=this._findClassDeclarations(e,i[0],s,n),i=i.slice(1));for(const t of i)r=r.flatMap((i=>this._findClassDeclarations(e,t,i.node,n)))}return r}_findClassDeclarations(e,t,n,i){const r=[],s=`@${e.getFilePath()}[${n.start}]${t}`;if(i.has(s))return r;i.add(s);const o=this._lookUpSymbolDeclarations(n,t);if(0===o.length&&36===n.nodeType)this._addDeclarationsFollowingWildcardImports(n,t,r,i);else for(const e of o)this._addClassOrFunctionDeclarations(e,r,i);return i.delete(s),r}_addVariableDeclarations(e,t,n){if(Hn(e))this._isStubThatShouldBeMappedToImplementation(e.path)?t.push(...this._findVariableDeclarations(e,n)):t.push(e);else if(Gn(e)){const i=this._evaluator.resolveAliasDeclaration(e,!0);i&&(Hn(i)?this._addVariableDeclarations(i,t,n):(zn(i)||jn(i))&&this._addClassOrFunctionDeclarations(i,t,n))}}_addClassOrFunctionDeclarations(e,t,n){var i;if(zn(e))this._isStubThatShouldBeMappedToImplementation(e.path)?t.push(...this._findClassOrTypeAliasDeclarations(e,n)):t.push(e);else if(jn(e))this._isStubThatShouldBeMappedToImplementation(e.path)?t.push(...this._findFunctionOrTypeAliasDeclarations(e,n)):t.push(e);else if(Gn(e)){const i=this._evaluator.resolveAliasDeclaration(e,!0);i&&!Gn(i)&&this._addClassOrFunctionDeclarations(i,t,n)}else if(Hn(e)){this._addVariableDeclarations(e,t,n);const r=null!==(i=e.typeAliasName)&&void 0!==i?i:e.node,s=this._evaluator.getType(r);if(!s)return;if(Eo(s)&&s.details.declaration)this._addClassOrFunctionDeclarations(s.details.declaration,t,n);else if(ko(s))for(const e of s.overloads.map((e=>e.details.declaration)).filter(a))this._addClassOrFunctionDeclarations(e,t,n);else _o(s)&&this._addClassTypeDeclarations(e.path,s,t,n)}}_addClassTypeDeclarations(e,t,n,i){const r=t.details.filePath,s=this._getSourceFiles(r),o=t.details.fullName.substring(t.details.moduleName.length+1);for(const e of s)n.push(...this._findClassDeclarationsByName(e,o,i))}_getSourceFiles(e){const t=[];if(this._isStubThatShouldBeMappedToImplementation(e))t.push(...this._getBoundSourceFilesFromStubFile(e));else{const n=this._boundSourceGetter(e);n&&t.push(n)}return t}_addDeclarationsFollowingWildcardImports(e,t,n,i){var r,s;const o=null===(r=Ft(e))||void 0===r?void 0:r.symbolTable;if(o)for(const e of o.values())for(const r of e.getDeclarations()){if(!Gn(r)||!r.path||22!==r.node.nodeType||!r.node.isWildcardImport)continue;const e=`@${r.path}/l/${t}`;if(i.has(e))continue;i.add(e);const o=this._getSourceFiles(r.path);for(const e of o){const r=null===(s=e.getParseResults())||void 0===s?void 0:s.parseTree;if(!r)continue;const o=this._lookUpSymbolDeclarations(r,t);if(0===o.length)this._addDeclarationsFollowingWildcardImports(r,t,n,i);else for(const e of o){const t=this._evaluator.resolveAliasDeclaration(e,!0);t&&(jn(t)||zn(t)?this._addClassOrFunctionDeclarations(t,n,i):Hn(t)&&this._addVariableDeclarations(t,n,i))}}}}_lookUpSymbolDeclarations(e,t){if(void 0===e)return[];const n=Ft(e),i=null==n?void 0:n.lookUpSymbol(t),r=null==i?void 0:i.getDeclarations();return null!=r?r:[]}_getFullClassName(e){const t=[];let n=e;for(;void 0!==n;)t.push(n.name.value),n=Er(n);return t.reverse().join(".")}_getBoundSourceFilesFromStubFile(e){return this._importResolver.getSourceFilesFromStub(e,this._execEnv,this._mapCompiled).map((t=>this._fileBinder(e,t))).filter(a)}_isStubThatShouldBeMappedToImplementation(e){return!this._preferStubs&&(!!el(e)&&this._importResolver.getSourceFilesFromStub(e,this._execEnv,this._mapCompiled).every((t=>t!==e)))}}function el(e){return".pyi"===re(e,[".pyi"],!1)}function tl(e){switch(e){case"error":return 0;case"warning":return 1;case"information":return 2;default:throw new Error(`${e} is not expected`)}}class nl{constructor(e,t,n){this.category=e,this.message=t,this.range=n,this._relatedInfo=[]}addAction(e){void 0===this._actions?this._actions=[e]:this._actions.push(e)}getActions(){return this._actions}setRule(e){this._rule=e}getRule(){return this._rule}addRelatedInfo(e,t,n){this._relatedInfo.push({filePath:t,message:e,range:n})}getRelatedInfo(){return this._relatedInfo}}class il{constructor(){this._messages=[],this._childAddenda=[]}addMessage(e){this._messages.push(e)}createAddendum(){const e=new il;return this.addAddendum(e),e}getString(e=5,t=8){let n=this._getLinesRecursive(e,t);n.length>t&&(n=n.slice(0,t),n.push("  ..."));const i=n.join("\n");return i.length>0?"\n"+i:""}isEmpty(){return 0===this._getMessageCount()}addAddendum(e){this._childAddenda.push(e)}getChildren(){return this._childAddenda}getMessages(){return this._messages}_getMessageCount(e=0){if(e>64)return 0;let t=this._messages.length;for(const n of this._childAddenda)t+=n._getMessageCount(e+1);return t}_getLinesRecursive(e,t,n=0){if(e<=0||n>64)return[];let i=[];for(const r of this._childAddenda){const s=this._messages.length>0?e-1:e;if(i.push(...r._getLinesRecursive(s,t,n+1)),i.length>=t){i=i.slice(0,t);break}}const r=this._messages.length>0?"  ":"";return this._messages.concat(i).map((e=>r+e))}}!function(e){e.strictListInference="strictListInference",e.strictSetInference="strictSetInference",e.strictDictionaryInference="strictDictionaryInference",e.strictParameterNoneValue="strictParameterNoneValue",e.enableTypeIgnoreComments="enableTypeIgnoreComments",e.reportGeneralTypeIssues="reportGeneralTypeIssues",e.reportPropertyTypeMismatch="reportPropertyTypeMismatch",e.reportFunctionMemberAccess="reportFunctionMemberAccess",e.reportMissingImports="reportMissingImports",e.reportMissingModuleSource="reportMissingModuleSource",e.reportMissingTypeStubs="reportMissingTypeStubs",e.reportImportCycles="reportImportCycles",e.reportUnusedImport="reportUnusedImport",e.reportUnusedClass="reportUnusedClass",e.reportUnusedFunction="reportUnusedFunction",e.reportUnusedVariable="reportUnusedVariable",e.reportDuplicateImport="reportDuplicateImport",e.reportWildcardImportFromLibrary="reportWildcardImportFromLibrary",e.reportOptionalSubscript="reportOptionalSubscript",e.reportOptionalMemberAccess="reportOptionalMemberAccess",e.reportOptionalCall="reportOptionalCall",e.reportOptionalIterable="reportOptionalIterable",e.reportOptionalContextManager="reportOptionalContextManager",e.reportOptionalOperand="reportOptionalOperand",e.reportTypedDictNotRequiredAccess="reportTypedDictNotRequiredAccess",e.reportUntypedFunctionDecorator="reportUntypedFunctionDecorator",e.reportUntypedClassDecorator="reportUntypedClassDecorator",e.reportUntypedBaseClass="reportUntypedBaseClass",e.reportUntypedNamedTuple="reportUntypedNamedTuple",e.reportPrivateUsage="reportPrivateUsage",e.reportPrivateImportUsage="reportPrivateImportUsage",e.reportConstantRedefinition="reportConstantRedefinition",e.reportIncompatibleMethodOverride="reportIncompatibleMethodOverride",e.reportIncompatibleVariableOverride="reportIncompatibleVariableOverride",e.reportInconsistentConstructor="reportInconsistentConstructor",e.reportOverlappingOverload="reportOverlappingOverload",e.reportMissingSuperCall="reportMissingSuperCall",e.reportUninitializedInstanceVariable="reportUninitializedInstanceVariable",e.reportInvalidStringEscapeSequence="reportInvalidStringEscapeSequence",e.reportUnknownParameterType="reportUnknownParameterType",e.reportUnknownArgumentType="reportUnknownArgumentType",e.reportUnknownLambdaType="reportUnknownLambdaType",e.reportUnknownVariableType="reportUnknownVariableType",e.reportUnknownMemberType="reportUnknownMemberType",e.reportMissingParameterType="reportMissingParameterType",e.reportMissingTypeArgument="reportMissingTypeArgument",e.reportInvalidTypeVarUse="reportInvalidTypeVarUse",e.reportCallInDefaultInitializer="reportCallInDefaultInitializer",e.reportUnnecessaryIsInstance="reportUnnecessaryIsInstance",e.reportUnnecessaryCast="reportUnnecessaryCast",e.reportUnnecessaryComparison="reportUnnecessaryComparison",e.reportAssertAlwaysTrue="reportAssertAlwaysTrue",e.reportSelfClsParameterName="reportSelfClsParameterName",e.reportImplicitStringConcatenation="reportImplicitStringConcatenation",e.reportUndefinedVariable="reportUndefinedVariable",e.reportUnboundVariable="reportUnboundVariable",e.reportInvalidStubStatement="reportInvalidStubStatement",e.reportIncompleteStub="reportIncompleteStub",e.reportUnsupportedDunderAll="reportUnsupportedDunderAll",e.reportUnusedCallResult="reportUnusedCallResult",e.reportUnusedCoroutine="reportUnusedCoroutine",e.reportUnnecessaryTypeIgnoreComment="reportUnnecessaryTypeIgnoreComment",e.reportMatchNotExhaustive="reportMatchNotExhaustive"}($o||($o={}));class rl{constructor(e){this._formatString=e}format(e){let t=this._formatString;return Object.keys(e).forEach((n=>{t=t.replace(`{${n}}`,e[n].toString())})),t}getFormatString(){return this._formatString}}let sl="default";function ol(){return"simplified"===sl}function al(e){return ol()?"":e.getString()}let ll;const cl=__webpack_require__(6395);function ul(e){void 0===ll&&(ll={});const t=e.split("."),n=pl(ll,t)||pl(cl,t);if(n)return n;E(`Missing localized string for key "${e}"`)}function pl(e,t){let n=e;for(const e of t){if(!n[e])return;n=n[e]}return n}async function dl({locale:e,style:t}={}){t&&(sl=t);const n=e?e.toLowerCase():function(){try{if(null===navigator||void 0===navigator?void 0:navigator.language)return navigator.language.toLowerCase()}catch{}const e=process.env,t=e.VSCODE_NLS_CONFIG;if(t)try{return JSON.parse(t).locale}catch{}const n=e.LC_ALL||e.LC_MESSAGES||e.LANG||e.LANGUAGE;if(n){const e=n.split(".");if(e.length>0&&e[0])return e[0]}return"en-us"}();ll=await async function(e){let t=await hl(e);if(void 0!==t)return t;const n=e.split("-");return n.length>0&&n[0]&&(t=await hl(n[0]),void 0!==t)?t:{}}(n)}async function hl(e){switch(e){case"fr":return(await __webpack_require__.e(846).then(__webpack_require__.t.bind(__webpack_require__,4846,19))).default;case"es-es":return(await __webpack_require__.e(162).then(__webpack_require__.t.bind(__webpack_require__,4162,19))).default;case"ja":return(await __webpack_require__.e(244).then(__webpack_require__.t.bind(__webpack_require__,244,19))).default;case"ko":return(await __webpack_require__.e(372).then(__webpack_require__.t.bind(__webpack_require__,1372,19))).default;case"nl":return(await __webpack_require__.e(101).then(__webpack_require__.t.bind(__webpack_require__,5101,19))).default;case"zh-cn":return(await __webpack_require__.e(131).then(__webpack_require__.t.bind(__webpack_require__,8131,19))).default;case"zh-tw":return(await __webpack_require__.e(753).then(__webpack_require__.t.bind(__webpack_require__,9753,19))).default;default:return(await __webpack_require__.e(416).then(__webpack_require__.t.bind(__webpack_require__,8416,19))).default}}var ml;function fl(e,t,n){w(Zs.isTypedDictClass(n));const i=Xs.createInstance("__new__","","",65);Xs.addParameter(i,{category:0,name:"cls",type:n,hasDeclaredType:!0}),Xs.addDefaultParameters(i),i.details.declaredReturnType=Zs.cloneAsInstance(n);const r=Xs.createInstance("__init__","","",64);Xs.addParameter(r,{category:0,name:"self",type:Zs.cloneAsInstance(n),hasDeclaredType:!0}),r.details.declaredReturnType=to.createInstance(),Xs.addParameter(r,{category:1,type:io.create(),hasDeclaredType:!0});const s=gl(e,n);s.forEach(((e,t)=>{Xs.addParameter(r,{category:0,name:t,hasDefault:!e.isRequired,type:e.valueType,hasDeclaredType:!0})}));const o=n.details.fields;o.set("__init__",qo.createWithType(4,r)),o.set("__new__",qo.createWithType(4,i));const a=e.getBuiltInType(t,"str");if(_o(a)){const i={category:0,name:"self",type:Zs.cloneAsInstance(n),hasDeclaredType:!0},r=e=>{let t=oo.createInstance(`__${e.details.name}_default`);return t.details.isSynthesized=!0,t=oo.cloneForScopeId(t,e.details.typeVarScopeId,n.details.name,1),t},l=(n,s,o,a=!1)=>{const l=Xs.createInstance("get","","",320);if(Xs.addParameter(l,i),l.details.typeVarScopeId=e.getScopeIdForNode(t),Xs.addParameter(l,{category:0,name:"k",type:n,hasDeclaredType:!0}),o){const e=r(l);Xs.addParameter(l,{category:0,name:"default",type:a?s:e,hasDeclaredType:!0}),l.details.declaredReturnType=a?s:Oo([s,e])}else l.details.declaredReturnType=Oo([s,to.createInstance()]);return l},c=(n,s)=>{const o={category:0,name:"k",type:n,hasDeclaredType:!0},a=Xs.createInstance("pop","","",320);Xs.addParameter(a,i),Xs.addParameter(a,o),a.details.declaredReturnType=s;const l=Xs.createInstance("pop","","",320);Xs.addParameter(l,i),Xs.addParameter(l,o),l.details.typeVarScopeId=e.getScopeIdForNode(t);const c=r(l);return Xs.addParameter(l,{category:0,name:"default",hasDeclaredType:!0,type:c,hasDefault:!0}),l.details.declaredReturnType=Oo([s,c]),[a,l]},u=(e,t)=>{const n=Xs.createInstance("setdefault","","",320);return Xs.addParameter(n,i),Xs.addParameter(n,{category:0,name:"k",hasDeclaredType:!0,type:e}),Xs.addParameter(n,{category:0,name:"default",hasDeclaredType:!0,type:t}),n.details.declaredReturnType=t,n},p=e=>{const t=Xs.createInstance("delitem","","",320);return Xs.addParameter(t,i),Xs.addParameter(t,{category:0,name:"k",hasDeclaredType:!0,type:e}),t.details.declaredReturnType=to.createInstance(),t},d=[],h=[],m=[];s.forEach(((e,t)=>{const n=Zs.cloneAsInstance(Zs.cloneWithLiteral(a,t));d.push(l(n,e.valueType,!1)),d.push(l(n,e.valueType,!0,!0)),d.push(l(n,e.valueType,!0,!1)),h.push(...c(n,e.valueType)),m.push(u(n,e.valueType))}));const f=Zs.cloneAsInstance(a);d.push(l(f,io.create(),!1)),d.push(l(f,io.create(),!0)),o.set("get",qo.createWithType(4,eo.create(d))),h.length>0&&o.set("pop",qo.createWithType(4,eo.create(h))),m.length>0&&o.set("setdefault",qo.createWithType(4,eo.create(m))),o.set("__delitem__",qo.createWithType(4,p(f)))}}function gl(e,t,n=!1){if(!t.details.typedDictEntries){const n=new Map;yl(e,t,n),t.details.typedDictEntries=n}const i=new Map;return t.details.typedDictEntries.forEach(((e,t)=>{i.set(t,{...e})})),n&&t.typedDictNarrowedEntries&&t.typedDictNarrowedEntries.forEach(((e,t)=>{i.set(t,{...e})})),i}function yl(e,t,n,i=0){w(Zs.isTypedDictClass(t)),i>Gs||(i++,t.details.baseClasses.forEach((t=>{_o(t)&&Zs.isTypedDictClass(t)&&yl(e,t,n,i)})),t.details.fields.forEach(((i,r)=>{if(!i.isIgnoredForProtocolMatch()){const s=Vo(i);if(s&&1===s.type){const o=e.getEffectiveTypeOfSymbol(i);let a=!Zs.isCanOmitDictValues(t);!function(e){return e.getDeclarations().some((e=>1===e.type&&!!e.isRequired))}(i)?function(e){return e.getDeclarations().some((e=>1===e.type&&!!e.isNotRequired))}(i)&&(a=!1):a=!0;const l=n.get(r);if(l&&!Ao(l.valueType,o)){const t=new il;t.addMessage(ml.DiagnosticAddendum.typedDictFieldRedefinition().format({parentType:e.printType(l.valueType),childType:e.printType(o)})),e.addDiagnostic(Vt(s.node).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typedDictFieldRedefinition().format({name:r})+t.getString(),s.node)}n.set(r,{valueType:o,isRequired:a,isProvided:!1})}}})))}function _l(e,t,n,i,r=0){let s=!0;const o=gl(e,t),a=gl(e,n,!0);return o.forEach(((o,l)=>{const c=a.get(l);c?(o.isRequired&&!c.isRequired?(i&&i.addMessage(ml.DiagnosticAddendum.typedDictFieldRequired().format({name:l,type:e.printType(t)})),s=!1):!o.isRequired&&c.isRequired&&(i&&i.addMessage(ml.DiagnosticAddendum.typedDictFieldNotRequired().format({name:l,type:e.printType(t)})),s=!1),e.canAssignType(o.valueType,c.valueType,void 0,void 0,void 0,r)||(i&&i.addMessage(ml.DiagnosticAddendum.memberTypeMismatch().format({name:l})),s=!1)):(i&&i.addMessage(ml.DiagnosticAddendum.typedDictFieldMissing().format({name:l,type:e.printType(n)})),s=!1)})),s}function vl(e,t,n,i){if(1!==t.items.length)return e.addError(ml.Diagnostic.typeArgsMismatchOne().format({received:t.items.length}),t),{node:t,type:Ys.create()};if(t.trailingComma||t.items[0].name||0!==t.items[0].argumentCategory)return;const r=gl(e,n,"get"===i.method),s=e.getTypeOfExpression(t.items[0].valueExpression),o=s.type;let a=new il,l=!0;const c=Ko(o,(s=>{if(ho(s))return s;if(vo(s)&&Zs.isBuiltIn(s,"str")){if(void 0===s.literalValue)return Ys.create();const o=s.literalValue,c=r.get(o);return c?(c.isRequired||c.isProvided||"get"!==i.method||function(e,t=!1){let n,i=e;for(;i;){switch(i.nodeType){case 53:return i.trySuite===n;case 58:if(t&&i.suite===n)return!0;break;case 28:case 36:case 10:return!1}n=i,i=i.parent}return!1}(t,!0)||a.addMessage(ml.DiagnosticAddendum.keyNotRequired().format({name:o,type:e.printType(n)})),"set"===i.method?e.canAssignType(c.valueType,i.setType||io.create(),a)||(l=!1):"del"===i.method&&c.isRequired&&(a.addMessage(ml.DiagnosticAddendum.keyRequiredDeleted().format({name:o})),l=!1),c.valueType):(a.addMessage(ml.DiagnosticAddendum.keyUndefined().format({name:o,type:e.printType(n)})),l=!1,Ys.create())}return a.addMessage(ml.DiagnosticAddendum.typeNotStringLiteral().format({type:e.printType(s)})),l=!1,Ys.create()}));if(i.setExpectedTypeDiag&&(a=i.setExpectedTypeDiag),!a.isEmpty()){let n;n="set"===i.method?ml.Diagnostic.typedDictSet():"del"===i.method?ml.Diagnostic.typedDictDelete():ml.Diagnostic.typedDictAccess();const r=Vt(t);e.addDiagnostic(l?r.diagnosticRuleSet.reportTypedDictNotRequiredAccess:r.diagnosticRuleSet.reportGeneralTypeIssues,l?$o.reportTypedDictNotRequiredAccess:$o.reportGeneralTypeIssues,n+a.getString(),t)}return{node:t,type:c,isIncomplete:!!s.isIncomplete}}function Tl(e,t){if(6===e.category){if(0===e.overloads.length)return!1;e=e.overloads[0]}return"builtins"===e.details.moduleName&&!!t&&!!e.boundToType&&!Zs.isSameGenericClass(t,e.boundToType)}function bl(e,t,n){const i=Er(e.node.name,!1),r=i?n.getTypeOfClass(i):void 0;if(r)return function(e,t,n,i){if(!e||!jn(e))return;const r=n.getTypeForDeclaration(e);if(!r||!ua(r))return;const s=28===e.node.nodeType?e.node.name.value:void 0;if(!s)return;const o=ba(i,0);for(const[e]of o){if(!_o(e))continue;const i=e.details.fields.get(s),r=null==i?void 0:i.getDeclarations();if(r)for(const e of r)if(jn(e)){const i=n.getTypeForDeclaration(e);if(i&&ua(i)){const n=El(e,t);if(n)return n}}}}(e,t,n,r.classType)}function Il(e,t,n){let i=e.docString;return!i&&t&&el(t.path)&&(i=function(e){for(const t of e)if(t.statements){const e=qr(t.statements);if(e)return e}}(n.findModules(t.path))),i}function Sl(e,t,n){let i=e.details.docString;if(!i&&t&&zn(t)&&(i=kl([t]),!i&&t&&el(t.path)&&4===t.type)&&(i=kl(n.findClassDeclarations(t))),!i&&t){const r=n.findClassDeclarationsByType(t.path,e);r&&(i=kl(r.filter((e=>zn(e))).map((e=>e))))}return i}function xl(e){var t,n,i;return qr(null!==(i=null===(n=null===(t=e.node)||void 0===t?void 0:t.suite)||void 0===n?void 0:n.statements)&&void 0!==i?i:[])}function Cl(e,t){if(e)return void 0!==e.docString?e.docString:function(e,t){const n=[];if(!el(e.path))return n;for(const i of t.findDeclarations(e))if(Hn(i)&&i.docString)n.push(i.docString);else if(zn(i)||jn(i)){const e=xl(i);e&&n.push(e)}return n}(e,t).find((e=>e))}function wl(e,t,n){if(!ko(e))return;const i=[];if(e.overloads.some((e=>e.details.docString)))e.overloads.forEach((e=>{e.details.docString&&i.push(e.details.docString)}));else if(t&&el(t.path)&&jn(t)){const e=kl(n.findFunctionDeclarations(t));e&&i.push(e)}return i}function El(e,t){let n=kl([e]);return!n&&el(e.path)&&(n=kl(t.findFunctionDeclarations(e))),n}function kl(e){for(const t of e){const e=xl(t);if(e)return e}}!function(e){let t,n,i,r;!function(e){e.annotatedParamCountMismatch=()=>new rl(ul("Diagnostic.annotatedParamCountMismatch")),e.annotatedTypeArgMissing=()=>ul("Diagnostic.annotatedTypeArgMissing"),e.annotationFormatString=()=>ul("Diagnostic.annotationFormatString"),e.annotationNotSupported=()=>ul("Diagnostic.annotationNotSupported"),e.annotationSpansStrings=()=>ul("Diagnostic.annotationSpansStrings"),e.annotationStringEscape=()=>ul("Diagnostic.annotationStringEscape"),e.argAssignment=()=>new rl(ul("Diagnostic.argAssignment")),e.argAssignmentFunction=()=>new rl(ul("Diagnostic.argAssignmentFunction")),e.argAssignmentParam=()=>new rl(ul("Diagnostic.argAssignmentParam")),e.argAssignmentParamFunction=()=>new rl(ul("Diagnostic.argAssignmentParamFunction")),e.argMissingForParam=()=>new rl(ul("Diagnostic.argMissingForParam")),e.argMissingForParams=()=>new rl(ul("Diagnostic.argMissingForParams")),e.argMorePositionalExpectedCount=()=>new rl(ul("Diagnostic.argMorePositionalExpectedCount")),e.argMorePositionalExpectedOne=()=>ul("Diagnostic.argMorePositionalExpectedOne"),e.argPositional=()=>ul("Diagnostic.argPositional"),e.argPositionalExpectedCount=()=>new rl(ul("Diagnostic.argPositionalExpectedCount")),e.argPositionalExpectedOne=()=>ul("Diagnostic.argPositionalExpectedOne"),e.argTypePartiallyUnknown=()=>ul("Diagnostic.argTypePartiallyUnknown"),e.argTypeUnknown=()=>ul("Diagnostic.argTypeUnknown"),e.assertAlwaysTrue=()=>ul("Diagnostic.assertAlwaysTrue"),e.assignmentExprContext=()=>ul("Diagnostic.assignmentExprContext"),e.assignmentExprComprehension=()=>new rl(ul("Diagnostic.assignmentExprComprehension")),e.assignmentExprInSubscript=()=>ul("Diagnostic.assignmentExprInSubscript"),e.assignmentInProtocol=()=>ul("Diagnostic.assignmentInProtocol"),e.assignmentTargetExpr=()=>ul("Diagnostic.assignmentTargetExpr"),e.asyncNotInAsyncFunction=()=>ul("Diagnostic.asyncNotInAsyncFunction"),e.awaitIllegal=()=>ul("Diagnostic.awaitIllegal"),e.awaitNotInAsync=()=>ul("Diagnostic.awaitNotInAsync"),e.backticksIllegal=()=>ul("Diagnostic.backticksIllegal"),e.baseClassCircular=()=>ul("Diagnostic.baseClassCircular"),e.baseClassInvalid=()=>ul("Diagnostic.baseClassInvalid"),e.baseClassFinal=()=>new rl(ul("Diagnostic.baseClassFinal")),e.baseClassMethodTypeIncompatible=()=>new rl(ul("Diagnostic.baseClassMethodTypeIncompatible")),e.baseClassUnknown=()=>ul("Diagnostic.baseClassUnknown"),e.bindTypeMismatch=()=>new rl(ul("Diagnostic.bindTypeMismatch")),e.booleanIsLowerCase=()=>new rl(ul("Diagnostic.booleanIsLowerCase")),e.breakOutsideLoop=()=>ul("Diagnostic.breakOutsideLoop"),e.callableExtraArgs=()=>ul("Diagnostic.callableExtraArgs"),e.callableFirstArg=()=>ul("Diagnostic.callableFirstArg"),e.callableSecondArg=()=>ul("Diagnostic.callableSecondArg"),e.casePatternIsIrrefutable=()=>ul("Diagnostic.casePatternIsIrrefutable"),e.classAlreadySpecialized=()=>new rl(ul("Diagnostic.classAlreadySpecialized")),e.classDecoratorTypeUnknown=()=>ul("Diagnostic.classDecoratorTypeUnknown"),e.classDefinitionCycle=()=>new rl(ul("Diagnostic.classDefinitionCycle")),e.classGetItemClsParam=()=>ul("Diagnostic.classGetItemClsParam"),e.classMethodClsParam=()=>ul("Diagnostic.classMethodClsParam"),e.classNotRuntimeSubscriptable=()=>new rl(ul("Diagnostic.classNotRuntimeSubscriptable")),e.classPatternBuiltInArgCount=()=>ul("Diagnostic.classPatternBuiltInArgCount"),e.classPatternBuiltInArgPositional=()=>ul("Diagnostic.classPatternBuiltInArgPositional"),e.classPatternTypeAlias=()=>new rl(ul("Diagnostic.classPatternTypeAlias")),e.classVarNotAllowed=()=>ul("Diagnostic.classVarNotAllowed"),e.classVarFirstArgMissing=()=>ul("Diagnostic.classVarFirstArgMissing"),e.classVarOverridesInstanceVar=()=>new rl(ul("Diagnostic.classVarOverridesInstanceVar")),e.classVarTooManyArgs=()=>ul("Diagnostic.classVarTooManyArgs"),e.classVarWithTypeVar=()=>ul("Diagnostic.classVarWithTypeVar"),e.clsSelfParamTypeMismatch=()=>new rl(ul("Diagnostic.clsSelfParamTypeMismatch")),e.comparisonAlwaysFalse=()=>new rl(ul("Diagnostic.comparisonAlwaysFalse")),e.comparisonAlwaysTrue=()=>new rl(ul("Diagnostic.comparisonAlwaysTrue")),e.comprehensionInDict=()=>ul("Diagnostic.comprehensionInDict"),e.comprehensionInSet=()=>ul("Diagnostic.comprehensionInSet"),e.concatenateParamSpecMissing=()=>ul("Diagnostic.concatenateParamSpecMissing"),e.concatenateTypeArgsMissing=()=>ul("Diagnostic.concatenateTypeArgsMissing"),e.constantRedefinition=()=>new rl(ul("Diagnostic.constantRedefinition")),e.constructorNoArgs=()=>new rl(ul("Diagnostic.constructorNoArgs")),e.constructorParametersMismatch=()=>new rl(ul("Diagnostic.constructorParametersMismatch")),e.continueInFinally=()=>ul("Diagnostic.continueInFinally"),e.continueOutsideLoop=()=>ul("Diagnostic.continueOutsideLoop"),e.dataClassBaseClassNotFrozen=()=>ul("Diagnostic.dataClassBaseClassNotFrozen"),e.dataClassFieldWithDefault=()=>ul("Diagnostic.dataClassFieldWithDefault"),e.dataClassPostInitParamCount=()=>new rl(ul("Diagnostic.dataClassPostInitParamCount")),e.dataClassPostInitType=()=>new rl(ul("Diagnostic.dataClassPostInitType")),e.dataClassSlotsOverwrite=()=>ul("Diagnostic.dataClassSlotsOverwrite"),e.dataClassTransformExpectedBoolLiteral=()=>ul("Diagnostic.dataClassTransformExpectedBoolLiteral"),e.dataClassTransformFieldDescriptor=()=>new rl(ul("Diagnostic.dataClassTransformFieldDescriptor")),e.dataClassTransformPositionalParam=()=>ul("Diagnostic.dataClassTransformPositionalParam"),e.dataClassTransformUnknownArgument=()=>new rl(ul("Diagnostic.dataClassTransformUnknownArgument")),e.declaredReturnTypePartiallyUnknown=()=>new rl(ul("Diagnostic.declaredReturnTypePartiallyUnknown")),e.declaredReturnTypeUnknown=()=>ul("Diagnostic.declaredReturnTypeUnknown"),e.defaultValueContainsCall=()=>ul("Diagnostic.defaultValueContainsCall"),e.defaultValueNotAllowed=()=>ul("Diagnostic.defaultValueNotAllowed"),e.defaultValueNotEllipsis=()=>ul("Diagnostic.defaultValueNotEllipsis"),e.deprecatedType=()=>new rl(ul("Diagnostic.deprecatedType")),e.dictExpandIllegalInComprehension=()=>ul("Diagnostic.dictExpandIllegalInComprehension"),e.dictInAnnotation=()=>ul("Diagnostic.dictInAnnotation"),e.dictKeyValuePairs=()=>ul("Diagnostic.dictKeyValuePairs"),e.dictUnpackIsNotMapping=()=>ul("Diagnostic.dictUnpackIsNotMapping"),e.delTargetExpr=()=>ul("Diagnostic.delTargetExpr"),e.dunderAllSymbolNotPresent=()=>new rl(ul("Diagnostic.dunderAllSymbolNotPresent")),e.duplicateArgsParam=()=>ul("Diagnostic.duplicateArgsParam"),e.duplicateBaseClass=()=>ul("Diagnostic.duplicateBaseClass"),e.duplicateCatchAll=()=>ul("Diagnostic.duplicateCatchAll"),e.duplicateEnumMember=()=>new rl(ul("Diagnostic.duplicateEnumMember")),e.duplicateImport=()=>new rl(ul("Diagnostic.duplicateImport")),e.duplicateKwargsParam=()=>ul("Diagnostic.duplicateKwargsParam"),e.duplicateKeywordOnly=()=>ul("Diagnostic.duplicateKeywordOnly"),e.duplicateParam=()=>new rl(ul("Diagnostic.duplicateParam")),e.duplicateCapturePatternTarget=()=>new rl(ul("Diagnostic.duplicateCapturePatternTarget")),e.duplicateStarPattern=()=>ul("Diagnostic.duplicateStarPattern"),e.duplicateStarStarPattern=()=>ul("Diagnostic.duplicateStarStarPattern"),e.duplicatePositionOnly=()=>ul("Diagnostic.duplicatePositionOnly"),e.duplicateUnpack=()=>ul("Diagnostic.duplicateUnpack"),e.ellipsisContext=()=>ul("Diagnostic.ellipsisContext"),e.ellipsisSecondArg=()=>ul("Diagnostic.ellipsisSecondArg"),e.enumClassOverride=()=>new rl(ul("Diagnostic.enumClassOverride")),e.exceptionGroupIncompatible=()=>ul("Diagnostic.exceptionGroupIncompatible"),e.exceptionTypeIncorrect=()=>new rl(ul("Diagnostic.exceptionTypeIncorrect")),e.exceptionTypeNotClass=()=>new rl(ul("Diagnostic.exceptionTypeNotClass")),e.exceptionTypeNotInstantiable=()=>new rl(ul("Diagnostic.exceptionTypeNotInstantiable")),e.expectedAfterDecorator=()=>ul("Diagnostic.expectedAfterDecorator"),e.expectedArrow=()=>ul("Diagnostic.expectedArrow"),e.expectedAsAfterException=()=>ul("Diagnostic.expectedAsAfterException"),e.expectedAssignRightHandExpr=()=>ul("Diagnostic.expectedAssignRightHandExpr"),e.expectedBinaryRightHandExpr=()=>ul("Diagnostic.expectedBinaryRightHandExpr"),e.expectedBoolLiteral=()=>ul("Diagnostic.expectedBoolLiteral"),e.expectedCase=()=>ul("Diagnostic.expectedCase"),e.expectedClassName=()=>ul("Diagnostic.expectedClassName"),e.expectedCloseBrace=()=>ul("Diagnostic.expectedCloseBrace"),e.expectedCloseBracket=()=>ul("Diagnostic.expectedCloseBracket"),e.expectedCloseParen=()=>ul("Diagnostic.expectedCloseParen"),e.expectedColon=()=>ul("Diagnostic.expectedColon"),e.expectedComplexNumberLiteral=()=>ul("Diagnostic.expectedComplexNumberLiteral"),e.expectedDecoratorExpr=()=>ul("Diagnostic.expectedDecoratorExpr"),e.expectedDecoratorName=()=>ul("Diagnostic.expectedDecoratorName"),e.expectedDecoratorNewline=()=>ul("Diagnostic.expectedDecoratorNewline"),e.expectedDelExpr=()=>ul("Diagnostic.expectedDelExpr"),e.expectedElse=()=>ul("Diagnostic.expectedElse"),e.expectedEqualityOperator=()=>ul("Diagnostic.expectedEqualityOperator"),e.expectedExceptionClass=()=>ul("Diagnostic.expectedExceptionClass"),e.expectedExceptionObj=()=>ul("Diagnostic.expectedExceptionObj"),e.expectedExpr=()=>ul("Diagnostic.expectedExpr"),e.expectedImport=()=>ul("Diagnostic.expectedImport"),e.expectedImportAlias=()=>ul("Diagnostic.expectedImportAlias"),e.expectedImportSymbols=()=>ul("Diagnostic.expectedImportSymbols"),e.expectedIdentifier=()=>ul("Diagnostic.expectedIdentifier"),e.expectedIndentedBlock=()=>ul("Diagnostic.expectedIndentedBlock"),e.expectedIn=()=>ul("Diagnostic.expectedIn"),e.expectedInExpr=()=>ul("Diagnostic.expectedInExpr"),e.expectedFunctionAfterAsync=()=>ul("Diagnostic.expectedFunctionAfterAsync"),e.expectedFunctionName=()=>ul("Diagnostic.expectedFunctionName"),e.expectedMemberName=()=>ul("Diagnostic.expectedMemberName"),e.expectedModuleName=()=>ul("Diagnostic.expectedModuleName"),e.expectedNameAfterAs=()=>ul("Diagnostic.expectedNameAfterAs"),e.expectedNamedParameter=()=>ul("Diagnostic.expectedNamedParameter"),e.expectedNewline=()=>ul("Diagnostic.expectedNewline"),e.expectedNewlineOrSemicolon=()=>ul("Diagnostic.expectedNewlineOrSemicolon"),e.expectedOpenParen=()=>ul("Diagnostic.expectedOpenParen"),e.expectedParamName=()=>ul("Diagnostic.expectedParamName"),e.expectedPatternExpr=()=>ul("Diagnostic.expectedPatternExpr"),e.expectedPatternSubjectExpr=()=>ul("Diagnostic.expectedPatternSubjectExpr"),e.expectedPatternValue=()=>ul("Diagnostic.expectedPatternValue"),e.expectedReturnExpr=()=>ul("Diagnostic.expectedReturnExpr"),e.expectedSliceIndex=()=>ul("Diagnostic.expectedSliceIndex"),e.expectedTypeNotString=()=>ul("Diagnostic.expectedTypeNotString"),e.expectedYieldExpr=()=>ul("Diagnostic.expectedYieldExpr"),e.finalClassIsAbstract=()=>new rl(ul("Diagnostic.finalClassIsAbstract")),e.finalContext=()=>ul("Diagnostic.finalContext"),e.finalMethodOverride=()=>new rl(ul("Diagnostic.finalMethodOverride")),e.finalReassigned=()=>new rl(ul("Diagnostic.finalReassigned")),e.finalRedeclaration=()=>new rl(ul("Diagnostic.finalRedeclaration")),e.finalRedeclarationBySubclass=()=>new rl(ul("Diagnostic.finalRedeclarationBySubclass")),e.finalTooManyArgs=()=>ul("Diagnostic.finalTooManyArgs"),e.finalUnassigned=()=>new rl(ul("Diagnostic.finalUnassigned")),e.formatStringBrace=()=>ul("Diagnostic.formatStringBrace"),e.formatStringBytes=()=>ul("Diagnostic.formatStringBytes"),e.formatStringEscape=()=>ul("Diagnostic.formatStringEscape"),e.formatStringInPattern=()=>ul("Diagnostic.formatStringInPattern"),e.formatStringIllegal=()=>ul("Diagnostic.formatStringIllegal"),e.formatStringUnicode=()=>ul("Diagnostic.formatStringUnicode"),e.formatStringUnterminated=()=>ul("Diagnostic.formatStringUnterminated"),e.functionDecoratorTypeUnknown=()=>ul("Diagnostic.functionDecoratorTypeUnknown"),e.generatorAsyncReturnType=()=>ul("Diagnostic.generatorAsyncReturnType"),e.generatorNotParenthesized=()=>ul("Diagnostic.generatorNotParenthesized"),e.generatorSyncReturnType=()=>ul("Diagnostic.generatorSyncReturnType"),e.genericClassAssigned=()=>ul("Diagnostic.genericClassAssigned"),e.genericClassDeleted=()=>ul("Diagnostic.genericClassDeleted"),e.genericNotAllowed=()=>ul("Diagnostic.genericNotAllowed"),e.genericTypeAliasBoundTypeVar=()=>new rl(ul("Diagnostic.genericTypeAliasBoundTypeVar")),e.genericTypeArgMissing=()=>ul("Diagnostic.genericTypeArgMissing"),e.genericTypeArgTypeVar=()=>ul("Diagnostic.genericTypeArgTypeVar"),e.genericTypeArgUnique=()=>ul("Diagnostic.genericTypeArgUnique"),e.globalReassignment=()=>new rl(ul("Diagnostic.globalReassignment")),e.globalRedefinition=()=>new rl(ul("Diagnostic.globalRedefinition")),e.implicitStringConcat=()=>ul("Diagnostic.implicitStringConcat"),e.importCycleDetected=()=>ul("Diagnostic.importCycleDetected"),e.importDepthExceeded=()=>new rl(ul("Diagnostic.importDepthExceeded")),e.importResolveFailure=()=>new rl(ul("Diagnostic.importResolveFailure")),e.importSourceResolveFailure=()=>new rl(ul("Diagnostic.importSourceResolveFailure")),e.importSymbolUnknown=()=>new rl(ul("Diagnostic.importSymbolUnknown")),e.incompatibleMethodOverride=()=>new rl(ul("Diagnostic.incompatibleMethodOverride")),e.inconsistentIndent=()=>ul("Diagnostic.inconsistentIndent"),e.inconsistentTabs=()=>ul("Diagnostic.inconsistentTabs"),e.initMustReturnNone=()=>ul("Diagnostic.initMustReturnNone"),e.initSubclassClsParam=()=>ul("Diagnostic.initSubclassClsParam"),e.instanceMethodSelfParam=()=>ul("Diagnostic.instanceMethodSelfParam"),e.instanceVarOverridesClassVar=()=>new rl(ul("Diagnostic.instanceVarOverridesClassVar")),e.instantiateAbstract=()=>new rl(ul("Diagnostic.instantiateAbstract")),e.instantiateProtocol=()=>new rl(ul("Diagnostic.instantiateProtocol")),e.internalBindError=()=>new rl(ul("Diagnostic.internalBindError")),e.internalParseError=()=>new rl(ul("Diagnostic.internalParseError")),e.internalTypeCheckingError=()=>new rl(ul("Diagnostic.internalTypeCheckingError")),e.invalidIdentifierChar=()=>ul("Diagnostic.invalidIdentifierChar"),e.invalidStubStatement=()=>ul("Diagnostic.invalidStubStatement"),e.invalidTokenChars=()=>new rl(ul("Diagnostic.invalidTokenChars")),e.isInstanceInvalidType=()=>new rl(ul("Diagnostic.isInstanceInvalidType")),e.isSubclassInvalidType=()=>new rl(ul("Diagnostic.isSubclassInvalidType")),e.keyValueInSet=()=>ul("Diagnostic.keyValueInSet"),e.keywordArgInTypeArgument=()=>ul("Diagnostic.keywordArgInTypeArgument"),e.keywordOnlyAfterArgs=()=>ul("Diagnostic.keywordOnlyAfterArgs"),e.keywordSubscriptIllegal=()=>ul("Diagnostic.keywordSubscriptIllegal"),e.lambdaReturnTypeUnknown=()=>ul("Diagnostic.lambdaReturnTypeUnknown"),e.lambdaReturnTypePartiallyUnknown=()=>new rl(ul("Diagnostic.lambdaReturnTypePartiallyUnknown")),e.listAssignmentMismatch=()=>new rl(ul("Diagnostic.listAssignmentMismatch")),e.listInAnnotation=()=>ul("Diagnostic.listInAnnotation"),e.literalUnsupportedType=()=>ul("Diagnostic.literalUnsupportedType"),e.literalEmptyArgs=()=>ul("Diagnostic.literalEmptyArgs"),e.literalNotCallable=()=>ul("Diagnostic.literalNotCallable"),e.matchIncompatible=()=>ul("Diagnostic.matchIncompatible"),e.matchIsNotExhaustive=()=>ul("Diagnostic.matchIsNotExhaustive"),e.maxParseDepthExceeded=()=>ul("Diagnostic.maxParseDepthExceeded"),e.memberAccess=()=>new rl(ul("Diagnostic.memberAccess")),e.memberDelete=()=>new rl(ul("Diagnostic.memberDelete")),e.memberSet=()=>new rl(ul("Diagnostic.memberSet")),e.metaclassConflict=()=>ul("Diagnostic.metaclassConflict"),e.metaclassDuplicate=()=>ul("Diagnostic.metaclassDuplicate"),e.metaclassIsGeneric=()=>ul("Diagnostic.metaclassIsGeneric"),e.methodNotDefined=()=>new rl(ul("Diagnostic.methodNotDefined")),e.methodNotDefinedOnType=()=>new rl(ul("Diagnostic.methodNotDefinedOnType")),e.methodOrdering=()=>ul("Diagnostic.methodOrdering"),e.methodOverridden=()=>new rl(ul("Diagnostic.methodOverridden")),e.methodReturnsNonObject=()=>new rl(ul("Diagnostic.methodReturnsNonObject")),e.missingProtocolMembers=()=>ul("Diagnostic.missingProtocolMembers"),e.missingSuperCall=()=>new rl(ul("Diagnostic.missingSuperCall")),e.moduleAsType=()=>ul("Diagnostic.moduleAsType"),e.moduleNotCallable=()=>ul("Diagnostic.moduleNotCallable"),e.moduleUnknownMember=()=>new rl(ul("Diagnostic.moduleUnknownMember")),e.namedExceptAfterCatchAll=()=>ul("Diagnostic.namedExceptAfterCatchAll"),e.namedParamAfterParamSpecArgs=()=>new rl(ul("Diagnostic.namedParamAfterParamSpecArgs")),e.namedTupleEmptyName=()=>ul("Diagnostic.namedTupleEmptyName"),e.namedTupleFirstArg=()=>ul("Diagnostic.namedTupleFirstArg"),e.namedTupleMultipleInheritance=()=>ul("Diagnostic.namedTupleMultipleInheritance"),e.namedTupleNameType=()=>ul("Diagnostic.namedTupleNameType"),e.namedTupleNameUnique=()=>ul("Diagnostic.namedTupleNameUnique"),e.namedTupleNoTypes=()=>ul("Diagnostic.namedTupleNoTypes"),e.namedTupleSecondArg=()=>ul("Diagnostic.namedTupleSecondArg"),e.newClsParam=()=>ul("Diagnostic.newClsParam"),e.newTypeLiteral=()=>ul("Diagnostic.newTypeLiteral"),e.newTypeNotAClass=()=>ul("Diagnostic.newTypeNotAClass"),e.newTypeProtocolClass=()=>ul("Diagnostic.newTypeProtocolClass"),e.nonDefaultAfterDefault=()=>ul("Diagnostic.nonDefaultAfterDefault"),e.noneNotCallable=()=>ul("Diagnostic.noneNotCallable"),e.noneNotIterable=()=>ul("Diagnostic.noneNotIterable"),e.noneNotSubscriptable=()=>ul("Diagnostic.noneNotSubscriptable"),e.noneNotUsableWith=()=>ul("Diagnostic.noneNotUsableWith"),e.noneOperator=()=>new rl(ul("Diagnostic.noneOperator")),e.noneUnknownMember=()=>new rl(ul("Diagnostic.noneUnknownMember")),e.nonLocalNoBinding=()=>new rl(ul("Diagnostic.nonLocalNoBinding")),e.nonLocalReassignment=()=>new rl(ul("Diagnostic.nonLocalReassignment")),e.nonLocalRedefinition=()=>new rl(ul("Diagnostic.nonLocalRedefinition")),e.nonLocalInModule=()=>ul("Diagnostic.nonLocalInModule"),e.noOverload=()=>new rl(ul("Diagnostic.noOverload")),e.noReturnContainsReturn=()=>ul("Diagnostic.noReturnContainsReturn"),e.noReturnContainsYield=()=>ul("Diagnostic.noReturnContainsYield"),e.noReturnReturnsNone=()=>ul("Diagnostic.noReturnReturnsNone"),e.notRequiredArgCount=()=>ul("Diagnostic.notRequiredArgCount"),e.notRequiredNotInTypedDict=()=>ul("Diagnostic.notRequiredNotInTypedDict"),e.objectNotCallable=()=>new rl(ul("Diagnostic.objectNotCallable")),e.obscuredClassDeclaration=()=>new rl(ul("Diagnostic.obscuredClassDeclaration")),e.obscuredFunctionDeclaration=()=>new rl(ul("Diagnostic.obscuredFunctionDeclaration")),e.obscuredMethodDeclaration=()=>new rl(ul("Diagnostic.obscuredMethodDeclaration")),e.obscuredParameterDeclaration=()=>new rl(ul("Diagnostic.obscuredParameterDeclaration")),e.obscuredVariableDeclaration=()=>new rl(ul("Diagnostic.obscuredVariableDeclaration")),e.operatorLessOrGreaterDeprecated=()=>ul("Diagnostic.operatorLessOrGreaterDeprecated"),e.optionalExtraArgs=()=>ul("Diagnostic.optionalExtraArgs"),e.orPatternIrrefutable=()=>ul("Diagnostic.orPatternIrrefutable"),e.orPatternMissingName=()=>ul("Diagnostic.orPatternMissingName"),e.overlappingOverload=()=>new rl(ul("Diagnostic.overlappingOverload")),e.overloadAbstractMismatch=()=>new rl(ul("Diagnostic.overloadAbstractMismatch")),e.overloadImplementationMismatch=()=>new rl(ul("Diagnostic.overloadImplementationMismatch")),e.overloadReturnTypeMismatch=()=>new rl(ul("Diagnostic.overloadReturnTypeMismatch")),e.overloadWithImplementation=()=>new rl(ul("Diagnostic.overloadWithImplementation")),e.overloadWithoutImplementation=()=>new rl(ul("Diagnostic.overloadWithoutImplementation")),e.paramAfterKwargsParam=()=>ul("Diagnostic.paramAfterKwargsParam"),e.paramAlreadyAssigned=()=>new rl(ul("Diagnostic.paramAlreadyAssigned")),e.paramAnnotationMissing=()=>new rl(ul("Diagnostic.paramAnnotationMissing")),e.paramNameMissing=()=>new rl(ul("Diagnostic.paramNameMissing")),e.paramSpecArgsKwargsUsage=()=>ul("Diagnostic.paramSpecArgsKwargsUsage"),e.paramSpecArgsUsage=()=>ul("Diagnostic.paramSpecArgsUsage"),e.paramSpecAssignedName=()=>new rl(ul("Diagnostic.paramSpecAssignedName")),e.paramSpecContext=()=>ul("Diagnostic.paramSpecContext"),e.paramSpecFirstArg=()=>ul("Diagnostic.paramSpecFirstArg"),e.paramSpecKwargsUsage=()=>ul("Diagnostic.paramSpecKwargsUsage"),e.paramSpecNotBound=()=>new rl(ul("Diagnostic.paramSpecNotBound")),e.paramSpecNotUsedByOuterScope=()=>new rl(ul("Diagnostic.paramSpecNotUsedByOuterScope")),e.paramSpecUnknownArg=()=>ul("Diagnostic.paramSpecUnknownArg"),e.paramSpecUnknownMember=()=>new rl(ul("Diagnostic.paramSpecUnknownMember")),e.paramSpecUnknownParam=()=>new rl(ul("Diagnostic.paramSpecUnknownParam")),e.paramTypeCovariant=()=>ul("Diagnostic.paramTypeCovariant"),e.paramTypeUnknown=()=>new rl(ul("Diagnostic.paramTypeUnknown")),e.paramAssignmentMismatch=()=>new rl(ul("Diagnostic.paramAssignmentMismatch")),e.paramTypePartiallyUnknown=()=>new rl(ul("Diagnostic.paramTypePartiallyUnknown")),e.parenthesizedContextManagerIllegal=()=>ul("Diagnostic.parenthesizedContextManagerIllegal"),e.positionArgAfterNamedArg=()=>ul("Diagnostic.positionArgAfterNamedArg"),e.privateImportFromPyTypedModule=()=>new rl(ul("Diagnostic.privateImportFromPyTypedModule")),e.positionOnlyAfterArgs=()=>ul("Diagnostic.positionOnlyAfterArgs"),e.positionOnlyAfterKeywordOnly=()=>ul("Diagnostic.positionOnlyAfterKeywordOnly"),e.positionOnlyIncompatible=()=>ul("Diagnostic.positionOnlyIncompatible"),e.positionOnlyFirstParam=()=>ul("Diagnostic.positionOnlyFirstParam"),e.privateUsedOutsideOfClass=()=>new rl(ul("Diagnostic.privateUsedOutsideOfClass")),e.privateUsedOutsideOfModule=()=>new rl(ul("Diagnostic.privateUsedOutsideOfModule")),e.propertyOverridden=()=>new rl(ul("Diagnostic.propertyOverridden")),e.propertyStaticMethod=()=>ul("Diagnostic.propertyStaticMethod"),e.protectedUsedOutsideOfClass=()=>new rl(ul("Diagnostic.protectedUsedOutsideOfClass")),e.protocolBaseClass=()=>new rl(ul("Diagnostic.protocolBaseClass")),e.protocolIllegal=()=>ul("Diagnostic.protocolIllegal"),e.protocolMemberNotClassVar=()=>new rl(ul("Diagnostic.protocolMemberNotClassVar")),e.protocolNotAllowedInTypeArgument=()=>ul("Diagnostic.protocolNotAllowedInTypeArgument"),e.protocolUsedInCall=()=>new rl(ul("Diagnostic.protocolUsedInCall")),e.protocolVarianceContravariant=()=>new rl(ul("Diagnostic.protocolVarianceContravariant")),e.protocolVarianceCovariant=()=>new rl(ul("Diagnostic.protocolVarianceCovariant")),e.protocolVarianceInvariant=()=>new rl(ul("Diagnostic.protocolVarianceInvariant")),e.recursiveDefinition=()=>new rl(ul("Diagnostic.recursiveDefinition")),e.relativeImportNotAllowed=()=>ul("Diagnostic.relativeImportNotAllowed"),e.requiredArgCount=()=>ul("Diagnostic.requiredArgCount"),e.requiredNotInTypedDict=()=>ul("Diagnostic.requiredNotInTypedDict"),e.returnMissing=()=>new rl(ul("Diagnostic.returnMissing")),e.returnOutsideFunction=()=>ul("Diagnostic.returnOutsideFunction"),e.returnTypeContravariant=()=>ul("Diagnostic.returnTypeContravariant"),e.returnTypeMismatch=()=>new rl(ul("Diagnostic.returnTypeMismatch")),e.returnTypeUnknown=()=>ul("Diagnostic.returnTypeUnknown"),e.returnTypePartiallyUnknown=()=>new rl(ul("Diagnostic.returnTypePartiallyUnknown")),e.revealLocalsArgs=()=>ul("Diagnostic.revealLocalsArgs"),e.revealLocalsNone=()=>ul("Diagnostic.revealLocalsNone"),e.revealTypeArgs=()=>ul("Diagnostic.revealTypeArgs"),e.revealTypeExpectedTextArg=()=>ul("Diagnostic.revealTypeExpectedTextArg"),e.revealTypeExpectedTextMismatch=()=>new rl(ul("Diagnostic.revealTypeExpectedTextMismatch")),e.revealTypeExpectedTypeMismatch=()=>new rl(ul("Diagnostic.revealTypeExpectedTypeMismatch")),e.selfTypeContext=()=>ul("Diagnostic.selfTypeContext"),e.selfTypeWithTypedSelfOrCls=()=>ul("Diagnostic.selfTypeWithTypedSelfOrCls"),e.setterGetterTypeMismatch=()=>ul("Diagnostic.setterGetterTypeMismatch"),e.starPatternInAsPattern=()=>ul("Diagnostic.starPatternInAsPattern"),e.starPatternInOrPattern=()=>ul("Diagnostic.starPatternInOrPattern"),e.singleOverload=()=>new rl(ul("Diagnostic.singleOverload")),e.slotsAttributeError=()=>new rl(ul("Diagnostic.slotsAttributeError")),e.slotsClassVarConflict=()=>new rl(ul("Diagnostic.slotsClassVarConflict")),e.starStarWildcardNotAllowed=()=>ul("Diagnostic.starStarWildcardNotAllowed"),e.staticClsSelfParam=()=>ul("Diagnostic.staticClsSelfParam"),e.strictTypeGuardReturnType=()=>new rl(ul("Diagnostic.strictTypeGuardReturnType")),e.stringNonAsciiBytes=()=>ul("Diagnostic.stringNonAsciiBytes"),e.stringNotSubscriptable=()=>ul("Diagnostic.stringNotSubscriptable"),e.stringUnsupportedEscape=()=>ul("Diagnostic.stringUnsupportedEscape"),e.stringUnterminated=()=>ul("Diagnostic.stringUnterminated"),e.stubFileMissing=()=>new rl(ul("Diagnostic.stubFileMissing")),e.stubUsesGetAttr=()=>ul("Diagnostic.stubUsesGetAttr"),e.sublistParamsIncompatible=()=>ul("Diagnostic.sublistParamsIncompatible"),e.superCallArgCount=()=>ul("Diagnostic.superCallArgCount"),e.superCallFirstArg=()=>new rl(ul("Diagnostic.superCallFirstArg")),e.superCallSecondArg=()=>new rl(ul("Diagnostic.superCallSecondArg")),e.superCallZeroArgForm=()=>ul("Diagnostic.superCallZeroArgForm"),e.symbolIsUnbound=()=>new rl(ul("Diagnostic.symbolIsUnbound")),e.symbolIsUndefined=()=>new rl(ul("Diagnostic.symbolIsUndefined")),e.symbolIsPossiblyUnbound=()=>new rl(ul("Diagnostic.symbolIsPossiblyUnbound")),e.symbolOverridden=()=>new rl(ul("Diagnostic.symbolOverridden")),e.totalOrderingMissingMethod=()=>ul("Diagnostic.totalOrderingMissingMethod"),e.trailingCommaInFromImport=()=>ul("Diagnostic.trailingCommaInFromImport"),e.tryWithoutExcept=()=>ul("Diagnostic.tryWithoutExcept"),e.tupleAssignmentMismatch=()=>new rl(ul("Diagnostic.tupleAssignmentMismatch")),e.tupleInAnnotation=()=>ul("Diagnostic.tupleInAnnotation"),e.tupleIndexOutOfRange=()=>new rl(ul("Diagnostic.tupleIndexOutOfRange")),e.typeAliasIsRecursiveDirect=()=>new rl(ul("Diagnostic.typeAliasIsRecursiveDirect")),e.typeAliasIsRecursiveIndirect=()=>new rl(ul("Diagnostic.typeAliasIsRecursiveIndirect")),e.typeAliasNotInModuleOrClass=()=>ul("Diagnostic.typeAliasNotInModuleOrClass"),e.typeAliasRedeclared=()=>new rl(ul("Diagnostic.typeAliasRedeclared")),e.typeAnnotationCall=()=>ul("Diagnostic.typeAnnotationCall"),e.typeAnnotationVariable=()=>ul("Diagnostic.typeAnnotationVariable"),e.typeArgListExpected=()=>ul("Diagnostic.typeArgListExpected"),e.typeArgListNotAllowed=()=>ul("Diagnostic.typeArgListNotAllowed"),e.typeArgsExpectingNone=()=>new rl(ul("Diagnostic.typeArgsExpectingNone")),e.typeArgsMismatchOne=()=>new rl(ul("Diagnostic.typeArgsMismatchOne")),e.typeArgsMissingForAlias=()=>new rl(ul("Diagnostic.typeArgsMissingForAlias")),e.typeArgsMissingForClass=()=>new rl(ul("Diagnostic.typeArgsMissingForClass")),e.typeArgsTooFew=()=>new rl(ul("Diagnostic.typeArgsTooFew")),e.typeArgsTooMany=()=>new rl(ul("Diagnostic.typeArgsTooMany")),e.typeAssignmentMismatch=()=>new rl(ul("Diagnostic.typeAssignmentMismatch")),e.typeCallNotAllowed=()=>ul("Diagnostic.typeCallNotAllowed"),e.typedDictAccess=()=>ul("Diagnostic.typedDictAccess"),e.typedDictBadVar=()=>ul("Diagnostic.typedDictBadVar"),e.typedDictBaseClass=()=>ul("Diagnostic.typedDictBaseClass"),e.typedDictDelete=()=>ul("Diagnostic.typedDictDelete"),e.typedDictEmptyName=()=>ul("Diagnostic.typedDictEmptyName"),e.typedDictEntryName=()=>ul("Diagnostic.typedDictEntryName"),e.typedDictEntryUnique=()=>ul("Diagnostic.typedDictEntryUnique"),e.typedDictExtraArgs=()=>ul("Diagnostic.typedDictExtraArgs"),e.typedDictFieldRedefinition=()=>new rl(ul("Diagnostic.typedDictFieldRedefinition")),e.typedDictFirstArg=()=>ul("Diagnostic.typedDictFirstArg"),e.typedDictSecondArgDict=()=>ul("Diagnostic.typedDictSecondArgDict"),e.typedDictSecondArgDictEntry=()=>ul("Diagnostic.typedDictSecondArgDictEntry"),e.typedDictSet=()=>ul("Diagnostic.typedDictSet"),e.typedDictTotalParam=()=>ul("Diagnostic.typedDictTotalParam"),e.typeExpectedClass=()=>new rl(ul("Diagnostic.typeExpectedClass")),e.typeGuardArgCount=()=>ul("Diagnostic.typeGuardArgCount"),e.typeNotAwaitable=()=>new rl(ul("Diagnostic.typeNotAwaitable")),e.typeNotCallable=()=>new rl(ul("Diagnostic.typeNotCallable")),e.typeNotIntantiable=()=>new rl(ul("Diagnostic.typeNotIntantiable")),e.typeNotIterable=()=>new rl(ul("Diagnostic.typeNotIterable")),e.typeNotSpecializable=()=>new rl(ul("Diagnostic.typeNotSpecializable")),e.typeNotSubscriptable=()=>new rl(ul("Diagnostic.typeNotSubscriptable")),e.typeNotUsableWith=()=>new rl(ul("Diagnostic.typeNotUsableWith")),e.typeNotSupportBinaryOperator=()=>new rl(ul("Diagnostic.typeNotSupportBinaryOperator")),e.typeNotSupportBinaryOperatorBidirectional=()=>new rl(ul("Diagnostic.typeNotSupportBinaryOperatorBidirectional")),e.typeNotSupportUnaryOperator=()=>new rl(ul("Diagnostic.typeNotSupportUnaryOperator")),e.typeNotSupportUnaryOperatorBidirectional=()=>new rl(ul("Diagnostic.typeNotSupportUnaryOperatorBidirectional")),e.typePartiallyUnknown=()=>new rl(ul("Diagnostic.typePartiallyUnknown")),e.typeUnknown=()=>new rl(ul("Diagnostic.typeUnknown")),e.typeVarAssignedName=()=>new rl(ul("Diagnostic.typeVarAssignedName")),e.typeVarAssignmentMismatch=()=>new rl(ul("Diagnostic.typeVarAssignmentMismatch")),e.typeVarBoundAndConstrained=()=>ul("Diagnostic.typeVarBoundAndConstrained"),e.typeVarFirstArg=()=>ul("Diagnostic.typeVarFirstArg"),e.typeVarGeneric=()=>ul("Diagnostic.typeVarGeneric"),e.typeVarNoMember=()=>new rl(ul("Diagnostic.typeVarNoMember")),e.typeVarNotSubscriptable=()=>new rl(ul("Diagnostic.typeVarNotSubscriptable")),e.typeVarNotUsedByOuterScope=()=>new rl(ul("Diagnostic.typeVarNotUsedByOuterScope")),e.typeVarSingleConstraint=()=>ul("Diagnostic.typeVarSingleConstraint"),e.typeVarsNotInGeneric=()=>ul("Diagnostic.typeVarsNotInGeneric"),e.typeVarTupleMustBeUnpacked=()=>ul("Diagnostic.typeVarTupleMustBeUnpacked"),e.typeVarTupleContext=()=>ul("Diagnostic.typeVarTupleContext"),e.typeVarUnknownParam=()=>new rl(ul("Diagnostic.typeVarUnknownParam")),e.typeVarUsedByOuterScope=()=>new rl(ul("Diagnostic.typeVarUsedByOuterScope")),e.typeVarUsedOnlyOnce=()=>new rl(ul("Diagnostic.typeVarUsedOnlyOnce")),e.typeVarVariance=()=>ul("Diagnostic.typeVarVariance"),e.unaccessedClass=()=>new rl(ul("Diagnostic.unaccessedClass")),e.unaccessedFunction=()=>new rl(ul("Diagnostic.unaccessedFunction")),e.unaccessedImport=()=>new rl(ul("Diagnostic.unaccessedImport")),e.unaccessedSymbol=()=>new rl(ul("Diagnostic.unaccessedSymbol")),e.unaccessedVariable=()=>new rl(ul("Diagnostic.unaccessedVariable")),e.unexpectedAsyncToken=()=>ul("Diagnostic.unexpectedAsyncToken"),e.unexpectedExprToken=()=>ul("Diagnostic.unexpectedExprToken"),e.unexpectedIndent=()=>ul("Diagnostic.unexpectedIndent"),e.unexpectedUnindent=()=>ul("Diagnostic.unexpectedUnindent"),e.unionSyntaxIllegal=()=>ul("Diagnostic.unionSyntaxIllegal"),e.unionTypeArgCount=()=>ul("Diagnostic.unionTypeArgCount"),e.uninitializedInstanceVariable=()=>new rl(ul("Diagnostic.uninitializedInstanceVariable")),e.unnecessaryCast=()=>new rl(ul("Diagnostic.unnecessaryCast")),e.unnecessaryIsInstanceAlways=()=>new rl(ul("Diagnostic.unnecessaryIsInstanceAlways")),e.unnecessaryIsSubclassAlways=()=>new rl(ul("Diagnostic.unnecessaryIsSubclassAlways")),e.unnecessaryTypeIgnore=()=>ul("Diagnostic.unnecessaryTypeIgnore"),e.unpackArgCount=()=>ul("Diagnostic.unpackArgCount"),e.unpackedArgInTypeArgument=()=>ul("Diagnostic.unpackedArgInTypeArgument"),e.unpackedArgWithVariadicParam=()=>ul("Diagnostic.unpackedArgWithVariadicParam"),e.unpackedDictArgumentNotMapping=()=>ul("Diagnostic.unpackedDictArgumentNotMapping"),e.unpackedSubscriptIllegal=()=>ul("Diagnostic.unpackedSubscriptIllegal"),e.unpackedTypedDictArgument=()=>ul("Diagnostic.unpackedTypedDictArgument"),e.unpackedTypeVarTupleExpected=()=>new rl(ul("Diagnostic.unpackedTypeVarTupleExpected")),e.unpackExpectedTypedDict=()=>ul("Diagnostic.unpackExpectedTypedDict"),e.unpackExpectedTypeVarTuple=()=>ul("Diagnostic.unpackExpectedTypeVarTuple"),e.unpackIllegalInComprehension=()=>ul("Diagnostic.unpackIllegalInComprehension"),e.unpackInAnnotation=()=>ul("Diagnostic.unpackInAnnotation"),e.unpackInDict=()=>ul("Diagnostic.unpackInDict"),e.unpackInSet=()=>ul("Diagnostic.unpackInSet"),e.unpackNotAllowed=()=>ul("Diagnostic.unpackNotAllowed"),e.unpackOperatorNotAllowed=()=>ul("Diagnostic.unpackOperatorNotAllowed"),e.unpackTuplesIllegal=()=>ul("Diagnostic.unpackTuplesIllegal"),e.unreachableCode=()=>ul("Diagnostic.unreachableCode"),e.unreachableExcept=()=>ul("Diagnostic.unreachableExcept"),e.unsupportedDunderAllOperation=()=>ul("Diagnostic.unsupportedDunderAllOperation"),e.unusedCallResult=()=>new rl(ul("Diagnostic.unusedCallResult")),e.unusedCoroutine=()=>ul("Diagnostic.unusedCoroutine"),e.varAnnotationIllegal=()=>ul("Diagnostic.varAnnotationIllegal"),e.variadicTypeArgsTooMany=()=>ul("Diagnostic.variadicTypeArgsTooMany"),e.variadicTypeParamTooManyAlias=()=>new rl(ul("Diagnostic.variadicTypeParamTooManyAlias")),e.variadicTypeParamTooManyClass=()=>new rl(ul("Diagnostic.variadicTypeParamTooManyClass")),e.walrusIllegal=()=>ul("Diagnostic.walrusIllegal"),e.walrusNotAllowed=()=>ul("Diagnostic.walrusNotAllowed"),e.wildcardInFunction=()=>ul("Diagnostic.wildcardInFunction"),e.wildcardLibraryImport=()=>ul("Diagnostic.wildcardLibraryImport"),e.yieldFromIllegal=()=>ul("Diagnostic.yieldFromIllegal"),e.yieldFromOutsideAsync=()=>ul("Diagnostic.yieldFromOutsideAsync"),e.yieldOutsideFunction=()=>ul("Diagnostic.yieldOutsideFunction"),e.yieldTypeMismatch=()=>new rl(ul("Diagnostic.yieldTypeMismatch")),e.yieldWithinListCompr=()=>ul("Diagnostic.yieldWithinListCompr"),e.zeroCaseStatementsFound=()=>ul("Diagnostic.zeroCaseStatementsFound"),e.zeroLengthTupleNotAllowed=()=>ul("Diagnostic.zeroLengthTupleNotAllowed")}(t=e.Diagnostic||(e.Diagnostic={})),function(e){e.argParam=()=>new rl(ul("DiagnosticAddendum.argParam")),e.argParamFunction=()=>new rl(ul("DiagnosticAddendum.argParamFunction")),e.argsParamMissing=()=>new rl(ul("DiagnosticAddendum.argsParamMissing")),e.argsPositionOnly=()=>new rl(ul("DiagnosticAddendum.argsPositionOnly")),e.argumentType=()=>new rl(ul("DiagnosticAddendum.argumentType")),e.argumentTypes=()=>new rl(ul("DiagnosticAddendum.argumentTypes")),e.assignToNone=()=>ul("DiagnosticAddendum.assignToNone"),e.asyncHelp=()=>ul("DiagnosticAddendum.asyncHelp"),e.baseClassProvidesType=()=>new rl(ul("DiagnosticAddendum.baseClassProvidesType")),e.dataClassFrozen=()=>new rl(ul("DiagnosticAddendum.dataClassFrozen")),e.dataClassFieldLocation=()=>ul("DiagnosticAddendum.dataClassFieldLocation"),e.finalMethod=()=>ul("DiagnosticAddendum.finalMethod"),e.functionParamDefaultMissing=()=>new rl(ul("DiagnosticAddendum.functionParamDefaultMissing")),e.functionParamName=()=>new rl(ul("DiagnosticAddendum.functionParamName")),e.functionReturnTypeMismatch=()=>new rl(ul("DiagnosticAddendum.functionReturnTypeMismatch")),e.functionTooFewParams=()=>new rl(ul("DiagnosticAddendum.functionTooFewParams")),e.incompatibleGetter=()=>ul("DiagnosticAddendum.incompatibleGetter"),e.incompatibleSetter=()=>ul("DiagnosticAddendum.incompatibleSetter"),e.incompatibleDeleter=()=>ul("DiagnosticAddendum.incompatibleDeleter"),e.initMethodLocation=()=>new rl(ul("DiagnosticAddendum.initMethodLocation")),e.initMethodSignature=()=>new rl(ul("DiagnosticAddendum.initMethodSignature")),e.functionTooManyParams=()=>new rl(ul("DiagnosticAddendum.functionTooManyParams")),e.keyNotRequired=()=>new rl(ul("DiagnosticAddendum.keyNotRequired")),e.keyRequiredDeleted=()=>new rl(ul("DiagnosticAddendum.keyRequiredDeleted")),e.keyUndefined=()=>new rl(ul("DiagnosticAddendum.keyUndefined")),e.kwargsParamMissing=()=>new rl(ul("DiagnosticAddendum.kwargsParamMissing")),e.listAssignmentMismatch=()=>new rl(ul("DiagnosticAddendum.listAssignmentMismatch")),e.literalAssignmentMismatch=()=>new rl(ul("DiagnosticAddendum.literalAssignmentMismatch")),e.matchIsNotExhaustiveType=()=>new rl(ul("DiagnosticAddendum.matchIsNotExhaustiveType")),e.matchIsNotExhaustiveHint=()=>ul("DiagnosticAddendum.matchIsNotExhaustiveHint"),e.memberAssignment=()=>new rl(ul("DiagnosticAddendum.memberAssignment")),e.memberIsAbstract=()=>new rl(ul("DiagnosticAddendum.memberIsAbstract")),e.memberIsAbstractMore=()=>new rl(ul("DiagnosticAddendum.memberIsAbstractMore")),e.memberIsFinalInProtocol=()=>new rl(ul("DiagnosticAddendum.memberIsFinalInProtocol")),e.memberIsInitVar=()=>new rl(ul("DiagnosticAddendum.memberIsInitVar")),e.memberIsNotFinalInProtocol=()=>new rl(ul("DiagnosticAddendum.memberIsNotFinalInProtocol")),e.memberSetClassVar=()=>new rl(ul("DiagnosticAddendum.memberSetClassVar")),e.memberTypeMismatch=()=>new rl(ul("DiagnosticAddendum.memberTypeMismatch")),e.memberUnknown=()=>new rl(ul("DiagnosticAddendum.memberUnknown")),e.missingProtocolMember=()=>new rl(ul("DiagnosticAddendum.missingProtocolMember")),e.missingGetter=()=>ul("DiagnosticAddendum.missingGetter"),e.missingSetter=()=>ul("DiagnosticAddendum.missingSetter"),e.missingDeleter=()=>ul("DiagnosticAddendum.missingDeleter"),e.namedParamMissingInDest=()=>new rl(ul("DiagnosticAddendum.namedParamMissingInDest")),e.namedParamMissingInSource=()=>new rl(ul("DiagnosticAddendum.namedParamMissingInSource")),e.namedParamTypeMismatch=()=>new rl(ul("DiagnosticAddendum.namedParamTypeMismatch")),e.newMethodLocation=()=>new rl(ul("DiagnosticAddendum.newMethodLocation")),e.newMethodSignature=()=>new rl(ul("DiagnosticAddendum.newMethodSignature")),e.noOverloadAssignable=()=>new rl(ul("DiagnosticAddendum.noOverloadAssignable")),e.orPatternMissingName=()=>new rl(ul("DiagnosticAddendum.orPatternMissingName")),e.overloadMethod=()=>ul("DiagnosticAddendum.overloadMethod"),e.overloadNotAssignable=()=>new rl(ul("DiagnosticAddendum.overloadNotAssignable")),e.overloadWithImplementation=()=>ul("DiagnosticAddendum.overloadWithImplementation"),e.overriddenMethod=()=>ul("DiagnosticAddendum.overriddenMethod"),e.overriddenSymbol=()=>ul("DiagnosticAddendum.overriddenSymbol"),e.overrideParamCount=()=>new rl(ul("DiagnosticAddendum.overrideParamCount")),e.overrideParamName=()=>new rl(ul("DiagnosticAddendum.overrideParamName")),e.overrideParamNamePositionOnly=()=>new rl(ul("DiagnosticAddendum.overrideParamNamePositionOnly")),e.overrideParamType=()=>new rl(ul("DiagnosticAddendum.overrideParamType")),e.overrideReturnType=()=>new rl(ul("DiagnosticAddendum.overrideReturnType")),e.overrideType=()=>new rl(ul("DiagnosticAddendum.overrideType")),e.paramAssignment=()=>new rl(ul("DiagnosticAddendum.paramAssignment")),e.paramSpecOverload=()=>ul("DiagnosticAddendum.paramSpecOverload"),e.paramType=()=>new rl(ul("DiagnosticAddendum.paramType")),e.privateImportFromPyTypedSource=()=>new rl(ul("DiagnosticAddendum.privateImportFromPyTypedSource")),e.propertyAccessFromProtocolClass=()=>ul("DiagnosticAddendum.propertyAccessFromProtocolClass"),e.propertyMethodIncompatible=()=>new rl(ul("DiagnosticAddendum.propertyMethodIncompatible")),e.propertyMethodMissing=()=>new rl(ul("DiagnosticAddendum.propertyMethodMissing")),e.propertyMissingDeleter=()=>new rl(ul("DiagnosticAddendum.propertyMissingDeleter")),e.propertyMissingSetter=()=>new rl(ul("DiagnosticAddendum.propertyMissingSetter")),e.protocolMemberClassVar=()=>new rl(ul("DiagnosticAddendum.protocolMemberClassVar")),e.protocolIncompatible=()=>new rl(ul("DiagnosticAddendum.protocolIncompatible")),e.protocolMemberMissing=()=>new rl(ul("DiagnosticAddendum.protocolMemberMissing")),e.protocolSourceIsNotConcrete=()=>new rl(ul("DiagnosticAddendum.protocolSourceIsNotConcrete")),e.readOnlyAttribute=()=>new rl(ul("DiagnosticAddendum.readOnlyAttribute")),e.seeDeclaration=()=>ul("DiagnosticAddendum.seeDeclaration"),e.seeClassDeclaration=()=>ul("DiagnosticAddendum.seeClassDeclaration"),e.seeFunctionDeclaration=()=>ul("DiagnosticAddendum.seeFunctionDeclaration"),e.seeMethodDeclaration=()=>ul("DiagnosticAddendum.seeMethodDeclaration"),e.seeParameterDeclaration=()=>ul("DiagnosticAddendum.seeParameterDeclaration"),e.seeVariableDeclaration=()=>ul("DiagnosticAddendum.seeVariableDeclaration"),e.tupleEntryTypeMismatch=()=>new rl(ul("DiagnosticAddendum.tupleEntryTypeMismatch")),e.tupleAssignmentMismatch=()=>new rl(ul("DiagnosticAddendum.tupleAssignmentMismatch")),e.tupleSizeMismatch=()=>new rl(ul("DiagnosticAddendum.tupleSizeMismatch")),e.tupleSizeMismatchIndeterminate=()=>new rl(ul("DiagnosticAddendum.tupleSizeMismatchIndeterminate")),e.typeAssignmentMismatch=()=>new rl(ul("DiagnosticAddendum.typeAssignmentMismatch")),e.typeBound=()=>new rl(ul("DiagnosticAddendum.typeBound")),e.typeConstrainedTypeVar=()=>new rl(ul("DiagnosticAddendum.typeConstrainedTypeVar")),e.typedDictFieldMissing=()=>new rl(ul("DiagnosticAddendum.typedDictFieldMissing")),e.typedDictFieldNotRequired=()=>new rl(ul("DiagnosticAddendum.typedDictFieldNotRequired")),e.typedDictFieldRedefinition=()=>new rl(ul("DiagnosticAddendum.typedDictFieldRedefinition")),e.typedDictFieldRequired=()=>new rl(ul("DiagnosticAddendum.typedDictFieldRequired")),e.typedDictFieldTypeMismatch=()=>new rl(ul("DiagnosticAddendum.typedDictFieldTypeMismatch")),e.typedDictFieldUndefined=()=>new rl(ul("DiagnosticAddendum.typedDictFieldUndefined")),e.typedDictFinalMismatch=()=>new rl(ul("DiagnosticAddendum.typedDictFinalMismatch")),e.typeIncompatible=()=>new rl(ul("DiagnosticAddendum.typeIncompatible")),e.typeNotCallable=()=>new rl(ul("DiagnosticAddendum.typeNotCallable")),e.typeNotClass=()=>new rl(ul("DiagnosticAddendum.typeNotClass")),e.typeParamSpec=()=>new rl(ul("DiagnosticAddendum.typeParamSpec")),e.typeNotStringLiteral=()=>new rl(ul("DiagnosticAddendum.typeNotStringLiteral")),e.typeOfSymbol=()=>new rl(ul("DiagnosticAddendum.typeOfSymbol")),e.typeUnsupported=()=>new rl(ul("DiagnosticAddendum.typeUnsupported")),e.typeVarIsContravariant=()=>new rl(ul("DiagnosticAddendum.typeVarIsContravariant")),e.typeVarIsCovariant=()=>new rl(ul("DiagnosticAddendum.typeVarIsCovariant")),e.typeVarIsInvariant=()=>new rl(ul("DiagnosticAddendum.typeVarIsInvariant")),e.typeVarTupleRequiresKnownLength=()=>ul("DiagnosticAddendum.typeVarTupleRequiresKnownLength"),e.typeVarNotAllowed=()=>ul("DiagnosticAddendum.typeVarNotAllowed"),e.typeVarsMissing=()=>new rl(ul("DiagnosticAddendum.typeVarsMissing")),e.unreachableExcept=()=>new rl(ul("DiagnosticAddendum.unreachableExcept")),e.useDictInstead=()=>ul("DiagnosticAddendum.useDictInstead"),e.useListInstead=()=>ul("DiagnosticAddendum.useListInstead"),e.useTupleInstead=()=>ul("DiagnosticAddendum.useTupleInstead"),e.useTypeInstead=()=>ul("DiagnosticAddendum.useTypeInstead")}(n=e.DiagnosticAddendum||(e.DiagnosticAddendum={})),function(e){e.addOptionalToAnnotation=()=>ul("CodeAction.addOptionalToAnnotation"),e.createTypeStub=()=>ul("CodeAction.createTypeStub"),e.createTypeStubFor=()=>new rl(ul("CodeAction.createTypeStubFor")),e.executingCommand=()=>ul("CodeAction.executingCommand"),e.filesToAnalyzeOne=()=>ul("CodeAction.filesToAnalyzeOne"),e.filesToAnalyzeCount=()=>new rl(ul("CodeAction.filesToAnalyzeCount")),e.findingReferences=()=>ul("CodeAction.findingReferences"),e.organizeImports=()=>ul("CodeAction.organizeImports")}(i=e.CodeAction||(e.CodeAction={})),function(e){e.moveFile=()=>new rl(ul("Refactoring.moveFile")),e.moveFileLabel=()=>new rl(ul("Refactoring.moveFileLabel")),e.moveFileDescription=()=>new rl(ul("Refactoring.moveFileDescription"))}(r=e.Refactoring||(e.Refactoring={}))}(ml||(ml={}));const Dl=/'/g,Al=/\\"/g;function Pl(e,t,n,i=[]){const r=0!=(16&t),s=0!=(128&t);if(t&=-145,e.typeAliasInfo){let r=!0;if((0==(32&t)||i.find((t=>t===e)))&&(r=!1),!r)try{i.push(e);let r=e.typeAliasInfo.name;const s=e.typeAliasInfo.typeParameters;if(s){let o;e.typeAliasInfo.typeArguments?(0==(2&t)||e.typeAliasInfo.typeArguments.some((e=>!ho(e))))&&(o=[],e.typeAliasInfo.typeArguments.forEach(((e,r)=>{Io(r<s.length?s[r]:s[s.length-1])&&vo(e)&&pa(e)&&e.tupleTypeArguments?e.tupleTypeArguments.forEach((e=>{o.push(Pl(e.type,t,n,i))})):o.push(Pl(e,t,n,i))}))):(0==(2&t)||s.some((e=>!ho(e))))&&(o=[],s.forEach((e=>{o.push(Pl(e,t,n,i))}))),o&&(0===o.length?r+="[()]":r+=`[${o.join(", ")}]`)}if(10!==e.category)return r}finally{i.pop()}}if(i.find((t=>{var n;return t===e||void 0!==t.typeAliasInfo&&t.typeAliasInfo.fullName===(null===(n=e.typeAliasInfo)||void 0===n?void 0:n.fullName)}))||i.length>Gs)return bo(e)&&e.details.isSynthesized&&e.details.recursiveTypeAliasName?e.details.recursiveTypeAliasName:e.typeAliasInfo?e.typeAliasInfo.name:"...";try{i.push(e);const o=0==(64&t),a=e=>void 0!==e.condition&&o?"*":"";switch(e.category){case 0:return"Unbound";case 1:return 0!=(1&t)?"Any":"Unknown";case 8:return`Module("${e.moduleName}")`;case 7:return Ks.isInstance(e)?void 0!==e.literalValue?`Literal[${Rl(e)}]`:`${Fl(e,t,n,i)}${a(e)}`:void 0!==e.literalValue?`Type[Literal[${Rl(e)}]]${a(e)}`:`Type[${Fl(e,t,n,i)}]${a(e)}`;case 5:{const r=Nl(e,t,n,i),o=`(${r[0].join(", ")})`;if(Xs.isParamSpecValue(e))return o;const a=`${o} -> ${r[1]}`;return s?`(${a})`:a}case 6:return`Overload[${e.overloads.map((e=>Pl(e,t,n,i))).join(", ")}]`;case 9:{const s=new Set,o=new Set,a=8&t?128|t:t;if(0==(32&t)&&e.typeAliasSources)for(const t of e.typeAliasSources){let r=!0,l=!0;const c=new Set;for(const n of t.subtypes){let t=0,i=!1;for(const r of e.subtypes){if(Ao(n,r,void 0,!0)){s.has(t)||(l=!1),c.add(t),i=!0;break}t++}if(!i){r=!1;break}}r&&!l&&(o.add(Pl(t,a,n,i)),c.forEach((e=>s.add(e))))}const l=e.subtypes.findIndex((e=>lo(e)));if(l>=0&&!s.has(l)){const r=Fo(e);if(ao(r))return"None";const s=Pl(r,a,n,i);return 8&t?s+" | None":"Optional["+s+"]"}const c=new Set,u=new Set;Jo(e,((e,t)=>{s.has(t)||(vo(e)&&void 0!==e.literalValue?c.add(Rl(e)):_o(e)&&void 0!==e.literalValue?u.add(Rl(e)):o.add(Pl(e,a,n,i)))}));const p=[];if(o.forEach((e=>p.push(e))),c.size>0){const e=[];c.forEach((t=>e.push(t))),p.push(`Literal[${e.join(", ")}]`)}if(u.size>0){const e=[];u.forEach((t=>e.push(t))),p.push(`Type[Literal[${e.join(", ")}]]`)}if(1===p.length)return p[0];if(8&t){const e=p.join(" | ");return r?`(${e})`:e}return`Union[${p.join(", ")}]`}case 10:{if(e.details.isSynthesized){if(e.details.recursiveTypeAliasName)return 0!=(32&t)&&e.details.boundType?Pl(Ks.isInstance(e)?Fa(e.details.boundType):e.details.boundType,t,n,i):e.details.recursiveTypeAliasName;if(e.details.isSynthesizedSelf&&e.details.boundType){let r=Pl(e.details.boundType,-33&t,n,i);return ho(e.details.boundType)||(r=`Self@${r}`),Ks.isInstantiable(e)?`Type[${r}]`:r}return 0!=(1&t)?"Any":"Unknown"}if(e.details.isParamSpec)return e.paramSpecAccess?`${e.details.name}.${e.paramSpecAccess}`:`${oo.getReadableName(e)}`;let r=oo.getReadableName(e);return e.isVariadicUnpacked&&(r=`*${r}`),Ks.isInstantiable(e)?`Type[${r}]`:r}case 3:return`${Ks.isInstantiable(e)?"Type[None]":"None"}${a(e)}`;case 4:return e.isNoReturn?"NoReturn":"Never";case 2:return e.isEllipsis?"...":"Any"}return""}finally{i.pop()}}function Rl(e,t="'"){const n=e.literalValue;if(void 0===n)return"";let i;if("string"==typeof n){const r="bytes"===e.details.name?"b":"";i=JSON.stringify(n).toString(),'"'!==t&&(i=`'${i.substring(1,i.length-1).replace(Al,'"').replace(Dl,"\\'")}'`),r&&(i=`${r}${i}`)}else"boolean"==typeof n?i=n?"True":"False":n instanceof Hs?i=`${n.className}.${n.itemName}`:"bigint"==typeof n?(i=n.toString(),i.endsWith("n")&&(i=i.substring(0,i.length-1))):i=n.toString();return i}function Fl(e,t,n,i=[]){var r,s;let o=e.aliasName||e.details.name;if(!Zs.isPseudoGenericClass(e)){const a=Zs.getTypeParameters(e),l=a.length>0?a[a.length-1]:void 0,c=!!l&&l.details.isVariadic,u=null!==(r=e.tupleTypeArguments)&&void 0!==r?r:null===(s=e.typeArguments)||void 0===s?void 0:s.map((e=>({type:e,isUnbounded:!1})));if(u)if(u.length>0){const r=[];let s=!0;u.forEach(((e,o)=>{const l=o<a.length?a[o]:void 0;if(l&&l.details.isVariadic&&vo(e.type)&&Zs.isBuiltIn(e.type,"tuple")&&e.type.tupleTypeArguments)0===e.type.tupleTypeArguments.length?(ho(e.type)||(s=!1),r.push("()")):r.push(...e.type.tupleTypeArguments.map((e=>{ho(e.type)||(s=!1);const r=Pl(e.type,t,n,i);return e.isUnbounded?`*tuple[${r}, ...]`:r})));else{ho(e.type)||(s=!1);const o=Pl(e.type,t,n,i);e.isUnbounded?1===u.length?r.push(o,"..."):r.push(`*tuple[${o}, ...]`):r.push(o)}})),e.isUnpacked&&(o="*"+o),0!=(2&t)&&s||(o+="["+r.join(", ")+"]")}else(Zs.isTupleClass(e)||c)&&(o+="[()]");else a.length>0&&(0==(2&t)||a.some((e=>!ho(e))))&&(o+="["+a.map((e=>Pl(e,t,n,i))).join(", ")+"]")}return o}function Nl(e,t,n,i=[]){const r=[];let s=!1;e.details.parameters.forEach(((o,a)=>{if(a===e.details.parameters.length-1&&1===o.category&&Io(o.type)){const s=Xs.getEffectiveParameterType(e,a);if(vo(s)&&Zs.isBuiltIn(s,"tuple")&&s.tupleTypeArguments)return void s.tupleTypeArguments.forEach((e=>{const s=Pl(e.type,t,n,i);r.push(s)}))}let l="";1===o.category?o.name&&o.isNameSynthesized||(l+="*"):2===o.category&&(l+="**"),o.name&&!o.isNameSynthesized&&(l+=o.name,s=!0);let c="=",u=!1;if(o.name)if(o.hasDeclaredType||o.isTypeInferred){const r=Xs.getEffectiveParameterType(e,a),s=i.length<Gs?Pl(r,t,n,i):"";o.isNameSynthesized?1!==o.category||Co(r)||(l+="*"):l+=": ",2===o.category&&Co(r)&&(l+="**"),l+=s,wo(r)&&(1!==o.category&&2!==o.category||(u=!0)),c=" = "}else 0==(2&t)&&(o.isNameSynthesized||(l+=": "),l+="Unknown",c=" = ");else if(0===o.category){if(!s)return;l+="/"}if(o.hasDefault&&(o.defaultValueExpression?l+=c+xr(o.defaultValueExpression):l+=c+"..."),Xs.shouldSkipArgsKwargsCompatibilityCheck(e)&&!u)if(1===o.category)l="...";else if(2===o.category)return;r.push(l)})),e.details.paramSpec&&r.push(`**${Pl(e.details.paramSpec,t,n,i)}`);const o=n(e),a=i.length<Gs?Pl(o,144|t,n,i):"";return[r,a]}class Ml extends _r{constructor(e,t,n,i,r,s=!1){super(),this._symbolName=e,this._declarations=t,this._evaluator=n,this._cancellationToken=i,this._startingNode=r,this._treatModuleInImportAndFromImportSame=s,this._results=[],this._dunderAllNameNodes=new Set,this._setDunderAllNodes(this._startingNode)}static collectFromNode(e,t,n,i,r=!1){const s=e.value,o=this.getDeclarationsForNode(e,t,!0,n);return(i=null!=i?i:Hr(e))?new Ml(s,o,t,n,i,r).collect():[]}static getDeclarationsForNode(e,t,n,i,r){ct(i);const s=this._getDeclarationsForNode(e,t),o=[];return s.forEach((e=>{const i=t.resolveAliasDeclaration(e,n);if(i&&(o.push(i),r&&el(i.path))){const e=r.findDeclarations(i);for(const t of e)t&&t.path&&this._addIfUnique(o,t)}})),o}collect(){return this.walk(this._startingNode),this._results}walk(e){zt(e)||super.walk(e)}visitName(e){if(ct(this._cancellationToken),e.value!==this._symbolName)return!1;if(this._declarations.length>0){const t=Ml._getDeclarationsForNode(e,this._evaluator);t&&t.length>0&&t.some((e=>this._resultsContainsDeclaration(e)))&&this._addResult(e)}else this._addResult(e);return!1}visitString(e){return ct(this._cancellationToken),this._dunderAllNameNodes.has(e)&&this._addResult(e),!1}_addResult(e){const t=38===e.nodeType?e:function(e){return function(e){const t=e.quoteMarkLength,n=!(65536&e.flags);return dt.create(e.start+t,e.length-t-(n?t:0))}(e.token)}(e);this._results.push({node:e,range:t})}_resultsContainsDeclaration(e){const t=this._evaluator.resolveAliasDeclaration(e,!1);if(!t)return!1;if(this._declarations.some((e=>is(e,t,this._treatModuleInImportAndFromImportSame))))return!0;const n=this._getResolveAliasDeclaration(t);return!(!n||n===t)&&this._declarations.some((e=>is(e,n,this._treatModuleInImportAndFromImportSame)))}_getResolveAliasDeclaration(e){if(n(e))return ls([e])[0];const t=this._evaluator.resolveAliasDeclaration(e,!0);return n(t)?ls([t])[0]:t;function n(e){return!!e&&6===e.type&&e.node&&e.usesLocalName&&21===e.node.nodeType}}_setDunderAllNodes(e){if(36!==e.nodeType)return;const t=Wt(e);if(!t)return;const n=zs(e);n&&t.stringNodes.forEach((e=>{if(e.value!==this._symbolName)return;const t=n.lookUpSymbolRecursive(e.value);t&&t.symbol.getDeclarations().some((e=>this._resultsContainsDeclaration(e)))&&this._dunderAllNameNodes.add(e)}))}static _addIfUnique(e,t){for(const n of e)if(is(n,t))return;e.push(t)}static _getDeclarationsForNode(e,t){var n,i,r,s,o,a;if(37!==(null===(n=e.parent)||void 0===n?void 0:n.nodeType)){let n=t.getDeclarationsForNameNode(e)||[];if(23===(null===(i=e.parent)||void 0===i?void 0:i.nodeType)&&(n=n.filter((t=>t.node===e.parent))),0===n.length){const n=t.getType(e);if(8===(null==n?void 0:n.category))return[cs(n.filePath)]}for(const e of n.filter((e=>Gn(e)&&!e.loadSymbolsFromPath))){const i=e.node;23!==i.nodeType&&n.push(...t.getDeclarationsForNameNode(i.module.nameParts[0])||[])}return n}const l=e.parent;if(21===(null===(r=l.parent)||void 0===r?void 0:r.nodeType)||22===(null===(s=l.parent)||void 0===s?void 0:s.nodeType)){const n=l.nameParts.findIndex((t=>t===e));if(0===n){let n=[];const i=1===l.nameParts.length&&21===l.parent.nodeType&&!!l.parent.alias,r=i?l.parent.alias.value:l.nameParts[0].value,s=null===(o=zs(e))||void 0===o?void 0:o.lookUpSymbolRecursive(r);return s&&1===l.nameParts.length&&(n.push(...s.symbol.getDeclarations().filter((e=>Gn(e)))),n.length>1&&(n=n.filter((e=>void 0!==(e=e).firstNamePart?e.firstNamePart===l.nameParts[0].value:e.node===l.parent))),i&&(n=ls(n))),n.push(...(null===(a=t.getDeclarationsForNameNode(l.nameParts[0]))||void 0===a?void 0:a.filter((e=>Gn(e))))||[]),n}return n>0&&t.getDeclarationsForNameNode(l.nameParts[n])||[]}return[]}}function Ol(e,t,n=70){let i="";const r=e.overloads.filter((e=>Xs.isOverloaded(e))).map((e=>e.details.name+t.printType(e,!1)));for(let e=0;e<r.length;e++)0!==e&&r[e].length>n&&r[e-1].length<=n&&(i+="\n"),i+=r[e],e<r.length-1&&(i+="\n",r[e].length>n&&(i+="\n"));return i}function Ll(e,t,n){const i=e.details.declaration,r=i?Er(i.node):void 0,s=r?n.getTypeOfClass(r):void 0;return function(e,t,n,i){let r;if(!Tl(e,i)&&t&&jn(t)&&(r=function(e,t,n){if(!Eo(e))return;let i=e.details.docString;return!i&&t&&(i=El(t,n)),!i&&e.details.declaration&&(i=El(e.details.declaration,n)),i}(e,t,n)),!r&&i){const t=Ta(i,e.details.name,29);for(const e of t)if(e.symbol.getDeclarations().length>0){const t=e.symbol.getDeclarations().slice(-1)[0];if(jn(t)&&(r=El(t,n),r))break}}return r||e.details.docString}(e,i,t,null==s?void 0:s.classType)}function Ul(e,t,n){if(0===e.overloads.length)return[];const i=e.overloads[0].details.declaration,r=i?Er(i.node):void 0,s=r?n.getTypeOfClass(r):void 0;return function(e,t,n,i,r){let s;if(!Tl(e,r))for(const i of t)if(s=wl(e,i,n),s&&s.length>0)return s;if(r&&e.overloads.length>0){const t=Ta(r,e.overloads[0].details.name,29);for(const e of t){const t=e.symbol.getDeclarations().slice(-1)[0],r=i.getTypeForDeclaration(t);if(r&&(s=wl(r,t,n),s&&s.length>0))break}}return null!=s?s:[]}(e,e.overloads.map((e=>e.details.declaration)).filter(a),t,n,null==s?void 0:s.classType)}function ql(e,t,n,i){if(1===(null==n?void 0:n.type)&&n.typeAliasName&&n.docString)return[n.docString];if(To(t)){const i=Il(t,n,e);if(i)return[i]}else if(_o(t)){const i=Sl(t,n,e);if(i)return[i]}else if(Eo(t)){const n=Ll(t,e,i);if(n)return[n]}else{if(ko(t))return Ul(t,e,i);if(1===(null==n?void 0:n.type)){const t=Cl(n,e);if(t)return[t]}else if(3===(null==n?void 0:n.type)){const t=bl(n,e,i);if(t)return[t]}}return[]}var Vl,Bl;!function(e){const t=["True","False","None","and","or","not","is","lambda","yield","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","nonlocal","pass","raise","return","try","while","with"],n=[...t,"async","await"],i=[...n,"case","match"];e.forVersion=function(e){return e>=De.V3_10?i:e>=De.V3_5?n:t}}(Vl||(Vl={})),function(e){e[e.LikelyKeyword=0]="LikelyKeyword",e[e.RecentImportModuleName=1]="RecentImportModuleName",e[e.ImportModuleName=2]="ImportModuleName",e[e.LiteralValue=3]="LiteralValue",e[e.NamedParameter=4]="NamedParameter",e[e.RecentKeywordOrSymbol=5]="RecentKeywordOrSymbol",e[e.RecentAutoImport=6]="RecentAutoImport",e[e.Keyword=7]="Keyword",e[e.EnumMember=8]="EnumMember",e[e.NormalSymbol=9]="NormalSymbol",e[e.PrivateSymbol=10]="PrivateSymbol",e[e.DunderSymbol=11]="DunderSymbol",e[e.AutoImport=12]="AutoImport"}(Bl||(Bl={}));const Wl="Dictionary key";class jl{constructor(e,t,n,i,r,s,o,a,l,c,u,p,d){this._workspacePath=e,this._parseResults=t,this._fileContents=n,this._importResolver=i,this._position=r,this._filePath=s,this._configOptions=o,this._importLookup=a,this._evaluator=l,this._options=c,this._sourceMapper=u,this._autoImportMaps=p,this._cancellationToken=d,this._insideStringLiteral=!1,this._execEnv=this._configOptions.findExecEnvironment(this._filePath)}getCompletionsForPosition(){var e,t;const n=xt(this._position,this._parseResults.tokenizerOutput.lines);if(void 0===n)return;const i=function(e,t){const n=e.getItemAtPosition(t);if(n<0)return;const i=e.getItemAt(n);return dt.overlaps(i,t)?i:void 0}(this._parseResults.tokenizerOutput.tokens,n);5===(null==i?void 0:i.type)&&(this._insideStringLiteral=!!dt.contains(i,n)||!!(65536&i.flags));let r=Tr(this._parseResults.parseTree,n);const s=r,o=r?vr(r):0;if(!s||38!==s.nodeType){let t=n,i=!1;for(;t>=0;){t--;const n=this._fileContents.substr(t,1);if("("===n||"\n"===n||"}"===n)break;","===n&&(i=!0);const a=Tr(this._parseResults.parseTree,t);if(a&&a!==s){vr(a)>o&&(r=a,i&&23===(null===(e=r.parent)||void 0===e?void 0:e.nodeType)&&(r=r.parent));break}}}if(void 0===r)return;const a=this._parseResults.tokenizerOutput.lines.getItemAt(this._position.line),l=this._fileContents.substr(a.start,a.length),c=l.substr(0,this._position.character),u=l.substr(this._position.character),p=c.search(/\w+$/),d=p>=0?c.substr(p):"";if(this._isWithinComment(n))return;let h=r;for(;h&&0!==h.nodeType;)h=h.parent;let m=h||r;for(;;){if(ct(this._cancellationToken),49===m.nodeType)return this._getLiteralCompletions(m,d,c,u);if(48===m.nodeType||27===m.nodeType)return;if(37===m.nodeType)return this._getImportModuleCompletions(m);if(0===m.nodeType)return this._getExpressionErrorCompletions(m,d,c,u);if(35===m.nodeType)return this._getMemberAccessCompletions(m.leftExpression,d);if(15===m.nodeType){const e=new $l;if(this._addTypedDictKeys(m,void 0,c,u,e))return{completionMap:e}}const e=es(m,17);if(e&&15===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)){const t=e.parent;if(t.trailingCommaToken&&t.trailingCommaToken.start<n){const e=new $l;if(this._addTypedDictKeys(t,void 0,c,u,e))return{completionMap:e}}}if(38===m.nodeType){const e=this._tryGetNameCompletions(m,n,d);if(e||void 0===e)return e}if(22===m.nodeType)return this._getImportFromCompletions(m,d);if(yr(m))return this._getExpressionCompletions(m,d,c,u);if(50===m.nodeType){if(m.parent&&25===m.parent.nodeType&&!m.parent.name&&m.parent.typeExpression&&dt.getEnd(m.parent.typeExpression)<n&&n<=m.parent.exceptSuite.start)return;if(m.parent&&10===m.parent.nodeType&&(!m.parent.name||!m.parent.name.value)&&0===m.parent.arguments.length&&n<=m.parent.suite.start)return;return this._getStatementCompletions(m,d,c,u)}if(36===m.nodeType)return this._getStatementCompletions(m,d,c,u);if(41===m.nodeType&&0===m.length&&m.parent&&30===m.parent.nodeType)return;if(!m.parent)break;m=m.parent}}resolveCompletionItem(e){ct(this._cancellationToken);const t=e.data,n=e.label;let i="";t.autoImportText&&(i=t.autoImportText);const r=jl._mostRecentCompletions.findIndex((e=>e.label===n&&e.autoImportText===i));if(r>0&&(jl._mostRecentCompletions=jl._mostRecentCompletions.splice(r,1)),0!==r&&jl._mostRecentCompletions.unshift({label:n,autoImportText:i}),jl._mostRecentCompletions.length>128&&jl._mostRecentCompletions.pop(),t.symbolLabel)if(this._itemToResolve=e,t.autoImportText){if(!e.additionalTextEdits){const e={completionMap:new $l};this._addAutoImportCompletions(t.symbolLabel,1,!1,e)}}else this.getCompletionsForPosition()}_tryGetNameCompletions(e,t,n){var i;if(!e.parent)return!1;if(21!==e.parent.nodeType||e.parent.alias!==e){if(37===e.parent.nodeType){if(e.parent.parent&&21===e.parent.parent.nodeType&&!e.parent.parent.alias&&dt.getEnd(e.parent.parent)<t)return;return this._getImportModuleCompletions(e.parent)}if(23===e.parent.nodeType){if(e.parent.alias===e)return;const i=e.parent.parent;if(i&&22===i.nodeType){if(!e.parent.alias&&dt.getEnd(e.parent)<t)return;return e.parent.name===e?this._getImportFromCompletions(i,n):this._getImportFromCompletions(i,"")}return!1}if(35===e.parent.nodeType&&e===e.parent.memberName)return this._getMemberAccessCompletions(e.parent.leftExpression,n);if(25!==e.parent.nodeType||e!==e.parent.name){if(28===e.parent.nodeType&&e===e.parent.name)return(null===(i=e.parent.decorators)||void 0===i?void 0:i.some((e=>this._isOverload(e))))?this._getMethodOverloadsCompletions(n,e):void 0;if(!(41===e.parent.nodeType&&e===e.parent.name||10===e.parent.nodeType&&e===e.parent.name||26===e.parent.nodeType&&dt.contains(e.parent.targetExpression,e.start)||33===e.parent.nodeType&&dt.contains(e.parent.targetExpression,e.start)))return!1}}}_isWithinComment(e){var t,n;const i=function(e,t){const n=t.getItemAtPosition(e);if(n<0)return;let i=t.getItemAt(n);if(!(e>i.start&&e<i.start+i.length)){for(let e=n-1;e>=0;e--){const n=t.getItemAt(e);if(i.start!==n.start)break;i=n}return e<=i.start?i:(w(n+1<t.length),t.getItemAt(n+1))}}(e,this._parseResults.tokenizerOutput.tokens);return!!i&&null!==(n=null===(t=i.comments)||void 0===t?void 0:t.some((t=>dt.overlaps(t,e))))&&void 0!==n&&n}_getExpressionErrorCompletions(e,t,n,i){var r;switch(e.category){case 0:return this._createSingleKeywordCompletion("in");case 1:return this._createSingleKeywordCompletion("else");case 2:case 4:return this._getExpressionCompletions(e,t,n,i);case 3:{let r=this._getLiteralCompletions(e,t,n,i);return r&&r.completionMap||(r=this._getExpressionCompletions(e,t,n,i)),r}case 7:if(e.child&&yr(e.child))return this._getMemberAccessCompletions(e.child,t);break;case 10:if(e.child&&38===e.child.nodeType)return(null===(r=e.decorators)||void 0===r?void 0:r.some((e=>this._isOverload(e))))?this._getMethodOverloadsCompletions(t,e.child):this._getMethodOverrideCompletions(t,e.child,e.decorators)}}_isOverload(e){return this._checkDecorator(e,"overload")}_checkDecorator(e,t){return 38===e.expression.nodeType&&e.expression.value===t}_createSingleKeywordCompletion(e){const t=ot.CompletionItem.create(e);t.kind=ot.CompletionItemKind.Keyword,t.sortText=this._makeSortText(Bl.LikelyKeyword,e);const n=new $l;return n.set(t),{completionMap:n}}_getMethodOverloadsCompletions(e,t){var n;const i=function(e,t){const n=Er(t,!1);if(n){const t=e.getTypeOfClass(n);if(!t)return;const i=new Map;for(const e of t.classType.details.mro)_o(e)&&Ma(e,i,!1);return i}const i=function(e){let t=e.parent;for(;t;){if(36===t.nodeType)return t;t=t.parent}E("Module node not found")}(t);if(i){const e=Ft(i);return null==e?void 0:e.symbolTable}}(this._evaluator,t);if(!i)return;const r=28===(null===(n=t.parent)||void 0===n?void 0:n.nodeType)||void 0,s=new $l,o=kr(t);return i.forEach(((n,i)=>{const a=Vo(n);if(!a||3!==a.type)return;if(!a.node.decorators.some((e=>this._isOverload(e))))return;const l=n.getDeclarations();if((1!==l.length||!l.some((e=>e.node===o)))&&N(t.value,i)){const o=this._createReplaceEdits(e,t,a.node.name.value);this._addSymbol(i,n,t.value,s,{funcParensDisabled:r,edits:{textEdit:o}})}})),{completionMap:s}}_getMethodOverrideCompletions(e,t,n){var i,r;const s=Er(t,!0);if(!s)return;const o=this._evaluator.getTypeOfClass(s);if(!o)return;const a=new Map;for(let e=1;e<o.classType.details.mro.length;e++){const t=o.classType.details.mro[e];_o(t)&&Ma(t,a,!1)}const l=null!==(i=null==n?void 0:n.some((e=>this._checkDecorator(e,"staticmethod"))))&&void 0!==i&&i,c=null!==(r=null==n?void 0:n.some((e=>this._checkDecorator(e,"classmethod"))))&&void 0!==r&&r,u=new $l;return a.forEach(((n,i)=>{let r=Vo(n);if(r&&3===r.type&&N(t.value,i)){const s=this._evaluator.getTypeForDeclaration(r);if(!s)return;let a=vo(s)&&Zs.isPropertyClass(s);if(Qt(i)&&(a=!1),!Eo(s)&&!a)return;if(a){const e=n.getTypedDeclarations();e.length>0&&3===e[0].type&&(r=e[0])}const p=Eo(s)&&Xs.isStaticMethod(s),d=Eo(s)&&Xs.isClassMethod(s)&&"__init_subclass__"!==i;if(l!==p||c!==d)return;const h=this._printMethodSignature(o.classType,r);let m;m=el(this._filePath)?`${h}: ...`:`${h}:\n${this._printOverriddenMethodBody(o.classType,p,a,r)}`;const f=this._createReplaceEdits(e,t,m);this._addSymbol(i,n,t.value,u,{funcParensDisabled:!0,edits:{format:this._options.snippet?ot.InsertTextFormat.Snippet:void 0,textEdit:f}})}})),{completionMap:u}}_createReplaceEdits(e,t,n){const i=38===(null==t?void 0:t.nodeType)?this._position.character-e.length+t.value.length:this._position.character,r={start:{line:this._position.line,character:this._position.character-e.length},end:{line:this._position.line,character:i}};return ot.TextEdit.replace(r,n)}_printMethodSignature(e,t){const n=t.node;let i;el(this._filePath)?i=!0:e.details.moduleName===t.moduleName&&(i=!1);const r=el(this._filePath)?1:void 0,s=n.parameters.map(((e,t)=>{let s="";1===e.category?s+="*":2===e.category&&(s+="**"),e.name&&(s+=e.name.value);const o=this._evaluator.getTypeAnnotationForParameter(n,t);return o&&(s+=": "+xr(o,r)),e.defaultValue&&(s+=o?" = ":"=",s+=(null!=i?i:!a(e.defaultValue))?"...":xr(e.defaultValue,r)),s||e.name||0!==e.category?s:"/"})).join(", ");let o=n.name.value+"("+s+")";return n.returnTypeAnnotation?o+=" -> "+xr(n.returnTypeAnnotation,r):n.functionAnnotationComment&&(o+=" -> "+xr(n.functionAnnotationComment.returnTypeAnnotation,r)),o;function a(e){switch(e.nodeType){case 40:case 11:return!0;case 49:return 0==(64&e.token.flags);case 48:return e.strings.every(a);case 55:return a(e.expression);case 7:return a(e.leftExpression)&&a(e.rightExpression);default:return!1}}}_printOverriddenMethodBody(e,t,n,i){let r="    ";if(1===e.details.baseClasses.length&&yo(e.details.baseClasses[0])&&"builtins.object"===e.details.baseClasses[0].details.fullName)return r+=this._options.snippet?"${0:pass}":"pass",r;if(0===i.node.parameters.length)return r+=this._options.snippet?"${0:pass}":"pass",r;const s=function(e){const t=[];let n=!1;for(const i of e)i.name&&t.push([i,n]),n=1===i.category||2===i.category;return t}(t?i.node.parameters:i.node.parameters.slice(1));return"__init__"!==i.node.name.value&&(r+="return "),i.node.isAsync&&(r+="await "),n?r+`super().${i.node.name.value}`:r+`super().${i.node.name.value}(${s.map((function(e){var t;const n=null===(t=e[0].name)||void 0===t?void 0:t.value;return 1===e[0].category?`*${n}`:2===e[0].category?`**${n}`:e[1]?`${n}=${n}`:n})).join(", ")})`}_getMemberAccessCompletions(e,t){const n=new Map,i=new $l;let r={},s=this._evaluator.getType(e);return s&&(s=this._evaluator.makeTopLevelTypeVarsConcrete(s),Jo(s,(r=>{if(yo(r=this._evaluator.makeTopLevelTypeVarsConcrete(r)))Ma(r,n,Ks.isInstance(r));else if(To(r))!function(e,t){e.loaderFields&&e.loaderFields.forEach(((e,n)=>{t.set(n,e)})),e.fields.forEach(((e,n)=>{t.set(n,e)}))}(r,n);else if(Eo(r)||ko(r)){const t=this._evaluator.getBuiltInType(e,"function");t&&_o(t)&&Ma(t,n,!0)}else if(lo(r)){const t=this._evaluator.getBuiltInType(e,"object");t&&_o(t)&&Ma(t,n,Ks.isInstance(r))}this._addSymbolsForSymbolTable(n,(()=>!0),t,!1,yo(r)?r:void 0,i)}))),(!s||po(s)||mo(s))&&(r=this._getLastKnownModule(e,s)),{completionMap:i,memberAccessInfo:r}}_getLastKnownModule(e,t){var n;let i=e,r=t,s=35===e.nodeType?null==e?void 0:e.memberName.value:void 0;for(;i&&(9===i.nodeType||35===i.nodeType?(i=i.leftExpression,void 0===s&&(s=35===i.nodeType&&null!==(n=null==i?void 0:i.memberName.value)&&void 0!==n?n:"")):i=void 0,!i||(r=this._evaluator.getType(i),void 0===r||po(r)||mo(r))););const o={};if(r&&!po(r)&&!mo(r)&&i){const e=Ga(r);o.lastKnownModule=e.find((e=>"typing"!==e)),35===i.nodeType?o.lastKnownMemberName=i.memberName.value:(38===i.nodeType&&_o(r)||38===i.nodeType&&vo(r))&&(o.lastKnownMemberName=r.details.name),o.unknownMemberName=s}return o}_getStatementCompletions(e,t,n,i){return this._getExpressionCompletions(e,t,n,i)}_getExpressionCompletions(e,t,n,i){var r,s,o,a;const l=this._isIndexArgument(e);if(!l&&40===e.nodeType)return;if(59===(null===(r=e.parent)||void 0===r?void 0:r.nodeType)&&e.parent===(null===(s=e.parent.target)||void 0===s?void 0:s.parent))return;const c=new $l,u={completionMap:c};if(".."===n.slice(-2))return u;if(this._addCallArgumentCompletions(e,t,n,i,!1,c),this._addSymbols(e,t,c),this._findMatchingKeywords(Vl.forVersion(this._execEnv.pythonVersion),t).map((e=>{if(c.has(e))return;const t=ot.CompletionItem.create(e);t.kind=ot.CompletionItemKind.Keyword,t.sortText=this._makeSortText(Bl.Keyword,e),c.set(t)})),t.startsWith("_")||this._itemToResolve||this._addAutoImportCompletions(t,.25,this._options.lazyEdit,u),0===e.nodeType)if(3===e.category&&24===(null===(o=e.parent)||void 0===o?void 0:o.nodeType))this._tryAddTypedDictStringLiteral(e.parent,void 0,void 0,c);else if(2===e.category&&e.parent&&3===e.parent.nodeType){const r=null===(a=this._evaluator.getExpectedType(e))||void 0===a?void 0:a.type;r&&this._addLiteralValuesForTargetType(r,n,t,i,c)}if(l){const n=e.parent.parent;this._getIndexerKeys(n,e).forEach((e=>{c.has(e)||this._addNameToCompletions(e,ot.CompletionItemKind.Constant,t,c,{sortText:this._makeSortText(Bl.LiteralValue,e),itemDetail:Wl})}))}return u}_isIndexArgument(e){const t=e.parent;return t&&1===t.nodeType&&0===t.argumentCategory&&t.parent&&24===t.parent.nodeType&&t.parent.baseExpression&&38===t.parent.baseExpression.nodeType}_addCallArgumentCompletions(e,t,n,i,r,s){const o=zr(e,xt(this._position,this._parseResults.tokenizerOutput.lines),this._parseResults.tokenizerOutput.tokens);if(!o)return;const a=this._evaluator.getCallSignatureInfo(o.callNode,o.activeIndex,o.activeOrFake);if(a){const e=It(a.callNode.leftExpression.start+a.callNode.leftExpression.length,this._parseResults.tokenizerOutput.lines);gt(this._position,e)>0&&(r||this._addNamedParameters(a,t,s),this._addLiteralValuesForArgument(a,n,t,i,s))}}_addLiteralValuesForArgument(e,t,n,i,r){e.signatures.forEach((e=>{if(!e.activeParam)return;const s=e.type,o=s.details.parameters.indexOf(e.activeParam);if(o<0)return;const a=s.details.parameters[o].type;this._addLiteralValuesForTargetType(a,t,n,i,r)}))}_addLiteralValuesForTargetType(e,t,n,i,r){const s=this._getQuoteValueFromPriorText(t);this._getSubTypesWithLiteralValues(e).forEach((e=>{if(Zs.isBuiltIn(e,"str")){const t=Rl(e,s.quoteCharacter);void 0===s.stringValue?this._addNameToCompletions(t,ot.CompletionItemKind.Constant,n,r,{sortText:this._makeSortText(Bl.LiteralValue,e.literalValue)}):this._addStringLiteralToCompletions(t.substr(1,t.length-2),s.stringValue,i,s.quoteCharacter,r)}}))}_getDictExpressionStringKeys(e,t){const n=function(e){if(15===e.nodeType)return e;let t=e;for(;t&&15!==t.nodeType&&45!==t.nodeType;)if(t=t.parent,!t)return;return t}(e);return n?n.entries.flatMap((e=>17!==e.nodeType||(null==t?void 0:t.has(e.keyExpression.id))?[]:48===e.keyExpression.nodeType?[e.keyExpression.strings.map((e=>e.value)).join("")]:[])):[]}_getSubTypesWithLiteralValues(e){const t=[];return Jo(e,(e=>{vo(e)&&ra(e)&&t.push(e)})),t}_getIndexerKeyType(e){var t;if((Zs.isBuiltIn(e,"dict")||Zs.isBuiltIn(e,"Mapping"))&&2===(null===(t=e.typeArguments)||void 0===t?void 0:t.length))return e.typeArguments[0];const n=_a(e,"__getitem__");if(null==n?void 0:n.symbol.hasDeclarations()){const e=n.symbol.getDeclarations()[0];if(jn(e)&&e.isMethod){const t=this._evaluator.getTypeForDeclaration(e);if(t&&Eo(t)&&2===t.details.parameters.length)return t.details.parameters[1].type}}}_getIndexerKeys(e,t){var n,i,r,s,o,a,l,c,u;if(38!==e.baseExpression.nodeType)return[];const p=this._evaluator.getType(e.baseExpression);if(!p||!vo(p))return[];const d=this._getIndexerKeyType(p);if(d){const e=[];if(this._getSubTypesWithLiteralValues(d).forEach((t=>{(Zs.isBuiltIn(t,"str")||Zs.isBuiltIn(t,"int")||Zs.isBuiltIn(t,"bool")||Zs.isBuiltIn(t,"bytes")||Zs.isEnumClass(t))&&e.push(Rl(t,this._parseResults.tokenizerOutput.predominantSingleQuoteCharacter))})),e.length>0)return e}const h=null!==(n=this._evaluator.getDeclarationsForNameNode(e.baseExpression))&&void 0!==n?n:[],m=h.length>0?h[0]:void 0;if(!m||1!==m.type&&2!==m.type)return[];if(m.path!==this._filePath)return[];let f=e.baseExpression;if(m.node){const e=Ar(m.node);(null===(i=Gr(f))||void 0===i?void 0:i.filePath)===(null===(r=Gr(e))||void 0===r?void 0:r.filePath)&&(f=e)}const g=Ml.collectFromNode(e.baseExpression,this._evaluator,this._cancellationToken,f),y=new Set;for(const e of g){const n=54===(null===(s=e.node.parent)||void 0===s?void 0:s.nodeType)?e.node.parent:e.node;if(3===(null===(o=n.parent)||void 0===o?void 0:o.nodeType)||4===(null===(a=n.parent)||void 0===a?void 0:a.nodeType)){if(15===n.parent.rightExpression.nodeType){const e=n.parent.rightExpression;for(const t of e.entries.filter((e=>17===e.nodeType))){const e=this._parseResults.text.substr(t.keyExpression.start,t.keyExpression.length).trim();e.length>0&&y.add(e)}}if(9===n.parent.rightExpression.nodeType){const e=n.parent.rightExpression,t=this._evaluator.getType(e.leftExpression);if(!t||!_o(t)||!Zs.isBuiltIn(t,"dict"))continue;for(const t of e.arguments){const e=null!==(c=null===(l=t.name)||void 0===l?void 0:l.value.trim())&&void 0!==c?c:"",n=this._parseResults.tokenizerOutput.predominantSingleQuoteCharacter;e.length>0&&y.add(`${n}${e}${n}`)}}}if(24===(null===(u=n.parent)||void 0===u?void 0:u.nodeType)&&1===n.parent.items.length&&0!==n.parent.items[0].valueExpression.nodeType&&!dt.containsRange(n.parent,t)){const e=n.parent.items[0],t=this._parseResults.text.substr(e.valueExpression.start,e.valueExpression.length).trim();t.length>0&&y.add(t)}}return[...y]}_getLiteralCompletions(e,t,n,i){var r,s,o;let a=e.parent;if(!a)return;const l=new $l;if(yr(a)){const o=this._evaluator.getExpectedType(a);if(o&&sa(o.type))return this._addLiteralValuesForTargetType(o.type,n,t,i,l),{completionMap:l};if(49===e.nodeType&&(null===(r=e.parent)||void 0===r?void 0:r.parent)){const t=e.parent.parent;let r;if(17===t.nodeType&&t.keyExpression===e.parent&&15===(null===(s=t.parent)||void 0===s?void 0:s.nodeType)?r=t.parent:45===(null==t?void 0:t.nodeType)&&(r=t),r&&this._addTypedDictKeys(r,e,n,i,l))return{completionMap:l}}}if(1!==a.nodeType){if(48!==a.nodeType||a.strings.length>1)return;if(a=a.parent,!a)return}if(1===a.nodeType&&24===(null===(o=a.parent)||void 0===o?void 0:o.nodeType)){if(!this._tryAddTypedDictStringLiteral(a.parent,49===e.nodeType?n:"",i,l)){const r=this._getIndexerKeys(a.parent,e),s=this._getQuoteValueFromPriorText(n);for(const n of r){const r=/^["|'].*["|']$/.test(n);if(49!==e.nodeType||r)if(r){const e=n.substr(1,n.length-2);this._addStringLiteralToCompletions(e,s.stringValue,i,s.quoteCharacter,l,Wl)}else this._addNameToCompletions(n,ot.CompletionItemKind.Constant,t,l,{sortText:this._makeSortText(Bl.LiteralValue,n),itemDetail:Wl})}if(0===l.size)return}}else{w(49===e.nodeType);const r=xt(this._position,this._parseResults.tokenizerOutput.lines),s=a.start<r&&r<dt.getEnd(e);this._addCallArgumentCompletions(e,t,n,i,s,l)}return{completionMap:l}}_addTypedDictKeys(e,t,n,i,r){var s;const o=this._evaluator.getExpectedType(e);if(!o)return!1;if(vr(o.node)<vr(e))return!1;let a=[];if(Jo(o.type,(e=>{vo(e)&&Zs.isTypedDictClass(e)&&a.push(e)})),0===a.length)return!1;const l=this._getDictExpressionStringKeys(e,t?new Set([null===(s=t.parent)||void 0===s?void 0:s.id]):void 0);a=this._tryNarrowTypedDicts(a,l);const c=this._getQuoteValueFromPriorText(n),u=new Set(l);return a.forEach((e=>{gl(this._evaluator,e,!0).forEach(((e,t)=>{u.has(t)||r.has(t)||(u.add(t),this._addStringLiteralToCompletions(t,c?c.stringValue:void 0,i,c?c.quoteCharacter:this._parseResults.tokenizerOutput.predominantSingleQuoteCharacter,r))}))})),!0}_tryNarrowTypedDicts(e,t){const n=e.flatMap((e=>{const n=gl(this._evaluator,e,!0);for(let e=0;e<t.length;e++)if(!n.has(t[e]))return[];return[e]}));return 0===n.length?e:n}_getQuoteValueFromPriorText(e){if(this._insideStringLiteral){const t=e.lastIndexOf("'"),n=e.lastIndexOf('"');if(t>n)return{quoteCharacter:"'",stringValue:e.substr(t+1)};if(n>t)return{quoteCharacter:'"',stringValue:e.substr(n+1)}}return{stringValue:void 0,quoteCharacter:this._parseResults.tokenizerOutput.predominantSingleQuoteCharacter}}_tryAddTypedDictStringLiteral(e,t,n,i){if(!e)return!1;const r=this._evaluator.getType(e.baseExpression);if(!r||!vo(r))return!1;if(!Zs.isTypedDictClass(r))return!1;const s=gl(this._evaluator,r,!0),o=t?this._getQuoteValueFromPriorText(t):void 0;return s.forEach(((e,t)=>{this._addStringLiteralToCompletions(t,o?o.stringValue:void 0,n,o?o.quoteCharacter:this._parseResults.tokenizerOutput.predominantSingleQuoteCharacter,i)})),!0}_addStringLiteralToCompletions(e,t,n,i,r,s){if(N(t||"",e)){const o=`${i}${e}${i}`;if(r.has(o))return;const a=ot.CompletionItem.create(o);a.kind=ot.CompletionItemKind.Constant,a.sortText=this._makeSortText(Bl.LiteralValue,o);let l=this._position.character;void 0!==t&&(l-=t.length+1);let c=this._position.character;void 0!==n&&n.startsWith(i)&&c++;const u={start:{line:this._position.line,character:l},end:{line:this._position.line,character:c}};a.textEdit=ot.TextEdit.replace(u,o),a.detail=s,r.set(a)}}_addAutoImportCompletions(e,t,n,i){var r,s,o;if(!i.completionMap||!this._configOptions.autoImportCompletions||!this._options.autoImport)return;const a=this._autoImportMaps.getModuleSymbolsMap(),l=new Hl(this._execEnv,this._importResolver,this._parseResults,this._position,i.completionMap,a,{libraryMap:this._autoImportMaps.libraryMap,lazyEdit:n}),c=[],u=null===(r=this._autoImportMaps.nameMap)||void 0===r?void 0:r.get(e);u&&e.length>1&&!i.completionMap.has(e)&&c.push(...l.getAutoImportCandidatesForAbbr(e,u,this._cancellationToken)),c.push(...l.getAutoImportCandidates(e,t,void 0,this._cancellationToken));const p=l.getPerfInfo(),d=new Pn;for(const t of c)t.symbol?this._addSymbol(t.name,t.symbol,e,i.completionMap,{autoImportSource:t.source,autoImportAlias:t.alias,edits:{textEdit:this._createReplaceEdits(e,void 0,t.insertionText),additionalTextEdits:t.edits}}):this._addNameToCompletions(null!==(s=t.alias)&&void 0!==s?s:t.name,null!==(o=t.kind)&&void 0!==o?o:ot.CompletionItemKind.Module,e,i.completionMap,{autoImportText:this._getAutoImportText(t.name,t.source,t.alias),edits:{textEdit:this._createReplaceEdits(e,void 0,t.insertionText),additionalTextEdits:t.edits}});i.autoImportInfo={indexUsed:p.indexUsed,totalTimeInMS:p.totalInMs,moduleTimeInMS:p.moduleTimeInMS,indexTimeInMS:p.indexTimeInMS,importAliasTimeInMS:p.importAliasTimeInMS,itemCount:c.length,symbolCount:p.symbolCount,indexCount:p.indexCount,importAliasCount:p.importAliasCount,additionTimeInMS:d.getDurationInMilliseconds()}}_getImportFromCompletions(e,t){if(e.isWildcardImport)return;const n=Rt(e.module);if(!n)return;const i=new $l,r=n.resolvedPaths.length>0?n.resolvedPaths[n.resolvedPaths.length-1]:"",s=this._importLookup(r);return s&&this._addSymbolsForSymbolTable(s.symbolTable,((t,n)=>t.getDeclarations().some((e=>!(0===e.type)))&&!e.imports.find((e=>e.name.value===n))),t,!0,void 0,i),n.implicitImports.forEach((n=>{e.imports.find((e=>e.name.value===n.name))||this._addNameToCompletions(n.name,ot.CompletionItemKind.Module,t,i)})),{completionMap:i}}_findMatchingKeywords(e,t){return e.filter((e=>!t||N(t,e)))}_addNamedParameters(e,t,n){const i=new Map;e.signatures.forEach((e=>{this._addNamedParametersToMap(e.type,i)})),e.callNode.arguments.forEach((e=>{e.name&&i.delete(e.name.value)})),i.forEach((e=>{if(N(t,e)){const t=e+"=";if(n.has(t))return;const i=ot.CompletionItem.create(t);i.kind=ot.CompletionItemKind.Variable;const r={workspacePath:this._workspacePath,filePath:this._filePath,position:this._position};i.data=r,i.sortText=this._makeSortText(Bl.NamedParameter,e),n.set(i)}}))}_addNamedParametersToMap(e,t){e.details.parameters.forEach((e=>{e.name&&!e.isNameSynthesized&&(Yt(e.name)||t.set(e.name,e.name))}))}_addSymbols(e,t,n){let i=e;for(;i;){let e=zs(i);if(e){for(;e;)this._addSymbolsForSymbolTable(e.symbolTable,(()=>!0),t,!1,void 0,n),e=e.parent;if(10===i.nodeType){const e=this._evaluator.getTypeOfClass(i);e&&_o(e.classType)&&e.classType.details.mro.forEach(((e,i)=>{_o(e)&&this._addSymbolsForSymbolTable(e.details.fields,(e=>!!e.isClassMember()&&e.getDeclarations().some((e=>1===e.type))),t,!1,void 0,n)}))}break}i=i.parent}}_addSymbolsForSymbolTable(e,t,n,i,r,s){e.forEach(((e,o)=>{(!e.isExternallyHidden()||e.getDeclarations().some((e=>{return t=e,n=this._filePath,Gn(t)?(null===(i=Gr(t.node))||void 0===i?void 0:i.filePath)===n:t.path===n;var t,n,i})))&&t(e,o)&&(s.has(o)||this._addSymbol(o,e,n,s,{boundObjectOrClass:r,funcParensDisabled:i}))}))}_addSymbol(e,t,n,i,r){var s,o,a;if(t.isPrivatePyTypedImport())return;let l=Vo(t);if(!l){const e=t.getDeclarations();e.length>0&&(l=e[e.length-1])}if(l){let c=ot.CompletionItemKind.Variable;if(l=this._evaluator.resolveAliasDeclaration(l,!0),l&&(c=this._convertDeclarationTypeToItemKind(l),1===l.type&&r.boundObjectOrClass&&_o(r.boundObjectOrClass)&&Zs.isEnumClass(r.boundObjectOrClass)&&3===(null===(s=l.node.parent)||void 0===s?void 0:s.nodeType)&&(c=ot.CompletionItemKind.EnumMember),this._itemToResolve)){const n=this._itemToResolve.data;if(n.symbolLabel===e&&!n.autoImportText){const n=this._evaluator.getEffectiveTypeOfSymbol(t);if(n){let i,s,a;switch(l.type){case 0:case 1:case 2:{let t=!1;if(n&&Ks.isInstantiable(n)){const i=Do(n);i&&i.name===e&&(t=!0)}i=e+": "+this._evaluator.printType(n,t);break}case 3:{const t=r.boundObjectOrClass&&(Eo(n)||ko(n))?this._evaluator.bindFunctionToClassOrObject(r.boundObjectOrClass,n):n;if(t)if(ua(t)&&r.boundObjectOrClass&&vo(r.boundObjectOrClass)){const n=this._evaluator.getGetterTypeFromProperty(t,!0)||Ys.create();i=e+": "+this._evaluator.printType(n,!1)+" (property)",s=r.boundObjectOrClass.details.fullName+"."+e+" (property)"}else ko(t)?(i=Ol(t,this._evaluator,35),s=zl(t.overloads[0])):(i=e+": "+this._evaluator.printType(t,!1),Eo(t)&&(s=zl(t)));break}case 4:case 5:i="class "+e+"()";break;case 6:if(i=e,l.path){const e=this._importLookup(l.path);e&&(a=e.docString)}break;default:i=e}if(1===l.type&&l.typeAliasName&&l.docString)a=l.docString;else if(To(n))a=Il(n,l,this._sourceMapper);else if(_o(n))a=Sl(n,l,this._sourceMapper);else if(Eo(n)){const e=r.boundObjectOrClass?this._evaluator.bindFunctionToClassOrObject(r.boundObjectOrClass,n):n;e&&Eo(e)&&(a=Ll(e,this._sourceMapper,this._evaluator))}else if(ko(n)){const e=r.boundObjectOrClass?this._evaluator.bindFunctionToClassOrObject(r.boundObjectOrClass,n):n;e&&ko(e)&&(a=Ul(e,this._sourceMapper,this._evaluator).find((e=>e)))}else 3===(null==l?void 0:l.type)?a=bl(l,this._sourceMapper,this._evaluator):1===(null==l?void 0:l.type)&&(a=Cl(null!==(o=t.getDeclarations().find((e=>1===e.type&&!!e.docString)))&&void 0!==o?o:l,this._sourceMapper));if(!s&&!a)return;if(this._options.format===ot.MarkupKind.Markdown){let e="";s&&(e+="```python\n"+s+"\n```\n"),s&&a&&(e+="---\n"),a&&(e+=ds(a)),e=e.trimEnd(),this._itemToResolve.documentation={kind:ot.MarkupKind.Markdown,value:e}}else if(this._options.format===ot.MarkupKind.PlainText){let e="";s&&(e+=s+"\n"),s&&a&&(e+="\n"),a&&(e+=hs(a)),e=e.trimEnd(),this._itemToResolve.documentation={kind:ot.MarkupKind.PlainText,value:e}}else E(`Unsupported markup type: ${this._options.format}`)}}}const u=r.autoImportSource?this._getAutoImportText(e,r.autoImportSource,r.autoImportAlias):void 0;this._addNameToCompletions(null!==(a=r.autoImportAlias)&&void 0!==a?a:e,c,n,i,{autoImportText:u,funcParensDisabled:r.funcParensDisabled,edits:r.edits})}else if(t.getSynthesizedType()){const t=ot.CompletionItemKind.Variable;this._addNameToCompletions(e,t,n,i,{funcParensDisabled:r.funcParensDisabled,edits:r.edits})}}_getAutoImportText(e,t,n){const i=function(e,t,n){let i;return i=t?`from ${t} import ${e}`:`import ${e}`,n&&(i=`${i} as ${n}`),i}(e,t,n);return this._options.format===ot.MarkupKind.Markdown?`\`\`\`\n${i}\n\`\`\``:this._options.format===ot.MarkupKind.PlainText?i:void E(`Unsupported markup type: ${this._options.format}`)}_addNameToCompletions(e,t,n,i,r){var s,o,a;if(!(null==r?void 0:r.autoImportText)&&!N(n,e))return;if(i.has(e,$l.matchKindAndImportText,t,null==r?void 0:r.autoImportText))return;const l=ot.CompletionItem.create(e);l.kind=t;const c={workspacePath:this._workspacePath,filePath:this._filePath,position:this._position};if((null==r?void 0:r.funcParensDisabled)&&(c.funcParensDisabled=!0),l.data=c,(null==r?void 0:r.sortText)||(null==r?void 0:r.itemDetail)?(l.sortText=r.sortText,l.detail=r.itemDetail):(null==r?void 0:r.autoImportText)?(l.sortText=this._makeSortText(Bl.AutoImport,e,r.autoImportText),c.autoImportText=r.autoImportText,l.detail="Auto-import"):t===ot.CompletionItemKind.EnumMember?l.sortText=this._makeSortText(Bl.EnumMember,e):Qt(e)?l.sortText=this._makeSortText(Bl.DunderSymbol,e):""===n&&Yt(e)?l.sortText=this._makeSortText(Bl.PrivateSymbol,e):l.sortText=this._makeSortText(Bl.NormalSymbol,e),c.symbolLabel=e,this._options.format===ot.MarkupKind.Markdown){let e="";(null==r?void 0:r.autoImportText)&&(e+=r.autoImportText,(r.typeDetail||r.documentation)&&(e+="\n\n")),(null==r?void 0:r.typeDetail)&&(e+="```python\n"+r.typeDetail+"\n```\n"),(null==r?void 0:r.documentation)&&(e+="---\n",e+=ds(r.documentation)),e=e.trimEnd(),e&&(l.documentation={kind:ot.MarkupKind.Markdown,value:e})}else if(this._options.format===ot.MarkupKind.PlainText){let e="";(null==r?void 0:r.autoImportText)&&(e+=r.autoImportText,(r.typeDetail||r.documentation)&&(e+="\n\n")),(null==r?void 0:r.typeDetail)&&(e+=r.typeDetail+"\n"),(null==r?void 0:r.documentation)&&(e+="\n"+hs(r.documentation)),e=e.trimEnd(),e&&(l.documentation={kind:ot.MarkupKind.PlainText,value:e})}else E(`Unsupported markup type: ${this._options.format}`);(null===(s=null==r?void 0:r.edits)||void 0===s?void 0:s.format)&&(l.insertTextFormat=r.edits.format),(null===(o=null==r?void 0:r.edits)||void 0===o?void 0:o.textEdit)&&(l.textEdit=r.edits.textEdit),(null===(a=null==r?void 0:r.edits)||void 0===a?void 0:a.additionalTextEdits)&&(l.additionalTextEdits=r.edits.additionalTextEdits.map((e=>({range:{start:{line:e.range.start.line,character:e.range.start.character},end:{line:e.range.end.line,character:e.range.end.character}},newText:e.replacementText}))),this._itemToResolve)&&this._itemToResolve.data.autoImportText===c.autoImportText&&(this._itemToResolve.additionalTextEdits=l.additionalTextEdits),i.set(l)}_getRecentListIndex(e,t){return jl._mostRecentCompletions.findIndex((n=>n.label===e&&n.autoImportText===t))}_makeSortText(e,t,n=""){const i=this._getRecentListIndex(t,n);return i>=0&&(e===Bl.AutoImport?e=Bl.RecentAutoImport:e===Bl.ImportModuleName?e=Bl.RecentImportModuleName:e!==Bl.Keyword&&e!==Bl.NormalSymbol&&e!==Bl.PrivateSymbol&&e!==Bl.DunderSymbol||(e=Bl.RecentKeywordOrSymbol)),this._formatInteger(e,2)+"."+this._formatInteger(i,4)+"."+t}_formatInteger(e,t){const n="0".charCodeAt(0);let i="";for(let r=0;r<t;r++){let t=Math.floor(e%10);t<0&&(t=9),i=String.fromCharCode(t+n)+i,e=Math.floor(e/10)}return i}_convertDeclarationTypeToItemKind(e){const t=this._evaluator.resolveAliasDeclaration(e,!0);if(!t)return ot.CompletionItemKind.Variable;switch(t.type){case 0:return"class"===t.intrinsicType?ot.CompletionItemKind.Class:ot.CompletionItemKind.Variable;case 2:return ot.CompletionItemKind.Variable;case 1:return t.isConstant||t.isFinal?ot.CompletionItemKind.Constant:ot.CompletionItemKind.Variable;case 3:if(this._isPossiblePropertyDeclaration(t)){const e=this._evaluator.getTypeOfFunction(t.node);if(e&&ua(e.decoratedType))return ot.CompletionItemKind.Property}return t.isMethod?ot.CompletionItemKind.Method:ot.CompletionItemKind.Function;case 4:case 5:return ot.CompletionItemKind.Class;case 6:return ot.CompletionItemKind.Module}}_getImportModuleCompletions(e){const t={leadingDots:e.leadingDots,hasTrailingDot:e.hasTrailingDot||!1,nameParts:e.nameParts.map((e=>e.value)),importedSymbols:[]},n=this._importResolver.getCompletionSuggestions(this._filePath,this._execEnv,t),i=new $l;if(!e.hasTrailingDot&&e.parent&&22===e.parent.nodeType&&e.parent.missingImportKeyword){const e="import",t=ot.CompletionItem.create(e);t.kind=ot.CompletionItemKind.Keyword,t.sortText=this._makeSortText(Bl.Keyword,e),i.set(t)}return n.forEach((e=>{if(i.has(e))return;const t=ot.CompletionItem.create(e);t.kind=ot.CompletionItemKind.Module,t.sortText=this._makeSortText(Bl.ImportModuleName,e),i.set(t)})),{completionMap:i}}_isPossiblePropertyDeclaration(e){return e.isMethod&&e.node.decorators.length>0}}function zl(e){const t=e.details.parameters.filter(((e,t)=>!(e.hasDefault||0===t&&"self"===e.name)));return e.details.fullName+"("+t.map((e=>1===e.category?"*"+e.name:2===e.category?"**"+e.name:e.name)).join(", ")+")"}jl._mostRecentCompletions=[];class $l{constructor(){this._completions=new Map}get size(){return this._completions.size}set(e){const t=this._completions.get(e.label);t?Array.isArray(t)?t.push(e):this._completions.set(e.label,[t,e]):this._completions.set(e.label,e)}get(e){return this._completions.get(e)}has(e,t,n,i){const r=this._completions.get(e);return!!r&&(!t||t(r,n,i))}clear(){this._completions.clear()}delete(e){return this._completions.delete(e)}toArray(){var e;const t=[];return null===(e=this._completions)||void 0===e||e.forEach((e=>{Array.isArray(e)?e.forEach((e=>{t.push(e)})):t.push(e)})),t}static matchKindAndImportText(e,t,n){var i;return!!e&&(Array.isArray(e)?!!e.find((e=>e.kind===t&&e.data.autoImport===n)):e.kind===t&&(null===(i=e.data)||void 0===i?void 0:i.autoImport)===n)}static labelOnlyIgnoringAutoImports(e,t,n){var i;if(!e)return!1;if(Array.isArray(e)){if(e.find((e=>{var t;return!(null===(t=e.data)||void 0===t?void 0:t.autoImport)})))return!0}else if(!(null===(i=e.data)||void 0===i?void 0:i.autoImport))return!0;return!1}}class Hl{constructor(e,t,n,i,r,s,o){this._execEnvironment=e,this._importResolver=t,this._parseResults=n,this._invocationPosition=i,this._excludes=r,this._moduleSymbolMap=s,this._options=o,this._stopWatch=new Pn,this._perfInfo={indexUsed:!1,totalInMs:0,moduleTimeInMS:0,indexTimeInMS:0,importAliasTimeInMS:0,symbolCount:0,indexCount:0,importAliasCount:0},this._importStatements=tn(this._parseResults.parseTree,!0),this._perfInfo.indexUsed=!!this._options.libraryMap}getAutoImportCandidatesForAbbr(e,t,n){const i=this._getCandidates(t.importName,1,e,n).get(t.importName);return i?i.filter((e=>e.source===t.importFrom)):[]}getAutoImportCandidates(e,t,n,i){const r=[];return this._getCandidates(e,t,n,i).forEach((e=>r.push(...e))),r}getPerfInfo(){return this._perfInfo.totalInMs=this._stopWatch.getDurationInMilliseconds(),this._perfInfo}_getCandidates(e,t,n,i){const r=new Map,s=new Map;return this._addImportsFromModuleMap(e,t,n,s,r,i),this._addImportsFromLibraryMap(e,t,n,s,r,i),this._addImportsFromImportAliasMap(s,n,r,i),r}_addImportsFromLibraryMap(e,t,n,i,r,s){var o;const a=this._stopWatch.getDurationInMilliseconds();null===(o=this._options.libraryMap)||void 0===o||o.forEach(((o,a)=>{if(o.privateOrProtected)return;if(this._moduleSymbolMap.has(a))return;const l=this._isStubFileOrHasInit(this._options.libraryMap,a);this._processModuleSymbolTable(Gl(o,!0),a,e,t,l,n,i,r,s)})),this._perfInfo.indexTimeInMS=this._stopWatch.getDurationInMilliseconds()-a}_addImportsFromModuleMap(e,t,n,i,r,s){const o=this._stopWatch.getDurationInMilliseconds();this._moduleSymbolMap.forEach(((o,a)=>{const l=this._isStubFileOrHasInit(this._moduleSymbolMap,a);this._processModuleSymbolTable(o,a,e,t,l,n,i,r,s)})),this._perfInfo.moduleTimeInMS=this._stopWatch.getDurationInMilliseconds()-o}_isStubFileOrHasInit(e,t){const n=te($(t),"__init__.py"),i=n+"i";return{isStub:t.endsWith(".pyi"),hasInit:e.has(n)||e.has(i)}}_processModuleSymbolTable(e,t,n,i,r,s,o,a,l){ct(l);const[c,u,p]=this._getImportPartsForSymbols(t);if(!c)return;const d=B(c,".");if(e.forEach(((e,l,h)=>{var m;if(this._perfIndexCount(e,h),!this._shouldIncludeVariable(e,l,r.isStub,h))return;if(!this._isSimilar(n,l,i))return;if(this._containsName(l,c,a))return;if(e.importAlias)return void this._addToImportAliasMap(e.importAlias,{importParts:{symbolName:l,importName:l,importFrom:c,filePath:t,dotCount:d,moduleNameAndType:p},importGroup:u,symbol:e.symbol,kind:e.importAlias.kind,itemKind:e.importAlias.itemKind},o);const f=this._getTextEditsForAutoImportByFilePath(c,l,s,l,u,t);this._addResult(a,{name:l,alias:s,symbol:e.symbol,source:c,kind:null!==(m=e.itemKind)&&void 0!==m?m:Kl(e.kind),insertionText:f.insertionText,edits:f.edits})})),!r.isStub&&!r.hasInit)return;const h=this._getImportParts(t);h&&this._isSimilar(n,h.importName,i)&&(this._containsName(h.importName,h.importFrom,a)||this._addToImportAliasMap({modulePath:t,originalName:h.importName,kind:ot.SymbolKind.Module,itemKind:ot.CompletionItemKind.Module},{importParts:h,importGroup:u,kind:ot.SymbolKind.Module,itemKind:ot.CompletionItemKind.Module},o))}_shouldIncludeVariable(e,t,n,i){var r;return!(!n&&e.kind===ot.SymbolKind.Variable)||!(!this._options.allowVariableInAll||i||!(null===(r=e.symbol)||void 0===r?void 0:r.isInDunderAll()))||function(e){return!Yt(e)&&(Zt(e)||Xt(e))}(t)}_addImportsFromImportAliasMap(e,t,n,i){ct(i);const r=this._stopWatch.getDurationInMilliseconds();e.forEach((e=>{this._perfInfo.importAliasCount+=e.size,e.forEach((e=>{var i,r;if(t){if(this._importStatements.mapByFilePath.has(e.importParts.filePath))return;if(e.importParts.importFrom){const t=this._importStatements.orderedImports.find((t=>t.moduleName===e.importParts.importFrom));if(t&&22===t.node.nodeType&&t.node.imports.some((t=>t.name.value===e.importParts.symbolName)))return}}if(this._containsName(e.importParts.importName,e.importParts.importFrom,n))return;const s=this._getTextEditsForAutoImportByFilePath(null!==(i=e.importParts.importFrom)&&void 0!==i?i:e.importParts.importName,e.importParts.symbolName,t,e.importParts.importName,e.importGroup,e.importParts.filePath);this._addResult(n,{name:e.importParts.importName,alias:t,symbol:e.symbol,kind:null!==(r=e.itemKind)&&void 0!==r?r:Kl(e.kind),source:e.importParts.importFrom,insertionText:s.insertionText,edits:s.edits})}))})),this._perfInfo.importAliasTimeInMS=this._stopWatch.getDurationInMilliseconds()-r}_addToImportAliasMap(e,t,n){if(!n.has(e.modulePath)){const i=new Map;return i.set(e.originalName,t),void n.set(e.modulePath,i)}const i=n.get(e.modulePath);if(!i.has(e.originalName))return void i.set(e.originalName,t);const r=i.get(e.originalName);this._compareImportAliasData(r,t)<=0||i.set(e.originalName,t)}_compareImportAliasData(e,t){const n=e.importGroup-t.importGroup;if(0!==n)return n;const i=e.importParts.dotCount-t.importParts.dotCount;return 0!==i?i:e.symbol&&!t.symbol?-1:!e.symbol&&t.symbol?1:U()(e.importParts.importName,t.importParts.importName)}_getImportPartsForSymbols(e){const t=this._importStatements.mapByFilePath.get(e);if(t)return[t.moduleName,en(t),{importType:2,isLocalTypingsFile:!1,moduleName:t.moduleName}];{const t=this._getModuleNameAndTypeFromFilePath(e);return[t.moduleName,cn(t),t]}}_getImportParts(e){return function(t){const n=t.moduleName;if(!n)return;const i=n.lastIndexOf("."),r=i>0?n.substring(i+1):void 0,s=i>0?n.substring(0,i):void 0;return{symbolName:r,importName:null!=r?r:n,importFrom:s,filePath:e,dotCount:B(n,"."),moduleNameAndType:t}}("__init__"===he(de(e))?this._getModuleNameAndTypeFromFilePath($(e)):this._getModuleNameAndTypeFromFilePath(e))}_isSimilar(e,t,n){if(1===n)return e===t;if(e.length<=0||t.length<=0)return!1;if(!this._options.patternMatcher){const n="_"!==e[0]&&"_"===t[0]&&t.length>1?1:0;return e[0].toLocaleLowerCase()===t[n].toLocaleLowerCase()&&N(e,t)}return this._options.patternMatcher(e,t)}_shouldExclude(e){return this._excludes.has(e,$l.labelOnlyIgnoringAutoImports)}_containsName(e,t,n){if(this._shouldExclude(e))return!0;const i=n.get(e);return!!(null==i?void 0:i.some((e=>e.source===t)))}_getModuleNameAndTypeFromFilePath(e){return this._importResolver.getModuleNameForImport(e,this._execEnvironment)}_getTextEditsForAutoImportByFilePath(e,t,n,i,r,s){var o,a,l,c,u,p;const d=this._importStatements.mapByFilePath.get(s);if(d){if(20===d.node.nodeType){const e=null===(a=null===(o=d.subnode)||void 0===o?void 0:o.alias)||void 0===a?void 0:a.value;if(t)return{insertionText:`${null!=e?e:d.moduleName}.${t}`,edits:[]};if(e)return{insertionText:`${e}`,edits:[]}}if(t&&22===d.node.nodeType&&!d.node.isWildcardImport){const r=d.node.imports.find((e=>e.name.value===t));if(r){const e=null===(l=r.alias)||void 0===l?void 0:l.value;return{insertionText:`${null!=e?e:t}`,edits:[]}}if(e===d.moduleName)return{insertionText:null!=n?n:i,edits:this._options.lazyEdit?void 0:rn({name:t,alias:n},d,this._parseResults)}}}else if(t){const r=this._importStatements.orderedImports.find((t=>t.moduleName===e));if(r&&22===r.node.nodeType&&!r.node.isWildcardImport){const e=r.node.imports.find((e=>e.name.value===t));if(!e)return{insertionText:null!=n?n:i,edits:this._options.lazyEdit?void 0:rn({name:t,alias:n},r,this._parseResults)};{const t=null===(c=e.alias)||void 0===c?void 0:c.value;if(t)return{insertionText:`${t}`,edits:[]}}}const o=null===(u=this._importStatements.implicitImports)||void 0===u?void 0:u.get(s);if(o){const e=null===(p=o.alias)||void 0===p?void 0:p.value;return{insertionText:`${null!=e?e:o.name.value}.${t}`,edits:[]}}}return{insertionText:null!=n?n:i,edits:this._options.lazyEdit?void 0:an({name:t,alias:n},this._importStatements,e,r,this._parseResults,this._invocationPosition)}}_perfIndexCount(e,t){e.symbol?this._perfInfo.symbolCount++:t&&this._perfInfo.indexCount++}_addResult(e,t){let n=e.get(t.name);n||(n=[],e.set(t.name,n)),n.push(t)}}function Gl(e,t){return{forEach(n){e.symbols.forEach((e=>{e.externallyVisible&&n({importAlias:e.alias,kind:e.kind,itemKind:e.itemKind},e.name,t)}))}}}function Kl(e){switch(e){case ot.SymbolKind.File:return ot.CompletionItemKind.File;case ot.SymbolKind.Module:case ot.SymbolKind.Namespace:return ot.CompletionItemKind.Module;case ot.SymbolKind.Package:return ot.CompletionItemKind.Folder;case ot.SymbolKind.Class:return ot.CompletionItemKind.Class;case ot.SymbolKind.Method:return ot.CompletionItemKind.Method;case ot.SymbolKind.Property:return ot.CompletionItemKind.Property;case ot.SymbolKind.Field:return ot.CompletionItemKind.Field;case ot.SymbolKind.Constructor:return ot.CompletionItemKind.Constructor;case ot.SymbolKind.Enum:return ot.CompletionItemKind.Enum;case ot.SymbolKind.Interface:return ot.CompletionItemKind.Interface;case ot.SymbolKind.Function:return ot.CompletionItemKind.Function;case ot.SymbolKind.Variable:case ot.SymbolKind.Array:return ot.CompletionItemKind.Variable;case ot.SymbolKind.String:return ot.CompletionItemKind.Constant;case ot.SymbolKind.Number:case ot.SymbolKind.Boolean:return ot.CompletionItemKind.Value;case ot.SymbolKind.Constant:case ot.SymbolKind.Null:return ot.CompletionItemKind.Constant;case ot.SymbolKind.Object:case ot.SymbolKind.Key:return ot.CompletionItemKind.Value;case ot.SymbolKind.EnumMember:return ot.CompletionItemKind.EnumMember;case ot.SymbolKind.Struct:return ot.CompletionItemKind.Struct;case ot.SymbolKind.Event:return ot.CompletionItemKind.Event;case ot.SymbolKind.Operator:return ot.CompletionItemKind.Operator;case ot.SymbolKind.TypeParameter:return ot.CompletionItemKind.TypeParameter;default:return}}class Jl{static getCallForDeclaration(e,t,n,i){if(ct(i),3===t.type||4===t.type)return{name:e,kind:Zl(t,n),uri:t.path,range:t.range,selectionRange:t.range}}static getIncomingCallsForDeclaration(e,t,n,i,r,s){ct(s);const o=new Ql(e,t,n,i,r,s).findCalls();return o.length>0?o:void 0}static getOutgoingCallsForDeclaration(e,t,n,i){let r;if(ct(i),3===e.type)r=e.node;else if(4===e.type){const t=n.getTypeForDeclaration(e);if(t&&_o(t)){const e=va(t,"__init__",14);if(e){const t=n.getTypeOfMember(e);if(t&&Eo(t)){const t=e.symbol.getDeclarations();if(t&&t.length>0){const e=t[0];3===e.type&&(r=e.node)}}}}}if(!r)return;const s=new Yl(r,t,n,i).findCalls();return s.length>0?s:void 0}static getTargetDeclaration(e,t){let n=e[0];for(const i of e)if((ns(i)||!ns(n))&&(3===i.type||4===i.type)&&(n=i,i.node===t))break;return n}}class Yl extends _r{constructor(e,t,n,i){super(),this._parseRoot=e,this._parseResults=t,this._evaluator=n,this._cancellationToken=i,this._outgoingCalls=[]}findCalls(){return this.walk(this._parseRoot),this._outgoingCalls}visitCall(e){let t;if(ct(this._cancellationToken),38===e.leftExpression.nodeType?t=e.leftExpression:35===e.leftExpression.nodeType&&(t=e.leftExpression.memberName),t){const e=this._evaluator.getDeclarationsForNameNode(t);e&&e.forEach((e=>{this._addOutgoingCallForDeclaration(t,e)}))}return!0}visitMemberAccess(e){ct(this._cancellationToken);const t=this._evaluator.getType(e.leftExpression);return t&&Jo(t,(t=>{let n=t;if(n=this._evaluator.makeTopLevelTypeVarsConcrete(n),!vo(n))return;const i=_a(n,e.memberName.value);if(!i)return;const r=this._evaluator.getTypeOfMember(i),s=i.symbol.getDeclarations();r&&vo(r)&&Zs.isPropertyClass(r)&&s.forEach((t=>{this._addOutgoingCallForDeclaration(e.memberName,t)}))})),!0}_addOutgoingCallForDeclaration(e,t){const n=this._evaluator.resolveAliasDeclaration(t,!0);if(!n)return;if(3!==n.type&&4!==n.type)return;const i={name:e.value,kind:Zl(n,this._evaluator),uri:n.path,range:n.range,selectionRange:n.range};let r=this._outgoingCalls.find((e=>e.to.uri===i.uri&&Tt(e.to.range,i.range)));r||(r={to:i,fromRanges:[]},this._outgoingCalls.push(r));const s=St(e.start,e.start+e.length,this._parseResults.tokenizerOutput.lines);r.fromRanges.push(s)}}class Ql extends _r{constructor(e,t,n,i,r,s){super(),this._filePath=e,this._symbolName=t,this._declaration=n,this._parseResults=i,this._evaluator=r,this._cancellationToken=s,this._incomingCalls=[]}findCalls(){return this.walk(this._parseResults.parseTree),this._incomingCalls}visitCall(e){let t;if(ct(this._cancellationToken),38===e.leftExpression.nodeType?t=e.leftExpression:35===e.leftExpression.nodeType&&(t=e.leftExpression.memberName),t&&t.value===this._symbolName){const e=this._evaluator.getDeclarationsForNameNode(t);e&&e.map((e=>this._evaluator.resolveAliasDeclaration(e,!0))).filter((e=>void 0!==e)).some((e=>is(e,this._declaration)))&&this._addIncomingCallForDeclaration(t)}return!0}visitMemberAccess(e){if(ct(this._cancellationToken),e.memberName.value===this._symbolName){const t=this._evaluator.getType(e.leftExpression);t&&Jo(t,(t=>{let n=t;if(n=this._evaluator.makeTopLevelTypeVarsConcrete(n),!vo(n))return;const i=_a(n,e.memberName.value);if(!i)return;const r=this._evaluator.getTypeOfMember(i),s=i.symbol.getDeclarations();r&&s.some((e=>is(e,this._declaration)))&&this._addIncomingCallForDeclaration(e.memberName)}))}return!0}_addIncomingCallForDeclaration(e){const t=Rr(e);if(!t)return;let n;if(36===t.nodeType){const e=St(0,0,this._parseResults.tokenizerOutput.lines),t=de(this._filePath);n={name:`(module) ${t}`,kind:ot.SymbolKind.Module,uri:this._filePath,range:e,selectionRange:e}}else if(30===t.nodeType){const e=St(t.start,t.start+t.length,this._parseResults.tokenizerOutput.lines);n={name:"(lambda)",kind:ot.SymbolKind.Function,uri:this._filePath,range:e,selectionRange:e}}else{const e=St(t.name.start,t.name.start+t.name.length,this._parseResults.tokenizerOutput.lines);n={name:t.name.value,kind:ot.SymbolKind.Function,uri:this._filePath,range:e,selectionRange:e}}let i=this._incomingCalls.find((e=>e.from.uri===n.uri&&Tt(e.from.range,n.range)));i||(i={from:n,fromRanges:[]},this._incomingCalls.push(i));const r=St(e.start,e.start+e.length,this._parseResults.tokenizerOutput.lines);i.fromRanges.push(r)}}function Zl(e,t){let n;switch(e.type){case 4:case 5:n=ot.SymbolKind.Class;break;case 3:if(e.isMethod){const i=t.getTypeForDeclaration(e);n=i&&ua(i)?ot.SymbolKind.Property:ot.SymbolKind.Method}else n=ot.SymbolKind.Function;break;default:n=ot.SymbolKind.Function}return n}class Xl{constructor(e,t,n,i,r){this.requiresGlobalSearch=e,this.nodeAtOffset=t,this.symbolName=n,this.declarations=i,this._reporter=r,this._locations=[]}get locations(){return this._locations}addLocations(...e){0!==e.length&&(this._reporter&&this._reporter(e),this._locations.push(...e))}}class ec{constructor(e,t,n,i,r,s){this._parseResults=e,this._filePath=t,this._referencesResult=n,this._includeDeclaration=i,this._evaluator=r,this._cancellationToken=s}findReferences(e=this._parseResults.parseTree){const t=new Ml(this._referencesResult.symbolName,this._referencesResult.declarations,this._evaluator,this._cancellationToken,e,!0),n=[];for(const e of t.collect())(this._includeDeclaration||e.node!==this._referencesResult.nodeAtOffset)&&n.push({path:this._filePath,range:{start:It(e.range.start,this._parseResults.tokenizerOutput.lines),end:It(dt.getEnd(e.range),this._parseResults.tokenizerOutput.lines)}});return n}}class tc{static getDeclarationForNode(e,t,n,i,r,s){ct(s);const o=Ml.getDeclarationsForNode(n,i,!1,s,e);if(0===o.length)return;const a=o.some((e=>{var n,i;if(e.path!==t)return!0;const r=Ar(e.node);return 36===r.nodeType||10===r.nodeType||35===(null===(i=null===(n=e.node)||void 0===n?void 0:n.parent)||void 0===i?void 0:i.nodeType)&&e.node===e.node.parent.memberName}));return new Xl(a,n,n.value,o,r)}static getDeclarationForPosition(e,t,n,i,r,s,o){ct(o);const a=xt(i,t.tokenizerOutput.lines);if(void 0===a)return;const l=Tr(t.parseTree,a);return void 0!==l&&38===l.nodeType?this.getDeclarationForNode(e,n,l,r,s,o):void 0}static addReferences(e,t,n,i,r,s){const o=new ec(e,t,n,i,r,s);n.addLocations(...o.findReferences())}}var nc,ic,rc,sc,oc,ac,lc,cc,uc,pc,dc,hc,mc,fc;!function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Symbol=2]="Symbol"}(nc||(nc={}));class gc{constructor(e,t,n,i,r,s,o,a,l){if(this._fs=e,this._evaluator=t,this._moduleFilePath=n,this._moduleNameAndType=r,this._newModuleNameAndType=s,this._type=o,this._declarations=a,this._token=l,this._results=new Map,this._aliasIntroduced=new Set,this._newModuleFilePath=ee(i),this._moduleNames=this._moduleName.split("."),this._newModuleNames=this._newModuleName.split("."),this._moduleNames.length!==this._newModuleNames.length)return void(this._onlyNameChanged=!1);let c=0;for(c=0;c<this._moduleNames.length-1&&this._moduleNames[c]===this._newModuleNames[c];c++);this._onlyNameChanged=c===this._moduleNames.length-1,w(this._type!==nc.Folder||this._onlyNameChanged,"We only support simple rename for folder")}static createForModule(e,t,n,i,r,s){if(e.fileSystem.existsSync(i)){if(ge(e.fileSystem,i))return this._create(e,t,n,i,r,nc.File,s);if(fe(e.fileSystem,i)){if("Renamed"!==function(e,t,n){if(e.realCasePath(t)===e.realCasePath(n))return"Same";const i=se(t,n,(t=>e.realCasePath(t)));return 3===i.length&&".."===i[1]&&".."!==i[2]?"Renamed":"Moved"}(e.fileSystem,i,r))return;let o=te(i,"__init__.pyi");if(!e.fileSystem.existsSync(o)&&(o=te(i,"__init__.py"),!e.fileSystem.existsSync(o)))return;return this._create(e,t,n,o,te(r,de(o)),nc.Folder,s)}}}static createForSymbol(e,t,n,i,r,s,o){if(!e.fileSystem.existsSync(i))return;const a=s.filter((e=>zn(e)||jn(e)||Hn(e)));return 0!==a.length?this._create(e,t,n,i,r,nc.Symbol,a,o):void 0}static _create(e,t,n,i,r,s,o,a){const l=t.findExecEnvironment(i),c=e.getModuleNameForImport(i,l);if(!c.moduleName)return;const u=e.getModuleNameForImport(r,l);if(!u.moduleName)return;a=ot.CancellationToken.is(o)?o:a;const p=ot.CancellationToken.is(o)?[]:o;return 0===p.length&&(p.push(cs(i)),el(i)&&(e.resolveImport(i,l,vn(c.moduleName)),e.getSourceFilesFromStub(i,l,!1).forEach((e=>p.push(cs(e)))))),new gc(e.fileSystem,n,i,r,c,u,s,p,a)}renameReferences(e,t){switch(this._type){case nc.Folder:return this._renameFolderReferences(e,t);case nc.File:return this._renameModuleReferences(e,t);case nc.Symbol:return this._updateSymbolReferences(e,t);default:return k(this._type,`${this._type} is unknown`)}}_updateSymbolReferences(e,t){var n,i,r,s;const o=new Ml(null!==(n=as(this._declarations[0]))&&void 0!==n?n:"",this._declarations,this._evaluator,this._token,t.parseTree,!0),a=tn(t.parseTree,!0),l=a.orderedImports.find((e=>e.moduleName===this._newModuleName)),c=new Set,u=new Map;for(const n of o.collect()){const o=n.node;if(49===o.nodeType)continue;if(Qr(o)){const n=null===(i=o.parent)||void 0===i?void 0:i.parent,s=this._getNewModuleName(e,n.module.leadingDots>0,!1);if(1===n.imports.length)this._addResultWithTextRange(e,n.module,t,s);else{const i=o.parent;this._addFromImportNameDeletion(e,t,c,n.imports,i);const l={name:i.name.value,alias:null===(r=i.alias)||void 0===r?void 0:r.value};this._addResultEdits(this._getTextEditsForNewOrExistingFromImport(e,n,t,c,a,s,[l]))}continue}const l=ts(o);if(l===o||35!==l.nodeType)continue;const p=35===l.leftExpression.nodeType?l.leftExpression.memberName:38===l.leftExpression.nodeType?l.leftExpression:void 0;if(!p)continue;const d=null===(s=this._evaluator.getDeclarationsForNameNode(p))||void 0===s?void 0:s.filter((e=>Gn(e)&&(21===e.node.nodeType||23===e.node.nodeType)));d&&0!==d.length&&h(u,d[0].node,(()=>[])).push(l)}for(const[n,i]of u){let r;if(this._canReplaceImportName(t,n,i)){const i=this._getReferenceModuleName(a,l);if(21===n.nodeType)i?(r=i,this._addImportNameDeletion(e,t,c,n.parent.list,n)):(r=n.alias?n.alias.value:this._newModuleName,this._addResultWithTextRange(e,n.module,t,this._newModuleName));else if(i)r=i,this._addFromImportNameDeletion(e,t,c,n.parent.imports,n);else{const i=n.parent,s=this._getNewModuleName(e,i.module.leadingDots>0,!0);r=n.alias?n.alias.value:this._newLastModuleName,this._addResultWithTextRange(e,i.module,t,s),this._addResultWithTextRange(e,n.name,t,this._newLastModuleName)}}else{const n=this._getReferenceModuleName(a,l);n?r=n:(r=this._newModuleName,this._addResultEdits(an([],a,this._newModuleName,cn(this._newModuleNameAndType),t,It(t.parseTree.length,t.tokenizerOutput.lines)).map((t=>({filePath:e,range:t.range,replacementText:t.replacementText})))))}for(const n of i)this._addResultWithTextRange(e,n.leftExpression,t,r)}}_getReferenceModuleName(e,t){var n,i;if(t&&20===t.node.nodeType)return(null===(n=t.subnode)||void 0===n?void 0:n.alias)?t.subnode.alias.value:this._newModuleName;if(null===(i=e.implicitImports)||void 0===i?void 0:i.has(this._newModuleFilePath)){const t=e.implicitImports.get(this._newModuleFilePath);return t.alias?t.alias.value:t.name.value}}_canReplaceImportName(e,t,n){var i;const r=null!==(i=t.alias)&&void 0!==i?i:21===t.nodeType?t.module.nameParts[t.module.nameParts.length-1]:t.name,s=Ml.getDeclarationsForNode(r,this._evaluator,!1,this._token);if(0===s.length)return!1;const o=new Ml(r.value,s,this._evaluator,this._token,e.parseTree,!0);for(const e of o.collect())if(!(Kr(e.node)||Jr(e.node)||Yr(e.node)||Qr(e.node)||Zr(e.node)||n.some((t=>dt.containsRange(t,e.node)))))return!1;return!0}_renameFolderReferences(e,t){const n=new Ml(this.lastModuleName,this._declarations,this._evaluator,this._token,t.parseTree,!0);for(const i of n.collect())this._addResultWithTextRange(e,i.range,t,this._newLastModuleName)}_renameModuleReferences(e,t){const n=new Ml(this.lastModuleName,this._declarations,this._evaluator,this._token,t.parseTree,!0),i=new Set,r=n.collect();this._updateModuleReferences(e,t,i,r),this._updateRelativeModuleNamePath(e,t,i,r)}_updateRelativeModuleNamePath(e,t,n,i){if(e!==this._moduleFilePath)return;let r;for(const s of this._getNewRelativeModuleNamesForFileMoved(e,yc.collect(t.parseTree).filter((e=>!i.some((t=>dt.containsRange(e.parent,t.node))))))){if(this._addResultWithTextRange(e,s.moduleName,t,s.newModuleName),!s.itemsToMove)continue;const i=s.moduleName.parent;for(const r of s.itemsToMove)this._addFromImportNameDeletion(e,t,n,i.imports,r);r=null!=r?r:tn(t.parseTree,!1),this._addResultEdits(this._getTextEditsForNewOrExistingFromImport(e,i,t,n,r,un(this._fs,this._newModuleFilePath,this._newModuleFilePath,!1,!0),s.itemsToMove.map((e=>{var t;return{name:e.name.value,alias:null===(t=e.alias)||void 0===t?void 0:t.value}}))))}}_updateModuleReferences(e,t,n,i){var r,s,o,a,l;let c;for(const u of i){const p=u.node;if(49===p.nodeType){this._addResultWithTextRange(e,u.range,t,this._newLastModuleName);continue}if(Kr(p)){if(!Xr(p))continue;const n=es(p,37);if(1===n.nameParts.length&&21===(null===(r=n.parent)||void 0===r?void 0:r.nodeType)&&!n.parent.alias&&this._newModuleNames.length>1){this._aliasIntroduced.add(n.parent),this._addResultWithTextRange(e,n,t,`${this._newModuleName} as ${this._newLastModuleName}`);continue}this._addResultWithTextRange(e,n,t,this._newModuleName);continue}if(Jr(p)){this._addResultWithTextRange(e,u.range,t,this._newLastModuleName);continue}if(Yr(p)){if(!Xr(p))continue;const r=es(p,37),s=r.parent,o=[],a=[];for(const e of s.imports)this._isExportedSymbol(e.name)?o.push(e):a.push(e);if(0===a.length){this._addResultWithTextRange(e,r,t,this._getNewModuleName(e,r.leadingDots>0,!1));continue}if(0===o.length)continue;if(s.module.leadingDots>0)for(const n of this._getNewRelativeModuleNamesForFileMoved(e,[s.module]))this._addResultWithTextRange(e,n.moduleName,t,n.newModuleName);for(const i of o)this._addFromImportNameDeletion(e,t,n,s.imports,i);c=null!=c?c:tn(t.parseTree,!1),this._addResultEdits(this._getTextEditsForNewOrExistingFromImport(e,s,t,n,c,this._newModuleName,o.map((e=>{var t;return{name:i.findIndex((t=>t.node===e.name))>=0?this._newLastModuleName:e.name.value,alias:i.findIndex((t=>t.node===e.alias))>=0?this._newLastModuleName:null===(t=e.alias)||void 0===t?void 0:t.value}}))));continue}if(Qr(p)){if(n.has(p.id))continue;const i=null===(s=p.parent)||void 0===s?void 0:s.parent,r=this._getNewModuleName(e,i.module.leadingDots>0,!0);if(this._isExportedSymbol(p)){this._addResultWithTextRange(e,u.range,t,this._newLastModuleName);continue}if(1===i.imports.length)this._addResultWithTextRange(e,i.module,t,r),this._addResultWithTextRange(e,u.range,t,this._newLastModuleName);else{const s=p.parent;if(i.module.leadingDots>0)for(const n of this._getNewRelativeModuleNamesForFileMoved(e,[i.module]))this._addResultWithTextRange(e,n.moduleName,t,n.newModuleName);this._addFromImportNameDeletion(e,t,n,i.imports,s),c=null!=c?c:tn(t.parseTree,!1);const l={name:this._newLastModuleName,alias:(null===(o=s.alias)||void 0===o?void 0:o.value)===this.lastModuleName?this._newLastModuleName:null===(a=s.alias)||void 0===a?void 0:a.value};this._addResultEdits(this._getTextEditsForNewOrExistingFromImport(e,i,t,n,c,r,[l]))}continue}if(Zr(p)){if(n.has(p.id))continue;this._addResultWithTextRange(e,u.range,t,this._newLastModuleName);continue}const d=Ml.getDeclarationsForNode(p,this._evaluator,!1,this._token).filter((e=>Gn(e)));if(this._onlyNameChanged)this._addResultWithTextRange(e,u.range,t,this._newLastModuleName);else if(null==d?void 0:d.some((e=>!(e.usesLocalName||e.node&&21!==e.node.nodeType||this._aliasIntroduced.has(e.node))))){const n=ts(p);if(35!==(null===(l=n.parent)||void 0===l?void 0:l.nodeType)){this._addResultWithTextRange(e,n,t,this._newModuleName);continue}const i=this._evaluator.getDeclarationsForNameNode(n.parent.memberName);if(!i||0===i.length)continue;this._addResultWithTextRange(e,n,t,this._newModuleName)}else u.node.value===this._newLastModuleName||this._addResultWithTextRange(e,u.range,t,this._newLastModuleName)}}_getNewRelativeModuleNamesForFileMoved(e,t){if(e!==this._moduleFilePath)return[];const n="__init__"===he(de(e)),i=$(e),r=[];for(const e of t){if(0===e.leadingDots)continue;const t=this._getNewModuleNameInfoForFileMoved(e,n,i);if(!t)continue;const s=un(this._fs,t.src,t.dest,!1,!0);r.push({moduleName:e,newModuleName:s,itemsToMove:t.itemsToMove})}return r}_getNewModuleNameInfoForFileMoved(e,t,n){const i=Rt(e);if(!i)return;let r=i.resolvedPaths[i.resolvedPaths.length-1];if(!r){if(0!==e.nameParts.length)return;{const t=pn(n,e.leadingDots);if(!t)return;r=te(t,"__init__.py")}}if(this._moduleFilePath!==r||!t)return{src:this._newModuleFilePath,dest:r};const s=[],o=[];for(const t of e.parent.imports)this._isExportedSymbol(t.name)?s.push(t):o.push(t);return 0===o.length?{src:this._newModuleFilePath,dest:this._newModuleFilePath}:0===s.length?{src:this._newModuleFilePath,dest:this._moduleFilePath}:{src:this._newModuleFilePath,dest:this._moduleFilePath,itemsToMove:[...s]}}_isExportedSymbol(e){const t=this._evaluator.getDeclarationsForNameNode(e);return!!t&&!t.some((e=>Gn(e)&&e.submoduleFallback))}_getNewModuleName(e,t,n){const i=e===this._moduleFilePath?this._newModuleFilePath:e,r=t?un(this._fs,i,this._newModuleFilePath,n,!0):this._newModuleName;if(n&&r.endsWith(this._newLastModuleName)){const e=r===this._newLastModuleName?0:r.length>this._newLastModuleName.length+1&&"."!==r[r.length-this._newLastModuleName.length-2]?1:0,t=r.length-this._newLastModuleName.length-e,n=r.substr(0,t);return n.length>0?n:"."}return r}getEdits(){const e=[];return this._results.forEach((t=>e.push(...t))),e}get lastModuleName(){return this._moduleNames[this._moduleNames.length-1]}get _moduleName(){return this._moduleNameAndType.moduleName}get _newLastModuleName(){return this._newModuleNames[this._newModuleNames.length-1]}get _newModuleName(){return this._newModuleNameAndType.moduleName}_addImportNameDeletion(e,t,n,i,r){this._addImportNameDeletionInternal(e,t,n,i,r,20),n.add(r.module.id),r.module.nameParts.forEach((e=>n.add(e.id))),r.alias&&n.add(r.alias.id)}_addFromImportNameDeletion(e,t,n,i,r){this._addImportNameDeletionInternal(e,t,n,i,r,22),n.add(r.name.id),r.alias&&n.add(r.alias.id)}_addImportNameDeletionInternal(e,t,n,i,r,s){const o=function(e,t){let n;if(1===e.length&&0===t)n=e[0];else if(t===e.length-1){const i=dt.getEnd(e[t-1]);n={start:i,length:dt.getEnd(e[t])-i}}else{const i=e[t].start;n={start:i,length:e[t+1].start-i}}return n}(i,i.findIndex((e=>e===r)));this._addResultWithTextRange(e,o,t,""),n.add(r.id);let a=0;for(a=i.length-1;a>=0&&n.has(i[a].id);a--);if(-1===a){const n=es(r,s);n&&this._addResultWithRange(e,function(e,t){const n=wt(e,t.lines),i=function(e,t,n){const i=n.tokens.getItemAtPosition(t);if(i<0)return;let r=i;for(;r<n.tokens.count;r++){const t=wt(n.tokens.getItemAt(r),n.lines);if(e.end.line!==t.start.line)break}for(let e=i;e<r;e++){const t=n.tokens.getItemAt(e);if(11!==t.type&&2!==t.type)return wt(t,n.lines).start}}(n,dt.getEnd(e),t);return i?{start:n.start,end:i}:n.end.line===t.lines.count-1?n:{start:n.start,end:{line:n.end.line+1,character:0}}}(n,t.tokenizerOutput),"")}else if(a>=0&&a<i.length-2){const n=dt.getEnd(i[a]),r=dt.getEnd(i[a+1])-n;this._addResultWithTextRange(e,{start:n,length:r},t,"")}}_addResultWithTextRange(e,t,n,i){n.text.substr(t.start,t.length)!==i&&this._addResultWithRange(e,wt(t,n.tokenizerOutput.lines),i)}_addResultEdits(e){e.forEach((e=>this._addResultWithRange(e.filePath,e.range,e.replacementText)))}_getDeletionsForSpan(e,t){var n;return r(e)&&(e=null!==(n=this._results.get(e))&&void 0!==n?n:[]),e.filter((e=>""===e.replacementText&&yt(e.range,t)))}_removeEdits(e,t){var n;r(e)&&(e=null!==(n=this._results.get(e))&&void 0!==n?n:[]),m(e,(e=>t.findIndex((t=>t===e))>=0))}_addResultWithRange(e,t,n){const i=h(this._results,e,(()=>[]));if(""===n){const e=this._getDeletionsForSpan(i,t);e.length>0&&(this._removeEdits(i,e),bt(t,e.map((e=>e.range))))}i.some((e=>Tt(e.range,t)&&e.replacementText===n))||i.push({filePath:e,range:t,replacementText:n})}_getTextEditsForNewOrExistingFromImport(e,t,n,i,r,s,o){const a=r.orderedImports.find((e=>e.moduleName===s));if(a&&22===a.node.nodeType&&!a.node.isWildcardImport){const r=rn(o,a,n);if(a.node!==t)return r.map((t=>({filePath:e,range:t.range,replacementText:t.replacementText})));if(this._onlyNameChanged&&1===o.length&&1===r.length){const s=this._getDeletionsForSpan(e,r[0].range);if(0===s.length)return[{filePath:e,range:r[0].range,replacementText:r[0].replacementText}];{const r=o[0].alias===this._newLastModuleName?this.lastModuleName:o[0].alias,a=t.imports.find((e=>{var t;return e.name.value===this.lastModuleName&&(null===(t=e.alias)||void 0===t?void 0:t.value)===r}));if(a)return this._removeEdits(e,s),a.alias&&i.delete(a.alias.id),[{filePath:e,range:wt(a.name,n.tokenizerOutput.lines),replacementText:this._newLastModuleName}]}}}return an(o,r,s,cn(this._newModuleNameAndType),n,It(n.parseTree.length,n.tokenizerOutput.lines)).map((t=>({filePath:e,range:t.range,replacementText:t.replacementText})))}}class yc extends _r{constructor(){super(...arguments),this._result=[]}walk(e){yr(e)||super.walk(e)}visitModuleName(e){return this._result.push(e),!1}static collect(e){const t=new yc;return t.walk(e),t._result}}class _c{constructor(){this._paths=[]}appendPath(e){this._paths.push(e)}getPaths(){return this._paths}normalizeOrder(){let e=0;this._paths.forEach(((t,n)=>{t<this._paths[e]&&(e=n)})),0!==e&&(this._paths=this._paths.slice(e).concat(this._paths.slice(0,e)))}isEqual(e){if(e._paths.length!==this._paths.length)return!1;for(let t=0;t<this._paths.length;t++)if(this._paths[t]!==e._paths[t])return!1;return!0}}class vc{constructor(e,t,n,i){this._uri=e,this._languageId=t,this._version=n,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){const t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content}update(e,t){for(let t of e)if(vc.isIncremental(t)){const e=Ic(t.range),n=this.offsetAt(e.start),i=this.offsetAt(e.end);this._content=this._content.substring(0,n)+t.text+this._content.substring(i,this._content.length);const r=Math.max(e.start.line,0),s=Math.max(e.end.line,0);let o=this._lineOffsets;const a=bc(t.text,!1,n);if(s-r===a.length)for(let e=0,t=a.length;e<t;e++)o[e+r+1]=a[e];else a.length<1e4?o.splice(r+1,s-r,...a):this._lineOffsets=o=o.slice(0,r+1).concat(a,o.slice(s+1));const l=t.text.length-(i-n);if(0!==l)for(let e=r+1+a.length,t=o.length;e<t;e++)o[e]=o[e]+l}else{if(!vc.isFull(t))throw new Error("Unknown change event received");this._content=t.text,this._lineOffsets=void 0}this._version=t}getLineOffsets(){return void 0===this._lineOffsets&&(this._lineOffsets=bc(this._content,!0)),this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let t=this.getLineOffsets(),n=0,i=t.length;if(0===i)return{line:0,character:e};for(;n<i;){let r=Math.floor((n+i)/2);t[r]>e?i=r:n=r+1}let r=n-1;return{line:r,character:e-t[r]}}offsetAt(e){let t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;let n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)}get lineCount(){return this.getLineOffsets().length}static isIncremental(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)}static isFull(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength}}function Tc(e,t){if(e.length<=1)return e;const n=e.length/2|0,i=e.slice(0,n),r=e.slice(n);Tc(i,t),Tc(r,t);let s=0,o=0,a=0;for(;s<i.length&&o<r.length;){let n=t(i[s],r[o]);e[a++]=n<=0?i[s++]:r[o++]}for(;s<i.length;)e[a++]=i[s++];for(;o<r.length;)e[a++]=r[o++];return e}function bc(e,t,n=0){const i=t?[n]:[];for(let t=0;t<e.length;t++){let r=e.charCodeAt(t);13!==r&&10!==r||(13===r&&t+1<e.length&&10===e.charCodeAt(t+1)&&t++,i.push(n+t+1))}return i}function Ic(e){const t=e.start,n=e.end;return t.line>n.line||t.line===n.line&&t.character>n.character?{start:n,end:t}:e}function Sc(e){const t=Ic(e.range);return t!==e.range?{newText:e.newText,range:t}:e}!function(e){e.create=function(e,t,n,i){return new vc(e,t,n,i)},e.update=function(e,t,n){if(e instanceof vc)return e.update(t,n),e;throw new Error("TextDocument.update: document must be created by TextDocument.create")},e.applyEdits=function(e,t){let n=e.getText(),i=Tc(t.map(Sc),((e,t)=>{let n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),r=0;const s=[];for(const t of i){let i=e.offsetAt(t.range.start);if(i<r)throw new Error("Overlapping edit");i>r&&s.push(n.substring(r,i)),t.newText.length&&s.push(t.newText),r=e.offsetAt(t.range.end)}return s.push(n.substr(r)),s.join("")}}(ic||(ic={})),function(e){e.Darwin="Darwin",e.Windows="Windows",e.Linux="Linux"}(rc||(rc={}));class xc{constructor(e,t,n,i){this.extraPaths=[],this.root=e||void 0,this.pythonVersion=t||Ae,this.pythonPlatform=n,this.extraPaths=[...null!=i?i:[]]}}function Cc(e=!1){const t=[$o.strictListInference,$o.strictSetInference,$o.strictDictionaryInference,$o.strictParameterNoneValue];return e&&t.push($o.enableTypeIgnoreComments),t}function wc(){return[$o.reportGeneralTypeIssues,$o.reportPropertyTypeMismatch,$o.reportFunctionMemberAccess,$o.reportMissingImports,$o.reportMissingModuleSource,$o.reportMissingTypeStubs,$o.reportImportCycles,$o.reportUnusedImport,$o.reportUnusedClass,$o.reportUnusedFunction,$o.reportUnusedVariable,$o.reportDuplicateImport,$o.reportWildcardImportFromLibrary,$o.reportOptionalSubscript,$o.reportOptionalMemberAccess,$o.reportOptionalCall,$o.reportOptionalIterable,$o.reportOptionalContextManager,$o.reportOptionalOperand,$o.reportTypedDictNotRequiredAccess,$o.reportUntypedFunctionDecorator,$o.reportUntypedClassDecorator,$o.reportUntypedBaseClass,$o.reportUntypedNamedTuple,$o.reportPrivateUsage,$o.reportPrivateImportUsage,$o.reportConstantRedefinition,$o.reportIncompatibleMethodOverride,$o.reportIncompatibleVariableOverride,$o.reportInconsistentConstructor,$o.reportOverlappingOverload,$o.reportMissingSuperCall,$o.reportUninitializedInstanceVariable,$o.reportInvalidStringEscapeSequence,$o.reportUnknownParameterType,$o.reportUnknownArgumentType,$o.reportUnknownLambdaType,$o.reportUnknownVariableType,$o.reportUnknownMemberType,$o.reportMissingParameterType,$o.reportMissingTypeArgument,$o.reportInvalidTypeVarUse,$o.reportCallInDefaultInitializer,$o.reportUnnecessaryIsInstance,$o.reportUnnecessaryCast,$o.reportUnnecessaryComparison,$o.reportAssertAlwaysTrue,$o.reportSelfClsParameterName,$o.reportImplicitStringConcatenation,$o.reportUndefinedVariable,$o.reportUnboundVariable,$o.reportInvalidStubStatement,$o.reportIncompleteStub,$o.reportUnsupportedDunderAll,$o.reportUnusedCallResult,$o.reportUnusedCoroutine,$o.reportUnnecessaryTypeIgnoreComment,$o.reportMatchNotExhaustive]}class Ec{constructor(e,t){this.include=[],this.exclude=[],this.ignore=[],this.strict=[],this.autoImportCompletions=!0,this.indexing=!1,this.logTypeEvaluationTime=!1,this.typeEvaluationTimeThreshold=50,this.initializedFromJson=!1,this.analyzeUnannotatedFunctions=!0,this.executionEnvironments=[],this.projectRoot=e,this.typeCheckingMode=t,this.diagnosticRuleSet=Ec.getDiagnosticRuleSet(t)}static getDiagnosticRuleSet(e){return"strict"===e?{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!1,omitConditionalConstraint:!1,pep604Printing:!0,strictListInference:!0,strictSetInference:!0,strictDictionaryInference:!0,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"none",reportFunctionMemberAccess:"error",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"error",reportImportCycles:"error",reportUnusedImport:"error",reportUnusedClass:"error",reportUnusedFunction:"error",reportUnusedVariable:"error",reportDuplicateImport:"error",reportWildcardImportFromLibrary:"error",reportOptionalSubscript:"error",reportOptionalMemberAccess:"error",reportOptionalCall:"error",reportOptionalIterable:"error",reportOptionalContextManager:"error",reportOptionalOperand:"error",reportTypedDictNotRequiredAccess:"error",reportUntypedFunctionDecorator:"error",reportUntypedClassDecorator:"error",reportUntypedBaseClass:"error",reportUntypedNamedTuple:"error",reportPrivateUsage:"error",reportPrivateImportUsage:"error",reportConstantRedefinition:"error",reportIncompatibleMethodOverride:"error",reportIncompatibleVariableOverride:"error",reportInconsistentConstructor:"error",reportOverlappingOverload:"error",reportMissingSuperCall:"none",reportUninitializedInstanceVariable:"none",reportInvalidStringEscapeSequence:"error",reportUnknownParameterType:"error",reportUnknownArgumentType:"error",reportUnknownLambdaType:"error",reportUnknownVariableType:"error",reportUnknownMemberType:"error",reportMissingParameterType:"error",reportMissingTypeArgument:"error",reportInvalidTypeVarUse:"error",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"error",reportUnnecessaryCast:"error",reportUnnecessaryComparison:"error",reportAssertAlwaysTrue:"error",reportSelfClsParameterName:"error",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"error",reportIncompleteStub:"error",reportUnsupportedDunderAll:"error",reportUnusedCallResult:"none",reportUnusedCoroutine:"error",reportUnnecessaryTypeIgnoreComment:"none",reportMatchNotExhaustive:"error"}:"off"===e?{printUnknownAsAny:!0,omitTypeArgsIfAny:!0,omitUnannotatedParamType:!0,omitConditionalConstraint:!0,pep604Printing:!0,strictListInference:!1,strictSetInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"none",reportPropertyTypeMismatch:"none",reportFunctionMemberAccess:"none",reportMissingImports:"warning",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"none",reportOptionalSubscript:"none",reportOptionalMemberAccess:"none",reportOptionalCall:"none",reportOptionalIterable:"none",reportOptionalContextManager:"none",reportOptionalOperand:"none",reportTypedDictNotRequiredAccess:"none",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportPrivateImportUsage:"none",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportInconsistentConstructor:"none",reportOverlappingOverload:"none",reportMissingSuperCall:"none",reportUninitializedInstanceVariable:"none",reportInvalidStringEscapeSequence:"none",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingParameterType:"none",reportMissingTypeArgument:"none",reportInvalidTypeVarUse:"none",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportUnnecessaryComparison:"none",reportAssertAlwaysTrue:"none",reportSelfClsParameterName:"none",reportImplicitStringConcatenation:"none",reportUnboundVariable:"none",reportUndefinedVariable:"warning",reportInvalidStubStatement:"none",reportIncompleteStub:"none",reportUnsupportedDunderAll:"none",reportUnusedCallResult:"none",reportUnusedCoroutine:"none",reportUnnecessaryTypeIgnoreComment:"none",reportMatchNotExhaustive:"none"}:{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!0,omitConditionalConstraint:!1,pep604Printing:!0,strictListInference:!1,strictSetInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"none",reportFunctionMemberAccess:"none",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"warning",reportOptionalSubscript:"error",reportOptionalMemberAccess:"error",reportOptionalCall:"error",reportOptionalIterable:"error",reportOptionalContextManager:"error",reportOptionalOperand:"error",reportTypedDictNotRequiredAccess:"error",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportPrivateImportUsage:"error",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportInconsistentConstructor:"none",reportOverlappingOverload:"none",reportMissingSuperCall:"none",reportUninitializedInstanceVariable:"none",reportInvalidStringEscapeSequence:"warning",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingParameterType:"none",reportMissingTypeArgument:"none",reportInvalidTypeVarUse:"warning",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportUnnecessaryComparison:"none",reportAssertAlwaysTrue:"warning",reportSelfClsParameterName:"warning",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"none",reportIncompleteStub:"none",reportUnsupportedDunderAll:"warning",reportUnusedCallResult:"none",reportUnusedCoroutine:"error",reportUnnecessaryTypeIgnoreComment:"none",reportMatchNotExhaustive:"none"}}getDefaultExecEnvironment(){return new xc(this.projectRoot,this.defaultPythonVersion,this.defaultPythonPlatform,this.defaultExtraPaths)}findExecEnvironment(e){var t;return null!==(t=this.executionEnvironments.find((t=>{const n=le(me(te(this.projectRoot,t.root)));return e.startsWith(n)})))&&void 0!==t?t:this.getDefaultExecEnvironment()}getExecutionEnvironments(){return this.executionEnvironments.length>0?this.executionEnvironments:[this.getDefaultExecEnvironment()]}initializeFromJson(e,t,n,i,r,s=!1){let o;this.initializedFromJson=!0,s||(this.include=[],void 0===e.include)||(Array.isArray(e.include)?e.include.forEach(((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "include" array should be a string.`):(0,S.isAbsolute)(e)?n.error(`Ignoring path "${e}" in "include" array because it is not relative.`):this.include.push(be(this.projectRoot,e))})):n.error('Config "include" entry must must contain an array.')),this.exclude=[],void 0!==e.exclude&&(Array.isArray(e.exclude)?e.exclude.forEach(((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "exclude" array should be a string.`):(0,S.isAbsolute)(e)?n.error(`Ignoring path "${e}" in "exclude" array because it is not relative.`):this.exclude.push(be(this.projectRoot,e))})):n.error('Config "exclude" entry must contain an array.')),this.ignore=[],void 0!==e.ignore&&(Array.isArray(e.ignore)?e.ignore.forEach(((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "ignore" array should be a string.`):(0,S.isAbsolute)(e)?n.error(`Ignoring path "${e}" in "ignore" array because it is not relative.`):this.ignore.push(be(this.projectRoot,e))})):n.error('Config "ignore" entry must contain an array.')),this.strict=[],void 0!==e.strict&&(Array.isArray(e.strict)?e.strict.forEach(((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "strict" array should be a string.`):(0,S.isAbsolute)(e)?n.error(`Ignoring path "${e}" in "strict" array because it is not relative.`):this.strict.push(be(this.projectRoot,e))})):n.error('Config "strict" entry must contain an array.')),void 0!==e.typeCheckingMode&&("off"===e.typeCheckingMode||"basic"===e.typeCheckingMode||"strict"===e.typeCheckingMode?o=e.typeCheckingMode:n.error('Config "typeCheckingMode" entry must contain "off", "basic", or "strict".')),void 0!==e.useLibraryCodeForTypes&&("boolean"==typeof e.useLibraryCodeForTypes?this.useLibraryCodeForTypes=e.useLibraryCodeForTypes:n.error('Config "useLibraryCodeForTypes" entry must be true or false.')),this.typeCheckingMode=o||t;const a=Ec.getDiagnosticRuleSet(this.typeCheckingMode);if(this.diagnosticRuleSet={...a},this.applyDiagnosticOverrides(r),Cc(!0).forEach((t=>{this.diagnosticRuleSet[t]=this._convertBoolean(e[t],t,this.diagnosticRuleSet[t])})),wc().forEach((t=>{this.diagnosticRuleSet[t]=this._convertDiagnosticLevel(e[t],t,this.diagnosticRuleSet[t])})),this.venvPath=void 0,void 0!==e.venvPath&&("string"!=typeof e.venvPath?n.error('Config "venvPath" field must contain a string.'):this.venvPath=me(te(this.projectRoot,e.venvPath))),this.venv=void 0,void 0!==e.venv&&("string"!=typeof e.venv?n.error('Config "venv" field must contain a string.'):this.venv=e.venv),void 0!==e.extraPaths&&(this.defaultExtraPaths=[],Array.isArray(e.extraPaths)?e.extraPaths.forEach(((e,t)=>{"string"!=typeof e?n.error(`Config "extraPaths" field ${t} must be a string.`):this.defaultExtraPaths.push(me(te(this.projectRoot,e)))})):n.error('Config "extraPaths" field must contain an array.')),void 0!==e.pythonVersion)if("string"==typeof e.pythonVersion){const t=Re(e.pythonVersion);t?this.defaultPythonVersion=t:n.error('Config "pythonVersion" field contains unsupported version.')}else n.error('Config "pythonVersion" field must contain a string.');this.ensureDefaultPythonVersion(i,n),void 0!==e.pythonPlatform&&("string"!=typeof e.pythonPlatform?n.error('Config "pythonPlatform" field must contain a string.'):this.defaultPythonPlatform=e.pythonPlatform),this.ensureDefaultPythonPlatform(i,n),this.typeshedPath=void 0,void 0!==e.typeshedPath&&("string"!=typeof e.typeshedPath?n.error('Config "typeshedPath" field must contain a string.'):this.typeshedPath=e.typeshedPath?me(te(this.projectRoot,e.typeshedPath)):""),this.stubPath=void 0,void 0!==e.typingsPath&&("string"!=typeof e.typingsPath?n.error('Config "typingsPath" field must contain a string.'):(n.error('Config "typingsPath" is now deprecated. Please, use stubPath instead.'),this.stubPath=me(te(this.projectRoot,e.typingsPath)))),void 0!==e.stubPath&&("string"!=typeof e.stubPath?n.error('Config "stubPath" field must contain a string.'):this.stubPath=me(te(this.projectRoot,e.stubPath))),void 0!==e.verboseOutput&&("boolean"!=typeof e.verboseOutput?n.error('Config "verboseOutput" field must be true or false.'):this.verboseOutput=e.verboseOutput),void 0!==e.useLibraryCodeForTypes&&("boolean"!=typeof e.useLibraryCodeForTypes?n.error('Config "useLibraryCodeForTypes" field must be true or false.'):this.useLibraryCodeForTypes=e.useLibraryCodeForTypes),this.executionEnvironments=[],void 0!==e.executionEnvironments&&(Array.isArray(e.executionEnvironments)?e.executionEnvironments.forEach(((e,t)=>{const i=this._initExecutionEnvironmentFromJson(e,t,n);i&&this.executionEnvironments.push(i)})):n.error('Config "executionEnvironments" field must contain an array.')),void 0!==e.autoImportCompletions&&("boolean"!=typeof e.autoImportCompletions?n.error('Config "autoImportCompletions" field must be true or false.'):this.autoImportCompletions=e.autoImportCompletions),void 0!==e.indexing&&("boolean"!=typeof e.indexing?n.error('Config "indexing" field must be true or false.'):this.indexing=e.indexing),void 0!==e.logTypeEvaluationTime&&("boolean"!=typeof e.logTypeEvaluationTime?n.error('Config "logTypeEvaluationTime" field must be true or false.'):this.logTypeEvaluationTime=e.logTypeEvaluationTime),void 0!==e.typeEvaluationTimeThreshold&&("number"!=typeof e.typeEvaluationTimeThreshold?n.error('Config "typeEvaluationTimeThreshold" field must be a number.'):this.typeEvaluationTimeThreshold=e.typeEvaluationTimeThreshold)}ensureDefaultPythonPlatform(e,t){void 0===this.defaultPythonPlatform&&(this.defaultPythonPlatform=e.getPythonPlatform(),void 0!==this.defaultPythonPlatform&&t.info(`Assuming Python platform ${this.defaultPythonPlatform}`))}ensureDefaultPythonVersion(e,t){if(void 0!==this.defaultPythonVersion)return;const n=[];this.defaultPythonVersion=e.getPythonVersion(this.pythonPath,n),void 0!==this.defaultPythonVersion&&t.info(`Assuming Python version ${Pe(this.defaultPythonVersion)}`);for(const e of n)t.info(e)}ensureDefaultExtraPaths(e,t,n){const i=[];if(t){const t=ee(this.projectRoot,"src");e.existsSync(t)&&!e.existsSync(ee(t,"__init__.py"))&&i.push(t)}if(n&&n.length>0)for(const t of n){const n=ee(this.projectRoot,t);i.push(n),fe(e,n)&&i.push(...yn(e,n))}i.length>0&&(this.defaultExtraPaths=i)}applyDiagnosticOverrides(e){if(e)for(const t of wc()){const n=e[t];void 0!==n&&(this.diagnosticRuleSet[t]=n)}}_convertBoolean(e,t,n){return void 0===e?n:"boolean"==typeof e?!!e:(console.log(`Config "${t}" entry must be true or false.`),n)}_convertDiagnosticLevel(e,t,n){return void 0===e?n:"boolean"==typeof e?e?"error":"none":"string"!=typeof e||"error"!==e&&"warning"!==e&&"information"!==e&&"none"!==e?(console.log(`Config "${t}" entry must be true, false, "error", "warning", "information" or "none".`),n):e}_initExecutionEnvironmentFromJson(e,t,n){try{const i=new xc(this.projectRoot,this.defaultPythonVersion,this.defaultPythonPlatform,this.defaultExtraPaths);if(e.root&&"string"==typeof e.root?i.root=me(te(this.projectRoot,e.root)):n.error(`Config executionEnvironments index ${t}: missing root value.`),e.extraPaths&&(Array.isArray(e.extraPaths)?e.extraPaths.forEach(((e,r)=>{"string"!=typeof e?n.error(`Config executionEnvironments index ${t}: extraPaths field ${r} must be a string.`):i.extraPaths.push(me(te(this.projectRoot,e)))})):n.error(`Config executionEnvironments index ${t}: extraPaths field must contain an array.`)),e.pythonVersion)if("string"==typeof e.pythonVersion){const r=Re(e.pythonVersion);r?i.pythonVersion=r:n.warn(`Config executionEnvironments index ${t} contains unsupported pythonVersion.`)}else n.error(`Config executionEnvironments index ${t} pythonVersion must be a string.`);return e.pythonPlatform&&("string"==typeof e.pythonPlatform?i.pythonPlatform=e.pythonPlatform:n.error(`Config executionEnvironments index ${t} pythonPlatform must be a string.`)),i}catch{n.error(`Config executionEnvironments index ${t} is not accessible.`)}}}class kc{constructor(e){this._diagnosticList=e||[],this._diagnosticMap=new Map}fetchAndClear(){const e=this._diagnosticList;return this._diagnosticList=[],this._diagnosticMap.clear(),e}addError(e,t){return this.addDiagnostic(new nl(0,e,t))}addWarning(e,t){return this.addDiagnostic(new nl(1,e,t))}addInformation(e,t){return this.addDiagnostic(new nl(2,e,t))}addUnusedCode(e,t,n){const i=new nl(3,e,t);return n&&i.addAction(n),this.addDiagnostic(i)}addDeprecated(e,t,n){const i=new nl(4,e,t);return n&&i.addAction(n),this.addDiagnostic(i)}addDiagnostic(e){const t=`${e.range.start.line},${e.range.start.character}-${e.range.end.line}-${e.range.end.character}:${M(e.message)}}`;return this._diagnosticMap.has(t)||(this._diagnosticList.push(e),this._diagnosticMap.set(t,e)),e}addDiagnostics(e){this._diagnosticList.push(...e)}getErrors(){return this._diagnosticList.filter((e=>0===e.category))}getWarnings(){return this._diagnosticList.filter((e=>1===e.category))}getInformation(){return this._diagnosticList.filter((e=>2===e.category))}getUnusedCode(){return this._diagnosticList.filter((e=>3===e.category))}getDeprecated(){return this._diagnosticList.filter((e=>4===e.category))}}class Dc extends kc{constructor(e,t){super(t),this._lines=e}addDiagnosticWithTextRange(e,t,n){const i=St(n.start,n.start+n.length,this._lines);switch(e){case"error":return this.addError(t,i);case"warning":return this.addWarning(t,i);case"information":return this.addInformation(t,i);default:throw new Error(`${e} is not expected value`)}}addUnusedCodeWithTextRange(e,t,n){return this.addUnusedCode(e,St(t.start,t.start+t.length,this._lines),n)}addDeprecatedWithTextRange(e,t,n){return this.addDeprecated(e,St(t.start,t.start+t.length,this._lines),n)}}class Ac{constructor(e){this._items=e}get start(){return this._items.length>0?this._items[0].start:0}get end(){const e=this._items[this._items.length-1];return this._items.length>0?e.start+e.length:0}get length(){return this.end-this.start}get count(){return this._items.length}contains(e){return e>=this.start&&e<this.end}getItemAt(e){if(e<0||e>=this._items.length)throw new Error("index is out of range");return this._items[e]}getItemAtPosition(e){if(0===this.count)return-1;if(e<this.start)return-1;if(e>this.end)return-1;let t=0,n=this.count-1;for(;t<n;){const i=Math.floor(t+(n-t)/2),r=this._items[i];if(e>=r.start&&(i>=this.count-1||e<this._items[i+1].start))return i;e<r.start?n=i-1:t=i+1}return t}getItemContaining(e){if(0===this.count)return-1;if(e<this.start)return-1;if(e>this.end)return-1;let t=0,n=this.count-1;for(;t<=n;){const i=Math.floor(t+(n-t)/2),r=this._items[i];if(dt.contains(r,e))return i;if(i<this.count-1&&dt.getEnd(r)<=e&&e<this._items[i+1].start)return-1;e<r.start?n=i-1:t=i+1}return-1}}!function(e){e.All="all",e.PreferSource="preferSource",e.PreferStubs="preferStubs"}(sc||(sc={}));class Pc{static getDefinitionsForPosition(e,t,n,i,r,s){ct(s);const o=xt(n,t.tokenizerOutput.lines);if(void 0===o)return;const a=Tr(t.parseTree,o);if(void 0===a)return;const l=[];if(38===a.nodeType){const t=r.getDeclarationsForNameNode(a);Pc._resolveDeclarations(t,r,l,e)}if(0===l.length)return;if(i===sc.All)return l;const c=i===sc.PreferStubs,u=e=>c===el(e.path);return l.find(u)?l.filter(u):l}static getTypeDefinitionsForPosition(e,t,n,i,r,s){var o;ct(s);const a=xt(n,t.tokenizerOutput.lines);if(void 0===a)return;const l=Tr(t.parseTree,a);if(void 0===l)return;const c=[];if(38===l.nodeType){const t=i.getType(l);if(t){let n=[];Jo(t,(t=>{7===(null==t?void 0:t.category)&&n.push(...e.findClassDeclarationsByType(r,t))})),0===n.length&&(n=null!==(o=i.getDeclarationsForNameNode(l))&&void 0!==o?o:[]),Pc._resolveDeclarations(n,i,c,e)}}return 0!==c.length?c:void 0}static _resolveDeclarations(e,t,n,i){e&&e.forEach((e=>{let r=t.resolveAliasDeclaration(e,!0,!0);if(r&&r.path){if(6===r.type&&r.isUnresolved)return;if(6===r.type&&r.symbolName&&r.submoduleFallback&&r.submoduleFallback.path&&(r=r.submoduleFallback),this._addIfUnique(n,{path:r.path,range:r.range}),jn(r)){const e=t.getTypeForDeclaration(r);if(e&&ko(e))for(const t of e.overloads.map((e=>e.details.declaration)).filter(a))this._addIfUnique(n,{path:t.path,range:t.range})}if(el(r.path))if(6===r.type)i.findModules(r.path).map((e=>{var t;return null===(t=Vt(e))||void 0===t?void 0:t.filePath})).filter(a).forEach((e=>this._addIfUnique(n,this._createModuleEntry(e))));else{const e=i.findDeclarations(r);for(const t of e)t&&t.path&&this._addIfUnique(n,{path:t.path,range:t.range})}}}))}static _createModuleEntry(e){return{path:e,range:{start:{line:0,character:0},end:{line:0,character:0}}}}static _addIfUnique(e,t){for(const n of e)if(n.path===t.path&&Tt(n.range,t.range))return;e.push(t)}}function Rc(e,t,n,i){let r=t;const s=[];let o,a,l=!1,c=!1;for(;;){if(6!==r.type||!r.symbolName)return{declaration:r,isPrivate:l,privatePyTypedImported:o,privatePyTypedImporter:a};if(!n&&r.usesLocalName)return{declaration:r,isPrivate:l,privatePyTypedImported:o,privatePyTypedImporter:a};let u;r.path&&r.loadSymbolsFromPath&&(u=e(r.path));const p=u?u.symbolTable.get(r.symbolName):void 0;if(!p)return r.submoduleFallback?Rc(e,r.submoduleFallback,n,i):r.isNativeLib?{declaration:void 0,isPrivate:l}:void 0;if(p.isPrivateMember()&&(l=!0),p.isExternallyHidden()&&!i)return;let d=p.getTypedDeclarations();if(0===d.length&&(d=p.getDeclarations(),0===d.length))return;const h=d.filter((e=>!s.includes(e)));if(r=h.length>0?h[h.length-1]:d[d.length-1],c&&(o=null!=o?o:null==r?void 0:r.moduleName),p.isPrivatePyTypedImport()&&(c=!0),c&&(a=null!=a?a:null==r?void 0:r.moduleName),s.find((e=>e===r)))return r.path===t.path&&6===r.type&&r.submoduleFallback?Rc(e,r.submoduleFallback,n,i):{declaration:t,isPrivate:l,privatePyTypedImported:o,privatePyTypedImporter:a};s.push(r)}}class Fc{static getSymbolsForDocument(e,t,n,i,r,s){var o;const a=[];return t||n?(Mc(null!==(o=null==t?void 0:t.symbols)&&void 0!==o?o:Fc.indexSymbols(e,n,{indexingForAutoImportMode:!1},s),i,r,"",a,s),a):a}static addHierarchicalSymbolsForDocument(e,t,n,i,r){var s;(t||n)&&Oc(null!==(s=null==t?void 0:t.symbols)&&void 0!==s?s:Fc.indexSymbols(e,n,{indexingForAutoImportMode:!1},r),i,r)}static indexSymbols(e,t,n,i){const r=[];return Lc(e,t,t.parseTree,n,r,i),r}}function Nc(e,t,n){let i;switch(t.type){case 4:case 5:i=ot.SymbolKind.Class;break;case 3:if(t.isMethod){const e=null==n?void 0:n.getTypeForDeclaration(t);i=e&&ua(e)?ot.SymbolKind.Property:ot.SymbolKind.Method}else i=ot.SymbolKind.Function;break;case 6:i=ot.SymbolKind.Module;break;case 2:if("self"===e||"cls"===e||"_"===e)return;i=ot.SymbolKind.Variable;break;case 1:if("_"===e)return;i=t.isConstant||t.isFinal?ot.SymbolKind.Constant:ot.SymbolKind.Variable;break;default:i=ot.SymbolKind.Variable}return i}function Mc(e,t,n,i,r,s){if(ct(s),e)for(const a of e)if(!a.alias){if(N(n,a.name)){const e={uri:x.file(t).toString(),range:a.selectionRange},n={name:a.name,kind:a.kind,location:e};i.length&&(n.containerName=i),r.push(n)}Mc(a.children,t,n,o(i,a.name),r,s)}function o(e,t){return e.length>0?`${e}.${t}`:t}}function Oc(e,t,n){if(ct(n),e)for(const i of e){if(i.alias)continue;const e=[];Oc(i.children,e,n);const r={name:i.name,kind:i.kind,range:i.range,selectionRange:i.selectionRange,children:e};t.push(r)}}function Lc(e,t,n,i,r,s){ct(s);const o=Ft(n);o&&o.symbolTable.forEach(((n,o)=>{if(n.isIgnoredForProtocolMatch())return;if(i.indexingForAutoImportMode&&!e.isStubFile&&!e.isInPyTypedPackage&&!n.isInDunderAll())return;let a=Vo(n);if(!a&&n.hasDeclarations()&&(a=n.getDeclarations()[0]),a){if(6===a.type){if(!i.indexingForAutoImportMode)return;if(!a.loadSymbolsFromPath||a.path.length<=0)return}!function(e,t,n,i,r,s,o,a){if(i.indexingForAutoImportMode&&!r)return;const l=Nc(s,n);if(void 0===l)return;const c=n.range;let u=c;const p=[];let d;if(4!==n.type&&3!==n.type||(i.indexingForAutoImportMode||Lc(e,t,n.node,i,p,a),u=St(n.node.start,n.node.start+n.node.length,t.tokenizerOutput.lines)),6===n.type&&(d=function(e,t){var n;if(!t.symbolName)return;const i=Rc(e,t,!0,!1);if(!i||!i.declaration)return;if(i.isPrivate)return;const r=as(i.declaration);if(!r||i.declaration.path.length<=0)return;const s=null!==(n=Nc(r,i.declaration))&&void 0!==n?n:ot.SymbolKind.Module;return{originalName:r,modulePath:i.declaration.path,kind:s,itemKind:Kl(s)}}(Vt(t.parseTree).importLookup,n),!d))return;const h={name:s,externallyVisible:r,kind:l,itemKind:Kl(l),alias:d,range:i.indexingForAutoImportMode?void 0:u,selectionRange:i.indexingForAutoImportMode?void 0:c,children:i.indexingForAutoImportMode?void 0:p};o.push(h)}(e,t,a,i,!n.isExternallyHidden(),o,r,s)}}))}function Uc(e,t,n,i){const r={name:n.name,kind:n.kind,location:ot.Location.create(t,n.range)};if(n.tags&&(r.tags=n.tags),i&&(r.containerName=i.name),e.push(r),n.children)for(const i of n.children)Uc(e,t,i,n)}class qc{constructor(e,t){this._parseResults=e,this._cancellationToken=t}sort(){ct(this._cancellationToken);const e=[],t=tn(this._parseResults.parseTree),n=t.orderedImports.map((e=>e)).sort(((e,t)=>function(e,t){const n=en(e),i=en(t);return n<i?-1:n>i?1:e.moduleName<t.moduleName?-1:1}(e,t)));if(0===n.length)return[];const i=this._getPrimaryReplacementRange(t.orderedImports);return e.push({range:i,replacementText:this._generateSortedImportText(n)}),this._addSecondaryReplacementRanges(t.orderedImports,e),e}_getPrimaryReplacementRange(e){let t=e.findIndex((e=>e.followsNonImportStatement));t<0&&(t=e.length);const n=e[t-1].node;return{start:It(e[0].node.start,this._parseResults.tokenizerOutput.lines),end:It(dt.getEnd(n),this._parseResults.tokenizerOutput.lines)}}_addSecondaryReplacementRanges(e,t){let n=e.findIndex((e=>e.followsNonImportStatement));if(!(n<0))for(;;){let i=e.findIndex(((e,t)=>t>n&&e.followsNonImportStatement));if(i<0&&(i=e.length),t.push({range:{start:It(e[n].node.start,this._parseResults.tokenizerOutput.lines),end:It(dt.getEnd(e[i-1].node),this._parseResults.tokenizerOutput.lines)},replacementText:""}),n=i,n>=e.length)break}}_generateSortedImportText(e){let t="",n=en(e[0]);for(const i of e){const r=en(i);let s;n!==r&&(t+=this._parseResults.tokenizerOutput.predominantEndOfLineSequence,n=r),s=20===i.node.nodeType?this._formatImportNode(i.subnode,i.moduleName):this._formatImportFromNode(i.node,i.moduleName),i!==e[e.length-1]&&(s+=this._parseResults.tokenizerOutput.predominantEndOfLineSequence),t+=s}return t}_formatImportNode(e,t){let n=`import ${t}`;return e.alias&&(n+=` as ${e.alias.value}`),n}_formatImportFromNode(e,t){const n=e.imports.sort(((e,t)=>this._compareSymbols(e,t))).map((e=>{let t=e.name.value;return e.alias&&(t+=` as ${e.alias.value}`),t}));let i=`from ${t} import `;if(e.isWildcardImport)return i+"*";const r=n.join(", ");if(i.length+r.length<=88)return i+r;i+="("+this._parseResults.tokenizerOutput.predominantEndOfLineSequence;for(const e of n)i+=this._parseResults.tokenizerOutput.predominantTabSequence+e+","+this._parseResults.tokenizerOutput.predominantEndOfLineSequence;return i+=")",i}_compareSymbols(e,t){return e.name.value<t.name.value?-1:1}}function Vc(e){const t=e.escapedValue,n=0!=(8&e.flags),i=0!=(64&e.flags);if(n&&!i)return{value:t,unescapeErrors:[],nonAsciiInBytes:!1,formatStringSegments:[]};const r=[];for(let e=0;e<t.length;e++)r.push(t.charCodeAt(e));const s=0!=(32&e.flags);if(!i&&!r.some((e=>13===e||10===e||92===e)))return{value:t,unescapeErrors:[],nonAsciiInBytes:s&&r.some((e=>e>=128)),formatStringSegments:[]};let o=0,a={offset:0,length:0,valueParts:[],isExpression:!1,hasFormatSpecifier:!1},l=0;const c={valueParts:[],unescapeErrors:[],nonAsciiInBytes:!1,formatStringSegments:[]},u=()=>{n||c.unescapeErrors.push({offset:l-1,length:2,errorType:0})},p=(e=0)=>l+e>=r.length?3:r[l+e],d=e=>{let t=!1,n=0,i="";for(let i=0;i<e;i++){const e=p(1+i);if(!jc(e)){t=!0;break}n=16*n+zc(e)}return t?(u(),i="\\"+String.fromCharCode(p()),l++):(i=String.fromCharCode(n),l+=1+e),i},h=e=>{const t=String.fromCharCode(e);c.valueParts.push(t),a.valueParts.push(t)};for(;;){let e=p();if(3===e)return i&&(a.isExpression&&c.unescapeErrors.push({offset:a.offset,length:l-a.offset,errorType:3}),l!==a.offset&&(a.length=l-a.offset,c.formatStringSegments.push(a))),f=c,{...f,value:f.valueParts.join(""),formatStringSegments:f.formatStringSegments.map((e=>({...e,value:e.valueParts.join("")})))};if(92===e){if(i&&a.isExpression&&!a.hasFormatSpecifier&&c.unescapeErrors.push({offset:l,length:1,errorType:1}),l++,n){h(e);continue}e=p();let t="";if(13===e||10===e)13===e&&10===p(1)&&(n&&(t+=String.fromCharCode(e)),l++,e=p()),n&&(t="\\"+t+String.fromCharCode(e)),l++;else if(n)t="\\"+String.fromCharCode(e),l++;else switch(e){case 92:case 39:case 34:t=String.fromCharCode(e),l++;break;case 97:t="",l++;break;case 98:t="\b",l++;break;case 102:t="\f",l++;break;case 110:t="\n",l++;break;case 114:t="\r",l++;break;case 116:t="\t",l++;break;case 118:t="\v",l++;break;case 120:t=d(2);break;case 78:{let n=!1,i=1;if(123!==p(i))n=!0;else for(i++;;){const e=p(i);if(125===e)break;if(!Bc(e)&&45!==e&&32!==(m=e)&&9!==m){n=!0;break}i++}n?(u(),t="\\"+String.fromCharCode(e),l++):(t="-",l+=1+i);break}case 117:t=d(4);break;case 85:t=d(8);break;default:if(Wc(e)){let n=e-48;l++,e=p(),Wc(e)&&(n=8*n+e-48,l++,e=p(),Wc(e)&&(n=8*n+e-48,l++)),t=String.fromCharCode(n)}else t="\\",u()}c.valueParts.push(t),a.valueParts.push(t)}else if(10===e||13===e)13===e&&10===p(1)&&(h(e),l++,e=p()),h(e),l++;else if(i&&123===e)a.isExpression||123!==p(1)?(0===o?(a.length=l-a.offset,a.length>0&&c.formatStringSegments.push(a),l++,a={offset:l,length:0,valueParts:[],isExpression:!0,hasFormatSpecifier:!1}):(h(e),l++),o++):(h(e),l+=2);else if(i&&125===e)a.isExpression||125!==p(1)?0===o?(c.unescapeErrors.push({offset:l,length:1,errorType:2}),l++):(o--,0===o?(a.length=l-a.offset,c.formatStringSegments.push(a),l++,a={offset:l,length:0,valueParts:[],isExpression:!1,hasFormatSpecifier:!1}):(h(e),l++)):(h(e),l+=2);else if(!a.isExpression||39!==e&&34!==e)a.isExpression&&58===e&&(a.hasFormatSpecifier=!0),s&&e>=128&&(c.nonAsciiInBytes=!0),h(e),l++;else{const t=e;h(e);const n=p(1)===t&&p(2)===t;for(n&&(l+=2,h(e),h(e),c.valueParts.push(String.fromCharCode(e)),c.valueParts.push(String.fromCharCode(e)));;){l++;let e=p();if(3===e)break;if(92!==e){if((10===e||13===e)&&!n)break;if(e===t){if(!n){l++,h(e);break}if(p(1)===t&&p(2)===t){l+=3,h(e),h(e),h(e);break}}h(e)}else h(e),l++,e=p(),h(e)}}}var m,f}function Bc(e){return e>=48&&e<=57||e>=97&&e<=122||e>=65&&e<=90}function Wc(e){return e>=48&&e<=55}function jc(e){return e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70}function zc(e){return e>=48&&e<=57?e-48:e>=97&&e<=102?e-97+10:e>=65&&e<=70?e-65+10:0}class $c{constructor(e){this._text=e,this._position=0,this._currentChar=e.length>0?e.charCodeAt(0):0,this._isEndOfStream=0===e.length}getText(){return this._text}get position(){return this._position}set position(e){this._position=e,this._checkBounds()}get currentChar(){return this._currentChar}getCurrentChar(){return this._currentChar}get nextChar(){return this.position+1<this._text.length?this._text.charCodeAt(this.position+1):0}get prevChar(){return this.position-1>=0?this._text.charCodeAt(this.position-1):0}isEndOfStream(){return this._isEndOfStream}lookAhead(e){const t=this._position+e;return t<0||t>=this._text.length?0:this._text.charCodeAt(t)}advance(e){this.position+=e}moveNext(){return this._position<this._text.length-1?(this._position+=1,this._currentChar=this._text.charCodeAt(this._position),!0):(this.advance(1),!this.isEndOfStream())}isAtWhiteSpace(){return 32===(e=this.currentChar)||9===e||12===e;var e}isAtLineBreak(){return 13===(e=this.currentChar)||10===e;var e}skipLineBreak(){13===this._currentChar?(this.moveNext(),10===this.currentChar&&this.moveNext()):10===this._currentChar&&this.moveNext()}skipWhitespace(){for(;!this.isEndOfStream()&&this.isAtWhiteSpace();)this.moveNext()}skipToEol(){for(;!this.isEndOfStream()&&!this.isAtLineBreak();)this.moveNext()}skipToWhitespace(){for(;!this.isEndOfStream()&&!this.isAtWhiteSpace();)this.moveNext()}charCodeAt(e){return this._text.charCodeAt(e)}get length(){return this._text.length}_checkBounds(){this._position<0&&(this._position=0),this._isEndOfStream=this._position>=this._text.length,this._isEndOfStream&&(this._position=this._text.length),this._currentChar=this._isEndOfStream?0:this._text.charCodeAt(this._position)}}!function(e){e.create=function(e,t,n,i=0){return{type:i,start:e,length:t,value:n}}}(oc||(oc={})),function(e){e.create=function(e,t,n,i){return{start:t,length:n,type:e,comments:i}}}(ac||(ac={})),function(e){e.create=function(e,t,n,i,r){return{start:e,length:t,type:3,isIndentAmbiguous:i,comments:r,indentAmount:n}}}(lc||(lc={})),function(e){e.create=function(e,t,n,i,r,s){return{start:e,length:t,type:4,comments:s,indentAmount:n,matchesIndent:i,isDedentAmbiguous:r}}}(cc||(cc={})),function(e){e.create=function(e,t,n,i){return{start:e,length:t,type:2,comments:i,newLineType:n}}}(uc||(uc={})),function(e){e.create=function(e,t,n,i){return{start:e,length:t,type:8,comments:i,keywordType:n}}}(pc||(pc={})),function(e){e.create=function(e,t,n,i,r,s){return{start:e,length:t,type:5,flags:n,escapedValue:i,prefixLength:r,quoteMarkLength:4&n?3:1,comments:s}}}(dc||(dc={})),function(e){e.create=function(e,t,n,i,r,s){return{start:e,length:t,type:6,isInteger:i,isImaginary:r,value:n,comments:s}}}(hc||(hc={})),function(e){e.create=function(e,t,n,i){return{start:e,length:t,type:9,operatorType:n,comments:i}}}(mc||(mc={})),function(e){e.create=function(e,t,n,i){return{start:e,length:t,type:7,value:n.normalize("NFKC"),comments:i}}}(fc||(fc={}));const Hc=new Map([["and",0],["as",1],["assert",2],["async",3],["await",4],["break",5],["case",6],["class",7],["continue",8],["__debug__",9],["def",10],["del",11],["elif",12],["else",13],["except",14],["finally",16],["for",17],["from",18],["global",19],["if",20],["import",21],["in",22],["is",23],["lambda",24],["match",25],["nonlocal",27],["not",28],["or",29],["pass",30],["raise",31],["return",32],["try",34],["while",35],["with",36],["yield",37],["False",15],["None",26],["True",33]]),Gc={0:3,1:4,2:4,3:2,4:4,5:1,6:2,7:4,8:2,9:4,10:2,11:4,12:10,13:2,14:4,15:10,16:10,17:2,18:4,19:26,20:10,21:10,22:2,23:4,24:2,25:4,26:2,27:4,28:10,29:2,30:4,31:2,32:4,33:2,34:4,36:2,37:2,38:1,39:2,40:2,41:2,42:2};class Kc{constructor(){this._cs=new $c(""),this._tokens=[],this._prevLineStart=0,this._parenDepth=0,this._lineRanges=[],this._indentAmounts=[],this._typeIgnoreLines=new Map,this._crCount=0,this._crLfCount=0,this._lfCount=0,this._indentCount=0,this._indentTabCount=0,this._indentSpacesTotal=0,this._singleQuoteCount=0,this._doubleQuoteCount=0,this._ipythonMode=!1}tokenize(e,t,n,i=0,r=!1){if(void 0===t)t=0;else if(t<0||t>e.length)throw new Error("Invalid range start");if(void 0===n)n=e.length;else{if(n<0||t+n>e.length)throw new Error("Invalid range length");t+n<e.length&&(e=e.substr(0,t+n))}this._cs=new $c(e),this._cs.position=t,this._tokens=[],this._prevLineStart=0,this._parenDepth=i,this._lineRanges=[],this._indentAmounts=[],this._ipythonMode=r;const s=t+n;for(0===t&&this._readIndentationAfterNewLine();!(this._cs.isEndOfStream()||(this._addNextToken(),this._cs.position>=s)););0!==this._tokens.length&&2===this._tokens[this._tokens.length-1].type||this._tokens.push(uc.create(this._cs.position,0,3,this._getComments())),this._setIndent(0,0,!1,!1),this._tokens.push(ac.create(1,this._cs.position,0,this._getComments())),this._addLineRange();let o="\n";this._crCount>this._crLfCount&&this._crCount>this._lfCount?o="\r":this._crLfCount>this._crCount&&this._crLfCount>this._lfCount&&(o="\r\n");let a="    ";if(this._indentTabCount>this._indentCount/2)a="\t";else if(this._indentCount>0){let e=Math.round(this._indentSpacesTotal/this._indentCount);e<1?e=1:e>8&&(e=8),a="";for(let t=0;t<e;t++)a+=" "}return{tokens:new Ac(this._tokens),lines:new Ac(this._lineRanges),typeIgnoreLines:this._typeIgnoreLines,typeIgnoreAll:this._typeIgnoreAll,predominantEndOfLineSequence:o,predominantTabSequence:a,predominantSingleQuoteCharacter:this._singleQuoteCount>=this._doubleQuoteCount?"'":'"'}}static getOperatorInfo(e){return Gc[e]}static isOperatorAssignment(e){return void 0!==e&&void 0!==Gc[e]&&0!=(4&Gc[e])}static isOperatorComparison(e){return void 0!==e&&void 0!==Gc[e]&&0!=(8&Gc[e])}_addNextToken(){this._cs.skipWhitespace(),this._cs.isEndOfStream()||this._handleCharacter()||this._cs.moveNext()}_handleCharacter(){const e=this._getStringPrefixLength();if(e>=0){let t="";e>0&&(t=this._cs.getText().substr(this._cs.position,e),this._cs.advance(e));const n=this._getQuoteTypeFlags(t);if(0!==n)return this._handleString(n,e),!0}if(35===this._cs.currentChar)return this._handleComment(),!0;if(this._ipythonMode&&this._isIPythonMagics())return this._handleIPythonMagics(37===this._cs.currentChar?1:2),!0;switch(this._cs.currentChar){case 65279:return 0!==this._cs.position&&this._handleInvalid();case 13:{const e=10===this._cs.nextChar?2:1,t=2===e?2:0;return this._handleNewLine(e,t),!0}case 10:return this._handleNewLine(1,1),!0;case 92:return 13===this._cs.nextChar?(10===this._cs.lookAhead(2)?this._cs.advance(3):this._cs.advance(2),this._addLineRange(),!0):10===this._cs.nextChar?(this._cs.advance(2),this._addLineRange(),!0):this._handleInvalid();case 40:this._parenDepth++,this._tokens.push(ac.create(13,this._cs.position,1,this._getComments()));break;case 41:this._parenDepth>0&&this._parenDepth--,this._tokens.push(ac.create(14,this._cs.position,1,this._getComments()));break;case 91:this._parenDepth++,this._tokens.push(ac.create(15,this._cs.position,1,this._getComments()));break;case 93:this._parenDepth>0&&this._parenDepth--,this._tokens.push(ac.create(16,this._cs.position,1,this._getComments()));break;case 123:this._parenDepth++,this._tokens.push(ac.create(17,this._cs.position,1,this._getComments()));break;case 125:this._parenDepth>0&&this._parenDepth--,this._tokens.push(ac.create(18,this._cs.position,1,this._getComments()));break;case 44:this._tokens.push(ac.create(12,this._cs.position,1,this._getComments()));break;case 96:this._tokens.push(ac.create(22,this._cs.position,1,this._getComments()));break;case 59:this._tokens.push(ac.create(11,this._cs.position,1,this._getComments()));break;case 58:if(61===this._cs.nextChar){this._tokens.push(mc.create(this._cs.position,2,35,this._getComments())),this._cs.advance(1);break}this._tokens.push(ac.create(10,this._cs.position,1,this._getComments()));break;default:if(this._isPossibleNumber()&&this._tryNumber())return!0;if(46===this._cs.currentChar){if(46===this._cs.nextChar&&46===this._cs.lookAhead(2))return this._tokens.push(ac.create(19,this._cs.position,3,this._getComments())),this._cs.advance(3),!0;this._tokens.push(ac.create(20,this._cs.position,1,this._getComments()));break}return!(!this._tryIdentifier()&&!this._tryOperator())||this._handleInvalid()}return!1}_addLineRange(){const e=this._cs.position-this._prevLineStart;e>0&&this._lineRanges.push({start:this._prevLineStart,length:e}),this._prevLineStart=this._cs.position}_handleNewLine(e,t){0===this._parenDepth&&3!==t&&(0!==this._tokens.length&&2===this._tokens[this._tokens.length-1].type||this._tokens.push(uc.create(this._cs.position,e,t,this._getComments()))),0===t?this._crCount++:2===t?this._crLfCount++:this._lfCount++,this._cs.advance(e),this._addLineRange(),this._readIndentationAfterNewLine()}_readIndentationAfterNewLine(){let e=0,t=0,n=!1,i=!1;for(;!this._cs.isEndOfStream();)switch(this._cs.currentChar){case 32:e++,t++,i=!0,this._cs.moveNext();break;case 9:e++,t+=8-t%8,n=!0,this._cs.moveNext();break;case 12:e=0,t=0,n=!1,i=!1,this._cs.moveNext();break;default:return void this._setIndent(e,t,i,n);case 35:case 10:case 13:return}}_setIndent(e,t,n,i){if(!(this._parenDepth>0))if(0===this._indentAmounts.length)t>0&&(this._indentCount++,i&&this._indentTabCount++,this._indentSpacesTotal+=t,this._indentAmounts.push({tab1Spaces:e,tab8Spaces:t,isSpacePresent:n,isTabPresent:i}),this._tokens.push(lc.create(this._cs.position,0,t,!1,this._getComments())));else{const r=this._indentAmounts[this._indentAmounts.length-1];if(r.tab8Spaces<t){const s=(r.isSpacePresent&&i||r.isTabPresent&&n)&&r.tab1Spaces>=e;this._indentCount++,i&&this._indentTabCount++,this._indentSpacesTotal+=t-this._indentAmounts[this._indentAmounts.length-1].tab8Spaces,this._indentAmounts.push({tab1Spaces:e,tab8Spaces:t,isSpacePresent:n,isTabPresent:i}),this._tokens.push(lc.create(this._cs.position,0,t,s,this._getComments()))}else if(r.tab8Spaces===t)(r.isSpacePresent&&i||r.isTabPresent&&n)&&this._tokens.push(lc.create(this._cs.position,0,t,!0,this._getComments()));else{let e=r.isSpacePresent&&i||r.isTabPresent&&n;const s=[];for(;this._indentAmounts.length>0&&this._indentAmounts[this._indentAmounts.length-1].tab8Spaces>t;)s.push(this._indentAmounts.length>1?this._indentAmounts[this._indentAmounts.length-2].tab8Spaces:0),this._indentAmounts.pop();s.forEach(((n,i)=>{const r=i<s.length-1||n===t,o=i<s.length-1?n:t;this._tokens.push(cc.create(this._cs.position,0,o,r,e,this._getComments())),e=!1}))}}}_tryIdentifier(){const e=()=>{for(;;)if(Ve(this._cs.currentChar))this._cs.moveNext();else{if(!Ve(this._cs.currentChar,this._cs.nextChar))break;this._cs.moveNext(),this._cs.moveNext()}},t=this._cs.position;if(qe(this._cs.currentChar)?(this._cs.moveNext(),e()):qe(this._cs.currentChar,this._cs.nextChar)&&(this._cs.moveNext(),this._cs.moveNext(),e()),this._cs.position>t){const e=this._cs.getText().substr(t,this._cs.position-t);return Hc.has(e)?this._tokens.push(pc.create(t,this._cs.position-t,Hc.get(e),this._getComments())):this._tokens.push(fc.create(t,this._cs.position-t,e,this._getComments())),!0}return!1}_isPossibleNumber(){return!!Be(this._cs.currentChar)||!(46!==this._cs.currentChar||!Be(this._cs.nextChar))}_tryNumber(){const e=this._cs.position;if(48===this._cs.currentChar){let t=0,n=0;if((120===this._cs.nextChar||88===this._cs.nextChar)&&We(this._cs.lookAhead(2))){for(this._cs.advance(2),n=2;We(this._cs.currentChar);)this._cs.moveNext();t=16}if((98===this._cs.nextChar||66===this._cs.nextChar)&&ze(this._cs.lookAhead(2))){for(this._cs.advance(2),n=2;ze(this._cs.currentChar);)this._cs.moveNext();t=2}if((111===this._cs.nextChar||79===this._cs.nextChar)&&je(this._cs.lookAhead(2))){for(this._cs.advance(2),n=2;je(this._cs.currentChar);)this._cs.moveNext();t=8}if(t>0){const i=this._cs.getText().substr(e,this._cs.position-e),r=i.replace(/_/g,"");let s=parseInt(r.substr(n),t);if(!isNaN(s)){const t=BigInt(r);return isFinite(s)&&BigInt(s)===t||(s=t),this._tokens.push(hc.create(e,i.length,s,!0,!1,this._getComments())),!0}}}let t=!1,n=!1;if(this._cs.currentChar>=49&&this._cs.currentChar<=57){for(;Be(this._cs.currentChar);)n=!0,this._cs.moveNext();t=46!==this._cs.currentChar&&101!==this._cs.currentChar&&69!==this._cs.currentChar}if(48===this._cs.currentChar){for(n=!0;48===this._cs.currentChar||95===this._cs.currentChar;)this._cs.moveNext();t=46!==this._cs.currentChar&&101!==this._cs.currentChar&&69!==this._cs.currentChar}if(t){let t=this._cs.getText().substr(e,this._cs.position-e);const n=t.replace(/_/g,"");let i=parseInt(n,10);if(!isNaN(i)){let r=!1;const s=BigInt(n);return isFinite(i)&&BigInt(i)===s||(i=s),106!==this._cs.currentChar&&74!==this._cs.currentChar||(r=!0,t+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()),this._tokens.push(hc.create(e,t.length,i,!0,r,this._getComments())),!0}}if(this._cs.position=e,(n||46===this._cs.currentChar&&this._cs.nextChar>=48&&this._cs.nextChar<=57)&&this._skipFloatingPointCandidate()){let t=this._cs.getText().substr(e,this._cs.position-e);const n=parseFloat(t);if(!isNaN(n)){let i=!1;return 106!==this._cs.currentChar&&74!==this._cs.currentChar||(i=!0,t+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()),this._tokens.push(hc.create(e,this._cs.position-e,n,!1,i,this._getComments())),!0}}return this._cs.position=e,!1}_tryOperator(){let e=0;const t=this._cs.nextChar;let n;switch(this._cs.currentChar){case 43:e=61===t?2:1,n=2===e?1:0;break;case 38:e=61===t?2:1,n=2===e?4:3;break;case 124:e=61===t?2:1,n=2===e?7:6;break;case 94:e=61===t?2:1,n=2===e?9:8;break;case 61:e=61===t?2:1,n=2===e?12:2;break;case 33:if(61!==t)return!1;e=2,n=28;break;case 37:e=61===t?2:1,n=2===e?25:24;break;case 126:e=1,n=5;break;case 45:if(62===t)return this._tokens.push(ac.create(21,this._cs.position,2,this._getComments())),this._cs.advance(2),!0;e=61===t?2:1,n=2===e?34:33;break;case 42:42===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?30:29):(e=61===t?2:1,n=2===e?27:26);break;case 47:47===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?14:13):(e=61===t?2:1,n=2===e?11:10);break;case 60:60===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?18:17):62===t?(e=2,n=19):(e=61===t?2:1,n=2===e?21:20);break;case 62:62===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?32:31):(e=61===t?2:1,n=2===e?16:15);break;case 64:e=61===t?2:1,n=2===e?23:22;break;default:return!1}return this._tokens.push(mc.create(this._cs.position,e,n,this._getComments())),this._cs.advance(e),e>0}_handleInvalid(){const e=this._cs.position;for(;10!==this._cs.currentChar&&13!==this._cs.currentChar&&!this._cs.isAtWhiteSpace()&&!this._cs.isEndOfStream();)(t=this._cs.currentChar)<Ne||(Ue||(Ze(!1),Ue=!0),Oe[t]!==Fe.SurrogateChar)||this._cs.moveNext(),this._cs.moveNext();var t;const n=this._cs.position-e;return n>0&&(this._tokens.push(ac.create(0,e,n,this._getComments())),!0)}_getComments(){const e=this._comments;return this._comments=void 0,e}_isIPythonMagics(){const e=this._tokens.length>0?this._tokens[this._tokens.length-1]:void 0;return!(void 0!==e&&2!==e.type&&3!==e.type||37!==this._cs.currentChar&&33!==this._cs.currentChar)}_handleIPythonMagics(e){const t=this._cs.position+1;let n=t;do{this._cs.skipToEol();const e=this._cs.position-n;if(!this._cs.getText().substr(n,e).match(/\\\s*$/))break;n=this._cs.position+1}while(!this._cs.isEndOfStream());const i=this._cs.position-t,r=this._cs.getText().substr(t,i),s=oc.create(t,i,r,e);this._addComments(s)}_handleComment(){const e=this._cs.position+1;this._cs.skipToEol();const t=this._cs.position-e,n=this._cs.getText().substr(e,t),i=oc.create(e,t,n),r=n.match(/^\s*type:\s*ignore(\s|\[|$)/);if(r){const t={start:e,length:r[0].length};r[0].endsWith("[")&&t.length--,this._tokens.findIndex((e=>2!==e.type&&e&&3!==e.type))<0?this._typeIgnoreAll=t:this._typeIgnoreLines.set(this._lineRanges.length,t)}this._addComments(i)}_addComments(e){this._comments?this._comments.push(e):this._comments=[e]}_getStringPrefixLength(){if(39===this._cs.currentChar||34===this._cs.currentChar)return 0;if(39===this._cs.nextChar||34===this._cs.nextChar)switch(this._cs.currentChar){case 102:case 70:case 114:case 82:case 98:case 66:case 117:case 85:return 1}if(39===this._cs.lookAhead(2)||34===this._cs.lookAhead(2))switch(this._cs.getText().substr(this._cs.position,2).toLowerCase()){case"rf":case"fr":case"ur":case"ru":case"br":case"rb":return 2}return-1}_getQuoteTypeFlags(e){let t=0;e=e.toLowerCase();for(let n=0;n<e.length;n++)switch(e[n]){case"u":t|=16;break;case"b":t|=32;break;case"r":t|=8;break;case"f":t|=64}return 39===this._cs.currentChar?(t|=1,39===this._cs.nextChar&&39===this._cs.lookAhead(2)&&(t|=4)):34===this._cs.currentChar&&(t|=2,34===this._cs.nextChar&&34===this._cs.lookAhead(2)&&(t|=4)),t}_handleString(e,t){const n=this._cs.position-t;4&e?this._cs.advance(3):(this._cs.moveNext(),1&e?this._singleQuoteCount++:this._doubleQuoteCount++);const i=this._skipToEndOfStringLiteral(e),r=this._cs.position;this._tokens.push(dc.create(n,r-n,i.flags,i.escapedValue,t,this._getComments()))}_skipToEndOfStringLiteral(e){const t=1&e?39:34,n=0!=(4&e);let i=[];for(;;){if(this._cs.isEndOfStream())return e|=65536,{escapedValue:String.fromCharCode.apply(void 0,i),flags:e};if(92===this._cs.currentChar)i.push(this._cs.currentChar),this._cs.moveNext(),13===this._cs.getCurrentChar()||10===this._cs.getCurrentChar()?(13===this._cs.getCurrentChar()&&10===this._cs.nextChar&&(i.push(this._cs.currentChar),this._cs.moveNext()),i.push(this._cs.currentChar),this._cs.moveNext(),this._addLineRange()):(i.push(this._cs.currentChar),this._cs.moveNext());else if(10===this._cs.currentChar||13===this._cs.currentChar){if(!n)return e|=65536,{escapedValue:String.fromCharCode.apply(void 0,i),flags:e};13===this._cs.currentChar&&10===this._cs.nextChar&&(i.push(this._cs.currentChar),this._cs.moveNext()),i.push(this._cs.currentChar),this._cs.moveNext(),this._addLineRange()}else{if(!n&&this._cs.currentChar===t){this._cs.moveNext();break}if(n&&this._cs.currentChar===t&&this._cs.nextChar===t&&this._cs.lookAhead(2)===t){this._cs.advance(3);break}i.push(this._cs.currentChar),this._cs.moveNext()}}return i.length>32768&&(i=i.slice(0,32768),e|=131072),{escapedValue:String.fromCharCode.apply(void 0,i),flags:e}}_skipFloatingPointCandidate(){const e=this._cs.position;return this._skipFractionalNumber(),this._cs.position>e&&(101!==this._cs.currentChar&&69!==this._cs.currentChar||(this._cs.moveNext(),this._skipDecimalNumber(!0))),this._cs.position>e}_skipFractionalNumber(){this._skipDecimalNumber(!1),46===this._cs.currentChar&&this._cs.moveNext(),this._skipDecimalNumber(!1)}_skipDecimalNumber(e){for(!e||45!==this._cs.currentChar&&43!==this._cs.currentChar||this._cs.moveNext();Be(this._cs.currentChar);)this._cs.moveNext()}}class Jc{constructor(){this.isStubFile=!1,this.pythonVersion=Ae,this.reportInvalidStringEscapeSequence=!1,this.skipFunctionAndClassBody=!1,this.ipythonMode=!1}}const Yc=256;class Qc{constructor(){this._tokenIndex=0,this._areErrorsSuppressed=!1,this._parseOptions=new Jc,this._diagSink=new kc,this._isInLoop=!1,this._isInFunction=!1,this._isInFinally=!1,this._isParsingTypeAnnotation=!1,this._isParsingIndexTrailer=!1,this._futureImportMap=new Map,this._importedModules=[],this._containsWildcardImport=!1,this._assignmentExpressionsAllowed=!0,this._typingImportAliases=[],this._typingSymbolAliases=new Map}parseSourceFile(e,t,n){Fn.tokenizeFileTime.timeOperation((()=>{this._startNewParse(e,0,e.length,t,n)}));const i=Yn.create({start:0,length:e.length});return Fn.parseFileTime.timeOperation((()=>{for(;!this._atEof();)if(!this._consumeTokenIfType(2)){const e=this._peekToken();if(3===e.type){this._getNextToken();const t=e;t.isIndentAmbiguous?this._addError(ml.Diagnostic.inconsistentTabs(),t):this._addError(ml.Diagnostic.unexpectedIndent(),e)}const t=this._parseStatement();t?(t.parent=i,i.statements.push(t)):this._consumeTokensUntilType([2])}})),w(void 0!==this._tokenizerOutput),{text:e,parseTree:i,importedModules:this._importedModules,futureImports:this._futureImportMap,tokenizerOutput:this._tokenizerOutput,containsWildcardImport:this._containsWildcardImport,typingSymbolAliases:this._typingSymbolAliases}}parseTextExpression(e,t,n,i,r=0,s=0,o){const a=new kc;let l;if(this._startNewParse(e,t,n,i,a,s),o&&(this._typingSymbolAliases=new Map(o)),1===r)l=this._parseTypeAnnotation();else if(2===r)l=this._parseFunctionTypeAnnotation();else{const e=this._parseTestOrStarExpressionList(!1,!0);e.parseError?l=e.parseError:(0===e.list.length&&this._addError(ml.Diagnostic.expectedExpr(),this._peekToken()),l=this._makeExpressionOrTuple(e,!1))}return 2===this._peekTokenType()&&this._getNextToken(),this._atEof()||this._addError(ml.Diagnostic.unexpectedExprToken(),this._peekToken()),{parseTree:l,lines:this._tokenizerOutput.lines,diagnostics:a.fetchAndClear()}}_startNewParse(e,t,n,i,r,s=0){this._fileContents=e,this._parseOptions=i,this._diagSink=r;const o=new Kc;this._tokenizerOutput=o.tokenize(e,t,n,s,this._parseOptions.ipythonMode),this._tokenIndex=0}_parseStatement(){switch(this._consumeTokenIfType(4)&&this._addError(ml.Diagnostic.unexpectedUnindent(),this._peekToken()),this._peekKeywordType()){case 20:return this._parseIfStatement();case 35:return this._parseWhileStatement();case 17:return this._parseForStatement();case 34:return this._parseTryStatement();case 36:return this._parseWithStatement();case 10:return this._parseFunctionDef();case 7:return this._parseClassDef();case 3:return this._parseAsyncStatement();case 25:{const e=this._peekToken(1);let t=!1;if(10===e.type||11===e.type||12===e.type||20===e.type||2===e.type||1===e.type)t=!0;else if(9===e.type){const n=e;26!==n.operatorType&&33!==n.operatorType&&(t=!0)}if(!t){const e=this._parseMatchStatement();if(e)return e}}}return 22===this._peekOperatorType()?this._parseDecorated():this._parseSimpleStatement()}_parseAsyncStatement(){const e=this._getKeywordToken(3);switch(this._peekKeywordType()){case 10:return this._parseFunctionDef(e);case 36:return this._parseWithStatement(e);case 17:return this._parseForStatement(e)}this._addError(ml.Diagnostic.unexpectedAsyncToken(),e)}_parseMatchStatement(){let e=!1;if(this._suppressErrors((()=>{const t=this._tokenIndex;this._getKeywordToken(25);const n=this._parseTestOrStarListAsExpression(!0,!0,12,ml.Diagnostic.expectedReturnExpr());e=0!==n.nodeType&&10===this._peekToken().type,this._tokenIndex=t})),!e)return;const t=this._getKeywordToken(25),n=this._parseTestOrStarListAsExpression(!0,!0,12,ml.Diagnostic.expectedReturnExpr()),i=sr.create(t,n),r=this._peekToken();if(this._consumeTokenIfType(10))if(this._consumeTokenIfType(2)){const e=this._peekToken();if(this._consumeTokenIfType(3)){const t=e;t.isIndentAmbiguous&&this._addError(ml.Diagnostic.inconsistentTabs(),t)}else this._addError(ml.Diagnostic.expectedIndentedBlock(),this._peekToken());for(;;){const e=this._peekToken();if(3===e.type){this._getNextToken();const t=e;t.isIndentAmbiguous?this._addError(ml.Diagnostic.inconsistentTabs(),t):this._addError(ml.Diagnostic.unexpectedIndent(),e)}const t=this._parseCaseStatement();t?(t.parent=i,i.cases.push(t)):this._consumeTokensUntilType([2,10])&&this._getNextToken();const n=this._peekToken();if(this._consumeTokenIfType(4)){n.matchesIndent||this._addError(ml.Diagnostic.inconsistentIndent(),n),n.isDedentAmbiguous&&this._addError(ml.Diagnostic.inconsistentTabs(),n);break}if(1===this._peekTokenType())break}i.cases.length>0?Jn(i,i.cases[i.cases.length-1]):this._addError(ml.Diagnostic.zeroCaseStatementsFound(),t)}else this._addError(ml.Diagnostic.expectedNewline(),r);else this._addError(ml.Diagnostic.expectedColon(),r),this._consumeTokensUntilType([2,10])&&this._getNextToken();this._getLanguageVersion()<De.V3_10&&this._addError(ml.Diagnostic.matchIncompatible(),t);for(let e=0;e<i.cases.length-1;e++){const t=i.cases[e];!t.guardExpression&&t.isIrrefutable&&this._addError(ml.Diagnostic.casePatternIsIrrefutable(),t.pattern)}return i}_parseCaseStatement(){const e=this._peekToken();if(!this._consumeTokenIfKeyword(6))return void this._addError(ml.Diagnostic.expectedCase(),e);const t=this._parsePatternSequence();let n,i;if(t.parseError)n=t.parseError;else if(0===t.list.length)this._addError(ml.Diagnostic.expectedPatternExpr(),this._peekToken()),n=di.create(e,11);else if(1!==t.list.length||t.trailingComma)n=ar.create(t.list[0],t.list);else{const e=t.list[0].orPatterns[0];n=69===e.nodeType&&e.isStar?ar.create(t.list[0],t.list):t.list[0]}this._consumeTokenIfKeyword(20)&&(i=this._parseTestExpression(!0));const r=this._parseSuite(this._isInFunction);return or.create(e,n,this._isPatternIrrefutable(n),i,r)}_isPatternIrrefutable(e){return 69===e.nodeType||66===e.nodeType&&e.orPatterns.some((e=>this._isPatternIrrefutable(e)))}_getPatternTargetNames(e,t){switch(e.nodeType){case 65:e.entries.forEach((e=>{this._getPatternTargetNames(e,t)}));break;case 68:e.arguments.forEach((e=>{this._getPatternTargetNames(e.pattern,t)}));break;case 66:e.target&&t.set(e.target.value,!0),e.orPatterns.forEach((e=>{this._getPatternTargetNames(e,t)}));break;case 69:e.isWildcard||t.set(e.target.value,!0);break;case 70:e.entries.forEach((e=>{72===e.nodeType?t.set(e.target.value,!0):(this._getPatternTargetNames(e.keyPattern,t),this._getPatternTargetNames(e.valuePattern,t))}))}}_parsePatternSequence(){const e=this._parseExpressionListGeneric((()=>this._parsePatternAs())),t=e.list.filter((e=>1===e.orPatterns.length&&69===e.orPatterns[0].nodeType&&e.orPatterns[0].isStar));t.length>1&&this._addError(ml.Diagnostic.duplicateStarPattern(),t[1].orPatterns[0]);const n=new Map;return e.list.forEach((e=>{e.orPatterns.forEach((e=>{69!==e.nodeType||e.isStar||e.isWildcard||(n.has(e.target.value)?this._addError(ml.Diagnostic.duplicateCapturePatternTarget().format({name:e.target.value}),e):n.set(e.target.value,e))}))})),e}_parsePatternAs(){const e=[];for(;;){const t=this._parsePatternAtom();if(e.push(t),!this._consumeTokenIfOperator(6))break}let t;if(e.length>1&&e.forEach((e=>{69===e.nodeType&&e.isStar&&this._addError(ml.Diagnostic.starPatternInOrPattern(),e)})),this._consumeTokenIfKeyword(1)){const e=this._getTokenIfIdentifier();e?t=Ri.create(e):this._addError(ml.Diagnostic.expectedNameAfterAs(),this._peekToken())}t&&1===e.length&&69===e[0].nodeType&&e[0].isStar&&this._addError(ml.Diagnostic.starPatternInAsPattern(),e[0]),e.forEach(((t,n)=>{n<e.length-1&&this._isPatternIrrefutable(t)&&this._addError(ml.Diagnostic.orPatternIrrefutable(),t)}));const n=new Map;return e.forEach((e=>{this._getPatternTargetNames(e,n)})),e.forEach((e=>{const t=new Map;if(this._getPatternTargetNames(e,t),t.size<n.size){const i=Array.from(n.keys()).filter((e=>!t.has(e))),r=new il;r.addMessage(ml.DiagnosticAddendum.orPatternMissingName().format({name:i.map((e=>`"${e}"`)).join(", ")})),this._addError(ml.Diagnostic.orPatternMissingName()+r.getString(),e)}})),lr.create(e,t)}_parsePatternAtom(){const e=this._parsePatternLiteral();if(e)return e;const t=this._parsePatternCaptureOrValue();if(t){const e=this._peekToken();if(0===t.nodeType||!this._consumeTokenIfType(13))return t;const n=this._parseClassPatternArgList(),i=69===t.nodeType?t.target:t.expression,r=ur.create(i,n);return this._consumeTokenIfType(14)||(this._addError(ml.Diagnostic.expectedCloseParen(),e),this._consumeTokensUntilType([2]),Jn(r,this._peekToken())),r}const n=this._peekToken();if(26===this._peekOperatorType()){const e=this._getNextToken(),t=this._getTokenIfIdentifier();return t?dr.create(Ri.create(t),e):(this._addError(ml.Diagnostic.expectedIdentifier(),this._peekToken()),di.create(e,2))}if(13===n.type||15===n.type){const e=this._getNextToken(),t=this._parsePatternSequence();let i;if(t.parseError)i=t.parseError;else if(1!==t.list.length||t.trailingComma||13!==e.type)i=ar.create(e,t.list);else{const r=t.list[0].orPatterns[0];i=69===r.nodeType&&r.isStar?ar.create(e,t.list):t.list[0],Jn(i,n)}const r=this._peekToken();return this._consumeTokenIfType(13===n.type?14:16)?Jn(i,r):(this._addError(13===n.type?ml.Diagnostic.expectedCloseParen():ml.Diagnostic.expectedCloseBracket(),n),this._consumeTokensUntilType([10,13===n.type?14:16])),i}if(17===n.type){const e=this._getNextToken(),t=this._parsePatternMapping(e),i=this._peekToken();return this._consumeTokenIfType(18)?Jn(t,i):(this._addError(ml.Diagnostic.expectedCloseBrace(),n),this._consumeTokensUntilType([10,18])),t}return this._handleExpressionParseError(11,ml.Diagnostic.expectedPatternExpr())}_parseClassPatternArgList(){const e=[];let t=!1;for(;;){const n=this._peekTokenType();if(14===n||2===n||1===n)break;const i=this._parseClassPatternArgument();if(i.name?t=!0:t&&!i.name&&this._addError(ml.Diagnostic.positionArgAfterNamedArg(),i),e.push(i),!this._consumeTokenIfType(12))break}return e}_parseClassPatternArgument(){const e=this._peekToken(),t=this._peekToken(1);let n;7!==e.type&&8!==e.type||9!==t.type||2!==t.operatorType||(this._getNextToken(),n=Ri.create(e),this._getNextToken());const i=this._parsePatternAs();return pr.create(i,n)}_parsePatternLiteral(){const e=this._peekToken(),t=this._peekOperatorType();if(6===e.type||33===t)return this._parsePatternLiteralNumber();if(5===e.type){const e=this._parseAtom();return w(48===e.nodeType),e.strings.forEach((e=>{64&e.token.flags&&this._addError(ml.Diagnostic.formatStringInPattern(),e)})),cr.create(e)}if(8===e.type){const t=e;if(15===t.keywordType||33===t.keywordType||26===t.keywordType)return cr.create(this._parseAtom())}}_parsePatternLiteralNumber(){const e=this._parseArithmeticExpression();let t,n;return 7===e.nodeType?33!==e.operator&&0!==e.operator||(t=e.leftExpression,n=e.rightExpression):t=e,t&&(55===t.nodeType&&33===t.operator&&(t=t.expression),(40!==t.nodeType||void 0!==n&&t.isImaginary)&&(this._addError(ml.Diagnostic.expectedComplexNumberLiteral(),e),n=void 0)),n&&(55===n.nodeType&&33===n.operator&&(n=n.expression),40===n.nodeType&&n.isImaginary||this._addError(ml.Diagnostic.expectedComplexNumberLiteral(),e)),cr.create(e)}_parsePatternMapping(e){const t=this._parseExpressionListGeneric((()=>this._parsePatternMappingItem()));if(t.list.length>0){const n=t.list.filter((e=>72===e.nodeType));return n.length>1&&this._addError(ml.Diagnostic.duplicateStarStarPattern(),n[1]),hr.create(e,t.list)}return t.parseError||di.create(this._peekToken(),11)}_parsePatternMappingItem(){let e;const t=this._peekToken();if(this._consumeTokenIfOperator(29)){const e=this._getTokenIfIdentifier();if(!e)return this._addError(ml.Diagnostic.expectedIdentifier(),this._peekToken()),di.create(this._peekToken(),11);const n=Ri.create(e);return"_"===e.value&&this._addError(ml.Diagnostic.starStarWildcardNotAllowed(),n),fr.create(t,n)}const n=this._parsePatternLiteral();if(n)e=n;else{const t=this._parsePatternCaptureOrValue();t&&(73===t.nodeType?e=t:(this._addError(ml.Diagnostic.expectedPatternValue(),t),e=di.create(this._peekToken(),11)))}let i;return e||(this._addError(ml.Diagnostic.expectedPatternExpr(),this._peekToken()),e=di.create(this._peekToken(),11)),this._consumeTokenIfType(10)?i=this._parsePatternAs():(this._addError(ml.Diagnostic.expectedColon(),this._peekToken()),i=di.create(this._peekToken(),11)),mr.create(e,i)}_parsePatternCaptureOrValue(){const e=this._peekToken();if(7===e.type||8===e.type){let e;for(;;){const t=this._getTokenIfIdentifier();if(!t){this._addError(ml.Diagnostic.expectedIdentifier(),this._peekToken());break}{const n=Ri.create(t);e=e?Ai.create(e,n):n}if(!this._consumeTokenIfType(20))break}return e?35===e.nodeType?gr.create(e):dr.create(e):(this._addError(ml.Diagnostic.expectedIdentifier(),this._peekToken()),di.create(this._peekToken(),11))}}_parseIfStatement(e=20){const t=this._getKeywordToken(e),n=this._parseTestExpression(!0),i=this._parseSuite(this._isInFunction),r=Zn.create(t,n,i);return this._consumeTokenIfKeyword(13)?(r.elseSuite=this._parseSuite(this._isInFunction),r.elseSuite.parent=r,Jn(r,r.elseSuite)):12===this._peekKeywordType()&&(r.elseSuite=this._parseIfStatement(12),r.elseSuite.parent=r,Jn(r,r.elseSuite)),r}_parseLoopSuite(){const e=this._isInLoop,t=this._isInFinally;this._isInLoop=!0,this._isInFinally=!1;const n=this._parseSuite(this._isInFunction);return this._isInLoop=e,this._isInFinally=t,n}_parseSuite(e=!1,t=!1,n){const i=this._peekToken(),r=Qn.create(i);if(!this._consumeTokenIfType(10)&&(9===i.type?2===this._peekOperatorType()&&this._addError(ml.Diagnostic.expectedEqualityOperator(),i):this._addError(ml.Diagnostic.expectedColon(),i),this._consumeTokensUntilType([2,10])))if(10===this._peekTokenType())this._getNextToken();else if(3!==this._peekToken(1).type)return this._getNextToken(),r;if(t){if(this._consumeTokenIfType(2)){let e=0;for(;;){const t=this._getNextToken();if(3===t.type&&e++,4===t.type&&(t.isDedentAmbiguous&&this._addError(ml.Diagnostic.inconsistentTabs(),t),e--,0===e))break;if(1===t.type)break}}else this._parseSimpleStatement();return this._tokenIndex>0&&Jn(r,this._tokenizerOutput.tokens.getItemAt(this._tokenIndex-1)),r}n&&n();const s=this._isInFunction;if(this._isInFunction=e,this._consumeTokenIfType(2)){n&&n();const e=this._peekToken();if(this._consumeTokenIfType(3)){const t=e;t.isIndentAmbiguous&&this._addError(ml.Diagnostic.inconsistentTabs(),t)}else this._addError(ml.Diagnostic.expectedIndentedBlock(),this._peekToken());for(;;){const e=this._peekToken();if(3===e.type){this._getNextToken();const t=e;t.isIndentAmbiguous?this._addError(ml.Diagnostic.inconsistentTabs(),t):this._addError(ml.Diagnostic.unexpectedIndent(),e)}const t=this._parseStatement();t?(t.parent=r,r.statements.push(t)):this._consumeTokensUntilType([2]);const n=this._peekToken();if(this._consumeTokenIfType(4)){n.matchesIndent||this._addError(ml.Diagnostic.inconsistentIndent(),n),n.isDedentAmbiguous&&this._addError(ml.Diagnostic.inconsistentTabs(),n);break}if(1===this._peekTokenType())break}}else{const e=this._parseSimpleStatement();r.statements.push(e),e.parent=r}return r.statements.length>0&&Jn(r,r.statements[r.statements.length-1]),this._isInFunction=s,r}_parseForStatement(e){const t=this._getKeywordToken(17),n=this._parseExpressionListAsPossibleTuple(2,ml.Diagnostic.expectedExpr(),t);let i,r,s;if(this._consumeTokenIfKeyword(22)){if(i=this._parseTestOrStarListAsExpression(!1,!0,2,ml.Diagnostic.expectedInExpr()),r=this._parseLoopSuite(),this._getLanguageVersion()<De.V3_9&&!this._parseOptions.isStubFile&&52===i.nodeType&&!i.enclosedInParens){let e=!1;i.expressions.forEach((t=>{56!==t.nodeType||e||(this._addError(ml.Diagnostic.unpackOperatorNotAllowed(),t),e=!0)}))}this._consumeTokenIfKeyword(13)&&(s=this._parseSuite(this._isInFunction))}else i=this._handleExpressionParseError(0,ml.Diagnostic.expectedIn()),r=Qn.create(this._peekToken());const o=ei.create(t,n,i,r);return o.elseSuite=s,s&&(Jn(o,s),s.parent=o),e&&(o.isAsync=!0,o.asyncToken=e,Jn(o,e)),o}_tryParseListComprehension(e){const t=this._tryParseCompForStatement();if(!t)return;56===e.nodeType?this._addError(ml.Diagnostic.unpackIllegalInComprehension(),e):16===e.nodeType&&this._addError(ml.Diagnostic.dictExpandIllegalInComprehension(),e);const n=Ci.create(e),i=[t];for(;;){const e=this._tryParseCompForStatement()||this._tryParseCompIfStatement();if(!e)break;e.parent=n,i.push(e)}return n.forIfNodes=i,i.length>0&&(i.forEach((e=>{e.parent=n})),Jn(n,i[i.length-1])),n}_tryParseCompForStatement(){const e=this._peekKeywordType();if(3===e){const e=this._peekToken(1);if(8!==e.type||17!==e.keywordType)return}else if(17!==e)return;let t;3===this._peekKeywordType()&&(t=this._getKeywordToken(3));const n=this._getKeywordToken(17),i=this._parseExpressionListAsPossibleTuple(2,ml.Diagnostic.expectedExpr(),n);let r;this._consumeTokenIfKeyword(22)?this._disallowAssignmentExpression((()=>{r=this._parseOrTest()})):r=this._handleExpressionParseError(0,ml.Diagnostic.expectedIn());const s=ti.create(t||n,i,r);return t&&(s.isAsync=!0,s.asyncToken=t),s}_tryParseCompIfStatement(){if(20!==this._peekKeywordType())return;const e=this._getKeywordToken(20),t=this._tryParseLambdaExpression()||this._parseAssignmentExpression(!0);return ni.create(e,t)}_parseWhileStatement(){const e=this._getKeywordToken(35),t=Xn.create(e,this._parseTestExpression(!0),this._parseLoopSuite());return this._consumeTokenIfKeyword(13)&&(t.elseSuite=this._parseSuite(this._isInFunction),t.elseSuite.parent=t,Jn(t,t.elseSuite)),t}_parseTryStatement(){const e=this._getKeywordToken(34),t=this._parseSuite(this._isInFunction),n=ii.create(e,t);let i=!1;for(;;){const e=this._peekToken();if(!this._consumeTokenIfKeyword(14))break;const t=this._peekToken();let r,s,o=!1;if(this._consumeTokenIfOperator(26)&&(this._getLanguageVersion()<De.V3_11&&!this._parseOptions.isStubFile&&this._addError(ml.Diagnostic.exceptionGroupIncompatible(),t),o=!0),10!==this._peekTokenType())if(r=this._parseTestExpression(!0),this._consumeTokenIfKeyword(1))s=this._getTokenIfIdentifier(),s||this._addError(ml.Diagnostic.expectedNameAfterAs(),this._peekToken());else{const e=this._peekToken();this._consumeTokenIfType(12)&&(this._addError(ml.Diagnostic.expectedAsAfterException(),e),this._parseTestExpression(!1))}r?i&&this._addError(ml.Diagnostic.namedExceptAfterCatchAll(),r):(i&&this._addError(ml.Diagnostic.duplicateCatchAll(),e),i=!0);const a=this._parseSuite(this._isInFunction),l=ri.create(e,a,o);r&&(l.typeExpression=r,l.typeExpression.parent=l),s&&(l.name=Ri.create(s),l.name.parent=l),n.exceptClauses.push(l),l.parent=n}return n.exceptClauses.length>0&&(Jn(n,n.exceptClauses[n.exceptClauses.length-1]),this._consumeTokenIfKeyword(13)&&(n.elseSuite=this._parseSuite(this._isInFunction),n.elseSuite.parent=n,Jn(n,n.elseSuite))),this._consumeTokenIfKeyword(16)&&(n.finallySuite=this._parseSuite(this._isInFunction),n.finallySuite.parent=n,Jn(n,n.finallySuite)),n.finallySuite||0!==n.exceptClauses.length||this._addError(ml.Diagnostic.tryWithoutExcept(),e),n}_parseFunctionDef(e,t){const n=this._getKeywordToken(10),i=this._getTokenIfIdentifier();if(!i)return this._addError(ml.Diagnostic.expectedFunctionName(),n),di.create(n,10,void 0,t);const r=this._peekToken();if(!this._consumeTokenIfType(13))return this._addError(ml.Diagnostic.expectedOpenParen(),this._peekToken()),di.create(i,10,Ri.create(i),t);const s=this._parseVarArgsList(14,!0);let o,a;this._consumeTokenIfType(14)||(this._addError(ml.Diagnostic.expectedCloseParen(),r),this._consumeTokensUntilType([10])),this._consumeTokenIfType(21)&&(o=this._parseTypeAnnotation());const l=this._parseSuite(!0,this._parseOptions.skipFunctionAndClassBody,(()=>{a||(a=this._getTypeAnnotationCommentText())})),c=si.create(n,Ri.create(i),l);return e&&(c.isAsync=!0,Jn(c,e)),c.parameters=s,s.forEach((e=>{e.parent=c})),t&&(c.decorators=t,t.forEach((e=>{e.parent=c})),t.length>0&&Jn(c,t[0])),o&&(c.returnTypeAnnotation=o,c.returnTypeAnnotation.parent=c,Jn(c,o)),a&&this._parseFunctionTypeAnnotationComment(a,c),c}_parseVarArgsList(e,t){const n=new Map,i=[];let r=!1,s=!1,o=!1,a=!1,l=!1,c=!1;for(;this._peekTokenType()!==e;){const u=this._parseParameter(t);if(!u){this._consumeTokensUntilType([e]);break}if(u.name){const e=u.name.value;n.has(e)?this._addError(ml.Diagnostic.duplicateParam().format({name:e}),u.name):n.set(e,e)}else 0===u.category&&0===i.length&&this._addError(ml.Diagnostic.positionOnlyFirstParam(),u);0===u.category&&(u.name?u.defaultValue?r=!0:!r||o||l||s||(this._addError(ml.Diagnostic.nonDefaultAfterDefault(),u),s=!0):(a?this._addError(ml.Diagnostic.duplicatePositionOnly(),u):o?this._addError(ml.Diagnostic.positionOnlyAfterKeywordOnly(),u):l&&this._addError(ml.Diagnostic.positionOnlyAfterArgs(),u),a=!0)),i.push(u),1===u.category&&(u.name?((o||l)&&this._addError(ml.Diagnostic.duplicateArgsParam(),u),l=!0):(o?this._addError(ml.Diagnostic.duplicateKeywordOnly(),u):l&&this._addError(ml.Diagnostic.keywordOnlyAfterArgs(),u),o=!0)),2===u.category?(c&&this._addError(ml.Diagnostic.duplicateKwargsParam(),u),c=!0):c&&this._addError(ml.Diagnostic.paramAfterKwargsParam(),u);const p=this._consumeTokenIfType(12);if(t&&!u.typeAnnotation){const e=this._parseVariableTypeAnnotationComment();e&&(u.typeAnnotationComment=e,u.typeAnnotationComment.parent=u,Jn(u,u.typeAnnotationComment))}if(!p)break}if(i.length>0){const e=i[i.length-1];1!==e.category||e.name||this._addError(ml.Diagnostic.expectedNamedParameter(),e)}return i}_parseParameter(e){let t=0,n=0;const i=this._peekToken();this._consumeTokenIfOperator(26)?t=1:this._consumeTokenIfOperator(29)?t=2:this._consumeTokenIfOperator(10)&&(this._getLanguageVersion()<De.V3_8&&!this._parseOptions.isStubFile&&this._addError(ml.Diagnostic.positionOnlyIncompatible(),i),n=1);const r=this._getTokenIfIdentifier();if(!r){if(1===t)return oi.create(i,1);if(1===n)return oi.create(i,0);if(13===this._peekTokenType()){const e=this._getNextToken();this._consumeTokensUntilType([14])&&this._getNextToken(),this._addError(ml.Diagnostic.sublistParamsIncompatible(),e)}else this._addError(ml.Diagnostic.expectedParamName(),this._peekToken())}let s=0;1===t?s=1:2===t&&(s=2);const o=oi.create(i,s);return r&&(o.name=Ri.create(r),o.name.parent=o,Jn(o,r)),e&&this._consumeTokenIfType(10)&&(o.typeAnnotation=this._parseTypeAnnotation(1===s),o.typeAnnotation.parent=o,Jn(o,o.typeAnnotation)),this._consumeTokenIfOperator(2)&&(o.defaultValue=this._parseTestExpression(!1),o.defaultValue.parent=o,Jn(o,o.defaultValue),t>0&&this._addError(ml.Diagnostic.defaultValueNotAllowed(),o.defaultValue)),o}_parseWithStatement(e){const t=this._getKeywordToken(36);let n=[];const i=this._peekToken();let r=!1;if(13===i.type){const e=this._tokenIndex;this._suppressErrors((()=>{for(this._getNextToken();n.push(this._parseWithItem()),this._consumeTokenIfType(12)&&14!==this._peekToken().type;);14===this._peekToken().type&&10===this._peekToken(1).type&&(r=1!==n.length||void 0!==n[0].target),this._tokenIndex=e,n=[]}))}for(r&&(this._consumeTokenIfType(13),this._getLanguageVersion()<De.V3_9&&this._addError(ml.Diagnostic.parenthesizedContextManagerIllegal(),i));n.push(this._parseWithItem()),this._consumeTokenIfType(12)&&14!==this._peekToken().type;);r&&(this._consumeTokenIfType(14)||this._addError(ml.Diagnostic.expectedCloseParen(),i));const s=this._parseSuite(this._isInFunction),o=li.create(t,s);return e&&(o.isAsync=!0,o.asyncToken=e,Jn(o,e)),o.withItems=n,n.forEach((e=>{e.parent=o})),o}_parseWithItem(){const e=this._parseTestExpression(!0),t=ci.create(e);return this._consumeTokenIfKeyword(1)&&(t.target=this._parseExpression(!1),t.target.parent=t,Jn(t,t.target)),t}_parseDecorated(){const e=[];for(;22===this._peekOperatorType();)e.push(this._parseDecorator());const t=this._peekToken();if(8===t.type)if(3===t.keywordType){if(this._getNextToken(),10===this._peekKeywordType())return this._parseFunctionDef(t,e);this._addError(ml.Diagnostic.expectedFunctionAfterAsync(),this._peekToken())}else{if(10===t.keywordType)return this._parseFunctionDef(void 0,e);if(7===t.keywordType)return this._parseClassDef(e)}return this._addError(ml.Diagnostic.expectedAfterDecorator(),this._peekToken()),ai.createDummyForDecorators(e)}_parseDecorator(){const e=this._getNextToken();w(22===e.operatorType);const t=this._parseTestExpression(!0);if(this._getLanguageVersion()<De.V3_9){let e=!1;(this._isNameOrMemberAccessExpression(t)||9===t.nodeType&&this._isNameOrMemberAccessExpression(t.leftExpression))&&(e=!0),e||this._addError(ml.Diagnostic.expectedDecoratorExpr(),t)}const n=ui.create(e,t);return this._consumeTokenIfType(2)||(this._addError(ml.Diagnostic.expectedDecoratorNewline(),this._peekToken()),this._consumeTokensUntilType([2])),n}_isNameOrMemberAccessExpression(e){return 38===e.nodeType||35===e.nodeType&&this._isNameOrMemberAccessExpression(e.leftExpression)}_parseClassDef(e){const t=this._getKeywordToken(7);let n=this._getTokenIfIdentifier();n||(this._addError(ml.Diagnostic.expectedClassName(),this._peekToken()),n=fc.create(0,0,"",void 0));let i=[];const r=this._peekToken();this._consumeTokenIfType(13)&&(i=this._parseArgList().args,this._consumeTokenIfType(14)||this._addError(ml.Diagnostic.expectedCloseParen(),r));const s=this._parseSuite(!1,this._parseOptions.skipFunctionAndClassBody),o=ai.create(t,Ri.create(n),s);return o.arguments=i,i.forEach((e=>{e.parent=o})),e&&(o.decorators=e,e.length>0&&(e.forEach((e=>{e.parent=o})),Jn(o,e[0]))),o}_parsePassStatement(){return Hi.create(this._getKeywordToken(30))}_parseBreakStatement(){const e=this._getKeywordToken(5);return this._isInLoop||this._addError(ml.Diagnostic.breakOutsideLoop(),e),tr.create(e)}_parseContinueStatement(){const e=this._getKeywordToken(8);return this._isInLoop?this._isInFinally&&this._addError(ml.Diagnostic.continueInFinally(),e):this._addError(ml.Diagnostic.continueOutsideLoop(),e),nr.create(e)}_parseReturnStatement(){const e=this._getKeywordToken(32),t=ir.create(e);if(this._isInFunction||this._addError(ml.Diagnostic.returnOutsideFunction(),e),!this._isNextTokenNeverExpression()){const e=this._parseTestOrStarListAsExpression(!0,!0,2,ml.Diagnostic.expectedReturnExpr());this._reportConditionalErrorForStarTupleElement(e),t.returnExpression=e,t.returnExpression.parent=t,Jn(t,e)}return t}_parseFromStatement(){const e=this._getKeywordToken(18),t=this._parseDottedModuleName(!0),n=Yi.create(e,t),i=0===t.leadingDots&&1===t.nameParts.length&&"__future__"===t.nameParts[0].value,r=this._peekToken();if(this._consumeTokenIfKeyword(21)){Jn(n,r);const e=this._peekToken();if(this._consumeTokenIfOperator(26))Jn(n,e),n.isWildcardImport=!0,n.wildcardToken=e,this._containsWildcardImport=!0;else{const e=this._peekToken(),t=this._consumeTokenIfType(13);let r;for(;;){const e=this._getTokenIfIdentifier();if(!e)break;r=void 0;const t=Qi.create(Ri.create(e));if(this._consumeTokenIfKeyword(1)){const e=this._getTokenIfIdentifier();e?(t.alias=Ri.create(e),t.alias.parent=t,Jn(t,e)):this._addError(ml.Diagnostic.expectedImportAlias(),this._peekToken())}n.imports.push(t),t.parent=n,Jn(n,t),i&&this._futureImportMap.set(e.value,!0);const s=this._peekToken();if(!this._consumeTokenIfType(12))break;r=s}if(0===n.imports.length&&this._addError(ml.Diagnostic.expectedImportSymbols(),this._peekToken()),t){n.usesParens=!0;const t=this._peekToken();this._consumeTokenIfType(14)?Jn(n,t):this._addError(ml.Diagnostic.expectedCloseParen(),e)}else r&&this._addError(ml.Diagnostic.trailingCommaInFromImport(),r)}}else this._addError(ml.Diagnostic.expectedImport(),this._peekToken()),t.hasTrailingDot||(n.missingImportKeyword=!0);this._importedModules.push({nameNode:n.module,leadingDots:n.module.leadingDots,nameParts:n.module.nameParts.map((e=>e.value)),importedSymbols:n.imports.map((e=>e.name.value))});let s=!1;if(1===n.module.nameParts.length){const e=n.module.nameParts[0].value;"typing"!==e&&"typing_extensions"!==e||(s=!0)}if(s){const e=["Literal","TypeAlias","Annotated"];n.isWildcardImport?e.forEach((e=>{this._typingSymbolAliases.set(e,e)})):n.imports.forEach((t=>{var n;e.some((e=>e===t.name.value))&&this._typingSymbolAliases.set((null===(n=t.alias)||void 0===n?void 0:n.value)||t.name.value,t.name.value)}))}return n}_parseImportStatement(){var e;const t=this._getKeywordToken(21),n=Gi.create(t);for(;;){const t=this._parseDottedModuleName(),i=Ji.create(t);if(this._consumeTokenIfKeyword(1)){const e=this._getTokenIfIdentifier();e?(i.alias=Ri.create(e),i.alias.parent=i,Jn(i,i.alias)):this._addError(ml.Diagnostic.expectedImportAlias(),this._peekToken())}if(i.module.leadingDots>0&&this._addError(ml.Diagnostic.relativeImportNotAllowed(),i.module),n.list.push(i),i.parent=n,this._importedModules.push({nameNode:i.module,leadingDots:i.module.leadingDots,nameParts:i.module.nameParts.map((e=>e.value)),importedSymbols:void 0}),1===t.nameParts.length){const n=t.nameParts[0].value;"typing"!==n&&"typing_extensions"!==n||this._typingImportAliases.push((null===(e=i.alias)||void 0===e?void 0:e.value)||n)}if(!this._consumeTokenIfType(12))break}return n.list.length>0&&Jn(n,n.list[n.list.length-1]),n}_parseDottedModuleName(e=!1){var t;const n=Ki.create(this._peekToken());for(;;){const e=null!==(t=this._getTokenIfType(19))&&void 0!==t?t:this._getTokenIfType(20);if(!e)break;19===e.type?n.leadingDots+=3:n.leadingDots++,Jn(n,e)}for(;;){const t=this._getTokenIfIdentifier();if(!t){(!e||0===n.leadingDots||n.nameParts.length>0)&&(this._addError(ml.Diagnostic.expectedModuleName(),this._peekToken()),n.hasTrailingDot=!0);break}const i=Ri.create(t);n.nameParts.push(i),i.parent=n,Jn(n,i);const r=this._peekToken();if(!this._consumeTokenIfType(20))break;Jn(n,r)}return n}_parseGlobalStatement(){const e=this._getKeywordToken(19),t=Zi.create(e);return t.nameList=this._parseNameList(),t.nameList.length>0&&(t.nameList.forEach((e=>{e.parent=t})),Jn(t,t.nameList[t.nameList.length-1])),t}_parseNonlocalStatement(){const e=this._getKeywordToken(27),t=Xi.create(e);return t.nameList=this._parseNameList(),t.nameList.length>0&&(t.nameList.forEach((e=>{e.parent=t})),Jn(t,t.nameList[t.nameList.length-1])),t}_parseNameList(){const e=[];for(;;){const t=this._getTokenIfIdentifier();if(!t){this._addError(ml.Diagnostic.expectedIdentifier(),this._peekToken());break}if(e.push(Ri.create(t)),!this._consumeTokenIfType(12))break}return e}_parseRaiseStatement(){const e=this._getKeywordToken(31),t=rr.create(e);return this._isNextTokenNeverExpression()||(t.typeExpression=this._parseTestExpression(!0),t.typeExpression.parent=t,Jn(t,t.typeExpression),this._consumeTokenIfKeyword(18)?(t.valueExpression=this._parseTestExpression(!0),t.valueExpression.parent=t,Jn(t,t.valueExpression)):this._consumeTokenIfType(12)&&(t.valueExpression=this._parseTestExpression(!0),t.valueExpression.parent=t,Jn(t,t.valueExpression),this._consumeTokenIfType(12)&&(t.tracebackExpression=this._parseTestExpression(!0),t.tracebackExpression.parent=t,Jn(t,t.tracebackExpression)))),t}_parseAssertStatement(){const e=this._getKeywordToken(2),t=this._parseTestExpression(!0),n=er.create(e,t);if(this._consumeTokenIfType(12)){const e=this._parseTestExpression(!0);n.exceptionExpression=e,n.exceptionExpression.parent=n,Jn(n,e)}return n}_parseDelStatement(){const e=this._getKeywordToken(11),t=this._parseExpressionList(!0);t.parseError||0!==t.list.length||this._addError(ml.Diagnostic.expectedDelExpr(),this._peekToken());const n=$i.create(e);return n.expressions=t.list,n.expressions.length>0&&(n.expressions.forEach((e=>{e.parent=n})),Jn(n,n.expressions[n.expressions.length-1])),n}_parseYieldExpression(){const e=this._getKeywordToken(37),t=this._peekToken();if(this._consumeTokenIfKeyword(18))return this._getLanguageVersion()<De.V3_3&&this._addError(ml.Diagnostic.yieldFromIllegal(),t),Di.create(e,this._parseTestExpression(!0));let n;return this._isNextTokenNeverExpression()||(n=this._parseTestOrStarListAsExpression(!0,!0,2,ml.Diagnostic.expectedYieldExpr()),this._reportConditionalErrorForStarTupleElement(n)),ki.create(e,n)}_tryParseYieldExpression(){if(37===this._peekKeywordType())return this._parseYieldExpression()}_parseSimpleStatement(){const e=pi.create(this._peekToken());for(;;){if(0===this._peekTokenType()){const e=this._getNextToken(),t=this._fileContents.substr(e.start,e.length).charCodeAt(0);this._addError(ml.Diagnostic.invalidTokenChars().format({text:`\\u${t.toString(16)}`}),e),this._consumeTokensUntilType([2]);break}const t=this._parseSmallStatement();if(e.statements.push(t),t.parent=e,Jn(e,t),0===t.nodeType)break;if(!this._consumeTokenIfType(11))break;const n=this._peekTokenType();if(2===n||1===n)break}return this._consumeTokenIfType(2)||this._addError(ml.Diagnostic.expectedNewlineOrSemicolon(),this._peekToken()),e}_parseSmallStatement(){switch(this._peekKeywordType()){case 30:return this._parsePassStatement();case 5:return this._parseBreakStatement();case 8:return this._parseContinueStatement();case 32:return this._parseReturnStatement();case 18:return this._parseFromStatement();case 21:return this._parseImportStatement();case 19:return this._parseGlobalStatement();case 27:return this._parseNonlocalStatement();case 31:return this._parseRaiseStatement();case 2:return this._parseAssertStatement();case 11:return this._parseDelStatement();case 37:return this._parseYieldExpression()}return this._parseExpressionStatement()}_makeExpressionOrTuple(e,t){if(1===e.list.length&&!e.trailingComma)return 56===e.list[0].nodeType&&this._addError(ml.Diagnostic.unpackOperatorNotAllowed(),e.list[0]),e.list[0];const n=e.list.length>0?e.list[0]:this._peekToken(-1),i=Si.create(n,t);return i.expressions=e.list,e.list.length>0&&(e.list.forEach((e=>{e.parent=i})),Jn(i,e.list[e.list.length-1])),i}_parseExpressionListAsPossibleTuple(e,t,n){if(this._isNextTokenNeverExpression())return this._addError(t,n),di.create(n,e);const i=this._parseExpressionList(!0);return i.parseError?i.parseError:this._makeExpressionOrTuple(i,!1)}_parseTestListAsExpression(e,t){if(this._isNextTokenNeverExpression())return this._handleExpressionParseError(e,t);const n=this._parseTestExpressionList();return n.parseError?n.parseError:this._makeExpressionOrTuple(n,!1)}_parseTestOrStarListAsExpression(e,t,n,i){if(this._isNextTokenNeverExpression())return this._handleExpressionParseError(n,i);const r=this._parseTestOrStarExpressionList(e,t);return r.parseError?r.parseError:this._makeExpressionOrTuple(r,!1)}_parseExpressionList(e){return this._parseExpressionListGeneric((()=>this._parseExpression(e)))}_parseTestExpressionList(){return this._parseExpressionListGeneric((()=>this._parseTestExpression(!1)))}_parseTestOrStarExpressionList(e,t){const n=this._parseExpressionListGeneric((()=>this._parseTestOrStarExpression(e)));if(!t&&!n.parseError){let e=!1;for(const t of n.list)if(56===t.nodeType){if(e){this._addError(ml.Diagnostic.duplicateUnpack(),t);break}e=!0}}return n}_parseExpression(e){const t=this._peekToken();return e&&this._consumeTokenIfOperator(26)?Ii.create(t,this._parseExpression(!1)):this._parseBitwiseOrExpression()}_parseTestOrStarExpression(e){return 26===this._peekOperatorType()?this._parseExpression(!0):this._parseTestExpression(e)}_parseTestExpression(e){if(24===this._peekKeywordType())return this._parseLambdaExpression();const t=e?this._parseAssignmentExpression():this._parseOrTest();if(0===t.nodeType)return t;if(!this._consumeTokenIfKeyword(20))return t;const n=this._parseOrTest();if(0===n.nodeType)return n;if(!this._consumeTokenIfKeyword(13))return this._handleExpressionParseError(1,ml.Diagnostic.expectedElse());const i=this._parseTestExpression(!0);return 0===i.nodeType?i:bi.create(t,n,i)}_parseAssignmentExpression(e=!1){const t=this._parseOrTest();if(0===t.nodeType)return t;if(38!==t.nodeType)return t;const n=this._peekToken();if(!this._consumeTokenIfOperator(35))return t;(!this._assignmentExpressionsAllowed||this._isParsingTypeAnnotation||e)&&this._addError(ml.Diagnostic.walrusNotAllowed(),n),this._getLanguageVersion()<De.V3_8&&this._addError(ml.Diagnostic.walrusIllegal(),n);const i=this._parseTestExpression(!1);return fi.create(t,i)}_parseOrTest(){let e=this._parseAndTest();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfKeyword(29))break;const n=this._parseAndTest();e=this._createBinaryOperationNode(e,n,t,37)}return e}_parseAndTest(){let e=this._parseNotTest();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfKeyword(0))break;const n=this._parseNotTest();e=this._createBinaryOperationNode(e,n,t,36)}return e}_parseNotTest(){const e=this._peekToken();if(this._consumeTokenIfKeyword(28)){const t=this._parseNotTest();return this._createUnaryOperationNode(e,t,38)}return this._parseComparison()}_parseComparison(){let e=this._parseBitwiseOrExpression();if(0===e.nodeType)return e;for(;;){let t;const n=this._peekToken();if(Kc.isOperatorComparison(this._peekOperatorType()))t=this._peekOperatorType(),19===t&&(this._addError(ml.Diagnostic.operatorLessOrGreaterDeprecated(),n),t=28),this._getNextToken();else if(this._consumeTokenIfKeyword(22))t=41;else if(this._consumeTokenIfKeyword(23))t=this._consumeTokenIfKeyword(28)?40:39;else if(28===this._peekKeywordType()){const e=this._peekToken(1);8===e.type&&22===e.keywordType&&(this._getNextToken(),this._getNextToken(),t=42)}if(void 0===t)break;const i=this._parseComparison();e=this._createBinaryOperationNode(e,i,n,t)}return e}_parseBitwiseOrExpression(){let e=this._parseBitwiseXorExpression();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfOperator(6))break;const n=this._parseBitwiseXorExpression();e=this._createBinaryOperationNode(e,n,t,6)}return e}_parseBitwiseXorExpression(){let e=this._parseBitwiseAndExpression();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfOperator(8))break;const n=this._parseBitwiseAndExpression();e=this._createBinaryOperationNode(e,n,t,8)}return e}_parseBitwiseAndExpression(){let e=this._parseShiftExpression();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfOperator(3))break;const n=this._parseShiftExpression();e=this._createBinaryOperationNode(e,n,t,3)}return e}_parseShiftExpression(){let e=this._parseArithmeticExpression();if(0===e.nodeType)return e;let t=this._peekToken(),n=this._peekOperatorType();for(;17===n||31===n;){this._getNextToken();const i=this._parseArithmeticExpression();e=this._createBinaryOperationNode(e,i,t,n),t=this._peekToken(),n=this._peekOperatorType()}return e}_parseArithmeticExpression(){let e=this._parseArithmeticTerm();if(0===e.nodeType)return e;let t=this._peekToken(),n=this._peekOperatorType();for(;0===n||33===n;){this._getNextToken();const i=this._parseArithmeticTerm();if(0===i.nodeType)return i;e=this._createBinaryOperationNode(e,i,t,n),t=this._peekToken(),n=this._peekOperatorType()}return e}_parseArithmeticTerm(){let e=this._parseArithmeticFactor();if(0===e.nodeType)return e;let t=this._peekToken(),n=this._peekOperatorType();for(;26===n||22===n||10===n||24===n||13===n;){this._getNextToken();const i=this._parseArithmeticFactor();e=this._createBinaryOperationNode(e,i,t,n),t=this._peekToken(),n=this._peekOperatorType()}return e}_parseArithmeticFactor(){const e=this._peekToken(),t=this._peekOperatorType();if(0===t||33===t||5===t){this._getNextToken();const n=this._parseArithmeticFactor();return this._createUnaryOperationNode(e,n,t)}const n=this._parseAtomExpression();if(0===n.nodeType)return n;const i=this._peekToken();if(this._consumeTokenIfOperator(29)){const e=this._parseArithmeticFactor();return this._createBinaryOperationNode(n,e,i,29)}return n}_isTypingAnnotation(e,t){if(38===e.nodeType){if(this._typingSymbolAliases.get(e.value)===t)return!0}else if(35===e.nodeType&&38===e.leftExpression.nodeType&&e.memberName.value===t){const t=e.leftExpression.value;return this._typingImportAliases.some((e=>e===t))}return!1}_parseAtomExpression(){let e;4!==this._peekKeywordType()||this._isParsingTypeAnnotation||(e=this._getKeywordToken(4),this._getLanguageVersion()<De.V3_5&&this._addError(ml.Diagnostic.awaitIllegal(),e));let t=this._parseAtom();if(0===t.nodeType)return t;for(;;){const e=this._peekToken();if(this._consumeTokenIfType(13)){const n=this._isParsingTypeAnnotation;this._isParsingTypeAnnotation=!1;const i=this._parseArgList(),r=xi.create(t,i.args,i.trailingComma);(i.args.length>1||i.trailingComma)&&i.args.forEach((e=>{32===e.valueExpression.nodeType&&(e.valueExpression.isParenthesized||this._addError(ml.Diagnostic.generatorNotParenthesized(),e.valueExpression))}));const s=this._peekToken();let o=!1;if(this._consumeTokenIfType(14)?(Jn(r,s),o=!0):(this._addError(ml.Diagnostic.expectedCloseParen(),e),this._consumeTokensUntilType([2]),Jn(r,this._peekToken())),this._isParsingTypeAnnotation=n,this._isParsingTypeAnnotation){const e=new il;38===t.nodeType&&"type"===t.value&&(e.addMessage(ml.DiagnosticAddendum.useTypeInstead()),this._addError(ml.Diagnostic.typeCallNotAllowed()+e.getString(),r))}if(t=r,void 0!==t.maxChildDepth&&t.maxChildDepth>=Yc&&(t=di.create(t,14),this._addError(ml.Diagnostic.maxParseDepthExceeded(),t)),!o)break}else if(this._consumeTokenIfType(15)){const n=this._isParsingIndexTrailer,i=this._isParsingTypeAnnotation;(this._isTypingAnnotation(t,"Literal")||this._isTypingAnnotation(t,"Annotated"))&&(this._isParsingTypeAnnotation=!1),this._isParsingIndexTrailer=!0;const r=this._parseSubscriptList();this._isParsingTypeAnnotation=i,this._isParsingIndexTrailer=n;const s=this._peekToken(),o=wi.create(t,r.list,r.trailingComma,s);Jn(o,o),this._consumeTokenIfType(16)||this._handleExpressionParseError(6,ml.Diagnostic.expectedCloseBracket(),e,o),t=o,void 0!==t.maxChildDepth&&t.maxChildDepth>=Yc&&(t=di.create(t,14),this._addError(ml.Diagnostic.maxParseDepthExceeded(),t))}else{if(!this._consumeTokenIfType(20))break;{const n=this._getTokenIfIdentifier();if(!n)return this._handleExpressionParseError(7,ml.Diagnostic.expectedMemberName(),e,t);t=Ai.create(t,Ri.create(n)),void 0!==t.maxChildDepth&&t.maxChildDepth>=Yc&&(t=di.create(t,14),this._addError(ml.Diagnostic.maxParseDepthExceeded(),t))}}}return e?Ti.create(e,t):t}_parseSubscriptList(){const e=[];let t=!1,n=!1;for(;;){const i=this._peekToken();if(10!==i.type&&this._isNextTokenNeverExpression())break;let r=0;this._consumeTokenIfOperator(26)?r=1:this._consumeTokenIfOperator(29)&&(r=2);const s=this._tokenIndex;let o,a=this._parsePossibleSlice();if(0===r)if(this._consumeTokenIfOperator(2)){const e=a;a=this._parsePossibleSlice(),38===e.nodeType?o=e.token:this._addError(ml.Diagnostic.expectedParamName(),e)}else 38===a.nodeType&&35===this._peekOperatorType()&&(this._tokenIndex=s,a=this._parseTestExpression(!0),!this._parseOptions.isStubFile&&this._getLanguageVersion()<De.V3_10&&this._addError(ml.Diagnostic.assignmentExprInSubscript(),a));const l=zi.create(i,a,r);if(o&&(l.name=Ri.create(o),l.name.parent=l),l.name?t=!0:t&&0===l.argumentCategory&&this._addError(ml.Diagnostic.positionArgAfterNamedArg(),l),e.push(l),l.name&&this._addError(ml.Diagnostic.keywordSubscriptIllegal(),l.name),0!==r){const e=this._parseOptions.isStubFile||this._getLanguageVersion()>=De.V3_11;2!==r&&e||this._addError(ml.Diagnostic.unpackedSubscriptIllegal(),l)}if(!this._consumeTokenIfType(12)){n=!1;break}n=!0}if(0===e.length){const t=this._handleExpressionParseError(3,ml.Diagnostic.expectedSliceIndex(),void 0,void 0,[16]);e.push(zi.create(this._peekToken(),t,0))}return{list:e,trailingComma:n}}_parsePossibleSlice(){const e=this._peekToken(),t=[void 0,void 0,void 0];let n=0,i=!1;for(;;){const e=this._peekTokenType();if(16===e||12===e)break;if(10!==e&&(t[n]=this._parseTestExpression(!1)),n++,n>=3||!this._consumeTokenIfType(10))break;i=!0}if(!i)return t[0]?t[0]:di.create(this._peekToken(),3);const r=Ei.create(e);r.startValue=t[0],r.startValue&&(r.startValue.parent=r),r.endValue=t[1],r.endValue&&(r.endValue.parent=r),r.stepValue=t[2],r.stepValue&&(r.stepValue.parent=r);const s=t[2]||t[1]||t[0];return s&&Jn(r,s),r}_parseArgList(){const e=[];let t=!1,n=!1;for(;;){const i=this._peekTokenType();if(14===i||2===i||1===i)break;n=!1;const r=this._parseArgument();if(r.name?t=!0:t&&0===r.argumentCategory&&this._addError(ml.Diagnostic.positionArgAfterNamedArg(),r),e.push(r),!this._consumeTokenIfType(12))break;n=!0}return{args:e,trailingComma:n}}_parseArgument(){const e=this._peekToken();let t=0;this._consumeTokenIfOperator(26)?t=1:this._consumeTokenIfOperator(29)&&(t=2);let n,i=this._parseTestExpression(!0);if(0===t)if(this._consumeTokenIfOperator(2)){const e=i;i=this._parseTestExpression(!1),38===e.nodeType?n=e.token:this._addError(ml.Diagnostic.expectedParamName(),e)}else{const e=this._tryParseListComprehension(i);e&&(i=e)}const r=zi.create(e,i,t);return n&&(r.name=Ri.create(n),r.name.parent=r),r}_parseAtom(){const e=this._peekToken();if(19===e.type)return Ni.create(this._getNextToken());if(6===e.type)return Mi.create(this._getNextToken());if(7===e.type)return Ri.create(this._getNextToken());if(5===e.type)return this._parseStringList();if(22===e.type){this._getNextToken(),this._addError(ml.Diagnostic.backticksIllegal(),e);const t=this._parseTestListAsExpression(2,ml.Diagnostic.expectedExpr());return this._consumeTokenIfType(22),t}if(13===e.type){const e=this._parseTupleAtom();if(52===e.nodeType&&this._isParsingTypeAnnotation&&!this._isParsingIndexTrailer){const t=new il;t.addMessage(ml.DiagnosticAddendum.useTupleInstead()),this._addError(ml.Diagnostic.tupleInAnnotation()+t.getString(),e)}return 7===e.nodeType&&(e.parenthesized=!0),48===e.nodeType&&(e.isParenthesized=!0),32===e.nodeType&&(e.isParenthesized=!0),e}if(15===e.type){const e=this._parseListAtom();if(this._isParsingTypeAnnotation&&!this._isParsingIndexTrailer){const t=new il;t.addMessage(ml.DiagnosticAddendum.useListInstead()),this._addError(ml.Diagnostic.listInAnnotation()+t.getString(),e)}return e}if(17===e.type){const e=this._parseDictionaryOrSetAtom();if(this._isParsingTypeAnnotation){const t=new il;t.addMessage(ml.DiagnosticAddendum.useDictInstead()),this._addError(ml.Diagnostic.dictInAnnotation()+t.getString(),e)}return e}if(8===e.type){const t=e;if(15===t.keywordType||33===t.keywordType||9===t.keywordType||26===t.keywordType)return Fi.create(this._getNextToken());const n=this._getTokenIfIdentifier();if(n)return Ri.create(n)}return this._handleExpressionParseError(2,ml.Diagnostic.expectedExpr())}_handleExpressionParseError(e,t,n,i,r){this._addError(t,null!=n?n:this._peekToken());const s=di.create(this._peekToken(),e,i),o=[2];return r&&o.push(...r),this._consumeTokensUntilType(o),s}_parseLambdaExpression(e=!0){const t=this._getKeywordToken(24),n=this._parseVarArgsList(10,!1);let i;this._consumeTokenIfType(10)||this._addError(ml.Diagnostic.expectedColon(),this._peekToken()),i=e?this._parseTestExpression(!1):this._tryParseLambdaExpression(!1)||this._parseOrTest();const r=Pi.create(t,i);return r.parameters=n,n.forEach((e=>{e.parent=r})),r}_tryParseLambdaExpression(e=!0){if(24===this._peekKeywordType())return this._parseLambdaExpression(e)}_parseTupleAtom(){var e;const t=this._getNextToken();w(13===t.type);const n=this._tryParseYieldExpression();if(n)return 14!==this._peekTokenType()?this._handleExpressionParseError(8,ml.Diagnostic.expectedCloseParen(),t,n):(Jn(n,this._getNextToken()),n);const i=this._parseTestListWithComprehension(),r=this._makeExpressionOrTuple(i,!0),s=1===i.list.length&&!i.trailingComma;if(s||Jn(r,t),14!==this._peekTokenType())return this._handleExpressionParseError(8,ml.Diagnostic.expectedCloseParen(),t,null!==(e=i.parseError)&&void 0!==e?e:r);{const e=this._getNextToken();s||Jn(r,e)}return r}_parseListAtom(){var e;const t=this._getNextToken();w(15===t.type);const n=this._parseTestListWithComprehension(),i=this._peekToken();return this._consumeTokenIfType(16)?r():this._handleExpressionParseError(9,ml.Diagnostic.expectedCloseBracket(),t,null!==(e=n.parseError)&&void 0!==e?e:r());function r(){const e=ji.create(t);return i&&Jn(e,i),n.list.length>0&&(n.list.forEach((t=>{t.parent=e})),Jn(e,n.list[n.list.length-1])),e.entries=n.list,e}}_parseTestListWithComprehension(){let e=!1;return this._parseExpressionListGeneric((()=>{let t=this._parseTestOrStarExpression(!0);const n=this._tryParseListComprehension(t);return n&&(t=n,e=!0),t}),(()=>this._isNextTokenNeverExpression()),(()=>e))}_parseDictionaryOrSetAtom(){const e=this._getNextToken();w(17===e.type);const t=[],n=[];let i,r=!1,s=!1,o=!1,a=!0;for(;18!==this._peekTokenType();){let e,l,c;i=void 0;const u=this._peekToken();if(this._consumeTokenIfOperator(29)?e=this._parseExpression(!1):(l=this._parseTestOrStarExpression(!0),this._consumeTokenIfType(10)&&(c=this._parseTestExpression(!1))),l&&c)if(56===l.nodeType&&this._addError(ml.Diagnostic.unpackInDict(),l),s)this._addError(ml.Diagnostic.keyValueInSet(),c);else{const e=Vi.create(l,c);let n=e;const i=this._tryParseListComprehension(e);i&&(n=i,o=!0,a||this._addError(ml.Diagnostic.comprehensionInDict(),n)),t.push(n),r=!0}else if(e)if(s)this._addError(ml.Diagnostic.unpackInSet(),e);else{const n=Bi.create(e);Jn(n,u);let i=n;const s=this._tryParseListComprehension(n);s&&(i=s,o=!0,a||this._addError(ml.Diagnostic.comprehensionInDict(),e)),t.push(i),r=!0}else if(w(void 0!==l),l)if(r){const e=di.create(this._peekToken(),13),n=Vi.create(l,e);t.push(n),this._addError(ml.Diagnostic.dictKeyValuePairs(),l)}else{const e=this._tryParseListComprehension(l);e&&(l=e,o=!0,a||this._addError(ml.Diagnostic.comprehensionInSet(),l)),n.push(l),s=!0}if(o)break;if(12!==this._peekTokenType())break;i=this._getNextToken(),a=!1}let l=this._peekToken();if(this._consumeTokenIfType(18)||(this._addError(ml.Diagnostic.expectedCloseBrace(),e),l=void 0),s){const t=Wi.create(e);return l&&Jn(t,l),n.length>0&&Jn(t,n[n.length-1]),n.forEach((e=>{e.parent=t})),t.entries=n,t}const c=qi.create(e);return i&&(c.trailingCommaToken=i,Jn(c,i)),l&&Jn(c,l),t.length>0&&(t.forEach((e=>{e.parent=c})),Jn(c,t[t.length-1])),c.entries=t,c}_parseExpressionListGeneric(e,t=(()=>this._isNextTokenNeverExpression()),n=(()=>!1)){let i=!1;const r=[];let s;for(;!t();){const t=e();if(0===t.nodeType){s=t;break}if(r.push(t),n())break;if(!this._consumeTokenIfType(12)){i=!1;break}i=!0}return{trailingComma:i,list:r,parseError:s}}_parseExpressionStatement(){let e,t=this._parseTestOrStarListAsExpression(!1,!1,2,ml.Diagnostic.expectedExpr());if(0===t.nodeType)return t;if(this._consumeTokenIfType(10)){if(e=this._parseTypeAnnotation(),t=yi.create(t,e),!this._parseOptions.isStubFile&&this._getLanguageVersion()<De.V3_6&&this._addError(ml.Diagnostic.varAnnotationIllegal(),e),!this._consumeTokenIfOperator(2))return t;const n=this._isTypingAnnotation(e,"TypeAlias"),i=this._isParsingTypeAnnotation;n&&(this._isParsingTypeAnnotation=!0);const r=this._tryParseYieldExpression()||this._parseTestOrStarListAsExpression(!1,!0,2,ml.Diagnostic.expectedAssignRightHandExpr());return this._isParsingTypeAnnotation=i,gi.create(t,r)}if(this._consumeTokenIfOperator(2))return this._parseChainAssignments(t);if(Kc.isOperatorAssignment(this._peekOperatorType())){const e=this._getNextToken(),n=this._tryParseYieldExpression()||this._parseTestListAsExpression(2,ml.Diagnostic.expectedBinaryRightHandExpr()),i=Object.assign({},t);return i.id=Kn++,vi.create(t,n,e.operatorType,i)}return t}_parseChainAssignments(e){let t=this._tryParseYieldExpression()||this._parseTestOrStarListAsExpression(!1,!0,2,ml.Diagnostic.expectedAssignRightHandExpr());if(0===t.nodeType)return gi.create(e,t);if(this._consumeTokenIfOperator(2)&&(t=this._parseChainAssignments(t),0===t.nodeType))return t;const n=gi.create(e,t),i=this._parseVariableTypeAnnotationComment();return i&&(n.typeAnnotationComment=i,n.typeAnnotationComment.parent=n,Jn(n,n.typeAnnotationComment)),n}_parseFunctionTypeAnnotation(){const e=this._peekToken();if(!this._consumeTokenIfType(13))return void this._addError(ml.Diagnostic.expectedOpenParen(),this._peekToken());let t=[];for(;;){const e=this._peekTokenType();if(14===e||2===e||1===e)break;this._consumeTokenIfOperator(26)||this._consumeTokenIfOperator(29);const n=this._parseTypeAnnotation();if(t.push(n),!this._consumeTokenIfType(12))break}if(this._consumeTokenIfType(14)||(this._addError(ml.Diagnostic.expectedCloseParen(),e),this._consumeTokensUntilType([10])),!this._consumeTokenIfType(21))return void this._addError(ml.Diagnostic.expectedArrow(),this._peekToken());const n=this._parseTypeAnnotation();let i=!1;return 1===t.length&&18===t[0].nodeType&&(t=[],i=!0),_i.create(e,i,t,n)}_parseTypeAnnotation(e=!1){const t=this._isParsingTypeAnnotation;this._isParsingTypeAnnotation=!0;const n=this._peekToken(),i=this._consumeTokenIfOperator(26);i&&(e?!this._parseOptions.isStubFile&&this._getLanguageVersion()<De.V3_11&&this._addError(ml.Diagnostic.unpackedSubscriptIllegal(),n):this._addError(ml.Diagnostic.unpackInAnnotation(),n));let r=this._parseTestExpression(!1);return i&&e&&(r=Ii.create(n,r)),this._isParsingTypeAnnotation=t,r}_reportStringTokenErrors(e,t){65536&e.flags&&this._addError(ml.Diagnostic.stringUnterminated(),e),t.nonAsciiInBytes&&this._addError(ml.Diagnostic.stringNonAsciiBytes(),e),64&e.flags&&(this._getLanguageVersion()<De.V3_6&&this._addError(ml.Diagnostic.formatStringIllegal(),e),32&e.flags&&this._addError(ml.Diagnostic.formatStringBytes(),e),16&e.flags&&this._addError(ml.Diagnostic.formatStringUnicode(),e))}_makeStringNode(e){const t=Vc(e);return this._reportStringTokenErrors(e,t),Oi.create(e,t.value,t.unescapeErrors.length>0)}_getTypeAnnotationCommentText(){if(0===this._tokenIndex)return;const e=this._tokenizerOutput.tokens.getItemAt(this._tokenIndex-1),t=this._tokenizerOutput.tokens.getItemAt(this._tokenIndex);if(e.start+e.length===t.start)return;const n=this._fileContents.substring(e.start+e.length,t.start).match(/^(\s*#\s*type:\s*)([^\r\n]*)/);if(!n)return;const i=n[2];if(i.trim().match(/^ignore(\s|\[|$)/))return;const r=e.start+e.length+n[1].length;return dc.create(r,i.length,0,i,0,void 0)}_parseVariableTypeAnnotationComment(){const e=this._getTypeAnnotationCommentText();if(!e)return;const t=this._makeStringNode(e),n=Ui.create([t]),i=(new Qc).parseTextExpression(this._fileContents,e.start,e.length,this._parseOptions,1,void 0,this._typingSymbolAliases);return i.diagnostics.forEach((e=>{this._addError(e.message,n)})),i.parseTree?i.parseTree:void 0}_parseFunctionTypeAnnotationComment(e,t){const n=this._makeStringNode(e),i=Ui.create([n]),r=(new Qc).parseTextExpression(this._fileContents,e.start,e.length,this._parseOptions,2,void 0,this._typingSymbolAliases);if(r.diagnostics.forEach((e=>{this._addError(e.message,i)})),!r.parseTree||62!==r.parseTree.nodeType)return;const s=r.parseTree;t.functionAnnotationComment=s,s.parent=t,Jn(t,s)}_parseFormatStringSegment(e,t,n,i){w(t.isExpression);const r=(new Qc).parseTextExpression(this._fileContents,e.start+e.prefixLength+e.quoteMarkLength+t.offset+n,i,this._parseOptions,0,1,this._typingSymbolAliases);return r.diagnostics.forEach((t=>{const n=(t.range?xt(t.range.start,r.lines):e.start)||e.start,i={start:n,length:((t.range?(xt(t.range.end,r.lines)||0)+1:e.start+e.length)||e.start+e.length)-n};this._addError(t.message,i)})),r.parseTree}_parseFormatString(e){const t=Vc(e);this._reportStringTokenErrors(e,t);const n=[];for(const i of t.formatStringSegments)if(i.isExpression){const t=this._getFormatStringExpressionLength(i.value.trimEnd()),r=this._parseFormatStringSegment(e,i,0,t);r&&n.push(r);const s=i.value.substr(t);let o=0,a=0;for(let r=0;r<s.length;r++)if(123===s.charCodeAt(r))0===o&&(a=r+1),o++;else if(125===s.charCodeAt(r)&&o>0&&(o--,0===o)){const s=this._getFormatStringExpressionLength(i.value.substr(t+a,r-a)),o=this._parseFormatStringSegment(e,i,t+a,s);o&&n.push(o)}}return Li.create(e,t.value,t.unescapeErrors.length>0,n)}_getFormatStringExpressionLength(e){let t=0;const n=[];let i,r=0,s=0,o=0;for(;t<e.length;){const a=e[t],l=n.length>0||r>0||s>0||o>0,c=n.length>0;if("="===a)i=t;else{if(":"===a){if(!l)break}else if("!"===a){if(!l&&(t===e.length-1||"="!==e[t+1]))break}else if("'"===a||'"'===a){let i=a;t+2<e.length&&e[t+1]===a&&e[t+2]===a&&(i=a+a+a,t+=2),n.length>0&&n[n.length-1]===i?n.pop():0===n.length&&n.push(i)}else"("===a?c||s++:")"===a?!c&&s>0&&s--:"{"===a?c||r++:"}"===a?!c&&r>0&&r--:"["===a?c||o++:"]"===a&&!c&&o>0&&o--;" "!==a&&(i=void 0)}t++}return this._parseOptions.pythonVersion>=De.V3_8&&void 0!==i&&(t=i),t}_createBinaryOperationNode(e,t,n,i){return void 0!==e.maxChildDepth&&e.maxChildDepth>=Yc&&(e=di.create(e,14),this._addError(ml.Diagnostic.maxParseDepthExceeded(),e)),void 0!==t.maxChildDepth&&t.maxChildDepth>=Yc&&(t=di.create(t,14),this._addError(ml.Diagnostic.maxParseDepthExceeded(),t)),mi.create(e,t,n,i)}_createUnaryOperationNode(e,t,n){return void 0!==t.maxChildDepth&&t.maxChildDepth>=Yc&&(t=di.create(t,14),this._addError(ml.Diagnostic.maxParseDepthExceeded(),t)),hi.create(e,t,n)}_parseStringList(){const e=[];for(;5===this._peekTokenType();){const t=this._getNextToken();64&t.flags?e.push(this._parseFormatString(t)):e.push(this._makeStringNode(t))}const t=Ui.create(e);if(this._isParsingTypeAnnotation)if(t.strings.length>1)this._addError(ml.Diagnostic.annotationSpansStrings(),t);else if(64&t.strings[0].token.flags)this._addError(ml.Diagnostic.annotationFormatString(),t);else{const e=t.strings[0].token,n=Vc(t.strings[0].token).value,i=e.start,r=e.prefixLength+e.quoteMarkLength;if(n.length!==e.length-r-e.quoteMarkLength)this._addError(ml.Diagnostic.annotationStringEscape(),t);else{const e=(new Qc).parseTextExpression(this._fileContents,i+r,n.length,this._parseOptions,1,0!=(4&t.strings[0].token.flags)?1:0,this._typingSymbolAliases);e.diagnostics.forEach((e=>{this._addError(e.message,t)})),e.parseTree&&(t.typeAnnotation=e.parseTree,t.typeAnnotation.parent=t)}}return t}_reportConditionalErrorForStarTupleElement(e){if(52===e.nodeType&&!(e.enclosedInParens||this._parseOptions.pythonVersion>=De.V3_8))for(const t of e.expressions)if(56===t.nodeType)return void this._addError(ml.Diagnostic.unpackTuplesIllegal(),t)}_isNextTokenNeverExpression(){switch(this._peekToken().type){case 8:switch(this._peekKeywordType()){case 17:case 22:case 20:return!0}break;case 9:switch(this._peekOperatorType()){case 1:case 34:case 27:case 11:case 25:case 4:case 7:case 9:case 18:case 32:case 30:case 14:case 2:return!0}break;case 3:case 4:case 2:case 1:case 11:case 14:case 16:case 18:case 12:case 10:return!0}return!1}_disallowAssignmentExpression(e){const t=this._assignmentExpressionsAllowed;this._assignmentExpressionsAllowed=!1,e(),this._assignmentExpressionsAllowed=t}_getNextToken(){const e=this._tokenizerOutput.tokens.getItemAt(this._tokenIndex);return this._atEof()||this._tokenIndex++,e}_atEof(){return this._tokenIndex>=this._tokenizerOutput.tokens.count-1}_peekToken(e=0){return this._tokenIndex+e<0?this._tokenizerOutput.tokens.getItemAt(0):this._tokenIndex+e>=this._tokenizerOutput.tokens.count?this._tokenizerOutput.tokens.getItemAt(this._tokenizerOutput.tokens.count-1):this._tokenizerOutput.tokens.getItemAt(this._tokenIndex+e)}_peekTokenType(){return this._peekToken().type}_peekKeywordType(){const e=this._peekToken();if(8===e.type)return e.keywordType}_peekOperatorType(){const e=this._peekToken();if(9===e.type)return e.operatorType}_getTokenIfIdentifier(){const e=this._peekToken();if(7===e.type)return this._getNextToken();if(0===e.type)return this._getNextToken(),this._addError(ml.Diagnostic.invalidIdentifierChar(),e),fc.create(e.start,e.length,"",e.comments);if(8===e.type){const t=this._peekKeywordType();if([9,25,6].find((e=>e===t))){const t=this._fileContents.substr(e.start,e.length);return this._getNextToken(),fc.create(e.start,e.length,t,e.comments)}}}_consumeTokensUntilType(e){for(;;){const t=this._peekToken();if(e.some((e=>e===t.type)))return!0;if(1===t.type)return!1;this._getNextToken()}}_getTokenIfType(e){if(this._peekTokenType()===e)return this._getNextToken()}_consumeTokenIfType(e){return!!this._getTokenIfType(e)}_consumeTokenIfKeyword(e){return this._peekKeywordType()===e&&(this._getNextToken(),!0)}_consumeTokenIfOperator(e){return this._peekOperatorType()===e&&(this._getNextToken(),!0)}_getKeywordToken(e){const t=this._getNextToken();return w(8===t.type),w(t.keywordType===e),t}_getLanguageVersion(){return this._parseOptions.pythonVersion}_suppressErrors(e){const t=this._areErrorsSuppressed;try{this._areErrorsSuppressed=!0,e()}finally{this._areErrorsSuppressed=t}}_addError(e,t){w(void 0!==t),this._areErrorsSuppressed||this._diagSink.addError(e,St(t.start,t.start+t.length,this._tokenizerOutput.lines))}}class Zc{constructor(e,t){this.symbolTable=new Map,this.notLocalBindings=new Map,this.type=e,this.parent=t}getGlobalScope(){let e=this;for(;e;){if(3===e.type||4===e.type)return e;e=e.parent}return E("failed to find scope"),this}isIndependentlyExecutable(){return 3===this.type||1===this.type}lookUpSymbol(e){return this.symbolTable.get(e)}lookUpSymbolRecursive(e,t=!1,n=!1){const i=this.symbolTable.get(e);if(i){if(t&&i.isExternallyHidden())return;const e=i.getDeclarations();if(0===e.length||e.some((e=>1!==e.type||!e.isDefinedByMemberAccess)))return{symbol:i,isOutsideCallerModule:t,isBeyondExecutionScope:n,scope:this}}let r;if(r=1===this.notLocalBindings.get(e)?this.getGlobalScope():this.parent,r)return r.lookUpSymbolRecursive(e,t||3===this.type,n||this.isIndependentlyExecutable())}addSymbol(e,t){const n=new qo(t);return this.symbolTable.set(e,n),n}getBindingType(e){return this.notLocalBindings.get(e)}setBindingType(e,t){return this.notLocalBindings.set(e,t)}setSlotsNames(e){this.slotsNames=e}getSlotsNames(){return this.slotsNames}}function Xc(e,t,n,i){if(4===e.nodeType)return Xc(e.rightExpression,t,n,i);if(55===e.nodeType){if(37===e.operator||36===e.operator){const r=eu(e.expression,t,n,i);if(void 0!==r)return!r}}else if(7===e.nodeType){if(37===e.operator||36===e.operator){const r=Xc(e.leftExpression,t,n,i),s=Xc(e.rightExpression,t,n,i);if(void 0===r||void 0===s)return;return 37===e.operator?r||s:r&&s}if(iu(e.leftExpression,i)&&52===e.rightExpression.nodeType){const n=function(e){let t;if(e.expressions.length>=2){if(40===e.expressions[0].nodeType&&!e.expressions[0].isImaginary&&40===e.expressions[1].nodeType&&!e.expressions[1].isImaginary){const n=e.expressions[0],i=e.expressions[1];"number"==typeof n.value&&"number"==typeof i.value&&(t=256*n.value+i.value)}}else if(1===e.expressions.length){const n=e.expressions[0];"number"==typeof n.value&&(t=256*n.value)}return t}(e.rightExpression);return tu(e.operator,t.pythonVersion,n)}if(24===e.leftExpression.nodeType&&iu(e.leftExpression.baseExpression,i)&&1===e.leftExpression.items.length&&!e.leftExpression.trailingComma&&!e.leftExpression.items[0].name&&0===e.leftExpression.items[0].argumentCategory&&40===e.leftExpression.items[0].valueExpression.nodeType&&!e.leftExpression.items[0].valueExpression.isImaginary&&0===e.leftExpression.items[0].valueExpression.value&&40===e.rightExpression.nodeType)return tu(e.operator,Math.floor(t.pythonVersion/256),e.rightExpression.value);if(function(e,t=["sys"]){return!(35!==e.nodeType||38!==e.leftExpression.nodeType||"platform"!==e.memberName.value||!t.some((t=>t===e.leftExpression.value)))}(e.leftExpression,i)&&48===e.rightExpression.nodeType){const n=e.rightExpression.strings.map((e=>e.value)).join(""),i=function(e){return e.pythonPlatform===rc.Darwin?"darwin":e.pythonPlatform===rc.Windows?"win32":e.pythonPlatform===rc.Linux?"linux":void 0}(t);return nu(e.operator,i,n)}if(function(e){return 35===e.nodeType&&38===e.leftExpression.nodeType&&"os"===e.leftExpression.value&&"name"===e.memberName.value}(e.leftExpression)&&48===e.rightExpression.nodeType){const n=e.rightExpression.strings.map((e=>e.value)).join(""),i=function(e){return e.pythonPlatform===rc.Darwin?"posix":e.pythonPlatform===rc.Windows?"nt":e.pythonPlatform===rc.Linux?"posix":void 0}(t);if(void 0!==i)return nu(e.operator,i,n)}}else if(11===e.nodeType){if(33===e.constType)return!0;if(15===e.constType)return!1}else if(38===e.nodeType){if("TYPE_CHECKING"===e.value)return!0}else if(n&&35===e.nodeType&&"TYPE_CHECKING"===e.memberName.value&&38===e.leftExpression.nodeType&&n.some((t=>t===e.leftExpression.value)))return!0}function eu(e,t,n,i){return(11!==e.nodeType||26!==e.constType)&&Xc(e,t,n,i)}function tu(e,t,n){if(void 0!==t&&void 0!==n){if(t=BigInt(t),n=BigInt(n),20===e)return t<n;if(21===e)return t<=n;if(15===e)return t>n;if(16===e)return t>=n;if(12===e)return t===n;if(28===e)return t!==n}}function nu(e,t,n){if(void 0!==t&&void 0!==n){if(12===e)return t===n;if(28===e)return t!==n}}function iu(e,t=["sys"]){return!(35!==e.nodeType||38!==e.leftExpression.nodeType||"version_info"!==e.memberName.value||!t.some((t=>t===e.leftExpression.value)))}class ru extends _r{constructor(e,t=!1){super(),this._moduleSymbolOnly=t,this._deferredBindingTasks=[],this._currentExceptTargets=[],this._finallyTargets=[],this._typingImportAliases=[],this._sysImportAliases=[],this._dataclassesImportAliases=[],this._typingSymbolAliases=new Map,this._dataclassesSymbolAliases=new Map,this._dunderAllStringNodes=[],this._usesUnsupportedDunderAllForm=!1,this._isInExceptSuite=!1,this._potentialHiddenSymbols=new Map,this._potentialPrivateSymbols=new Map,this._functionCodeFlowComplexity=0,this._fileInfo=e}bindModule(e){var t;const n=void 0===this._fileInfo.builtinsScope;this._createNewScope(n?4:3,this._fileInfo.builtinsScope,(()=>{Nt(e,this._currentScope),Ut(e,this._currentFlowNode),this._addImplicitSymbolToCurrentScope("__doc__",e,"str | None"),this._addImplicitSymbolToCurrentScope("__name__",e,"str"),this._addImplicitSymbolToCurrentScope("__qualname__",e,"str"),this._addImplicitSymbolToCurrentScope("__loader__",e,"Any"),this._addImplicitSymbolToCurrentScope("__package__",e,"str"),this._addImplicitSymbolToCurrentScope("__spec__",e,"Any"),this._addImplicitSymbolToCurrentScope("__path__",e,"Iterable[str]"),this._addImplicitSymbolToCurrentScope("__file__",e,"str"),this._addImplicitSymbolToCurrentScope("__cached__",e,"str"),this._addImplicitSymbolToCurrentScope("__dict__",e,"Dict[str, Any]"),this._addImplicitSymbolToCurrentScope("__annotations__",e,"Dict[str, Any]"),this._addImplicitSymbolToCurrentScope("__builtins__",e,"Any"),this._currentFlowNode=this._createStartFlowNode(),this._walkStatementsAndReportUnreachable(e.statements),Bt(e,this._currentScopeCodeFlowExpressions),qt(e,this._currentFlowNode)})),this._bindDeferred(),this._potentialHiddenSymbols.forEach(((e,t)=>{var n;(null===(n=this._dunderAllNames)||void 0===n?void 0:n.some((e=>e===t)))||(this._fileInfo.isStubFile?e.setIsExternallyHidden():e.setPrivatePyTypedImport())})),this._potentialPrivateSymbols.forEach(((e,t)=>{var n;(null===(n=this._dunderAllNames)||void 0===n?void 0:n.some((e=>e===t)))||e.setIsPrivateMember()})),this._dunderAllNames?jt(e,{names:this._dunderAllNames,stringNodes:this._dunderAllStringNodes,usesUnsupportedDunderAllForm:this._usesUnsupportedDunderAllForm}):jt(e,void 0);const i=Ft(e);if(i&&this._dunderAllNames)for(const e of this._dunderAllNames)null===(t=i.symbolTable.get(e))||void 0===t||t.setIsInDunderAll()}visitModule(e){return E("We should never get here"),!1}visitSuite(e){return this._walkStatementsAndReportUnreachable(e.statements),!1}visitModuleName(e){const t=Rt(e);if(w(void 0!==t),!t||t.isNativeLib)return!0;if(!t.isImportFound)return this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingImports,$o.reportMissingImports,ml.Diagnostic.importResolveFailure().format({importName:t.importName}),e),!0;if(!t.isStubFile&&1===t.importType&&!t.pyTypedInfo){const n=this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingTypeStubs,$o.reportMissingTypeStubs,ml.Diagnostic.stubFileMissing().format({importName:t.importName}),e);if(n){const e={action:"pyright.createtypestub",moduleName:t.importName};n.addAction(e)}}return t.isStubFile&&0!==t.importType&&t.nonStubImportResult&&!t.nonStubImportResult.isImportFound&&(this._fileInfo.isStubFile||this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingModuleSource,$o.reportMissingModuleSource,ml.Diagnostic.importSourceResolveFailure().format({importName:t.importName}),e)),!0}visitClass(e){this.walkMultiple(e.decorators);const t={type:4,node:e,path:this._fileInfo.filePath,range:St(e.name.start,dt.getEnd(e.name),this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite},n=this._bindNameToScope(this._currentScope,e.name.value);n&&n.addDeclaration(t),Ot(e,t),this.walkMultiple(e.arguments);let i=this._currentScope;for(;2===i.type;)i=i.parent;return this._createNewScope(2,i,(()=>{Nt(e,this._currentScope),this._addImplicitSymbolToCurrentScope("__doc__",e,"str | None"),this._addImplicitSymbolToCurrentScope("__module__",e,"str"),this._moduleSymbolOnly||this.walk(e.suite)})),this._createAssignmentTargetFlowNodes(e.name,!1,!1),!1}visitFunction(e){Ut(e,this._currentFlowNode);const t=this._bindNameToScope(this._currentScope,e.name.value),n=Er(e,!0),i={type:3,node:e,isMethod:!!n,isGenerator:!1,path:this._fileInfo.filePath,range:St(e.name.start,dt.getEnd(e.name),this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};return t&&t.addDeclaration(i),Ot(e,i),this.walkMultiple(e.decorators),e.parameters.forEach((e=>{e.defaultValue&&this.walk(e.defaultValue),e.typeAnnotation&&this.walk(e.typeAnnotation),e.typeAnnotationComment&&this.walk(e.typeAnnotationComment)})),e.returnTypeAnnotation&&this.walk(e.returnTypeAnnotation),e.functionAnnotationComment&&this.walk(e.functionAnnotationComment),this._createNewScope(1,this._getNonClassParentScope(),(()=>{Nt(e,this._currentScope),Er(e)&&this._addImplicitSymbolToCurrentScope("__class__",e,"class"),this._deferBinding((()=>{this._currentFlowNode=this._createStartFlowNode(),this._functionCodeFlowComplexity=0,e.parameters.forEach((e=>{if(e.name){const t=this._bindNameToScope(this._currentScope,e.name.value);if(t){const n={type:2,node:e,path:this._fileInfo.filePath,range:St(e.start,dt.getEnd(e),this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};t.addDeclaration(n),Ot(e.name,n)}this._createFlowAssignment(e.name)}})),this._targetFunctionDeclaration=i,this._currentReturnTarget=this._createBranchLabel(),this.walk(e.suite),qt(e.suite,this._currentFlowNode),this._addAntecedent(this._currentReturnTarget,this._currentFlowNode);const t=this._finishFlowLabel(this._currentReturnTarget);qt(e,t),Bt(e,this._currentScopeCodeFlowExpressions),function(e,t){e.codeFlowComplexity=t}(e,this._functionCodeFlowComplexity)}))})),this._createAssignmentTargetFlowNodes(e.name,!1,!1),!1}visitLambda(e){return Ut(e,this._currentFlowNode),e.parameters.forEach((e=>{e.defaultValue&&this.walk(e.defaultValue)})),this._createNewScope(1,this._getNonClassParentScope(),(()=>{Nt(e,this._currentScope),this._deferBinding((()=>{this._currentFlowNode=this._createStartFlowNode(),e.parameters.forEach((e=>{if(e.name){const t=this._bindNameToScope(this._currentScope,e.name.value);if(t){const n={type:2,node:e,path:this._fileInfo.filePath,range:St(e.start,dt.getEnd(e),this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};t.addDeclaration(n),Ot(e.name,n)}this._createFlowAssignment(e.name),this.walk(e.name)}})),this.walk(e.expression),Bt(e,this._currentScopeCodeFlowExpressions)}))})),!1}visitCall(e){var t,n;if(this._disableTrueFalseTargets((()=>{this.walk(e.leftExpression),this.walkMultiple(e.arguments)})),this._createCallFlowNode(e),3===this._currentScope.type&&35===e.leftExpression.nodeType&&38===e.leftExpression.leftExpression.nodeType&&"__all__"===e.leftExpression.leftExpression.value){let i=!0;if("extend"===e.leftExpression.memberName.value&&1===e.arguments.length){const t=e.arguments[0].valueExpression;if(31===t.nodeType)t.entries.forEach((e=>{var t,n;48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType&&(null===(t=this._dunderAllNames)||void 0===t||t.push(e.strings[0].value),null===(n=this._dunderAllStringNodes)||void 0===n||n.push(e.strings[0]),i=!1)}));else if(35===t.nodeType&&38===t.leftExpression.nodeType&&"__all__"===t.memberName.value){const e=this._getDunderAllNamesFromImport(t.leftExpression.value);e&&e.length>0&&(e.forEach((e=>{var t;null===(t=this._dunderAllNames)||void 0===t||t.push(e)})),i=!1)}}else if("remove"===e.leftExpression.memberName.value&&1===e.arguments.length){const t=e.arguments[0].valueExpression;48===t.nodeType&&1===t.strings.length&&49===t.strings[0].nodeType&&this._dunderAllNames&&(this._dunderAllNames=this._dunderAllNames.filter((e=>e!==t.strings[0].value)),this._dunderAllStringNodes=this._dunderAllStringNodes.filter((e=>e.value!==t.strings[0].value)),i=!1)}else if("append"===e.leftExpression.memberName.value&&1===e.arguments.length){const r=e.arguments[0].valueExpression;48===r.nodeType&&1===r.strings.length&&49===r.strings[0].nodeType&&(null===(t=this._dunderAllNames)||void 0===t||t.push(r.strings[0].value),null===(n=this._dunderAllStringNodes)||void 0===n||n.push(r.strings[0]),i=!1)}i&&(this._usesUnsupportedDunderAllForm=!0,this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll,$o.reportUnsupportedDunderAll,ml.Diagnostic.unsupportedDunderAllOperation(),e))}return!1}visitAssignment(e){if(this._handleTypingStubAssignmentOrAnnotation(e))return!1;this._bindPossibleTupleNamedTarget(e.leftExpression),e.typeAnnotationComment&&(this.walk(e.typeAnnotationComment),this._addTypeDeclarationForVariable(e.leftExpression,e.typeAnnotationComment)),this.walk(e.rightExpression);let t=!0;if((kr(e)||9===e.rightExpression.nodeType&&this._fileInfo.isTypingStubFile||function(e){let t=e;for(;t;){switch(t.nodeType){case 26:case 57:return!0}t=t.parent}return!1}(e))&&(t=!1),this._addInferredTypeAssignmentForVariable(e.leftExpression,e.rightExpression,t),this._createAssignmentTargetFlowNodes(e.leftExpression,!0,!1),3===this._currentScope.type&&(38===e.leftExpression.nodeType&&"__all__"===e.leftExpression.value||54===e.leftExpression.nodeType&&38===e.leftExpression.valueExpression.nodeType&&"__all__"===e.leftExpression.valueExpression.value)){const t=e.rightExpression;this._dunderAllNames=[];let n=!1;31===t.nodeType?t.entries.forEach((e=>{48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType?(this._dunderAllNames.push(e.strings[0].value),this._dunderAllStringNodes.push(e.strings[0])):n=!0})):52===t.nodeType?t.expressions.forEach((e=>{48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType?(this._dunderAllNames.push(e.strings[0].value),this._dunderAllStringNodes.push(e.strings[0])):n=!0})):n=!0,n&&(this._usesUnsupportedDunderAllForm=!0,this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll,$o.reportUnsupportedDunderAll,ml.Diagnostic.unsupportedDunderAllOperation(),e))}if(2===this._currentScope.type&&(38===e.leftExpression.nodeType&&"__slots__"===e.leftExpression.value||54===e.leftExpression.nodeType&&38===e.leftExpression.valueExpression.nodeType&&"__slots__"===e.leftExpression.valueExpression.value)){const t=e.rightExpression,n=[];let i=!0;48===t.nodeType?n.push(t):31===t.nodeType?t.entries.forEach((e=>{48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType?n.push(e):i=!1})):52===t.nodeType?t.expressions.forEach((e=>{48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType?n.push(e):i=!1})):i=!1,i&&this._addSlotsToCurrentScope(n)}return!1}visitAssignmentExpression(e){this._disableTrueFalseTargets((()=>{this.walk(e.rightExpression)}));const t=function(e){let t=!1,n=Ar(e);for(;void 0!==n;)switch(n.nodeType){case 28:case 30:case 36:return n;case 10:return t?void 0:n;case 32:t=!0,n=Ar(n.parent);break;default:return}}(e);if(t){const n=Ft(t);let i=this._currentScope;for(;i&&i!==n;){if(i.lookUpSymbol(e.name.value)){this._addError(ml.Diagnostic.assignmentExprComprehension().format({name:e.name.value}),e.name);break}i=i.parent}this._bindNameToScope(n,e.name.value),this._addInferredTypeAssignmentForVariable(e.name,e.rightExpression),this._createAssignmentTargetFlowNodes(e.name,!0,!1)}else this._addError(ml.Diagnostic.assignmentExprContext(),e),this.walk(e.name);return!1}visitAugmentedAssignment(e){if(this.walk(e.leftExpression),this.walk(e.rightExpression),this._bindPossibleTupleNamedTarget(e.destExpression),this._createAssignmentTargetFlowNodes(e.destExpression,!1,!1),1===e.operator&&3===this._currentScope.type&&38===e.leftExpression.nodeType&&"__all__"===e.leftExpression.value){const t=e.rightExpression;let n=!0;if(31===t.nodeType)t.entries.forEach((e=>{var t;48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType&&(null===(t=this._dunderAllNames)||void 0===t||t.push(e.strings[0].value),this._dunderAllStringNodes.push(e.strings[0]))})),n=!1;else if(35===t.nodeType&&38===t.leftExpression.nodeType&&"__all__"===t.memberName.value){const e=this._getDunderAllNamesFromImport(t.leftExpression.value);e&&(e.forEach((e=>{var t;null===(t=this._dunderAllNames)||void 0===t||t.push(e)})),n=!1)}n&&(this._usesUnsupportedDunderAllForm=!0,this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll,$o.reportUnsupportedDunderAll,ml.Diagnostic.unsupportedDunderAllOperation(),e))}return!1}visitDel(e){return e.expressions.forEach((e=>{this._bindPossibleTupleNamedTarget(e),this.walk(e),this._createAssignmentTargetFlowNodes(e,!1,!0)})),!1}visitTypeAnnotation(e){if(this._handleTypingStubAssignmentOrAnnotation(e))return!1;this.walk(e.typeAnnotation),this._createVariableAnnotationFlowNode(),this._bindPossibleTupleNamedTarget(e.valueExpression),this._addTypeDeclarationForVariable(e.valueExpression,e.typeAnnotation);const t=[];return this._isNarrowingExpression(e.valueExpression,t)&&t.forEach((e=>{const t=At(e);this._currentScopeCodeFlowExpressions.add(t)})),this.walk(e.valueExpression),!1}visitFor(e){this._bindPossibleTupleNamedTarget(e.targetExpression),this._addInferredTypeAssignmentForVariable(e.targetExpression,e),this.walk(e.iterableExpression);const t=this._createLoopLabel(),n=this._createBranchLabel(),i=this._createBranchLabel();if(this._addAntecedent(t,this._currentFlowNode),this._currentFlowNode=t,this._addAntecedent(n,this._currentFlowNode),this._createAssignmentTargetFlowNodes(e.targetExpression,!0,!1),this._bindLoopStatement(t,i,(()=>{this.walk(e.forSuite),this._addAntecedent(t,this._currentFlowNode)})),this._currentFlowNode=this._finishFlowLabel(n),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i),e.asyncToken){const t=kr(e);t&&t.isAsync||this._addError(ml.Diagnostic.asyncNotInAsyncFunction(),e.asyncToken)}return!1}visitContinue(e){return this._currentContinueTarget&&this._addAntecedent(this._currentContinueTarget,this._currentFlowNode),this._currentFlowNode=ru._unreachableFlowNode,!1}visitBreak(e){return this._currentBreakTarget&&this._addAntecedent(this._currentBreakTarget,this._currentFlowNode),this._currentFlowNode=ru._unreachableFlowNode,!1}visitReturn(e){return this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.returnStatements||(this._targetFunctionDeclaration.returnStatements=[]),this._targetFunctionDeclaration.returnStatements.push(e)),e.returnExpression&&this.walk(e.returnExpression),Ut(e,this._currentFlowNode),this._currentReturnTarget&&this._addAntecedent(this._currentReturnTarget,this._currentFlowNode),this._finallyTargets.forEach((e=>{this._addAntecedent(e,this._currentFlowNode)})),this._currentFlowNode=ru._unreachableFlowNode,!1}visitYield(e){return this._isInListComprehension(e,!0)&&this._addError(ml.Diagnostic.yieldWithinListCompr(),e),this._bindYield(e),!1}visitYieldFrom(e){return this._isInListComprehension(e,!0)&&this._addError(ml.Diagnostic.yieldWithinListCompr(),e),this._bindYield(e),!1}visitMemberAccess(e){return Ut(e,this._currentFlowNode),!0}visitName(e){return Ut(e,this._currentFlowNode),!1}visitIndex(e){return Ut(e,this._currentFlowNode),!0}visitIf(e){const t=this._currentFlowNode,n=this._createBranchLabel(),i=this._createBranchLabel(),r=this._createBranchLabel(t);return r.affectedExpressions=this._trackCodeFlowExpressions((()=>{const t=eu(e.testExpression,this._fileInfo.executionEnvironment,this._typingImportAliases,this._sysImportAliases);this._bindConditional(e.testExpression,n,i),this._currentFlowNode=!1===t?ru._unreachableFlowNode:this._finishFlowLabel(n),this.walk(e.ifSuite),this._addAntecedent(r,this._currentFlowNode),this._currentFlowNode=!0===t?ru._unreachableFlowNode:this._finishFlowLabel(i),e.elseSuite?this.walk(e.elseSuite):this._bindNeverCondition(e.testExpression,r,!1),this._addAntecedent(r,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(r)})),!1}visitWhile(e){const t=this._createBranchLabel(),n=this._createBranchLabel(),i=this._createBranchLabel(),r=eu(e.testExpression,this._fileInfo.executionEnvironment,this._typingImportAliases,this._sysImportAliases),s=this._createLoopLabel();return this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=s,this._bindConditional(e.testExpression,t,n),this._currentFlowNode=!1===r?ru._unreachableFlowNode:this._finishFlowLabel(t),this._bindLoopStatement(s,i,(()=>{this.walk(e.whileSuite)})),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=!0===r?ru._unreachableFlowNode:this._finishFlowLabel(n),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i),!1}visitAssert(e){const t=this._createBranchLabel(),n=this._createBranchLabel();return this._bindConditional(e.testExpression,t,n),e.exceptionExpression&&(this._currentFlowNode=this._finishFlowLabel(n),this.walk(e.exceptionExpression)),this._currentFlowNode=this._finishFlowLabel(t),!1}visitExcept(e){if(e.typeExpression&&this.walk(e.typeExpression),e.name){this.walk(e.name);const t=this._bindNameToScope(this._currentScope,e.name.value);if(this._createAssignmentTargetFlowNodes(e.name,!0,!1),t){const n={type:1,node:e.name,isConstant:Zt(e.name.value),inferredTypeSource:e,path:this._fileInfo.filePath,range:St(e.name.start,dt.getEnd(e.name),this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};t.addDeclaration(n)}}const t=this._isInExceptSuite;return this._isInExceptSuite=!0,this.walk(e.exceptSuite),this._isInExceptSuite=t,e.name&&this._createFlowAssignment(e.name,!0),!1}visitRaise(e){return this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.raiseStatements||(this._targetFunctionDeclaration.raiseStatements=[]),this._targetFunctionDeclaration.raiseStatements.push(e)),e.typeExpression&&this.walk(e.typeExpression),e.valueExpression&&this.walk(e.valueExpression),e.tracebackExpression&&this.walk(e.tracebackExpression),this._finallyTargets.forEach((e=>{this._addAntecedent(e,this._currentFlowNode)})),this._currentFlowNode=ru._unreachableFlowNode,!1}visitTry(e){const t=this._currentFlowNode,n=e.exceptClauses.map((()=>this._createBranchLabel())),i=this._createBranchLabel(t);let r=!1;const s=this._createBranchLabel(t),o={flags:ft.PreFinallyGate,id:kt(),antecedent:s,isGateClosed:!1};if(i.affectedExpressions=this._trackCodeFlowExpressions((()=>{e.finallySuite&&this._addAntecedent(i,o),e.exceptClauses.some((e=>!e.typeExpression))||n.push(s),n.forEach((e=>{this._addAntecedent(e,this._currentFlowNode)})),e.finallySuite&&this._finallyTargets.push(s),this._useExceptTargets(n,(()=>{this.walk(e.trySuite)})),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(i,this._currentFlowNode),this._isCodeUnreachable()||(r=!0),e.exceptClauses.forEach(((e,t)=>{this._currentFlowNode=this._finishFlowLabel(n[t]),this.walk(e),this._addAntecedent(i,this._currentFlowNode),this._isCodeUnreachable()||(r=!0)})),e.finallySuite&&this._finallyTargets.pop(),this._currentFlowNode=this._finishFlowLabel(i)})),e.finallySuite){this.walk(e.finallySuite);const t={flags:ft.PostFinally,id:kt(),finallyNode:e.finallySuite,antecedent:this._currentFlowNode,preFinallyGate:o};this._currentFlowNode=r?t:ru._unreachableFlowNode}return this._functionCodeFlowComplexity+=4,!1}visitAwait(e){var t;const n=kr(e);if(void 0===n||!n.isAsync){if(this._fileInfo.isIPythonMode&&void 0===n)return!0;32!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&this._addError(ml.Diagnostic.awaitNotInAsync(),e)}return!0}visitGlobal(e){const t=this._currentScope.getGlobalScope();return e.nameList.forEach((e=>{const n=e.value;0===this._currentScope.getBindingType(n)&&this._addError(ml.Diagnostic.nonLocalRedefinition().format({name:n}),e);const i=this._currentScope.lookUpSymbolRecursive(n);i&&i.scope===this._currentScope&&this._addError(ml.Diagnostic.globalReassignment().format({name:n}),e),this._bindNameToScope(t,n),this._currentScope!==t&&this._currentScope.setBindingType(n,1)})),!0}visitNonlocal(e){const t=this._currentScope.getGlobalScope();return this._currentScope===t?this._addError(ml.Diagnostic.nonLocalInModule(),e):e.nameList.forEach((e=>{const n=e.value;1===this._currentScope.getBindingType(n)&&this._addError(ml.Diagnostic.globalRedefinition().format({name:n}),e);const i=this._currentScope.lookUpSymbolRecursive(n);i&&i.scope===this._currentScope?this._addError(ml.Diagnostic.nonLocalReassignment().format({name:n}),e):i&&i.scope!==t||this._addError(ml.Diagnostic.nonLocalNoBinding().format({name:n}),e),i&&this._currentScope.setBindingType(n,0)})),!0}visitImportAs(e){var t,n,i,r,s,o;if(e.module.nameParts.length>0){const a=e.module.nameParts[0].value;let l;l=e.alias?e.alias.value:a;const c=this._bindNameToScope(this._currentScope,l);!c||3!==this._currentScope.type&&4!==this._currentScope.type||e.alias&&1===e.module.nameParts.length&&e.module.nameParts[0].value===e.alias.value||(this._fileInfo.isStubFile||this._fileInfo.isInPyTypedPackage)&&this._potentialHiddenSymbols.set(l,c);const u=Rt(e.module);w(void 0!==u),c&&this._createAliasDeclarationForMultipartImportName(e,e.alias,u,c),this._createFlowAssignment(e.alias?e.alias:e.module.nameParts[0]),1===e.module.nameParts.length&&("typing"===a||"typing_extensions"===a?this._typingImportAliases.push(null!==(n=null===(t=e.alias)||void 0===t?void 0:t.value)&&void 0!==n?n:a):"sys"===a?this._sysImportAliases.push(null!==(r=null===(i=e.alias)||void 0===i?void 0:i.value)&&void 0!==r?r:a):"dataclasses"===a&&this._dataclassesImportAliases.push(null!==(o=null===(s=e.alias)||void 0===s?void 0:s.value)&&void 0!==o?o:a))}return!0}visitImportFrom(e){const t=["Final","TypeAlias","ClassVar","Required","NotRequired","Annotated"],n=["InitVar"],i=Rt(e.module);let r="";i&&i.isImportFound&&!i.isNativeLib&&(r=i.resolvedPaths[i.resolvedPaths.length-1]);const s=he(de(this._fileInfo.filePath)),o="__init__"===s&&1===e.module.leadingDots&&1===e.module.nameParts.length;let a=!1,l=!1;if(1===e.module.nameParts.length){const t=e.module.nameParts[0].value;"typing"!==t&&"typing_extensions"!==t||(a=!0),"dataclasses"===t&&(l=!0)}if(e.isWildcardImport){if((Er(e)||kr(e))&&this._addError(ml.Diagnostic.wildcardInFunction(),e),i){const s=[],c=this._fileInfo.importLookup(r);if(c){const t=this._getWildcardImportNames(c);o&&(t.some((t=>t===e.module.nameParts[0].value))||this._addImplicitFromImport(e,i)),t.forEach((t=>{const n=this._bindNameToScope(this._currentScope,t);if(n)if(c.symbolTable.get(t)){const i={type:6,node:e,path:r,loadSymbolsFromPath:!0,range:{start:{line:0,character:0},end:{line:0,character:0}},usesLocalName:!1,symbolName:t,moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};n.addDeclaration(i),s.push(t)}else if(i&&i.filteredImplicitImports){const s=i.filteredImplicitImports.find((e=>e.name===t));if(s){const i={type:6,node:e,path:s.path,loadSymbolsFromPath:!0,range:{start:{line:0,character:0},end:{line:0,character:0}},usesLocalName:!1,moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite},o={type:6,node:e,path:r,loadSymbolsFromPath:!0,usesLocalName:!1,symbolName:t,submoduleFallback:i,range:{start:{line:0,character:0},end:{line:0,character:0}},moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};n.addDeclaration(o)}}}))}this._createFlowWildcardImport(e,s),a&&t.forEach((e=>{this._typingSymbolAliases.set(e,e)})),l&&n.forEach((e=>{this._dataclassesSymbolAliases.set(e,e)}))}}else o&&this._addImplicitFromImport(e,i),e.imports.forEach((o=>{const c=o.name.value,u=o.alias||o.name,p=this._bindNameToScope(this._currentScope,u.value);if(p){let d,h;e.module.nameParts.length>0&&(3!==this._currentScope.type&&4!==this._currentScope.type||o.alias&&o.alias.value===o.name.value||(this._fileInfo.isStubFile||this._fileInfo.isInPyTypedPackage)&&this._potentialHiddenSymbols.set(u.value,p)),i&&i.filteredImplicitImports&&(d=i.filteredImplicitImports.find((e=>e.name===c)));let m=!0;d&&(h={type:6,node:o,path:d.path,loadSymbolsFromPath:!0,range:{start:{line:0,character:0},end:{line:0,character:0}},usesLocalName:!1,moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite},"__init__"===s&&1===e.module.leadingDots&&0===e.module.nameParts.length&&(m=!1));const f={type:6,node:o,path:r,loadSymbolsFromPath:m,usesLocalName:!!o.alias,symbolName:c,submoduleFallback:h,range:{start:{line:0,character:0},end:{line:0,character:0}},moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,isNativeLib:null==i?void 0:i.isNativeLib};p.addDeclaration(f),this._createFlowAssignment(o.alias||o.name),a&&t.some((e=>e===o.name.value))&&this._typingSymbolAliases.set(u.value,o.name.value),l&&n.some((e=>e===o.name.value))&&this._dataclassesSymbolAliases.set(u.value,o.name.value)}}));return!0}visitWith(e){e.withItems.forEach((e=>{this.walk(e.expression),e.target&&(this._bindPossibleTupleNamedTarget(e.target),this._addInferredTypeAssignmentForVariable(e.target,e),this._createAssignmentTargetFlowNodes(e.target,!0,!1))}));const t=this._createContextManagerLabel(e.withItems.map((e=>e.expression)),!!e.isAsync,!1);this._addAntecedent(t,this._currentFlowNode);const n=this._createContextManagerLabel(e.withItems.map((e=>e.expression)),!!e.isAsync,!0);this._currentExceptTargets.forEach((e=>{this._addAntecedent(e,n)}));const i=this._currentFlowNode,r=this._createBranchLabel(i);return this._addAntecedent(r,t),r.affectedExpressions=this._trackCodeFlowExpressions((()=>{if(this._useExceptTargets([t,n],(()=>{this.walk(e.suite)})),this._addAntecedent(r,this._currentFlowNode),this._currentFlowNode=r,this._isCodeUnreachable()||this._addExceptTargets(this._currentFlowNode),e.asyncToken){const t=kr(e);t&&t.isAsync||this._addError(ml.Diagnostic.asyncNotInAsyncFunction(),e.asyncToken)}})),!1}visitTernary(e){const t=this._currentFlowNode,n=this._createBranchLabel(),i=this._createBranchLabel(),r=this._createBranchLabel(t);return r.affectedExpressions=this._trackCodeFlowExpressions((()=>{this._bindConditional(e.testExpression,n,i),this._currentFlowNode=this._finishFlowLabel(n),this.walk(e.ifExpression),this._addAntecedent(r,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i),this.walk(e.elseExpression),this._addAntecedent(r,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(r)})),!1}visitUnaryOperation(e){return 38===e.operator&&this._currentFalseTarget&&this._currentTrueTarget?this._bindConditional(e.expression,this._currentFalseTarget,this._currentTrueTarget):this._disableTrueFalseTargets((()=>{this.walk(e.expression)})),!1}visitBinaryOperation(e){if(36===e.operator||37===e.operator){let t,n=this._currentTrueTarget,i=this._currentFalseTarget;n&&i||(t=this._createBranchLabel(),n=i=t);const r=this._createBranchLabel();36===e.operator?this._bindConditional(e.leftExpression,r,i):this._bindConditional(e.leftExpression,n,r),this._currentFlowNode=this._finishFlowLabel(r),this._bindConditional(e.rightExpression,n,i),t&&(this._currentFlowNode=this._finishFlowLabel(t))}else this._disableTrueFalseTargets((()=>{this.walk(e.leftExpression),this.walk(e.rightExpression)}));return!1}visitListComprehension(e){const t=kr(e);return this._createNewScope(0,this._getNonClassParentScope(),(()=>{var n;Nt(e,this._currentScope);const i=this._createBranchLabel();for(let i=0;i<e.forIfNodes.length;i++){const r=e.forIfNodes[i],s=new Map;33===r.nodeType&&(this._bindPossibleTupleNamedTarget(r.targetExpression,s),this._addInferredTypeAssignmentForVariable(r.targetExpression,r),r.asyncToken&&(t&&t.isAsync||31===(null===(n=e.parent)||void 0===n?void 0:n.nodeType)&&this._addError(ml.Diagnostic.asyncNotInAsyncFunction(),r.asyncToken)))}for(let t=0;t<e.forIfNodes.length;t++){const n=e.forIfNodes[t];if(33===n.nodeType)this.walk(n.iterableExpression),this._createAssignmentTargetFlowNodes(n.targetExpression,!0,!1);else{const e=this._createBranchLabel();this._bindConditional(n.testExpression,e,i),this._currentFlowNode=this._finishFlowLabel(e)}}this.walk(e.expression),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i)})),!1}visitMatch(e){this.walk(e.subjectExpression);const t=[],n=this._isNarrowingExpression(e.subjectExpression,t);n&&t.forEach((e=>{const t=At(e);this._currentScopeCodeFlowExpressions.add(t)}));const i=this._createBranchLabel();let r=!1;return e.cases.forEach((t=>{const s=this._createBranchLabel(),o=this._createBranchLabel(),a=this._createBranchLabel();this._addAntecedent(o,this._currentFlowNode),t.isIrrefutable?t.guardExpression||(r=!0):this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(o),this.walk(t.pattern),n&&this._createFlowNarrowForPattern(e.subjectExpression,t),t.guardExpression?this._bindConditional(t.guardExpression,a,s):this._addAntecedent(a,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(a),this.walk(t.suite),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s)})),n&&(this._createFlowNarrowForPattern(e.subjectExpression,e),r||this._createFlowExhaustedMatch(e)),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i),!1}visitPatternAs(e){const t=this._createBranchLabel();if(e.orPatterns.forEach((e=>{this.walk(e),this._addAntecedent(t,this._currentFlowNode)})),this._currentFlowNode=this._finishFlowLabel(t),e.target){this.walk(e.target);const t=this._bindNameToScope(this._currentScope,e.target.value);if(this._createAssignmentTargetFlowNodes(e.target,!1,!1),t){const n={type:1,node:e.target,isConstant:Zt(e.target.value),inferredTypeSource:e,path:this._fileInfo.filePath,range:St(e.target.start,dt.getEnd(e.target),this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};t.addDeclaration(n)}}return!1}visitPatternCapture(e){return e.isWildcard||this._addPatternCaptureTarget(e.target),!0}visitPatternMappingExpandEntry(e){return"_"!==e.target.value&&this._addPatternCaptureTarget(e.target),!0}_getNonClassParentScope(){let e=this._currentScope;for(;2===e.type;)e=e.parent;return e}_addSlotsToCurrentScope(e){w(2===this._currentScope.type);let t=!1;for(const n of e){const e=n.strings[0].value;if("__dict__"===e){t=!0;continue}let i=this._currentScope.lookUpSymbol(e);if(!i){i=this._currentScope.addSymbol(e,9);const t="none"!==this._fileInfo.diagnosticRuleSet.reportPrivateUsage;Yt(e)&&t&&i.setIsPrivateMember()}const r={type:1,node:n,isConstant:Zt(e),isDefinedBySlots:!0,path:this._fileInfo.filePath,range:St(n.start,n.start+n.length,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};i.addDeclaration(r)}t||this._currentScope.setSlotsNames(e.map((e=>e.strings[0].value)))}_isInListComprehension(e,t=!1){let n,i,r=e;for(;r;){if(32===r.nodeType){if(t&&r.forIfNodes.length>0){const e=r.forIfNodes[0];if(n===e&&33===e.nodeType&&i===e.iterableExpression)return!1}return!0}i=n,n=r,r=r.parent}return!1}_addPatternCaptureTarget(e){const t=this._bindNameToScope(this._currentScope,e.value);if(this._createAssignmentTargetFlowNodes(e,!1,!1),t){const n={type:1,node:e,isConstant:Zt(e.value),inferredTypeSource:e.parent,path:this._fileInfo.filePath,range:St(e.start,dt.getEnd(e),this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};t.addDeclaration(n)}}_useExceptTargets(e,t){const n=this._currentExceptTargets;this._currentExceptTargets=e,t(),this._currentExceptTargets=n}_getDunderAllNamesFromImport(e){var t;const n=this._currentScope.lookUpSymbol(e);if(!n)return;const i=n.getDeclarations().find((e=>6===e.type)),r=(null==i?void 0:i.path)&&i.loadSymbolsFromPath?i.path:(null===(t=null==i?void 0:i.submoduleFallback)||void 0===t?void 0:t.path)&&i.submoduleFallback.loadSymbolsFromPath?i.submoduleFallback.path:void 0;if(!r)return;const s=this._fileInfo.importLookup(r);return s?s.dunderAllNames:void 0}_addImplicitFromImport(e,t){const n=e.module.nameParts[0].value,i=this._bindNameToScope(this._currentScope,n);i&&this._createAliasDeclarationForMultipartImportName(e,void 0,t,i),this._createFlowAssignment(e.module.nameParts[0])}_createAliasDeclarationForMultipartImportName(e,t,n,i){const r=e.module.nameParts[0].value;if(n&&n.isImportFound&&!n.isNativeLib&&n.resolvedPaths.length>0){const s=i.getDeclarations().find((e=>6===e.type&&e.firstNamePart===r));let o;if(o=s||{type:6,node:e,path:n.resolvedPaths[n.resolvedPaths.length-1],loadSymbolsFromPath:!1,moduleName:n.importName,isInExceptSuite:this._isInExceptSuite,range:{start:{line:0,character:0},end:{line:0,character:0}},firstNamePart:r,usesLocalName:!!t},t||1===e.module.nameParts.length)o.path=n.resolvedPaths[n.resolvedPaths.length-1],o.loadSymbolsFromPath=!0,this._addImplicitImportsToLoaderActions(n,o);else{let t=o;for(let i=1;i<e.module.nameParts.length&&!(i>=n.resolvedPaths.length);i++){const r=e.module.nameParts[i].value;let s=t.implicitImports?t.implicitImports.get(r):void 0;s||(s={path:n.resolvedPaths[i],loadSymbolsFromPath:!1,implicitImports:new Map},t.implicitImports||(t.implicitImports=new Map),t.implicitImports.set(r,s)),i===e.module.nameParts.length-1&&(s.path=n.resolvedPaths[i],s.loadSymbolsFromPath=!0,this._addImplicitImportsToLoaderActions(n,s)),t=s}}s||i.addDeclaration(o)}else{const n={type:6,node:e,path:"*** unresolved ***",loadSymbolsFromPath:!0,range:{start:{line:0,character:0},end:{line:0,character:0}},usesLocalName:!!t,moduleName:"",isUnresolved:!0,isInExceptSuite:this._isInExceptSuite};i.addDeclaration(n)}}_getWildcardImportNames(e){const t=[];if(e.dunderAllNames){if(!e.usesUnsupportedDunderAllForm)return e.dunderAllNames;t.push(...e.dunderAllNames)}return e.symbolTable.forEach(((e,n)=>{e.isExternallyHidden()||Yt(n)||t.push(n)})),t}_walkStatementsAndReportUnreachable(e){let t=!1;for(const n of e)Ut(n,this._currentFlowNode),t||(t=this._isCodeUnreachable()),t?this._targetFunctionDeclaration&&!this._targetFunctionDeclaration.isGenerator&&(new su).checkContainsYield(n)&&(this._targetFunctionDeclaration.isGenerator=!0):this.walk(n);return!1}_createStartFlowNode(){return{flags:ft.Start,id:kt()}}_createBranchLabel(e){return{flags:ft.BranchLabel,id:kt(),antecedents:[],preBranchAntecedent:e,affectedExpressions:void 0}}_createFlowNarrowForPattern(e,t){const n={flags:ft.NarrowForPattern,id:kt(),subjectExpression:e,statement:t,antecedent:this._currentFlowNode};this._currentFlowNode=n}_createContextManagerLabel(e,t,n){return{flags:ft.PostContextManager|ft.BranchLabel,id:kt(),antecedents:[],expressions:e,affectedExpressions:void 0,isAsync:t,blockIfSwallowsExceptions:n}}_createLoopLabel(){return{flags:ft.LoopLabel,id:kt(),antecedents:[],affectedExpressions:void 0}}_finishFlowLabel(e){return 0===e.antecedents.length?ru._unreachableFlowNode:1===e.antecedents.length&&e.flags===ft.BranchLabel?e.antecedents[0]:(this._functionCodeFlowComplexity+=e.antecedents.length,e)}_bindNeverCondition(e,t,n){const i=[];if(55===e.nodeType&&38===e.operator)this._bindNeverCondition(e.expression,t,!n);else if(7!==e.nodeType||36!==e.operator&&37!==e.operator)this._isNarrowingExpression(e,i,!0)&&i.filter((e=>38===e.nodeType)).length>0&&(this._currentFlowNode=this._createFlowConditional(n?ft.TrueNeverCondition:ft.FalseNeverCondition,this._currentFlowNode,e)),this._addAntecedent(t,this._currentFlowNode);else if(36===e.operator){const i=this._currentFlowNode;this._bindNeverCondition(e.leftExpression,t,n),this._currentFlowNode=i,this._bindNeverCondition(e.rightExpression,t,n)}else{const i=this._currentFlowNode,r=this._createBranchLabel();if(this._bindNeverCondition(e.leftExpression,r,n),i!==this._currentFlowNode){this._currentFlowNode=this._finishFlowLabel(r);const s=this._currentFlowNode;this._bindNeverCondition(e.rightExpression,t,n),s===this._currentFlowNode&&(this._currentFlowNode=i)}}}_bindConditional(e,t,n){this._setTrueFalseTargets(t,n,(()=>{this.walk(e)})),this._isLogicalExpression(e)||(this._addAntecedent(t,this._createFlowConditional(ft.TrueCondition,this._currentFlowNode,e)),this._addAntecedent(n,this._createFlowConditional(ft.FalseCondition,this._currentFlowNode,e)))}_disableTrueFalseTargets(e){this._setTrueFalseTargets(void 0,void 0,e)}_setTrueFalseTargets(e,t,n){const i=this._currentTrueTarget,r=this._currentFalseTarget;this._currentTrueTarget=e,this._currentFalseTarget=t,n(),this._currentTrueTarget=i,this._currentFalseTarget=r}_createFlowConditional(e,t,n){if(t.flags&ft.Unreachable)return t;const i=eu(n,this._fileInfo.executionEnvironment,this._typingImportAliases,this._sysImportAliases);if(!0===i&&e&ft.FalseCondition||!1===i&&e&ft.TrueCondition)return ru._unreachableFlowNode;const r=[];if(!this._isNarrowingExpression(n,r))return t;r.forEach((e=>{const t=At(e);this._currentScopeCodeFlowExpressions.add(t)}));const s=r.filter((e=>38===e.nodeType)),o={flags:e,id:kt(),reference:s.length>0?s[0]:void 0,expression:n,antecedent:t};return this._addExceptTargets(o),o}_isLogicalExpression(e){switch(e.nodeType){case 55:return 38===e.operator;case 7:return 36===e.operator||37===e.operator}return!1}_isNarrowingExpression(e,t,n=!1,i=!1){switch(e.nodeType){case 38:case 35:case 24:if(n){if(38!==e.nodeType)return!1;if(!i)return!1}return!!Dt(e)&&(t.push(e),!0);case 4:return t.push(e.name),this._isNarrowingExpression(e.rightExpression,t,n,!0),!0;case 7:{const i=39===e.operator||40===e.operator,r=12===e.operator||28===e.operator;if(i||r){if(11===e.rightExpression.nodeType&&26===e.rightExpression.constType)return this._isNarrowingExpression(e.leftExpression,t,n,!0);if(i&&9===e.leftExpression.nodeType&&38===e.leftExpression.leftExpression.nodeType&&"type"===e.leftExpression.leftExpression.value&&1===e.leftExpression.arguments.length&&0===e.leftExpression.arguments[0].argumentCategory)return this._isNarrowingExpression(e.leftExpression.arguments[0].valueExpression,t,n,!0);const s=this._isNarrowingExpression(e.leftExpression,t,n,!0);if(i)return s;if(r){const i=this._isNarrowingExpression(e.rightExpression,t,n,!0);return s||i}}return!(41!==e.operator&&42!==e.operator||48!==e.leftExpression.nodeType||!this._isNarrowingExpression(e.rightExpression,t,n,!0))||41===e.operator&&this._isNarrowingExpression(e.leftExpression,t,n,!0)}case 55:return 38===e.operator&&this._isNarrowingExpression(e.expression,t,n,!1);case 5:return this._isNarrowingExpression(e.rightExpression,t,n,!0);case 9:if(38===e.leftExpression.nodeType&&("isinstance"===e.leftExpression.value||"issubclass"===e.leftExpression.value)&&2===e.arguments.length)return this._isNarrowingExpression(e.arguments[0].valueExpression,t,n,!0);if(38===e.leftExpression.nodeType&&"callable"===e.leftExpression.value&&1===e.arguments.length)return this._isNarrowingExpression(e.arguments[0].valueExpression,t,n,!0);if(e.arguments.length>=1)return!n&&this._isNarrowingExpression(e.arguments[0].valueExpression,t,n,!0)}return!1}_createAssignmentTargetFlowNodes(e,t,n){switch(e.nodeType){case 38:case 35:case 24:this._createFlowAssignment(e,n),t&&this.walk(e);break;case 52:e.expressions.forEach((e=>{this._createAssignmentTargetFlowNodes(e,t,n)}));break;case 54:this._createAssignmentTargetFlowNodes(e.valueExpression,!1,n),t&&this.walk(e);break;case 56:this._createAssignmentTargetFlowNodes(e.expression,!1,n),t&&this.walk(e);break;case 31:e.entries.forEach((e=>{this._createAssignmentTargetFlowNodes(e,t,n)}));break;default:t&&this.walk(e)}}_createCallFlowNode(e){if(!this._isCodeUnreachable()){const t={flags:ft.Call,id:kt(),node:e,antecedent:this._currentFlowNode};this._currentFlowNode=t}Ut(e,this._currentFlowNode),this._isCodeUnreachable()||this._addExceptTargets(this._currentFlowNode)}_createVariableAnnotationFlowNode(){if(!this._isCodeUnreachable()){const e={flags:ft.VariableAnnotation,id:kt(),antecedent:this._currentFlowNode};this._currentFlowNode=e}}_createFlowAssignment(e,t=!1){let n=0;if(38===e.nodeType){const t=this._currentScope.lookUpSymbolRecursive(e.value);w(void 0!==t),n=t.symbol.id}const i=this._currentFlowNode;if(!this._isCodeUnreachable()&&Dt(e)){const i={flags:ft.Assignment,id:kt(),node:e,antecedent:this._currentFlowNode,targetSymbolId:n},r=At(e);this._currentScopeCodeFlowExpressions.add(r),t&&(i.flags|=ft.Unbind),35===e.nodeType&&this._addExceptTargets(i),this._currentFlowNode=i}t&&void 0!==Lt(e)||Ut(e,t?i:this._currentFlowNode)}_createFlowWildcardImport(e,t){if(!this._isCodeUnreachable()){const n={flags:ft.WildcardImport,id:kt(),node:e,names:t,antecedent:this._currentFlowNode};this._addExceptTargets(n),this._currentFlowNode=n}Ut(e,this._currentFlowNode)}_createFlowExhaustedMatch(e){if(!this._isCodeUnreachable()){const t={flags:ft.ExhaustedMatch,id:kt(),node:e,antecedent:this._currentFlowNode};this._currentFlowNode=t}Ut(e,this._currentFlowNode)}_isCodeUnreachable(){return!!(this._currentFlowNode.flags&ft.Unreachable)}_addExceptTargets(e){this._currentExceptTargets&&this._currentExceptTargets.forEach((t=>{this._addAntecedent(t,e)}))}_trackCodeFlowExpressions(e){const t=this._currentScopeCodeFlowExpressions;this._currentScopeCodeFlowExpressions=new Set,e();const n=this._currentScopeCodeFlowExpressions;return t&&this._currentScopeCodeFlowExpressions.forEach((e=>{t.add(e)})),this._currentScopeCodeFlowExpressions=t,n}_bindLoopStatement(e,t,n){const i=this._currentContinueTarget,r=this._currentBreakTarget,s=this._functionCodeFlowComplexity;this._currentContinueTarget=e,this._currentBreakTarget=t,this._functionCodeFlowComplexity=1,e.affectedExpressions=this._trackCodeFlowExpressions(n),this._currentContinueTarget=i,this._currentBreakTarget=r,this._functionCodeFlowComplexity=2*this._functionCodeFlowComplexity+s}_addAntecedent(e,t){this._currentFlowNode.flags&ft.Unreachable||e.antecedents.some((e=>e.id===t.id))||e.antecedents.push(t)}_bindNameToScope(e,t,n){const i=this._currentScope.getBindingType(t);if(void 0===i){let i=e.lookUpSymbol(t);return i||(i=e.addSymbol(t,5),3!==this._currentScope.type&&4!==this._currentScope.type||Yt(t)&&(Kt(t)?i.setIsExternallyHidden():this._fileInfo.isStubFile||this._fileInfo.isInPyTypedPackage?4===this._currentScope.type?i.setIsExternallyHidden():this._potentialPrivateSymbols.set(t,i):i.setIsPrivateMember()),n&&n.set(t,i)),i}{const e=(0===i?this._currentScope.parent:this._currentScope.getGlobalScope()).lookUpSymbolRecursive(t);if(e)return e.symbol}}_bindPossibleTupleNamedTarget(e,t){switch(e.nodeType){case 38:this._bindNameToScope(this._currentScope,e.value,t);break;case 52:e.expressions.forEach((e=>{this._bindPossibleTupleNamedTarget(e,t)}));break;case 31:e.entries.forEach((e=>{this._bindPossibleTupleNamedTarget(e,t)}));break;case 54:this._bindPossibleTupleNamedTarget(e.valueExpression,t);break;case 56:this._bindPossibleTupleNamedTarget(e.expression,t)}}_addImplicitSymbolToCurrentScope(e,t,n){const i=this._addSymbolToCurrentScope(e,!1);i&&(i.addDeclaration({type:0,node:t,intrinsicType:n,path:this._fileInfo.filePath,range:{start:{line:0,character:0},end:{line:0,character:0}},moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite}),i.setIsIgnoredForProtocolMatch())}_addSymbolToCurrentScope(e,t){let n=this._currentScope.lookUpSymbol(e);if(!n){let i=0;t&&(i|=1),2===this._currentScope.type&&(i|=4),this._fileInfo.isStubFile&&Yt(e)&&(i|=2),n=this._currentScope.addSymbol(e,i)}return n}_createNewScope(e,t,n){const i=this._currentScope,r=new Zc(e,t);this._currentScope=r;const s=4===e||3===e||1===e,o=this._currentScopeCodeFlowExpressions;return s&&(this._currentScopeCodeFlowExpressions=new Set),n(),this._currentScopeCodeFlowExpressions=o,this._currentScope=i,r}_addInferredTypeAssignmentForVariable(e,t,n=!1){switch(e.nodeType){case 38:{const i=e,r=this._currentScope.lookUpSymbolRecursive(i.value);if(r&&r.symbol){const s={type:1,node:e,isConstant:Zt(e.value),inferredTypeSource:t,isInferenceAllowedInPyTyped:this._isInferenceAllowedInPyTyped(i.value),typeAliasName:n?e:void 0,path:this._fileInfo.filePath,range:St(i.start,dt.getEnd(i),this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,docString:this._getVariableDocString(e)};r.symbol.addDeclaration(s)}break}case 35:{const n=this._getMemberAccessInfo(e);if(n){const i=e.memberName;let r=n.classScope.lookUpSymbol(i.value);if(!r){r=n.classScope.addSymbol(i.value,1);const e="none"!==this._fileInfo.diagnosticRuleSet.reportPrivateUsage;Yt(i.value)&&e&&r.setIsPrivateMember()}n.isInstanceMember?r.isClassMember()&&r.getDeclarations().some((e=>3===e.type&&e.isMethod))||r.setIsInstanceMember():r.setIsClassMember();const s={type:1,node:e.memberName,isConstant:Zt(i.value),inferredTypeSource:t,isDefinedByMemberAccess:!0,path:this._fileInfo.filePath,range:St(e.memberName.start,e.memberName.start+e.memberName.length,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,docString:this._getVariableDocString(e)};r.addDeclaration(s)}break}case 52:e.expressions.forEach((e=>{this._addInferredTypeAssignmentForVariable(e,t)}));break;case 54:this._addInferredTypeAssignmentForVariable(e.valueExpression,t);break;case 56:this._addInferredTypeAssignmentForVariable(e.expression,t);break;case 31:e.entries.forEach((e=>{this._addInferredTypeAssignmentForVariable(e,t)}))}}_isInferenceAllowedInPyTyped(e){return["__match_args__","__slots__","__all__"].some((t=>t===e))}_addTypeDeclarationForVariable(e,t){var n,i,r;let s=!1;switch(e.nodeType){case 38:{const o=e,a=this._currentScope.lookUpSymbolRecursive(o.value);if(a&&a.symbol){const s=this._isAnnotationFinal(t),l=this._isAnnotationTypeAlias(t);let c=t,u=t;l?(c=void 0,u=void 0,2!==this._currentScope.type&&3!==this._currentScope.type&&4!==this._currentScope.type&&this._addError(ml.Diagnostic.typeAliasNotInModuleOrClass(),t)):s.isFinal&&(u=s.finalTypeNode,s.finalTypeNode||(c=void 0));let p=this._isAnnotationClassVar(t);if(p.isClassVar&&(u=p.classVarTypeNode,p.classVarTypeNode||(c=void 0)),s.isFinal){const t=Dr(e);t&&10===t.nodeType&&(3!==(null===(n=e.parent)||void 0===n?void 0:n.nodeType)&&3!==(null===(r=null===(i=e.parent)||void 0===i?void 0:i.parent)||void 0===r?void 0:r.nodeType)||(p={isClassVar:!0,classVarTypeNode:void 0}))}const d={type:1,node:e,isConstant:Zt(o.value),isFinal:s.isFinal,isClassVar:p.isClassVar,isRequired:this._isRequiredAnnotation(u),isNotRequired:this._isNotRequiredAnnotation(u),typeAliasAnnotation:l?t:void 0,typeAliasName:l?e:void 0,path:this._fileInfo.filePath,typeAnnotationNode:c,range:St(o.start,dt.getEnd(o),this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,docString:this._getVariableDocString(e)};if(a.symbol.addDeclaration(d),p.isClassVar?a.symbol.setIsClassVar():a.symbol.setIsInstanceMember(),24===t.nodeType)if(this._isDataclassesAnnotation(t.baseExpression,"InitVar"))a.symbol.setIsInitVar();else if(this._isTypingAnnotation(t.baseExpression,"Annotated")&&t.items.length>0){const e=t.items[0].valueExpression;24===e.nodeType&&this._isDataclassesAnnotation(e.baseExpression,"InitVar")&&a.symbol.setIsInitVar()}}s=!0;break}case 35:{const n=this._getMemberAccessInfo(e);if(n){const i=e.memberName;let r=n.classScope.lookUpSymbol(i.value);if(!r){r=n.classScope.addSymbol(i.value,1);const e="none"!==this._fileInfo.diagnosticRuleSet.reportPrivateUsage;Yt(i.value)&&e&&r.setIsPrivateMember()}n.isInstanceMember?r.setIsInstanceMember():r.setIsClassMember();const o=this._isAnnotationFinal(t),a={type:1,node:e.memberName,isConstant:Zt(i.value),isDefinedByMemberAccess:!0,isFinal:o.isFinal,path:this._fileInfo.filePath,typeAnnotationNode:o.isFinal&&!o.finalTypeNode?void 0:t,range:St(e.memberName.start,e.memberName.start+e.memberName.length,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,docString:this._getVariableDocString(e)};r.addDeclaration(a),s=!0}break}}s||this._addError(ml.Diagnostic.annotationNotSupported(),t)}_isTypingAnnotation(e,t){return this._isKnownAnnotation(e,t,this._typingImportAliases,this._typingSymbolAliases)}_isDataclassesAnnotation(e,t){return this._isKnownAnnotation(e,t,this._dataclassesImportAliases,this._dataclassesSymbolAliases)}_isKnownAnnotation(e,t,n,i){if(38===e.nodeType){if(i.get(e.value)===t)return!0}else if(35===e.nodeType&&38===e.leftExpression.nodeType&&e.memberName.value===t){const t=e.leftExpression.value;return n.some((e=>e===t))}return!1}_getVariableDocString(e){var t,n,i,r;let s,o=e;for(;o&&3!==o.nodeType;)54!==o.nodeType||s||(s=o),o=o.parent;if(3!==(null==o?void 0:o.nodeType)){if(!s)return;o=s}const a=o.parent;if(47!==(null==a?void 0:a.nodeType))return;const l=a.parent;if(!l||36!==l.nodeType&&50!==l.nodeType)return;const c=l.statements.findIndex((e=>e===a));if(c<0||c===l.statements.length-1)return;const u=l.statements[c+1];if(47!==u.nodeType||!Vr(u))return;let p=!1;if(36===(null===(t=null==a?void 0:a.parent)||void 0===t?void 0:t.nodeType))p=!0;else if(50===(null===(n=null==a?void 0:a.parent)||void 0===n?void 0:n.nodeType)&&10===(null===(r=null===(i=null==a?void 0:a.parent)||void 0===i?void 0:i.parent)||void 0===r?void 0:r.nodeType))p=!0;else{const e=kr(a);e&&"__init__"===e.name.value&&Er(e,!0)&&(p=!0)}if(!p)return;const d=u.statements[0].strings;return 1===d.length?d[0].value:d.map((e=>e.value)).join("")}_isAnnotationFinal(e){let t,n=!1;return e&&(this._isTypingAnnotation(e,"Final")?n=!0:24===e.nodeType&&1===e.items.length&&(!this._isAnnotationFinal(e.baseExpression).isFinal||0!==e.items[0].argumentCategory||e.items[0].name||e.trailingComma||(n=!0,t=e.items[0].valueExpression))),{isFinal:n,finalTypeNode:t}}_isAnnotationClassVar(e){let t,n=!1;for(;e;){if(!(24===e.nodeType&&e.items.length>0&&this._isTypingAnnotation(e.baseExpression,"Annotated"))){if(this._isTypingAnnotation(e,"ClassVar")){n=!0;break}if(24===e.nodeType&&1===e.items.length){!this._isAnnotationClassVar(e.baseExpression).isClassVar||0!==e.items[0].argumentCategory||e.items[0].name||e.trailingComma||(n=!0,t=e.items[0].valueExpression);break}break}e=e.items[0].valueExpression}return{isClassVar:n,classVarTypeNode:t}}_isRequiredAnnotation(e){return!(!e||24!==e.nodeType||1!==e.items.length||!this._isTypingAnnotation(e.baseExpression,"Required"))}_isNotRequiredAnnotation(e){return!(!e||24!==e.nodeType||1!==e.items.length||!this._isTypingAnnotation(e.baseExpression,"NotRequired"))}_isAnnotationTypeAlias(e){return!!e&&this._isTypingAnnotation(e,"TypeAlias")}_getMemberAccessInfo(e){if(38!==e.leftExpression.nodeType)return;const t=e.leftExpression.value,n=kr(e);if(!n)return;const i=Er(n,!0);if(!i)return;let r=!1;if(n.parameters.length<1||!n.parameters[0].name)return;const s=i.name.value,o=n.parameters[0].name.value;if(t===s)r=!1;else{if(t!==o)return;if("__new__"===n.name.value)r=!1;else{r=!0;for(const e of n.decorators)if(38===e.expression.nodeType){const t=e.expression.value;if("staticmethod"===t)return;if("classmethod"===t){r=!1;break}}}}const a=Ft(i);return w(void 0!==a),{classNode:i,methodNode:n,classScope:a,isInstanceMember:r}}_addImplicitImportsToLoaderActions(e,t){e.filteredImplicitImports.forEach((e=>{const n=t.implicitImports?t.implicitImports.get(e.name):void 0;n?(n.path=e.path,n.loadSymbolsFromPath=!0):(t.implicitImports||(t.implicitImports=new Map),t.implicitImports.set(e.name,{path:e.path,loadSymbolsFromPath:!0,implicitImports:new Map}))}))}_handleTypingStubAssignmentOrAnnotation(e){if(!this._fileInfo.isTypingStubFile)return!1;let t;if(54===e.nodeType)t=e;else{if(54!==e.leftExpression.nodeType)return!1;t=e.leftExpression}if(38!==t.valueExpression.nodeType)return!1;const n=t.valueExpression,i=new Map([["Tuple",!0],["Generic",!0],["Protocol",!0],["Callable",!0],["Type",!0],["ClassVar",!0],["Final",!0],["Literal",!0],["TypedDict",!0],["Union",!0],["Optional",!0],["Annotated",!0],["TypeAlias",!0],["OrderedDict",!0],["Concatenate",!0],["TypeGuard",!0],["StrictTypeGuard",!0],["Unpack",!0],["Self",!0],["NoReturn",!0],["Never",!0],["LiteralString",!0]]),r=n.value;if(!i.has(r))return!1;const s=this._bindNameToScope(this._currentScope,r);return s&&s.addDeclaration({type:5,node:t,path:this._fileInfo.filePath,range:St(t.start,dt.getEnd(t),this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite}),!0}_deferBinding(e){this._moduleSymbolOnly||this._deferredBindingTasks.push({scope:this._currentScope,codeFlowExpressions:this._currentScopeCodeFlowExpressions,callback:e})}_bindDeferred(){for(;this._deferredBindingTasks.length>0;){const e=this._deferredBindingTasks.shift();this._currentScope=e.scope,this._currentScopeCodeFlowExpressions=e.codeFlowExpressions,e.callback()}}_bindYield(e){const t=kr(e);t?t.isAsync&&61===e.nodeType&&this._addError(ml.Diagnostic.yieldFromOutsideAsync(),e):function(e){let t=e.parent;for(;t;){if(30===t.nodeType)return t;if(50===t.nodeType)return;t=t.parent}}(e)||this._addError(ml.Diagnostic.yieldOutsideFunction(),e),this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.yieldStatements||(this._targetFunctionDeclaration.yieldStatements=[]),this._targetFunctionDeclaration.yieldStatements.push(e),this._targetFunctionDeclaration.isGenerator=!0),e.expression&&this.walk(e.expression),Ut(e,this._currentFlowNode)}_addDiagnostic(e,t,n,i){let r;switch(e){case"error":r=this._addError(n,i);break;case"warning":r=this._addWarning(n,i);break;case"information":r=this._addInformation(n,i);break;case"none":break;default:return k(e,`${e} is not expected`)}return r&&r.setRule(t),r}_addError(e,t){return this._fileInfo.diagnosticSink.addDiagnosticWithTextRange("error",e,t)}_addWarning(e,t){return this._fileInfo.diagnosticSink.addDiagnosticWithTextRange("warning",e,t)}_addInformation(e,t){return this._fileInfo.diagnosticSink.addDiagnosticWithTextRange("information",e,t)}}ru._unreachableFlowNode={flags:ft.Unreachable,id:kt()};class su extends _r{constructor(){super(...arguments),this._containsYield=!1}checkContainsYield(e){return this.walk(e),this._containsYield}visitYield(e){return this._containsYield=!0,!1}visitYieldFrom(e){return this._containsYield=!0,!1}}function ou(e,t,n,i){var r;if(4===n.nodeType)return null!==(r=ou(e,t,n.rightExpression,i))&&void 0!==r?r:ou(e,t,n.name,i);if(7===n.nodeType){const r=39===n.operator||40===n.operator,s=12===n.operator||28===n.operator;if(r||s){const o=39===n.operator||12===n.operator?i:!i;if(11===n.rightExpression.nodeType&&26===n.rightExpression.constType){let i=n.leftExpression;if(4===i.nodeType&&(i=i.name),Lr(t,i))return t=>function(e,t,n){const i=Ko(t,(e=>ta(e)));return e.mapSubtypesExpandTypeVars(i,void 0,((e,t)=>{if(ho(e))return e;const i=bo(t)&&0===t.details.constraints.length?t:e;return vo(e)&&Zs.isBuiltIn(e,"object")?n?Zo(to.createInstance(),e.condition):i:lo(e)===n?e:void 0}))}(e,t,o);if(24===i.nodeType&&Lr(t,i.baseExpression)&&1===i.items.length&&!i.trailingComma&&0===i.items[0].argumentCategory&&!i.items[0].name&&40===i.items[0].valueExpression.nodeType&&i.items[0].valueExpression.isInteger&&!i.items[0].valueExpression.isImaginary){const t=i.items[0].valueExpression.value;if("number"==typeof t)return n=>function(e,t,n,i){return e.mapSubtypesExpandTypeVars(t,void 0,(t=>{if(!vo(t)||!pa(t)||da(t)||!t.tupleTypeArguments)return t;const r=t.tupleTypeArguments.length;if(i<0||i>=r)return t;const s=e.makeTopLevelTypeVarsConcrete(t.tupleTypeArguments[i].type);if(n){if(!e.canAssignType(s,to.createInstance()))return}else if(lo(s))return;return t}))}(e,n,o,t)}}if(r&&9===n.leftExpression.nodeType){const i=e.getTypeOfExpression(n.leftExpression.leftExpression,void 0,2).type;if(_o(i)&&Zs.isBuiltIn(i,"type")&&1===n.leftExpression.arguments.length&&0===n.leftExpression.arguments[0].argumentCategory&&Lr(t,n.leftExpression.arguments[0].valueExpression)){const t=e.makeTopLevelTypeVarsConcrete(e.getTypeOfExpression(n.rightExpression).type);if(_o(t))return e=>function(e,t,n){return Ko(e,(e=>{if(vo(e)){const i=Zs.isDerivedFrom(t,Zs.cloneAsInstantiable(e));if(n)return i?Zs.isSameGenericClass(e,t)?e:Zs.cloneAsInstance(t):void 0;if(i&&Zs.isFinal(e))return;return e}return lo(e)?n?void 0:e:ho(e)&&n?Zs.cloneAsInstance(t):e}))}(e,t,o)}}if(r&&Lr(t,n.leftExpression)){const t=e.getTypeOfExpression(n.rightExpression).type;if(vo(t)&&(Zs.isEnumClass(t)||Zs.isBuiltIn(t,"bool"))&&void 0!==t.literalValue)return n=>pu(e,n,t,o,!0)}if(s){const r=12===n.operator?i:!i;if(Lr(t,n.leftExpression)){const t=e.getTypeOfExpression(n.rightExpression).type;if(vo(t)&&void 0!==t.literalValue)return n=>pu(e,n,t,r,!1)}if(Lr(t,n.rightExpression)){const t=e.getTypeOfExpression(n.leftExpression).type;if(vo(t)&&void 0!==t.literalValue)return n=>pu(e,n,t,r,!1)}if(24===n.leftExpression.nodeType&&1===n.leftExpression.items.length&&!n.leftExpression.trailingComma&&0===n.leftExpression.items[0].argumentCategory&&Lr(t,n.leftExpression.baseExpression)){const t=e.getTypeOfExpression(n.leftExpression.items[0].valueExpression).type;if(vo(t)&&ra(t))if(Zs.isBuiltIn(t,"str")){const i=e.getTypeOfExpression(n.rightExpression).type;if(vo(i)&&void 0!==i.literalValue)return n=>function(e,t,n,i,r){let s=!0;const o=Ko(t,(t=>{if(vo(t)&&Zs.isTypedDictClass(t)){const s=gl(e,t).get(n.literalValue);if(s&&sa(s.valueType))return r?e.canAssignType(s.valueType,i)?t:void 0:e.canAssignType(i,s.valueType)?void 0:t}return s=!1,t}));return s?o:t}(e,n,t,i,r)}else if(Zs.isBuiltIn(t,"int")){const i=e.getTypeOfExpression(n.rightExpression).type;if(vo(i)&&void 0!==i.literalValue)return n=>function(e,t,n,i,r){let s=!0;const o=Ko(t,(t=>{var o;if(vo(t)&&Zs.isTupleClass(t)&&!da(t)&&"number"==typeof n.literalValue){const s=n.literalValue;if(t.tupleTypeArguments&&s>=0&&s<t.tupleTypeArguments.length){const n=null===(o=t.tupleTypeArguments[s])||void 0===o?void 0:o.type;if(n&&sa(n))return r?e.canAssignType(n,i)?t:void 0:e.canAssignType(i,n)?void 0:t}}return s=!1,t}));return s?o:t}(e,n,t,i,r)}}}if(s&&9===n.leftExpression.nodeType&&1===n.leftExpression.arguments.length&&40===n.rightExpression.nodeType&&n.rightExpression.isInteger&&Lr(t,n.leftExpression.arguments[0].valueExpression)){const t=e.getTypeOfExpression(n.leftExpression.leftExpression,void 0,2).type;if(Eo(t)&&"builtins.len"===t.details.fullName){const t=n.rightExpression.value;if("number"==typeof t)return n=>function(e,t,n,i){return Ko(t,(t=>{const r=e.makeTopLevelTypeVarsConcrete(t);return vo(r)&&pa(r)&&!da(r)&&r.tupleTypeArguments?r.tupleTypeArguments.length===n===i?t:void 0:t}))}(e,n,t,o)}}if(s&&35===n.leftExpression.nodeType&&Lr(t,n.leftExpression.leftExpression)){const t=e.getTypeOfExpression(n.rightExpression).type,i=n.leftExpression.memberName;if(vo(t)&&void 0!==t.literalValue)return n=>uu(e,n,i.value,t,o)}if(35===n.leftExpression.nodeType&&Lr(t,n.leftExpression.leftExpression)){const t=e.getTypeOfExpression(n.rightExpression).type,i=n.leftExpression.memberName;if(vo(t)&&(Zs.isEnumClass(t)||Zs.isBuiltIn(t,"bool"))&&void 0!==t.literalValue)return n=>uu(e,n,i.value,t,o)}}if(41===n.operator&&i&&Lr(t,n.leftExpression)){const t=e.getTypeOfExpression(n.rightExpression).type;return n=>function(e,t,n){if(!vo(n)||!Zs.isBuiltIn(n))return t;const i=n.details.name;if(!["list","set","frozenset","deque","tuple"].some((e=>e===i)))return t;if(!n.typeArguments||1!==n.typeArguments.length)return t;let r=n.typeArguments[0];pa(n)&&n.tupleTypeArguments&&(r=Oo(n.tupleTypeArguments.map((e=>e.type))));let s=!0;const o=Qo(r),a=Ko(t,(t=>ho(t)?(s=!1,t):e.canAssignType(r,t)?t:e.canAssignType(o,t)?Ko(r,(e=>{if(vo(e)&&Lo(t,e))return e})):void 0));return s?a:t}(e,n,t)}if((41===n.operator||42===n.operator)&&Lr(t,n.rightExpression)){const t=e.getTypeOfExpression(n.leftExpression).type;if(vo(t)&&Zs.isBuiltIn(t,"str")&&ra(t)){const r=41===n.operator?i:!i;return n=>function(e,t,n,i){return Ko(t,(t=>{if(vo(t)&&Zs.isTypedDictClass(t)){const r=gl(e,t,!0).get(n.literalValue);if(i){if(!r)return Zs.isFinal(t)?void 0:t;if(r.isRequired||r.isProvided)return t;const e=t.typedDictNarrowedEntries,i=new Map;return e&&e.forEach(((e,t)=>{i.set(t,e)})),i.set(n.literalValue,{valueType:r.valueType,isRequired:!1,isProvided:!0}),Zs.cloneAsInstance(Zs.cloneForNarrowedTypedDictEntries(Zs.cloneAsInstantiable(t),i))}return void 0!==r&&(r.isRequired||r.isProvided)?void 0:t}return t}))}(e,n,Zs.cloneAsInstantiable(t),r)}}}if(9===n.nodeType){const r=e.getTypeOfExpression(n.leftExpression,void 0,2).type;if(Eo(r)&&("isinstance"===r.details.builtInName||"issubclass"===r.details.builtInName)&&2===n.arguments.length){const s="isinstance"===r.details.builtInName,o=n.arguments[0].valueExpression,a=n.arguments[1].valueExpression;if(Lr(t,o)){const t=function(e){let t=!1;const n=[],i=e=>{e.forEach((e=>{_o(e)||bo(e)&&Ks.isInstantiable(e)||co(e)||Eo(e)&&2===e.details.parameters.length&&1===e.details.parameters[0].category&&2===e.details.parameters[1].category?n.push(e):t=!0}))};return Jo(e,(e=>{yo(e)&&Ks.isInstance(e)&&pa(e)?e.tupleTypeArguments&&i(e.tupleTypeArguments.map((e=>e.type))):i([e])})),t?void 0:n}(e.getTypeOfExpression(a,void 0,168).type);if(t)return r=>{const o=cu(e,r,t,s,i,!1,n);return ao(o)?cu(e,r,t,s,i,!0,n):o}}}if(Eo(r)&&"callable"===r.details.builtInName&&1===n.arguments.length&&Lr(t,n.arguments[0].valueExpression))return t=>{let r=hu(e,t,i,n,!1);return i&&ao(r)&&(r=hu(e,t,i,n,!0)),r};if(_o(r)&&Zs.isBuiltIn(r,"bool")&&1===n.arguments.length&&!n.arguments[0].name&&Lr(t,n.arguments[0].valueExpression))return t=>lu(e,t,i);if(n.arguments.length>=1&&Lr(t,n.arguments[0].valueExpression)&&Eo(r)&&r.details.declaredReturnType&&vo(r.details.declaredReturnType)&&Zs.isBuiltIn(r.details.declaredReturnType,["TypeGuard","StrictTypeGuard"])){const t=e.getTypeOfExpression(n).type;if(vo(t)&&Zs.isBuiltIn(t,"bool")&&t.typeGuardType){const n=Zs.isBuiltIn(r.details.declaredReturnType,"StrictTypeGuard"),s=t.typeGuardType;return t=>function(e,t,n,i,r){return r?Ko(t,(t=>Ko(n,(r=>{const s=e.canAssignType(n,t),o=e.canAssignType(t,r);if(i){if(s)return t;if(o)return r}else if(!s&&!s)return t})))):i?n:t}(e,t,s,i,n)}}}if(Lr(t,n))return t=>lu(e,t,i);if(38===n.nodeType&&38===t.nodeType&&n!==t){const r=au(e,n,n);if(r&&1===r.length&&1===r[0].type){const s=au(e,t,n);if(s){let o=[];if(s.length>1&&(o=s.filter((t=>e.isNodeReachable(n,t.node)&&e.isNodeReachable(t.node,r[0].node)))),0===o.length){const s=r[0].inferredTypeSource;if(s&&!Mr(n,s)&&yr(s))return ou(e,t,s,i)}}}}return 55===n.nodeType&&38===n.operator?ou(e,t,n.expression,!i):void 0}function au(e,t,n){const i=zs(t);if(1!==(null==i?void 0:i.type)&&3!==(null==i?void 0:i.type))return;const r=i.lookUpSymbol(t.value);if(!r)return;const s=r.getDeclarations();if(0===s.length||s.some((e=>1!==e.type&&2!==e.type)))return;let o;if(s.some((e=>{const t=Rr(2===e.type?e.node.name:e.node);return!(!o||t===o)||(o=t,!1)})))return;const a=s.filter((t=>e.isNodeReachable(n,t.node)));return a.length>0?a:void 0}function lu(e,t,n){return Ko(t,(t=>{if(n){if(e.canBeTruthy(t))return e.removeFalsinessFromType(t)}else if(e.canBeFalsy(t))return e.removeTruthinessFromType(t)}))}function cu(e,t,n,i,r,s,o){const a=Ko(t,(e=>ta(e))),l=(t,a,l,c)=>{const u=[];let p=!1,d=!1;for(const c of n){const n=e.makeTopLevelTypeVarsConcrete(c);if(_o(n)){const h=!bo(c)&&(Zs.isDerivedFrom(t,n)||i&&Zs.isProtocolClass(n)&&e.canAssignType(n,t)||Zs.isBuiltIn(n,"dict")&&Zs.isTypedDictClass(t)),m=Zs.isDerivedFrom(n,t)||i&&Zs.isProtocolClass(t)&&e.canAssignType(t,n);if(h&&(p=!0),m&&h&&!Zs.isSameGenericClass(t,n)&&(d=!0),r)if(h)u.push(Zo(t,l));else if(m){let n=c;if(yo(c)&&(Zs.isSpecialBuiltIn(c)||c.details.typeParameters.length>0)){const i=new jo(na(c)),r=Zs.cloneForSpecialization(c,void 0,!1);e.populateTypeVarMapBasedOnExpectedType(r,t,i,void 0)&&(n=fa(r,i,!0))}u.push(Zo(n,l))}else if(s){const e=`<subclass of ${t.details.name} and ${n.details.name}>`,r=Vt(o);let s=Zs.createInstantiable(e,br(o,r.moduleName,e),r.moduleName,r.filePath,0,Ir(o),void 0,t.details.effectiveMetaclass,t.details.docString);s.details.baseClasses=[Zs.cloneAsInstantiable(t),n],Ha(s),s=Zo(s,n.condition),bo(a)&&!a.details.isParamSpec&&0===a.details.constraints.length&&(s=Zo(s,[{typeVarName:oo.getNameWithScope(a),constraintIndex:0,isConstrainedTypeVar:!1}])),u.push(i?Zs.cloneAsInstance(s):s)}}else if(bo(c)&&Ks.isInstantiable(c))i&&Ks.isInstance(a)?bo(a)&&Ao(Fa(c),a)?r&&u.push(a):r?u.push(Fa(c)):(u.push(a),d=!0):!i&&Ks.isInstantiable(a)&&(bo(a)&&Ao(c,a)?r&&u.push(a):r?u.push(c):(u.push(a),d=!0));else if(Eo(c)&&i){let e=!1;yo(t)&&(e=!!Ks.isInstantiable(a)||!!va(t,"__call__")),e&&(r?u.push(a):p=!0)}}return r||p&&!d||u.push(c),i?u.map((e=>Fa(e))):u},c=[],u=[],p=e.mapSubtypesExpandTypeVars(a,void 0,((t,s)=>{const a=Xo(t)?t:s,p=vo(t)&&Zs.isBuiltIn(t,"type");if(r&&ho(t))return i?c.push(Oo(n.map((e=>Fa(e))))):c.push(Oo(n)),void u.push(t);if(i){if(lo(t)){const e=n.some((e=>co(e)));return r?e?t:void 0:e?void 0:t}if((To(t)||vo(t)&&Zs.isBuiltIn(t,"ModuleType"))&&r){const t=n.filter((t=>{const n=e.makeTopLevelTypeVarsConcrete(t);return _o(n)&&Zs.isProtocolClass(n)}));if(t.length>0)return Fa(Oo(t))}if(vo(t)&&!p)return Oo(l(Zs.cloneAsInstantiable(t),Fa(s),Xo(t),a));if((Eo(t)||ko(t))&&i)return Oo(((t,i)=>{const s=[];if(r)for(const r of n){const n=e.makeTopLevelTypeVarsConcrete(r);e.canAssignType(t,Fa(n))&&(Eo(r)?s.push(i):s.push(Fa(r)))}else n.some((n=>{const i=e.makeTopLevelTypeVarsConcrete(n);return!(yo(i)&&!Zs.isProtocolClass(i))&&e.canAssignType(t,Fa(i))}))||s.push(i);return s})(t,Fa(s)));if(_o(t)||p){const e=n.some((e=>_o(e)&&Zs.isBuiltIn(e,"type")));return r?e?a:void 0:e?void 0:a}}else{if(_o(t))return Oo(l(t,s,Xo(t),a));if(p){const n=e.getBuiltInObject(o,"object");if(n&&vo(n))return Oo(l(Zs.cloneAsInstantiable(n),Na(s),Xo(t),a))}}return r?void 0:a}));return ao(p)&&c.length>0?Oo(c):u.length>0?Oo([p,...u]):p}function uu(e,t,n,i,r){return Ko(t,(t=>{let s;if(vo(t)?s=_a(t,n):_o(t)&&(s=va(t,n)),s&&s.isTypeDeclared){const n=e.getTypeOfMember(s);if(sa(n))return r?e.canAssignType(n,i)?t:void 0:e.canAssignType(i,n)?void 0:t}return t}))}function pu(e,t,n,i,r){return Ko(t,(t=>{if(vo(t=e.makeTopLevelTypeVarsConcrete(t))&&Zs.isSameGenericClass(n,t)){if(void 0!==t.literalValue){const e=Zs.isLiteralValueSame(t,n);if(e&&!i||!e&&i)return;return t}if(i)return n;{const i=du(e,t);if(i&&i.length>0)return Oo(i.filter((e=>!Zs.isLiteralValueSame(e,n))))}}else if(i&&(r||lo(t)))return;return t}))}function du(e,t){if(Zs.isBuiltIn(t,"bool"))return[Zs.cloneWithLiteral(t,!0),Zs.cloneWithLiteral(t,!1)];if(Zs.isEnumClass(t)){const n=[];return t.details.fields.forEach((i=>{if(!i.isIgnoredForProtocolMatch()){const r=e.getEffectiveTypeOfSymbol(i);vo(r)&&Zs.isSameGenericClass(t,r)&&void 0!==r.literalValue&&n.push(r)}})),n}}function hu(e,t,n,i,r){return e.mapSubtypesExpandTypeVars(t,void 0,(e=>{switch(e.category){case 5:case 6:return n?e:void 0;case 3:case 8:return n?void 0:e;case 7:if(Ks.isInstantiable(e))return n?e:void 0;if(va(e,"__call__"))return n?e:void 0;if(!n)return e;if(r){const t=`<callable subtype of ${e.details.name}>`,n=Vt(i);let r=Zs.createInstantiable(t,br(i,n.moduleName,t),n.moduleName,n.filePath,0,Ir(i),void 0,e.details.effectiveMetaclass,e.details.docString);r.details.baseClasses=[Zs.cloneAsInstantiable(e)],Ha(r),r=Zo(r,e.condition);const s=Xs.createInstance("__call__","","",64),o={category:0,name:"self",type:Zs.cloneAsInstance(r),hasDeclaredType:!0};return Xs.addParameter(s,o),Xs.addDefaultParameters(s),s.details.declaredReturnType=Ys.create(),r.details.fields.set("__call__",qo.createWithType(4,s)),Zs.cloneAsInstance(r)}return;default:return e}}))}const mu=["builtins.bool","builtins.bytearray","builtins.bytes","builtins.dict","builtins.float","builtins.frozenset","builtins.int","builtins.list","builtins.set","builtins.str","builtins.tuple"];function fu(e,t,n,i){switch(n.nodeType){case 65:return function(e,t,n,i){if(!i)return t;let r=vu(e,t,n.entries.length,n.starEntryIndex);return r=r.filter((t=>{let i=!0;const r=[];let s=t.isTuple;if(n.entries.forEach(((o,a)=>{const l=Tu(e,n,t,a,n.entries.length,n.starEntryIndex,!0,!1),c=fu(e,l,o,!0);a===n.starEntryIndex?vo(c)&&c.tupleTypeArguments&&!da(c)&&c.tupleTypeArguments?r.push(...c.tupleTypeArguments.map((e=>e.type))):(r.push(c),s=!1):(r.push(c),ao(c)&&(i=!1))})),i){if(s){const i=e.getBuiltInType(n,"tuple");i&&_o(i)&&(t.subtype=Zs.cloneAsInstance(Va(i,r.map((e=>({type:e,isUnbounded:!1}))))))}if(t.isObject){const i=e.getTypingType(n,"Sequence");i&&_o(i)&&(t.subtype=Zs.cloneAsInstance(Zs.cloneForSpecialization(i,[Qo(Oo(r))],!0)))}}return i})),Oo(r.map((e=>e.subtype)))}(e,t,n,i);case 67:return function(e,t,n,i){const r=e.getTypeOfExpression(n.expression).type;return Ko(t,i?t=>{if(e.canAssignType(t,r))return r}:t=>{if(!(vo(r)&&ra(r)&&vo(t)&&ra(t)&&e.canAssignType(r,t)||lo(t)&&lo(r)))return vo(t)&&Zs.isBuiltIn(t,"bool")&&void 0===t.literalValue&&vo(r)&&Zs.isBuiltIn(r,"bool")&&void 0!==r.literalValue?Zs.cloneWithLiteral(r,!r.literalValue):t})}(e,t,n,i);case 68:return function(e,t,n,i){let r=e.getTypeOfExpression(n.className,void 0,2).type;if(yo(r)&&!r.typeAliasInfo&&(r=xa(r)),!i){if(!_o(r))return t;let s=r;s.details.typeParameters.length>0&&(s=Zs.cloneForSpecialization(s,void 0,!1));const o=Fa(s);return e.mapSubtypesExpandTypeVars(t,void 0,((t,r)=>{if(!vo(t))return r;if(!e.canAssignType(o,t))return t;if(0===n.arguments.length)return;if(!e.canAssignType(t,o)&&!Zs.isFinal(t))return t;if(1===n.arguments.length&&!n.arguments[0].name&&mu.some((e=>s.details.fullName===e)))return;let a=[];n.arguments.some((e=>!e.name))&&yo(t)&&(a=gu(e,t));for(let s=0;s<n.arguments.length;s++)if(!ao(yu(e,n.arguments[s],s,a,t,i)))return r}))}return Ks.isInstantiable(r)?e.mapSubtypesExpandTypeVars(r,void 0,((r,s)=>ho(r)?s:_o(r)?e.mapSubtypesExpandTypeVars(t,void 0,(t=>{if(ho(t))return Fa(s);if(vo(t)){let o;if(e.canAssignType(r,Zs.cloneAsInstantiable(t)))o=t;else{if(!e.canAssignType(Zs.cloneAsInstantiable(t),r))return;if(o=Zo(Fa(s),Xo(t)),_o(s)&&vo(t)&&(Zs.isSpecialBuiltIn(s)||s.details.typeParameters.length>0)){const n=new jo(na(s)),i=Zs.cloneForSpecialization(s,void 0,!1),r=Zs.cloneAsInstance(i);e.populateTypeVarMapBasedOnExpectedType(r,t,n,[])&&(o=fa(r,n,!0))}}let a=[];n.arguments.some((e=>!e.name))&&(a=gu(e,r));let l=!0;if(n.arguments.forEach(((t,n)=>{ao(yu(e,t,n,a,o,i))&&(l=!1)})),l)return o}})):void 0)):(e.addDiagnostic(Vt(n).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.DiagnosticAddendum.typeNotClass().format({type:e.printType(r)}),n.className),no.createNever())}(e,t,n,i);case 66:return function(e,t,n,i){let r=t;return i?Oo(n.orPatterns.map((t=>{const n=fu(e,r,t,!0);return r=fu(e,r,t,!1),n}))):(n.orPatterns.forEach((t=>{r=fu(e,r,t,!1)})),r)}(e,t,n,i);case 70:return function(e,t,n,i){if(!i)return t;let r=_u(e,t);return r=r.filter((t=>{let r=!0;return n.entries.forEach((s=>{if(t.typedDict){if(71===s.nodeType){const o=fu(e,e.getBuiltInObject(n,"str"),s.keyPattern,i);ao(o)&&(r=!1);const a=Ko(o,(n=>{if(ho(n))return n;if(vo(n)&&Zs.isBuiltIn(n,"str")){if(!ra(n))return Ys.create();const i=gl(e,t.typedDict).get(n.literalValue);if(i){const t=fu(e,i.valueType,s.valuePattern,!0);if(!ao(t))return t}}}));ao(a)&&(r=!1)}}else if(t.dictTypeArgs&&71===s.nodeType){const n=fu(e,t.dictTypeArgs.key,s.keyPattern,i),o=fu(e,t.dictTypeArgs.value,s.valuePattern,i);(ao(n)||ao(o))&&(r=!1)}})),r})),Oo(r.map((e=>e.subtype)))}(e,t,n,i);case 73:return function(e,t,n,i){const r=e.getTypeOfExpression(n.expression).type,s=[];return e.mapSubtypesExpandTypeVars(r,void 0,((r,o)=>{s.push(e.mapSubtypesExpandTypeVars(t,Xo(r),(t=>{if(!i){if(vo(t)&&Zs.isEnumClass(t)&&!ra(t)&&vo(r)&&Lo(t,r)&&ra(r)){const n=du(e,t);if(n)return Oo(n.filter((e=>!Zs.isLiteralValueSame(r,e))))}else if(vo(t)&&vo(r)&&Zs.isLiteralValueSame(r,t))return;return t}return ao(r)||ao(t)?no.createNever():ho(r)||ho(t)?po(r)||po(t)?Ys.create():io.create():e.useSpeculativeMode(n.expression,(()=>e.getTypeFromMagicMethodReturn(r,[t],"__eq__",n.expression,void 0)))?o:void 0})))})),Oo(s)}(e,t,n,i);case 69:return i?t:no.createNever();case 0:return t}}function gu(e,t){const n=va(t,"__match_args__");if(n){const t=e.getTypeOfMember(n);if(vo(t)&&pa(t)&&!da(t)&&t.tupleTypeArguments){const e=t.tupleTypeArguments;if(e.every((e=>vo(e.type)&&Zs.isBuiltIn(e.type,"str")&&ra(e.type))))return e.map((e=>e.type.literalValue))}}return[]}function yu(e,t,n,i,r,s){var o;let a,l;if(t.name?a=t.name.value:n<i.length&&(a=i[n]),ho(r))return r;if(!yo(r))return Ys.create();if(yo(r)&&mu.some((e=>r.details.fullName===e))&&0===n&&!t.name)l=Zs.cloneAsInstance(r);else if(a&&(l=null===(o=e.useSpeculativeMode(t,(()=>e.getTypeFromObjectMember(t,Zs.cloneAsInstance(r),a))))||void 0===o?void 0:o.type),!l){if(!s)return r;if(Zs.isFinal(r))return no.createNever();l=Ys.create()}return fu(e,l,t.pattern,s)}function _u(e,t){const n=[];return Jo(t,(t=>{const i=e.makeTopLevelTypeVarsConcrete(t);if(ho(i))n.push({subtype:t,dictTypeArgs:{key:i,value:i}});else if(vo(i))if(Zs.isTypedDictClass(i))n.push({subtype:t,typedDict:i});else{let e;for(const t of i.details.mro)if(_o(t)&&Zs.isBuiltIn(t,"Mapping")){e=t;break}if(e){const r=ha(e,i);r.typeArguments&&r.typeArguments.length>=2&&n.push({subtype:t,dictTypeArgs:{key:r.typeArguments[0],value:r.typeArguments[1]}})}}})),n}function vu(e,t,n,i){const r=[],s=void 0===i?n:n-1;return Jo(t,(t=>{const n=e.makeTopLevelTypeVarsConcrete(t);let o;if(ho(n))r.push({subtype:t,entryTypes:[n],isIndeterminateLength:!0});else if(vo(n)){if(Zs.isBuiltIn(n,"object"))return void r.push({subtype:t,entryTypes:[Fa(n)],isIndeterminateLength:!0,isObject:!0});for(const e of n.details.mro){if(!_o(e))break;if(Zs.isBuiltIn(e,"str")||Zs.isBuiltIn(e,"bytes")||Zs.isBuiltIn(e,"bytearray"))break;if(Zs.isBuiltIn(e,"Sequence")){o=e;break}if(pa(e)){o=e;break}}if(o){const e=ha(o,n);pa(e)?e.tupleTypeArguments&&(da(e)?r.push({subtype:t,entryTypes:[Oo(e.tupleTypeArguments.map((e=>e.type)))],isIndeterminateLength:!0,isTuple:!0}):e.tupleTypeArguments.length>=s&&(void 0!==i||e.tupleTypeArguments.length===s)&&r.push({subtype:t,entryTypes:e.tupleTypeArguments.map((e=>e.type)),isIndeterminateLength:!1,isTuple:!0})):r.push({subtype:t,entryTypes:[e.typeArguments&&e.typeArguments.length>0?e.typeArguments[0]:Ys.create()],isIndeterminateLength:!0})}}})),r}function Tu(e,t,n,i,r,s,o,a){if(n.isIndeterminateLength){let r=n.entryTypes[0];if(a){const n=e.getBuiltInObject(t,"object");n&&vo(n)&&(r=n)}return o||i!==s||ao(r)||(r=Iu(e,t,r)),r}if(void 0===s||i<s)return n.entryTypes[i];if(i===s){let i=Oo(n.entryTypes.slice(s,s+n.entryTypes.length-r+1).map((e=>Qo(e))));return o||(i=Iu(e,t,i)),i}const l=n.entryTypes.length-(r-i);return w(l>=0&&l<n.entryTypes.length),n.entryTypes[l]}function bu(e,t,n,i,r){switch(t=fu(e,t,r,!0),r.nodeType){case 65:{const s=vu(e,t,r.entries.length,r.starEntryIndex);r.entries.forEach(((t,o)=>{const a=Oo(s.map((t=>Tu(e,r,t,o,r.entries.length,r.starEntryIndex,!1,i))));bu(e,a,n,!1,t)}));break}case 66:r.target&&e.assignTypeToExpression(r.target,t,n,r.target),r.orPatterns.forEach((r=>{bu(e,t,n,i,r),t=fu(e,t,r,!1)}));break;case 69:e.assignTypeToExpression(r.target,r.isWildcard?io.create():t,n,r.target);break;case 70:{const i=_u(e,t);r.entries.forEach((t=>{const s=[],o=[];i.forEach((n=>{if(n.typedDict)if(71===t.nodeType){const i=fu(e,e.getBuiltInObject(r,"str"),t.keyPattern,!0);s.push(i),Jo(i,(t=>{if(vo(t)&&Zs.isBuiltIn(t,"str")&&ra(t)){const i=gl(e,n.typedDict).get(t.literalValue);o.push(i?i.valueType:Ys.create())}else o.push(Ys.create())}))}else 72===t.nodeType&&(s.push(e.getBuiltInObject(r,"str")),o.push(Ys.create()));else if(n.dictTypeArgs)if(71===t.nodeType){const i=fu(e,n.dictTypeArgs.key,t.keyPattern,!0);s.push(i),o.push(fu(e,n.dictTypeArgs.value,t.valuePattern,!0))}else 72===t.nodeType&&(s.push(n.dictTypeArgs.key),o.push(n.dictTypeArgs.value))}));const a=Oo(s),l=Oo(o);if(71===t.nodeType)bu(e,a,n,!1,t.keyPattern),bu(e,l,n,!1,t.valuePattern);else if(72===t.nodeType){const i=e.getBuiltInType(r,"dict"),s=e.getBuiltInObject(r,"str"),o=i&&_o(i)&&vo(s)?Zs.cloneAsInstance(Zs.cloneForSpecialization(i,[a,l],!0)):Ys.create();e.assignTypeToExpression(t.target,o,n,t.target)}}));break}case 68:{const i=r.arguments.map((e=>[]));e.mapSubtypesExpandTypeVars(t,void 0,(n=>{vo(n)?Jo(t,(t=>{const s=e.makeTopLevelTypeVarsConcrete(t);if(ho(s))r.arguments.forEach(((e,t)=>{i[t].push(s)}));else if(vo(s)){let t=[];r.arguments.some((e=>!e.name))&&(t=gu(e,Zs.cloneAsInstantiable(n))),r.arguments.forEach(((r,s)=>{const o=yu(e,r,s,t,Zs.cloneAsInstantiable(n),!0);i[s].push(o)}))}})):r.arguments.forEach(((e,t)=>{i[t].push(Ys.create())}))})),r.arguments.forEach(((t,r)=>{bu(e,Oo(i[r]),n,!1,t.pattern)}));break}}}function Iu(e,t,n){if(ao(n))return n;const i=Fa(e.getBuiltInObject(t,"list"));return i&&vo(i)?Zs.cloneForSpecialization(i,[n],!0):Ys.create()}const Su=new Map([["Tuple",{version:De.V3_9,fullName:"builtins.tuple",replacementText:"tuple"}],["List",{version:De.V3_9,fullName:"builtins.list",replacementText:"list"}],["Dict",{version:De.V3_9,fullName:"builtins.dict",replacementText:"dict"}],["Set",{version:De.V3_9,fullName:"builtins.set",replacementText:"set"}],["FrozenSet",{version:De.V3_9,fullName:"builtins.frozenset",replacementText:"frozenset"}],["Type",{version:De.V3_9,fullName:"builtins.type",replacementText:"type"}],["Deque",{version:De.V3_9,fullName:"collections.deque",replacementText:"collections.deque"}],["DefaultDict",{version:De.V3_9,fullName:"collections.defaultdict",replacementText:"collections.defaultdict"}],["OrderedDict",{version:De.V3_9,fullName:"collections.OrderedDict",replacementText:"collections.OrderedDict"}],["Counter",{version:De.V3_9,fullName:"collections.Counter",replacementText:"collections.Counter"}],["ChainMap",{version:De.V3_9,fullName:"collections.ChainMap",replacementText:"collections.ChainMap"}]]),xu=new Map([["Optional",{version:De.V3_10,fullName:"typing.Optional",replacementText:"| None"}],["Union",{version:De.V3_10,fullName:"typing.Union",replacementText:"|"}]]);class Cu extends _r{constructor(e,t){super(),this._isUnboundCheckSuppressed=!1,this._scopedNodes=[],this._moduleNode=e,this._fileInfo=Vt(e),this._evaluator=t}check(){this._scopedNodes.push(this._moduleNode),this._walkStatementsAndReportUnreachable(this._moduleNode.statements);const e=Wt(this._moduleNode);e&&(this._evaluator.markNamesAccessed(this._moduleNode,e.names),this._reportUnusedDunderAllSymbols(e.stringNodes)),this._validateSymbolTables(),this._reportDuplicateImports()}walk(e){zt(e)?this._evaluator.suppressDiagnostics(e,(()=>{super.walk(e)})):super.walk(e)}visitSuite(e){return this._walkStatementsAndReportUnreachable(e.statements),!1}visitStatementList(e){return e.statements.forEach((e=>{yr(e)&&this._evaluator.getType(e)})),!0}visitClass(e){const t=this._evaluator.getTypeOfClass(e);return this.walk(e.suite),this.walkMultiple(e.decorators),this.walkMultiple(e.arguments),t&&(Zs.isProtocolClass(t.classType)&&(e.arguments.forEach((e=>{if(!e.name){const n=this._evaluator.getType(e.valueExpression);n&&_o(n)&&!Zs.isBuiltIn(n,"Protocol")&&!Zs.isBuiltIn(n,"Generic")&&(Zs.isProtocolClass(n)||this._evaluator.addError(ml.Diagnostic.protocolBaseClass().format({classType:this._evaluator.printType(t.classType,!1),baseType:this._evaluator.printType(n,!1)}),e.valueExpression))}})),this._validateProtocolTypeParamVariance(e,t.classType)),this._fileInfo.isStubFile||(this._validateBaseClassOverrides(t.classType),this._validateSlotsClassVarConflict(t.classType)),this._validateMultipleInheritanceCompatibility(t.classType,e.name),this._validateConstructorConsistency(t.classType),this._validateFinalMemberOverrides(t.classType),this._validateInstanceVariableInitialization(t.classType),this._validateFinalClassNotAbstract(t.classType,e),this._validateDataClassPostInit(t.classType,e),this._validateProtocolCompatibility(t.classType,e),this._reportDuplicateEnumMembers(t.classType),Zs.isTypedDictClass(t.classType)&&this._validateTypedDictClassSuite(e.suite),Zs.isEnumClass(t.classType)&&this._validateEnumClassOverride(e,t.classType)),this._scopedNodes.push(e),!1}visitFunction(e){var t;const n=this._evaluator.getTypeOfFunction(e),i=Er(e,!0);if(n){let r=!1;e.parameters.forEach(((e,t)=>{if(e.name)if(1===e.category){const t=e.typeAnnotation||e.typeAnnotationComment;if(t&&35===t.nodeType&&"args"===t.memberName.value){const e=this._evaluator.getType(t.leftExpression);e&&bo(e)&&e.details.isParamSpec&&(r=!0)}}else 2===e.category&&(r=!1);if(e.name&&0===e.category&&r&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.namedParamAfterParamSpecArgs().format({name:e.name.value}),e.name),e.name&&"_"!==e.name.value){const i=n.functionType.details.parameters.find((t=>{var n;return t.name===(null===(n=e.name)||void 0===n?void 0:n.value)}));if(i){const r=i.type;if(po(r)||bo(r)&&r.details.isSynthesized&&!r.details.isSynthesizedSelf)this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,$o.reportUnknownParameterType,ml.Diagnostic.paramTypeUnknown().format({paramName:e.name.value}),e.name);else if(La(r)){const t=new il;t.addMessage(ml.DiagnosticAddendum.paramType().format({paramType:this._evaluator.printType(r,!0)})),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,$o.reportUnknownParameterType,ml.Diagnostic.paramTypePartiallyUnknown().format({paramName:e.name.value})+t.getString(),e.name)}let s=!1;(n.functionType.details.parameters[t].typeAnnotation||bo(r)&&r.details.isSynthesizedSelf)&&(s=!0),s||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingParameterType,$o.reportMissingParameterType,ml.Diagnostic.paramAnnotationMissing().format({name:e.name.value}),e.name)}}if(e.defaultValue&&this._fileInfo.isStubFile){const t=this._evaluator.getType(e.defaultValue);t&&ca(t)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStubStatement,$o.reportInvalidStubStatement,ml.Diagnostic.defaultValueNotEllipsis(),e.defaultValue)}}));const s=n.functionType.details.parameters.filter((e=>!!(e.typeAnnotation&&bo(e.type)&&wo(e.type)&&0!==e.category&&e.name&&e.type.paramSpecAccess)));1===s.length&&s[0].typeAnnotation&&this._evaluator.addError(ml.Diagnostic.paramSpecArgsKwargsUsage(),s[0].typeAnnotation),this._fileInfo.isStubFile&&(e.returnTypeAnnotation||(null===(t=e.functionAnnotationComment)||void 0===t?void 0:t.returnTypeAnnotation)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,$o.reportUnknownParameterType,ml.Diagnostic.returnTypeUnknown(),e.name)),i&&this._validateMethod(e,n.functionType,i)}if(e.parameters.forEach(((e,t)=>{if(e.defaultValue&&this.walk(e.defaultValue),e.typeAnnotation&&this.walk(e.typeAnnotation),e.typeAnnotationComment&&this.walk(e.typeAnnotationComment),n){const i=e.typeAnnotation||e.typeAnnotationComment;if(i&&t<n.functionType.details.parameters.length){const e=n.functionType.details.parameters[t].type;bo(e)&&1===e.details.variance&&!e.details.isSynthesized&&"__init__"!==n.functionType.details.name&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.paramTypeCovariant(),i)}}})),e.returnTypeAnnotation&&this.walk(e.returnTypeAnnotation),e.functionAnnotationComment&&this.walk(e.functionAnnotationComment),this.walkMultiple(e.decorators),e.parameters.forEach((e=>{e.name&&this.walk(e.name)})),this.walk(e.suite),n&&(this._validateFunctionReturn(e,n.functionType),this._validateDunderSignatures(e,n.functionType,void 0!==i),this._validateStrictTypeGuardFunction(e,n.functionType,void 0!==i)),this._fileInfo.isStubFile&&"__getattr__"===e.name.value){const t=zs(e);3===(null==t?void 0:t.type)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompleteStub,$o.reportIncompleteStub,ml.Diagnostic.stubUsesGetAttr(),e.name)}if(this._scopedNodes.push(e),this._validateFunctionTypeVarUsage(e),n&&ko(n.decoratedType)){const t=n.decoratedType.overloads;if(t.length>1){const n=100;t.length<n&&this._validateOverloadConsistency(e,t[t.length-1],t.slice(0,t.length-1))}}return!1}visitLambda(e){this._evaluator.getType(e),this.walkMultiple([...e.parameters,e.expression]),e.parameters.forEach((e=>{if(e.name){const t=this._evaluator.getType(e.name);t&&(po(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,$o.reportUnknownLambdaType,ml.Diagnostic.paramTypeUnknown().format({paramName:e.name.value}),e.name):La(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,$o.reportUnknownLambdaType,ml.Diagnostic.paramTypePartiallyUnknown().format({paramName:e.name.value}),e.name))}}));const t=this._evaluator.getType(e.expression);return t&&(po(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,$o.reportUnknownLambdaType,ml.Diagnostic.lambdaReturnTypeUnknown(),e.expression):La(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,$o.reportUnknownLambdaType,ml.Diagnostic.lambdaReturnTypePartiallyUnknown().format({returnType:this._evaluator.printType(t,!0)}),e.expression)),this._scopedNodes.push(e),!1}visitCall(e){var t;if(this._validateIsInstanceCall(e),this._validateIllegalDefaultParamInitializer(e),("none"!==this._fileInfo.diagnosticRuleSet.reportUnusedCallResult||"none"!==this._fileInfo.diagnosticRuleSet.reportUnusedCoroutine)&&47===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)){const t=38===e.leftExpression.nodeType&&"reveal_type"===e.leftExpression.value,n=this._evaluator.getType(e);!t&&n&&this._isTypeValidForUnusedValueTest(n)&&(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnusedCallResult,$o.reportUnusedCallResult,ml.Diagnostic.unusedCallResult().format({type:this._evaluator.printType(n,!1)}),e),vo(n)&&Zs.isBuiltIn(n,"Coroutine")&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnusedCoroutine,$o.reportUnusedCoroutine,ml.Diagnostic.unusedCoroutine(),e))}return!0}visitAwait(e){var t;if("none"!==this._fileInfo.diagnosticRuleSet.reportUnusedCallResult&&47===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&9===e.expression.nodeType){const t=this._evaluator.getType(e);t&&this._isTypeValidForUnusedValueTest(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnusedCallResult,$o.reportUnusedCallResult,ml.Diagnostic.unusedCallResult().format({type:this._evaluator.printType(t,!1)}),e)}return!0}visitFor(e){return this._evaluator.evaluateTypesForStatement(e),!0}visitList(e){return this._validateIllegalDefaultParamInitializer(e),!0}visitSet(e){return this._validateIllegalDefaultParamInitializer(e),!0}visitDictionary(e){return this._validateIllegalDefaultParamInitializer(e),!0}visitListComprehension(e){return this._scopedNodes.push(e),!0}visitIf(e){return this._evaluator.getType(e.testExpression),!0}visitWhile(e){return this._evaluator.getType(e.testExpression),!0}visitWith(e){return e.withItems.forEach((e=>{this._evaluator.evaluateTypesForStatement(e)})),!0}visitReturn(e){let t;const n=kr(e),i=n?this._evaluator.getFunctionDeclaredReturnType(n):void 0;if(t=e.returnExpression?this._evaluator.getType(e.returnExpression)||Ys.create():to.createInstance(),this._evaluator.isNodeReachable(e,void 0)&&n){if(i)if(ao(i))this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.noReturnContainsReturn(),e);else{const n=new il;let r=!1;if(this._evaluator.canAssignType(i,t,n,new jo,64))r=!0;else{const s=Sa(i);if(s&&s.some((e=>e.details.constraints.length>0))){const o=new jo;for(const t of s)if(t.details.constraints.length>0){const n=this._evaluator.narrowConstrainedTypeVar(e,t);n&&(o.setTypeVarType(t,n),o.addSolveForScope(na(t)))}if(!o.isEmpty()){const e=fa(i,o);this._evaluator.canAssignType(e,t,n,void 0,64)&&(r=!0)}}}r||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.returnTypeMismatch().format({exprType:this._evaluator.printType(t,!1),returnType:this._evaluator.printType(i,!1)})+n.getString(),e.returnExpression?e.returnExpression:e)}po(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,$o.reportUnknownVariableType,ml.Diagnostic.returnTypeUnknown(),e.returnExpression):La(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,$o.reportUnknownVariableType,ml.Diagnostic.returnTypePartiallyUnknown().format({returnType:this._evaluator.printType(t,!0)}),e.returnExpression)}return!0}visitYield(e){const t=e.expression?this._evaluator.getType(e.expression):to.createInstance();return this._validateYieldType(e,t||Ys.create()),!0}visitYieldFrom(e){const t=this._evaluator.getType(e.expression)||Ys.create();let n;if(vo(t)&&Zs.isBuiltIn(t,"Coroutine"))n=Ys.create();else{n=this._evaluator.getTypeFromIterable(t,!1,e)||Ys.create();const i=za(n);n=i?i.length>=1?i[0]:Ys.create():this._evaluator.getTypeFromIterator(t,!1,e)||Ys.create()}return this._validateYieldType(e,n),!0}visitRaise(e){if(this._evaluator.verifyRaiseExceptionType(e),e.valueExpression){const t=this._evaluator.getBuiltInType(e,"BaseException"),n=this._evaluator.getType(e.valueExpression);if(n&&t&&_o(t)){const i=new il;Jo(n,(e=>{ho(e=this._evaluator.makeTopLevelTypeVarsConcrete(e))||lo(e)||yo(e)&&Da(e,t,!1)||i.addMessage(ml.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e,!1)}))})),i.isEmpty()||this._evaluator.addError(ml.Diagnostic.expectedExceptionObj()+i.getString(),e.valueExpression)}}return!0}visitExcept(e){if(e.typeExpression){this._evaluator.evaluateTypesForStatement(e);const t=this._evaluator.getType(e.typeExpression);t&&this._validateExceptionType(t,e.typeExpression)}return!0}visitAssert(e){e.exceptionExpression&&this._evaluator.getType(e.exceptionExpression);const t=this._evaluator.getType(e.testExpression);return t&&vo(t)&&pa(t)&&t.tupleTypeArguments&&t.tupleTypeArguments.length>0&&(da(t)||this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportAssertAlwaysTrue,$o.reportAssertAlwaysTrue,ml.Diagnostic.assertAlwaysTrue(),e.testExpression)),!0}visitAssignment(e){return this._evaluator.evaluateTypesForStatement(e),e.typeAnnotationComment&&this._evaluator.getType(e.typeAnnotationComment),!0}visitAssignmentExpression(e){return this._evaluator.getType(e),!0}visitAugmentedAssignment(e){return this._evaluator.evaluateTypesForStatement(e),!0}visitIndex(e){this._evaluator.getType(e);const t=this._evaluator.getType(e.baseExpression);return t&&Jo(t,(t=>{if(vo(t)&&t.tupleTypeArguments&&!da(t)){const n=t.tupleTypeArguments.length;if(1===e.items.length&&!e.trailingComma&&0===e.items[0].argumentCategory&&!e.items[0].name){const i=this._evaluator.getType(e.items[0].valueExpression);i&&vo(i)&&Zs.isBuiltIn(i,"int")&&ra(i)&&"number"==typeof i.literalValue&&(i.literalValue>=0&&i.literalValue>=n||i.literalValue<0&&i.literalValue+n<0)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.tupleIndexOutOfRange().format({index:i.literalValue,type:this._evaluator.printType(t)}),e)}}})),!0}visitBinaryOperation(e){return 12!==e.operator&&28!==e.operator||function(e){let t,n=e;for(;n;){switch(n.nodeType){case 2:return n.testExpression===t}t=n,n=n.parent}return!1}(e)||this._validateComparisonTypes(e),this._evaluator.getType(e),!0}visitSlice(e){return this._evaluator.getType(e),!0}visitUnpack(e){return this._evaluator.getType(e),!0}visitTuple(e){return this._evaluator.getType(e),!0}visitUnaryOperation(e){return this._evaluator.getType(e),!0}visitTernary(e){return this._evaluator.getType(e),!0}visitStringList(e){for(const t of e.strings)t.hasUnescapeErrors&&Vc(t.token).unescapeErrors.forEach((e=>{const n={start:t.token.start+t.token.prefixLength+t.token.quoteMarkLength+e.offset,length:e.length};0===e.errorType?this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportInvalidStringEscapeSequence,$o.reportInvalidStringEscapeSequence,ml.Diagnostic.stringUnsupportedEscape(),n):1===e.errorType?this._evaluator.addDiagnosticForTextRange(this._fileInfo,"error","",ml.Diagnostic.formatStringEscape(),n):2===e.errorType?this._evaluator.addDiagnosticForTextRange(this._fileInfo,"error","",ml.Diagnostic.formatStringBrace(),n):3===e.errorType&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,"error","",ml.Diagnostic.formatStringUnterminated(),n)}));return e.typeAnnotation&&this._evaluator.getType(e),e.strings.length>1&&!e.isParenthesized&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportImplicitStringConcatenation,$o.reportImplicitStringConcatenation,ml.Diagnostic.implicitStringConcat(),e),!0}visitFormatString(e){return e.expressions.forEach((e=>{this._evaluator.getType(e)})),!0}visitGlobal(e){return this._suppressUnboundCheck((()=>{e.nameList.forEach((e=>{this._evaluator.getType(e),this.walk(e)}))})),!1}visitNonlocal(e){return this._suppressUnboundCheck((()=>{e.nameList.forEach((e=>{this._evaluator.getType(e),this.walk(e)}))})),!1}visitName(e){return this._conditionallyReportPrivateUsage(e),this._isUnboundCheckSuppressed||this._reportUnboundName(e),!0}visitDel(e){return this._suppressUnboundCheck((()=>{e.expressions.forEach((e=>{this._evaluator.verifyDeleteExpression(e),this.walk(e)}))})),!1}visitMemberAccess(e){return this._evaluator.getType(e),this._conditionallyReportPrivateUsage(e.memberName),this.walk(e.leftExpression),!1}visitImportAs(e){return this._evaluator.evaluateTypesForStatement(e),!1}visitImportFrom(e){if(e.isWildcardImport){const t=Rt(e.module);t&&t.isImportFound&&2!==t.importType&&!this._fileInfo.isStubFile&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportWildcardImportFromLibrary,$o.reportWildcardImportFromLibrary,ml.Diagnostic.wildcardLibraryImport(),e.wildcardToken||e)}else e.imports.forEach((e=>{this._evaluator.evaluateTypesForStatement(e)}));return!1}visitTypeAnnotation(e){return this._evaluator.getType(e.typeAnnotation),!0}visitMatch(e){return this._evaluator.getType(e.subjectExpression),this._validateExhaustiveMatch(e),!0}visitCase(e){return e.guardExpression&&this._evaluator.getType(e.guardExpression),this._evaluator.evaluateTypesForStatement(e.pattern),!0}visitPatternClass(e){return function(e,t){const n=e.getTypeOfExpression(t.className,void 0,2).type;ho(n)||(n.typeAliasInfo&&_o(n)&&n.typeArguments&&n.isTypeArgumentExplicit?e.addDiagnostic(Vt(t).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.classPatternTypeAlias().format({type:e.printType(n)}),t.className):!_o(n)||n.includeSubclasses?e.addDiagnostic(Vt(t).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.DiagnosticAddendum.typeNotClass().format({type:e.printType(n)}),t.className):mu.some((e=>n.details.fullName===e))&&(t.arguments.length>1?e.addDiagnostic(Vt(t).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.classPatternBuiltInArgCount(),t.arguments[1]):1===t.arguments.length&&t.arguments[0].name&&e.addDiagnostic(Vt(t).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.classPatternBuiltInArgPositional(),t.arguments[0].name)))}(this._evaluator,e),!0}visitTry(e){return this._reportUnusedExceptStatements(e),!0}visitError(e){return e.child&&this._evaluator.getType(e.child),!1}_validateExhaustiveMatch(e){if("none"===this._fileInfo.diagnosticRuleSet.reportMatchNotExhaustive)return;const t=this._evaluator.evaluateTypeForSubnode(e,(()=>{this._evaluator.evaluateTypesForMatchNode(e)}));if(t&&!ao(t.type)){const n=new il;n.addMessage(ml.DiagnosticAddendum.matchIsNotExhaustiveType().format({type:this._evaluator.printType(t.type)})),n.addMessage(ml.DiagnosticAddendum.matchIsNotExhaustiveHint()),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMatchNotExhaustive,$o.reportMatchNotExhaustive,ml.Diagnostic.matchIsNotExhaustive()+n.getString(),e.subjectExpression)}}_suppressUnboundCheck(e){const t=this._isUnboundCheckSuppressed;this._isUnboundCheckSuppressed=!0;try{e()}finally{this._isUnboundCheckSuppressed=t}}_validateIllegalDefaultParamInitializer(e){"none"!==this._fileInfo.diagnosticRuleSet.reportCallInDefaultInitializer&&function(e){let t,n=e;for(;n;){if(41===n.nodeType&&t===n.defaultValue)return!0;if(30===n.nodeType||28===n.nodeType||10===n.nodeType||36===n.nodeType)return!1;t=n,n=n.parent}return!1}(e)&&!this._fileInfo.isStubFile&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportCallInDefaultInitializer,$o.reportCallInDefaultInitializer,ml.Diagnostic.defaultValueContainsCall(),e)}_validateComparisonTypes(e){const t=this._evaluator.getType(e.leftExpression),n=this._evaluator.getType(e.rightExpression);if(t&&n)if(sa(n)&&sa(t)){if(void 0===Xc(e,this._fileInfo.executionEnvironment)){let i=!1;Jo(t,(e=>{this._evaluator.canAssignType(n,e)&&(i=!0)})),i||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryComparison,$o.reportUnnecessaryComparison,ml.Diagnostic.comparisonAlwaysFalse().format({leftType:this._evaluator.printType(t,!0),rightType:this._evaluator.printType(n,!0)}),e)}}else{let i=!1;if(Jo(t,(e=>{i||(e=this._evaluator.makeTopLevelTypeVarsConcrete(e),Jo(n,(t=>{i||(t=this._evaluator.makeTopLevelTypeVarsConcrete(t),this._isTypeComparable(e,t)&&(i=!0))})))})),!i){const i=this._evaluator.printType(t,!0),r=this._evaluator.printType(n,!0),s=12===e.operator?ml.Diagnostic.comparisonAlwaysFalse():ml.Diagnostic.comparisonAlwaysTrue();this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryComparison,$o.reportUnnecessaryComparison,s.format({leftType:i,rightType:r}),e)}}}_isTypeComparable(e,t){if(ho(e)||ho(t))return!0;if(ao(e)||ao(t))return!1;if(To(e)||To(t))return!Ao(e,t);if(lo(e)||lo(t))return!Ao(e,t);if(_o(e)||vo(e)&&Zs.isBuiltIn(e,"type")){if(_o(t)||vo(t)&&Zs.isBuiltIn(t,"type")){const n=Zs.cloneForSpecialization(e,void 0,!1),i=Zs.cloneForSpecialization(t,void 0,!1);if(this._evaluator.canAssignType(n,i)||this._evaluator.canAssignType(i,n))return!0}const n=e.details.effectiveMetaclass;return!!(n&&yo(n)&&va(n,"__eq__",4))}if(vo(e)){if(vo(t)){const n=Zs.cloneForSpecialization(e,void 0,!1),i=Zs.cloneForSpecialization(t,void 0,!1);if(this._evaluator.canAssignType(n,i)||this._evaluator.canAssignType(i,n))return!0}return!!va(Zs.cloneAsInstantiable(e),"__eq__",4)}return!0}_isTypeValidForUnusedValueTest(e){return!lo(e)&&!ao(e)&&!ho(e)}_validateFunctionTypeVarUsage(e){if("none"===this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse)return;const t=new Map;let n=!0;const i=new Br(((i,r,s)=>{const o=this._evaluator.getType(i);if(o&&bo(o)&&o.scopeId===this._evaluator.getScopeIdForNode(e)){let e=o.details.constraints.length>0||n&&void 0!==o.details.boundType&&void 0!==r||wo(o);if(!e&&s&&void 0!==r){const t=this._evaluator.getType(s);(null==t?void 0:t.typeAliasInfo)&&t.typeAliasInfo.typeParameters&&r<t.typeAliasInfo.typeParameters.length&&(e=!0)}t.has(o.details.name)?t.get(o.details.name).nodes.push(i):t.set(o.details.name,{nodes:[i],isExempt:e})}}));e.parameters.forEach((e=>{const t=e.typeAnnotation||e.typeAnnotationComment;t&&i.walk(t)})),e.returnTypeAnnotation&&(n=!1,i.walk(e.returnTypeAnnotation)),t.forEach((e=>{1!==e.nodes.length||e.isExempt||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse,$o.reportInvalidTypeVarUse,ml.Diagnostic.typeVarUsedOnlyOnce().format({name:e.nodes[0].value}),e.nodes[0])}))}_validateOverloadConsistency(e,t,n){for(let i=0;i<n.length;i++){const r=n[i];if(Xs.isOverloaded(t)&&Xs.isOverloaded(r)&&this._isOverlappingOverload(t,r)){this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportOverlappingOverload,$o.reportOverlappingOverload,ml.Diagnostic.overlappingOverload().format({name:e.name.value,obscured:n.length+1,obscuredBy:i+1}),e.name);break}}for(let i=0;i<n.length;i++){const r=n[i];if(Xs.isOverloaded(t)&&Xs.isOverloaded(r)&&this._isOverlappingOverload(r,t)){const s=Xs.getSpecializedReturnType(r),o=Xs.getSpecializedReturnType(t);if(s&&o&&!this._evaluator.canAssignType(o,s,void 0,new jo,8)){const t=this._findNodeForOverload(e,r);this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportOverlappingOverload,$o.reportOverlappingOverload,ml.Diagnostic.overloadReturnTypeMismatch().format({name:e.name.value,newIndex:n.length+1,prevIndex:i+1}),(t||e).name);break}}}}_findNodeForOverload(e,t){const n=this._evaluator.getDeclarationsForNameNode(e.name);if(n)for(const e of n)if(3===e.type){const n=this._evaluator.getTypeOfFunction(e.node);if((null==n?void 0:n.functionType)===t)return e.node}}_isOverlappingOverload(e,t){return(!Xs.isInstanceMethod(e)||"__get__"!==e.details.name)&&this._evaluator.canAssignType(e,t,void 0,new jo(na(e)),56)}_isLegalOverloadImplementation(e,t,n){var i;const r=new jo(na(t));let s=this._evaluator.canAssignType(e,t,n,r,290);const o=null!==(i=e.details.declaredReturnType)&&void 0!==i?i:this._evaluator.getFunctionInferredReturnType(e),a=fa(t.details.declaredReturnType||this._evaluator.getFunctionInferredReturnType(t),r),l=new il;return ao(o)||this._evaluator.canAssignType(a,o,l.createAddendum(),r,8)||(l.addMessage(ml.DiagnosticAddendum.functionReturnTypeMismatch().format({sourceType:this._evaluator.printType(o,!1),destType:this._evaluator.printType(a,!1)})),n&&n.addAddendum(l),s=!1),s}_walkStatementsAndReportUnreachable(e){let t,n=!1;for(const i of e){if(!n&&!this._evaluator.isNodeReachable(i,t)){const t=i.start,r=e[e.length-1],s=dt.getEnd(r);this._evaluator.addUnusedCode(i,{start:t,length:s-t}),n=!0}!n&&this._fileInfo.isStubFile&&this._validateStubStatement(i),this.walk(i),t=i}}_validateStubStatement(e){switch(e.nodeType){case 19:case 28:case 10:case 0:break;case 57:case 26:case 53:case 58:this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStubStatement,$o.reportInvalidStubStatement,ml.Diagnostic.invalidStubStatement(),e);break;case 47:for(const t of e.statements)switch(t.nodeType){case 2:case 4:case 5:case 6:case 7:case 9:case 11:case 14:case 15:case 24:case 26:case 27:case 29:case 30:case 31:case 35:case 38:case 39:case 40:case 43:case 44:case 45:case 46:case 51:case 52:case 53:case 55:case 56:case 57:case 58:case 59:case 60:case 61:this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStubStatement,$o.reportInvalidStubStatement,ml.Diagnostic.invalidStubStatement(),t)}}}_validateExceptionType(e,t){const n=this._evaluator.getBuiltInType(t,"BaseException"),i=e=>!n||!_o(n)||Da(e,n,!1),r=new il;let s;return ho(e)?s=e:_o(e)?(i(e)||r.addMessage(ml.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e,!1)})),s=Zs.cloneAsInstance(e)):vo(e)&&(s=Ko(this._evaluator.getTypeFromIterator(e,!1,t)||Ys.create(),(t=>ho(t)?t:_o(t)?(i(t)||r.addMessage(ml.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e,!1)})),Zs.cloneAsInstance(t)):(r.addMessage(ml.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e,!1)})),Ys.create())))),r.isEmpty()||this._evaluator.addError(ml.Diagnostic.exceptionTypeNotClass().format({type:this._evaluator.printType(e,!1)}),t),s||Ys.create()}_reportUnusedDunderAllSymbols(e){if("none"===this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll)return;const t=Ft(this._moduleNode);t&&e.forEach((e=>{t.symbolTable.has(e.value)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll,$o.reportUnsupportedDunderAll,ml.Diagnostic.dunderAllSymbolNotPresent().format({name:e.value}),e)}))}_validateSymbolTables(){for(const e of this._scopedNodes){const t=Ft(e);t&&t.symbolTable.forEach(((e,n)=>{this._conditionallyReportUnusedSymbol(n,e,t.type),this._reportIncompatibleDeclarations(n,e),this._reportMultipleFinalDeclarations(n,e,t.type),this._reportMultipleTypeAliasDeclarations(n,e),this._reportInvalidOverload(n,e)}))}}_reportInvalidOverload(e,t){const n=t.getTypedDeclarations();if(n.length>=1){const i=n[0];if(3===i.type){const n=this._evaluator.getEffectiveTypeOfSymbol(t),r=(ko(n)?n.overloads:Eo(n)?[n]:[]).filter((e=>Xs.isOverloaded(e)));if(1===r.length&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.singleOverload().format({name:e}),i.node.name),r.forEach((t=>{if(t.details.declaration&&!function(e){let t=!0;return e.suite.statements.forEach((e=>{0!==e.nodeType&&(47===e.nodeType?e.statements.forEach((e=>{18!==e.nodeType&&48!==e.nodeType&&42!==e.nodeType&&(t=!1)})):t=!1)})),t}(t.details.declaration.node)){const n=new il;n.addMessage(ml.DiagnosticAddendum.overloadWithImplementation()),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.overloadWithImplementation().format({name:e})+n.getString(),t.details.declaration.node.name)}})),!this._fileInfo.isStubFile&&r.length>0){let t;if(ko(n)&&!Xs.isOverloaded(n.overloads[n.overloads.length-1])?t=n.overloads[n.overloads.length-1]:Eo(n)&&!Xs.isOverloaded(n)&&(t=n),t)ko(n)&&n.overloads.forEach(((n,r)=>{if(n===t||!Xs.isOverloaded(n))return;const s=new il;if(!this._isLegalOverloadImplementation(n,t,s)&&t.details.declaration){const o=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.overloadImplementationMismatch().format({name:e,index:r+1})+s.getString(),t.details.declaration.node.name);o&&n.details.declaration&&o.addRelatedInfo(ml.DiagnosticAddendum.overloadMethod(),i.path,i.range)}}));else{let e=!1;const t=Dr(i.node);if(t&&10===t.nodeType){const n=this._evaluator.getTypeOfClass(t);n&&Zs.isProtocolClass(n.classType)&&(e=!0)}e||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.overloadWithoutImplementation().format({name:i.node.name.value}),i.node.name)}}}}}_reportMultipleFinalDeclarations(e,t,n){if(!Wo(t))return;const i=t.getDeclarations();let r=!1,s=!1;if(i.forEach((t=>{rs(t)&&(r&&this._evaluator.addError(ml.Diagnostic.finalRedeclaration().format({name:e}),t.node),r=!0),1===t.type&&t.inferredTypeSource&&(s&&2!==n&&this._evaluator.addError(ml.Diagnostic.finalReassigned().format({name:e}),t.node),s=!0)})),!s&&!this._fileInfo.isStubFile){const n=i.find((e=>1===e.type&&e.isFinal));if(n){let i=!1;if(t.isClassMember()&&!t.isClassVar()){const e=Er(n.node,!0);if(e){const t=this._evaluator.getTypeOfClass(e);t&&yo(t.decoratedType)&&Zs.isDataClass(t.decoratedType)&&(i=!0)}}i||this._evaluator.addError(ml.Diagnostic.finalUnassigned().format({name:e}),n.node)}}}_reportMultipleTypeAliasDeclarations(e,t){const n=t.getDeclarations(),i=n.find((e=>ss(e)));i&&n.length>1&&n.forEach((t=>{t!==i&&this._evaluator.addError(ml.Diagnostic.typeAliasRedeclared().format({name:e}),t.node)}))}_reportIncompatibleDeclarations(e,t){const n=Vo(t);if(!n)return;if("_"===e)return;let i,r=t.getDeclarations().filter((e=>e!==n));if(3===n.type){const e=this._evaluator.getTypeOfFunction(n.node);r=r.filter((t=>{if(3!==t.type)return!0;const n=this._evaluator.getTypeOfFunction(t.node);if(!n)return!0;const i=e?this._evaluator.makeTopLevelTypeVarsConcrete(e.decoratedType):void 0;return i&&vo(i)&&Zs.isPropertyClass(i)&&vo(n.decoratedType)&&Zs.isPropertyClass(n.decoratedType)?n.decoratedType.details.typeSourceId!==i.details.typeSourceId:!Xs.isOverloaded(n.functionType)}))}if(0===r.length)return;i=3===n.type?n.isMethod?ml.DiagnosticAddendum.seeMethodDeclaration():ml.DiagnosticAddendum.seeFunctionDeclaration():4===n.type?ml.DiagnosticAddendum.seeClassDeclaration():2===n.type?ml.DiagnosticAddendum.seeParameterDeclaration():1===n.type?ml.DiagnosticAddendum.seeVariableDeclaration():ml.DiagnosticAddendum.seeDeclaration();const s=e=>{if(e){let t;3===n.type||4===n.type?t=n.node.name:1===n.type?38===n.node.nodeType&&(t=n.node):2===n.type&&n.node.name&&(t=n.node.name),t&&e.addRelatedInfo(i,n.path,n.range)}};for(const t of r)if(4===t.type)s(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.obscuredClassDeclaration().format({name:e}),t.node.name));else if(3===t.type){const i=this._evaluator.getTypeForDeclaration(n);i&&Eo(i)&&this._evaluator.getFunctionInferredReturnType(i);let r=!1;const o=this._evaluator.getTypeForDeclaration(t),a=wr(n.node)===wr(t.node);o&&Eo(o)&&this._evaluator.getFunctionInferredReturnType(o),i&&o&&Ao(i,o)&&(r=!0),(!r||a)&&s(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,t.isMethod?ml.Diagnostic.obscuredMethodDeclaration().format({name:e}):ml.Diagnostic.obscuredFunctionDeclaration().format({name:e}),t.node.name))}else if(2===t.type)t.node.name&&s(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.obscuredParameterDeclaration().format({name:e}),t.node.name));else if(1===t.type){const i=this._evaluator.getTypeForDeclaration(n);if(t.typeAnnotationNode){if(38===t.node.nodeType){let n=!1;const r=this._evaluator.getTypeForDeclaration(t);i&&r&&Ao(i,r)&&(n=!0),n||s(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.obscuredVariableDeclaration().format({name:e}),t.node))}}else!i||ua(i)||3!==n.type&&4!==n.type||s(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.obscuredVariableDeclaration().format({name:e}),t.node))}}_conditionallyReportUnusedSymbol(e,t,n){const i=this._fileInfo.accessedSymbolMap;t.isIgnoredForProtocolMatch()||i.has(t.id)||"_"!==e&&(Qt(e)||t.getDeclarations().forEach((t=>{this._conditionallyReportUnusedDeclaration(t,this._isSymbolPrivate(e,n))})))}_conditionallyReportUnusedDeclaration(e,t){let n,i,r,s;switch(e.type){case 6:if(n=this._fileInfo.diagnosticRuleSet.reportUnusedImport,s=$o.reportUnusedImport,21===e.node.nodeType)if(e.node.alias)this._fileInfo.isStubFile||(i=e.node.alias);else{const t=e.node.module.nameParts;if(t.length>0){const e=t.map((e=>e.value)).join("."),n={start:t[0].start,length:t[0].length};return dt.extend(n,t[t.length-1]),this._fileInfo.diagnosticSink.addUnusedCodeWithTextRange(ml.Diagnostic.unaccessedSymbol().format({name:e}),n,{action:"pyright.unusedImport"}),void this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportUnusedImport,$o.reportUnusedImport,ml.Diagnostic.unaccessedImport().format({name:e}),n)}}else if(23===e.node.nodeType){const t=e.node.parent,n=this._fileInfo.isStubFile&&void 0!==e.node.alias,r=1===t.module.nameParts.length&&"__future__"===t.module.nameParts[0].value;n||r||(i=e.node.alias||e.node.name)}i&&(r=ml.Diagnostic.unaccessedImport().format({name:i.value}));break;case 1:case 2:if(!t)return;if(this._fileInfo.isStubFile)return;n=this._fileInfo.diagnosticRuleSet.reportUnusedVariable,38===e.node.nodeType?(i=e.node,i.value.startsWith("_")&&(n="none")):41===e.node.nodeType&&(i=e.node.name,n="none"),i&&(s=$o.reportUnusedVariable,r=ml.Diagnostic.unaccessedVariable().format({name:i.value}));break;case 4:if(!t)return;if(this._fileInfo.isStubFile)return;n=this._fileInfo.diagnosticRuleSet.reportUnusedClass,i=e.node.name,s=$o.reportUnusedClass,r=ml.Diagnostic.unaccessedClass().format({name:i.value});break;case 3:if(!t)return;if(this._fileInfo.isStubFile)return;n=this._fileInfo.diagnosticRuleSet.reportUnusedFunction,i=e.node.name,s=$o.reportUnusedFunction,r=ml.Diagnostic.unaccessedFunction().format({name:i.value});break;default:return}if(i&&void 0!==s&&r){const e=s===$o.reportUnusedImport?{action:"pyright.unusedImport"}:void 0;this._fileInfo.diagnosticSink.addUnusedCodeWithTextRange(ml.Diagnostic.unaccessedSymbol().format({name:i.value}),i,e),this._evaluator.addDiagnostic(n,s,r,i)}}_validateIsInstanceCall(e){if(38!==e.leftExpression.nodeType||"isinstance"!==e.leftExpression.value&&"issubclass"!==e.leftExpression.value||2!==e.arguments.length)return;const t=e.leftExpression.value,n="isinstance"===t;let i=this._evaluator.getType(e.arguments[0].valueExpression);if(!i)return;i=Ko(i,(e=>ta(e)));const r=this._evaluator.getType(e.arguments[1].valueExpression);if(!r)return;let s=!0;if(Jo(r,(e=>{vo(e)&&Zs.isTupleClass(e)&&e.tupleTypeArguments?e.tupleTypeArguments.some((e=>!this._isTypeSupportedTypeForIsInstance(e.type,n)))&&(s=!1):this._isTypeSupportedTypeForIsInstance(e,n)||(s=!1)})),!s){const t=new il;t.addMessage(ml.DiagnosticAddendum.typeVarNotAllowed()),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,n?ml.Diagnostic.isInstanceInvalidType().format({type:this._evaluator.printType(r,!1)})+t.getString():ml.Diagnostic.isSubclassInvalidType().format({type:this._evaluator.printType(r,!1)})+t.getString(),e.arguments[1])}let o=e;for(;o;){if(2===o.nodeType)return;o=o.parent}const a=["FunctionType","LambdaType","BuiltinFunctionType","BuiltinMethodType","type","Type"],l=[];let c=!1;if(Jo(r,(e=>{yo(e)?Ks.isInstantiable(e)?void 0===e.literalValue&&(l.push(e),Zs.isBuiltIn(e)&&a.some((t=>t===e.details.name))&&(s=!1),e.includeSubclasses&&(c=!0)):(pa(e)?e.tupleTypeArguments&&e.tupleTypeArguments.forEach((e=>{_o(e.type)?(l.push(e.type),e.type.includeSubclasses&&(c=!0)):s=!1})):e.includeSubclasses&&(c=!0),Zs.isBuiltIn(e)&&a.some((t=>t===e.details.name))&&(s=!1)):s=!1})),!s)return;if(l.some((e=>Zs.isProtocolClass(e)&&!Zs.isRuntimeCheckable(e)))&&this._evaluator.addError(ml.Diagnostic.protocolUsedInCall().format({name:t}),e.arguments[1].valueExpression),function(e){let t=!1;return Jo(e,(n=>{ho(e)?t=!0:_o(n)?Zs.hasUnknownBaseClass(n)&&(t=!0):vo(n)&&Zs.hasUnknownBaseClass(n)&&(t=!0)})),t}(i))return;const u=e=>Oo(e),p=e=>{const t=[];for(const i of l){const r=Zs.isDerivedFrom(e,i)||n&&Zs.isProtocolClass(i)&&this._evaluator.canAssignType(i,e)||Zs.isBuiltIn(i,"dict")&&Zs.isTypedDictClass(e),s=Zs.isDerivedFrom(i,e)||n&&Zs.isProtocolClass(e)&&this._evaluator.canAssignType(e,i);s&&s&&!Zs.isSameGenericClass(e,i)?t.push(Ys.create()):r?t.push(e):s&&t.push(i)}return n?t.map((e=>_o(e)?Zs.cloneAsInstance(e):e)):t};let d;if(n&&vo(i))d=u(p(Zs.cloneAsInstantiable(i)));else if(!n&&_o(i))d=u(p(i));else{if(!fo(i))return;{let e=[],t=!1;if(Jo(i,(i=>{ho(i)&&(t=!0),n&&vo(i)?e=e.concat(p(Zs.cloneAsInstantiable(i))):!n&&_o(i)&&(e=e.concat(p(i)))})),d=u(e),t)return}}const h=()=>Oo(l.map((e=>Zs.cloneAsInstance(e))));!c&&Ao(d,i,!0)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryIsInstance,$o.reportUnnecessaryIsInstance,n?ml.Diagnostic.unnecessaryIsInstanceAlways().format({testType:this._evaluator.printType(i,!1),classType:this._evaluator.printType(h(),!1)}):ml.Diagnostic.unnecessaryIsSubclassAlways().format({testType:this._evaluator.printType(i,!1),classType:this._evaluator.printType(h(),!1)}),e)}_isTypeSupportedTypeForIsInstance(e,t){let n=!0;return Jo(e,(e=>{switch((e=this._evaluator.makeTopLevelTypeVarsConcrete(e)).category){case 2:case 1:case 0:break;case 7:e.isTypeArgumentExplicit&&!e.includeSubclasses&&(n=!1);break;case 3:n=!!t&&Ks.isInstantiable(e);break;case 5:n=Ks.isInstantiable(e);break;case 9:n=this._isTypeSupportedTypeForIsInstance(e,t);break;default:n=!1}})),n}_isSymbolPrivate(e,t){return 1===t||0===t||(!!Kt(e)||!!Jt(e)&&!(2===t))}_reportDeprecatedUse(e){var t;const n=null!==(t=Su.get(e.value))&&void 0!==t?t:xu.get(e.value);if(!n)return;const i=this._evaluator.getType(e);i&&_o(i)&&i.details.fullName===n.fullName&&this._fileInfo.executionEnvironment.pythonVersion>=n.version&&this._evaluator.addDeprecated(ml.Diagnostic.deprecatedType().format({version:Pe(n.version),replacement:n.replacementText}),e)}_reportUnboundName(e){if("none"!==this._fileInfo.diagnosticRuleSet.reportUnboundVariable&&!zt(e)){const t=this._evaluator.getType(e);t&&(mo(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnboundVariable,$o.reportUnboundVariable,ml.Diagnostic.symbolIsUnbound().format({name:e.value}),e):go(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnboundVariable,$o.reportUnboundVariable,ml.Diagnostic.symbolIsPossiblyUnbound().format({name:e.value}),e))}}_conditionallyReportPrivateUsage(e){var t;if("none"===this._fileInfo.diagnosticRuleSet.reportPrivateUsage)return;if(this._fileInfo.isStubFile)return;if(1===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.name===e)return;const n=e.value,i=Kt(n),r=Jt(n);if(!i&&!r)return;const s=this._evaluator.getDeclarationsForNameNode(e);let o,a=s&&s.length>0?s[s.length-1]:void 0;if(!a||a.node===e)return;if(6===a.type){if(a.usesLocalName)return;const e=this._evaluator.resolveAliasDeclarationWithInfo(a,!0);if(!e)return;if(a=e.declaration,!e.isPrivate)return}if(!a||a.node===e)return;a.node&&(o=Er(a.node)),a.node&&a.node.parent&&a.node.parent===o&&(o=Er(o));let l=!1;if(o&&r){const t=this._evaluator.getTypeOfClass(o);if(t&&_o(t.decoratedType)){if(Zs.isDefinedInStub(t.decoratedType))return;l=!0;const n=Er(e);if(n){const e=this._evaluator.getTypeOfClass(n);if(e&&_o(e.decoratedType)&&Da(e.decoratedType,t.decoratedType,!0))return}}}o&&!Mr(e,o)&&(l?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportPrivateUsage,$o.reportPrivateUsage,ml.Diagnostic.protectedUsedOutsideOfClass().format({name:n}),e):this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportPrivateUsage,$o.reportPrivateUsage,ml.Diagnostic.privateUsedOutsideOfClass().format({name:n}),e))}_validateEnumClassOverride(e,t){t.details.baseClasses.forEach(((t,n)=>{if(yo(t)&&Zs.isEnumClass(t)){let i=!1;t.details.fields.forEach((e=>{const n=this._evaluator.getEffectiveTypeOfSymbol(e);vo(n)&&Zs.isSameGenericClass(n,t)&&(i=!0)})),i&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.enumClassOverride().format({name:t.details.name}),e.arguments[n])}}))}_validateTypedDictClassSuite(e){const t=e=>{this._evaluator.addError(ml.Diagnostic.typedDictBadVar(),e)};e.statements.forEach((e=>{if(!zt(e))if(47===e.nodeType)for(const n of e.statements)54!==n.nodeType&&18!==n.nodeType&&48!==n.nodeType&&42!==n.nodeType&&t(n);else t(e)}))}_validateStrictTypeGuardFunction(e,t,n){var i;if(!t.details.declaredReturnType)return;if(!vo(t.details.declaredReturnType)||!Zs.isBuiltIn(t.details.declaredReturnType,"StrictTypeGuard")||!t.details.declaredReturnType.typeArguments||t.details.declaredReturnType.typeArguments.length<1)return;const r=t.details.declaredReturnType.typeArguments[0],s=n&&!Xs.isStaticMethod(t)?1:0;if(s>=t.details.parameters.length)return;const o=Xs.getEffectiveParameterType(t,s);if(!this._evaluator.canAssignType(o,r)){const t=e.returnTypeAnnotation||(null===(i=e.functionAnnotationComment)||void 0===i?void 0:i.returnTypeAnnotation);t&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.strictTypeGuardReturnType().format({type:this._evaluator.printType(o),returnType:this._evaluator.printType(r)}),t)}}_validateDunderSignatures(e,t,n){var i;const r=t.details.name;if(n&&"__init__"===r){const n=e.returnTypeAnnotation||(null===(i=e.functionAnnotationComment)||void 0===i?void 0:i.returnTypeAnnotation),r=t.details.declaredReturnType;if(n&&r)lo(r)||ao(r)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.initMustReturnNone(),n);else{const n=this._evaluator.getFunctionInferredReturnType(t);ao(n)||lo(n)||ho(n)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.initMustReturnNone(),e.name)}}}_validateFunctionReturn(e,t){var n;if(this._fileInfo.isStubFile)return;const i=e.returnTypeAnnotation||(null===(n=e.functionAnnotationComment)||void 0===n?void 0:n.returnTypeAnnotation);if(i){const n=!this._evaluator.isAfterNodeReachable(e),r=this._evaluator.isAfterNodeReachable(e.suite);let s=t.details.declaredReturnType;if(s){po(s)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,$o.reportUnknownVariableType,ml.Diagnostic.declaredReturnTypeUnknown(),i):La(s)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,$o.reportUnknownVariableType,ml.Diagnostic.declaredReturnTypePartiallyUnknown().format({returnType:this._evaluator.printType(s,!0)}),i);const e=new il;bo(s)&&2===s.details.variance&&(e.addMessage(ml.DiagnosticAddendum.typeVarIsContravariant().format({name:oo.getReadableName(s)})),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.returnTypeContravariant()+e.getString(),i))}if(Xs.isGenerator(t)&&(s=Pa(t)),s&&!n&&r)if(ao(s))Or(e.suite)||Xs.isOverloaded(t)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.noReturnReturnsNone(),i);else if(!Xs.isAbstractMethod(t)){const n=new il;this._evaluator.canAssignType(s,to.createInstance(),n)||Or(e.suite)||Xs.isOverloaded(t)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.returnMissing().format({returnType:this._evaluator.printType(s,!1)})+n.getString(),i)}}else{const n=this._evaluator.getFunctionInferredReturnType(t);po(n)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,$o.reportUnknownParameterType,ml.Diagnostic.returnTypeUnknown(),e.name):La(n)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,$o.reportUnknownParameterType,ml.Diagnostic.returnTypePartiallyUnknown().format({returnType:this._evaluator.printType(n,!0)}),e.name)}}_validateFinalMemberOverrides(e){e.details.fields.forEach(((t,n)=>{const i=va(e,n,1);if(i&&_o(i.classType)&&Wo(i.symbol)&&!Kt(n)){const e=t.getDeclarations()[0];this._evaluator.addError(ml.Diagnostic.finalRedeclarationBySubclass().format({name:n,className:i.classType.details.name}),e.node)}}))}_reportDuplicateEnumMembers(e){Zs.isEnumClass(e)&&!Zs.isBuiltIn(e)&&e.details.fields.forEach(((t,n)=>{if(t.getTypedDeclarations().length>0)return;const i=t.getDeclarations();if(i.length>=2&&1===i[0].type){const r=this._evaluator.getEffectiveTypeOfSymbol(t);vo(r)&&Zs.isSameGenericClass(r,e)&&void 0!==r.literalValue&&this._evaluator.addError(ml.Diagnostic.duplicateEnumMember().format({name:n}),i[1].node)}}))}_validateProtocolCompatibility(e,t){if(Zs.isProtocolClass(e))return;const n=new il,i=t=>e.details.mro.some((e=>yo(e)&&!Zs.isProtocolClass(e)&&e.details.fields.has(t)));e.details.baseClasses.forEach((e=>{yo(e)&&Zs.isProtocolClass(e)&&ga(e).forEach(((e,t)=>{const r=e.symbol.getDeclarations();0!==r.length&&yo(e.classType)&&(1===r[0].type?r.some((e=>1===e.type&&!!e.inferredTypeSource))||i(t)||n.addMessage(ml.DiagnosticAddendum.missingProtocolMember().format({name:t,classType:e.classType.details.name})):3===r[0].type&&Or(r[0].node.suite)&&r[0]&&".pyi"!==pe(r[0].path).toLowerCase()&&(i(t)||n.addMessage(ml.DiagnosticAddendum.missingProtocolMember().format({name:t,classType:e.classType.details.name}))))}))})),n.isEmpty()||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.missingProtocolMembers()+n.getString(),t.name)}_validateDataClassPostInit(e,t){if(!Zs.isDataClass(e))return;const n=va(e,"__post_init__",18);if(!n)return;const i=new Map;e.details.fields.forEach(((e,t)=>{e.isInitVar()&&i.set(t,e)}));const r=this._evaluator.getTypeOfMember(n);if(!Eo(r)||!Xs.isInstanceMethod(r)||!r.details.declaration)return;const s=Ho(r);if(void 0!==s.argsIndex||void 0!==s.kwargsIndex||void 0!==s.firstKeywordOnlyIndex)return;const o=s.params.filter((e=>!e.param.hasDefault)),a=i.size+1;(a<o.length||a>s.params.length)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.dataClassPostInitParamCount().format({expected:i.size}),r.details.declaration.node.name);let l=1;i.forEach(((e,t)=>{if(l>=s.params.length)return;const n=s.params[l].param;if(n.hasDeclaredType&&n.typeAnnotation){const i=this._evaluator.getDeclaredTypeOfSymbol(e),o=Xs.getEffectiveParameterType(r,s.params[l].index),a=new il;if(i&&!this._evaluator.canAssignType(o,i,a)){const i=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.dataClassPostInitType().format({fieldName:t})+a.getString(),n.typeAnnotation);if(i){const t=e.getTypedDeclarations();t.length>0&&i.addRelatedInfo(ml.DiagnosticAddendum.dataClassFieldLocation(),t[0].path,t[0].range)}}}l++}))}_validateFinalClassNotAbstract(e,t){if(!Zs.isFinal(e))return;if(!Zs.supportsAbstractMethods(e))return;const n=this._evaluator.getAbstractMethods(e);if(0===n.length)return;const i=new il;n.forEach(((e,t)=>{if(2===t)i.addMessage(ml.DiagnosticAddendum.memberIsAbstractMore().format({count:n.length-2}));else if(t<2&&_o(e.classType)){const t=e.classType.details.name;i.addMessage(ml.DiagnosticAddendum.memberIsAbstract().format({type:t,name:e.symbolName}))}})),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.finalClassIsAbstract().format({type:e.details.name})+i.getString(),t.name)}_validateInstanceVariableInitialization(e){"none"!==this._fileInfo.diagnosticRuleSet.reportUninitializedInstanceVariable&&e.details.fields.forEach(((t,n)=>{if(!t.isInstanceMember())return;const i=t.getDeclarations();i.find((e=>{const t=Dr(e.node);return!t||10===t.nodeType||"__init__"===t.name.value}))||va(e,n,1)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUninitializedInstanceVariable,$o.reportUninitializedInstanceVariable,ml.Diagnostic.uninitializedInstanceVariable().format({name:n}),i[0].node)}))}_validateProtocolTypeParamVariance(e,t){const n=t.details.typeParameters.filter((e=>!wo(e)));if(0===n.length)return;const i=this._evaluator.getBuiltInType(e,"object");if(!_o(i))return;const r=n.map((e=>Io(e)?e:oo.cloneAsInvariant(e))),s=Zs.cloneWithNewTypeParameters(t,r),o=Zs.cloneAsInstance(i),a=Zs.createInstantiable("__protocolVarianceDummy","","","",0,0,void 0,void 0);r.forEach(((i,l)=>{if(i.details.isVariadic)return;const c=r.map(((e,t)=>e.details.isVariadic?e:t===l?o:a)),u=r.map(((e,t)=>t===l||e.details.isVariadic?e:a)),p=Zs.cloneForSpecialization(s,c,!0),d=Zs.cloneForSpecialization(s,u,!0);let h;if(h=this._evaluator.canAssignProtocolClassToSelf(p,d)?1:this._evaluator.canAssignProtocolClassToSelf(d,p)?2:0,h!==n[l].details.variance){let n;n=1===h?ml.Diagnostic.protocolVarianceCovariant().format({variable:i.details.name,class:t.details.name}):2===h?ml.Diagnostic.protocolVarianceContravariant().format({variable:i.details.name,class:t.details.name}):ml.Diagnostic.protocolVarianceInvariant().format({variable:i.details.name,class:t.details.name}),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse,$o.reportInvalidTypeVarUse,n,e.name)}}))}_validateSlotsClassVarConflict(e){e.details.localSlotsNames&&e.details.fields.forEach(((e,t)=>{const n=e.getDeclarations();n.some((e=>1===e.type&&e.isDefinedBySlots))&&n.forEach((e=>{1!==e.type||e.isDefinedBySlots||e.isDefinedByMemberAccess||38===e.node.nodeType&&$r(e.node)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.slotsClassVarConflict().format({name:t}),e.node)}))}))}_validateConstructorConsistency(e){const t=va(e,"__init__",12),n=va(e,"__new__",12);if(!(t&&n&&yo(t.classType)&&yo(n.classType)))return;if(!Zs.isSameGenericClass(n.classType,e)&&!Zs.isSameGenericClass(t.classType,e))return;const i=n.classType.details.effectiveMetaclass;if(i&&yo(i)&&!Zs.isBuiltIn(i,"type")&&va(i,"__call__",40))return;let r=this._evaluator.getTypeOfMember(n);if(!Eo(r)&&!ko(r))return;if(r=this._evaluator.bindFunctionToClassOrObject(e,r,void 0,void 0,void 0,!0),!r)return;if(ko(r)&&(r=r.overloads.find((e=>!Xs.isOverloaded(e))),!r))return;let s=this._evaluator.getTypeOfMember(t);if((Eo(s)||ko(s))&&(s=this._evaluator.bindFunctionToClassOrObject(Zs.cloneAsInstance(e),s),s&&(!ko(s)||(s=s.overloads.find((e=>!Xs.isOverloaded(e))),s))&&Eo(s)&&Eo(r)&&!(Xs.hasDefaultParameters(s)||Xs.hasDefaultParameters(r)||(s=Xs.cloneWithNewFlags(s,98304|s.details.flags),r=Xs.cloneWithNewFlags(r,98304|s.details.flags),this._evaluator.canAssignType(r,s,void 0,void 0,32)&&this._evaluator.canAssignType(s,r,void 0,void 0,32))))){const i=Zs.isSameGenericClass(t.classType,e),o=Vo(t.symbol),a=Vo(n.symbol);if(o&&a){const e=i?o:a,l=28===e.node.nodeType?e.node.name:e.node,c=new il,u=this._evaluator.printType(s),p=this._evaluator.printType(r);c.addMessage(ml.DiagnosticAddendum.initMethodSignature().format({type:u})),c.addMessage(ml.DiagnosticAddendum.newMethodSignature().format({type:p}));const d=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInconsistentConstructor,$o.reportInconsistentConstructor,ml.Diagnostic.constructorParametersMismatch().format({classType:this._evaluator.printType(Zs.cloneAsInstance(i?t.classType:n.classType))})+c.getString(),l);if(d){const e=i?a:o;d.addRelatedInfo((i?ml.DiagnosticAddendum.newMethodLocation():ml.DiagnosticAddendum.initMethodLocation()).format({type:this._evaluator.printType(Zs.cloneAsInstance(i?n.classType:t.classType))}),e.path,e.range)}}}}_validateMultipleInheritanceCompatibility(e,t){if("none"===this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride)return;const n=[];if(e.details.baseClasses.forEach((e=>{!yo(e)||Zs.isBuiltIn(e,"Generic")||Zs.isBuiltIn(e,"Protocol")||n.push(e)})),n.length<2)return;const i=n.map((t=>{const n=e.details.mro.find((e=>yo(e)&&Zs.isSameGenericClass(e,t)));return n&&yo(n)?function(e){const t=new Map;for(let n=e.details.mro.length-1;n>=0;n--){const i=ha(e.details.mro[n],e);yo(i)?i.details.fields.forEach(((e,n)=>{!e.isIgnoredForProtocolMatch()&&e.hasTypedDeclarations()&&t.set(n,{classType:i,symbol:e,isInstanceMember:e.isInstanceMember(),isClassVar:e.isClassVar(),isTypeDeclared:!0,skippedUndeclaredType:!1})})):t.clear()}return t}(n):new Map}));for(let r=1;r<i.length;r++){const s=i[r];for(const[o,a]of s)if(!Qt(o)&&!Kt(o)&&yo(a.classType))for(let s=0;s<r;s++){const l=i[s].get(o);if(l){let i=this._evaluator.getEffectiveTypeOfSymbol(a.symbol);yo(a.classType)&&(i=ha(i,a.classType));let c=this._evaluator.getEffectiveTypeOfSymbol(l.symbol);if(yo(l.classType)&&(c=ha(c,l.classType)),Eo(i)||ko(i)){const u=new il;let p;if(Eo(c))p=c;else if(ko(c)&&(p=c.overloads[c.overloads.length-1],Xs.isOverloaded(p)))continue;if(p&&!this._evaluator.canOverrideMethod(i,p,u,!0)){const d=p.details.declaration;if(d&&3===d.type){const p=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,$o.reportIncompatibleMethodOverride,ml.Diagnostic.baseClassMethodTypeIncompatible().format({classType:e.details.name,name:o})+u.getString(),t),d=Vo(l.symbol),h=Vo(a.symbol);p&&d&&h&&(p.addRelatedInfo(ml.DiagnosticAddendum.baseClassProvidesType().format({baseClass:this._evaluator.printType(Fa(n[s])),type:this._evaluator.printType(c)}),d.path,d.range),p.addRelatedInfo(ml.DiagnosticAddendum.baseClassProvidesType().format({baseClass:this._evaluator.printType(Fa(n[r])),type:this._evaluator.printType(i)}),h.path,h.range))}}}}}}}_validateBaseClassOverrides(e){e.details.fields.forEach(((t,n)=>{var i;if(Kt(n))return;if(!t.hasTypedDeclarations())return;const r=this._evaluator.getEffectiveTypeOfSymbol(t);if(!ho(r))for(const s of e.details.baseClasses){if(!yo(s))continue;const o=e.details.mro.find((e=>yo(e)&&Zs.isSameGenericClass(e,s)));if(!o)continue;const a=va(o,n,0);if(!a||!_o(a.classType))continue;if(!a.symbol.hasTypedDeclarations())continue;const l=ha(this._evaluator.getEffectiveTypeOfSymbol(a.symbol),a.classType);if(Eo(l)||ko(l)){const e=new il;let s;if(Eo(r)?s=r:ko(r)&&(s=r.overloads[r.overloads.length-1]),s){const r=["__init__","__new__","__init_subclass__"],o=!Qt(n);if(!r.some((e=>e===n))&&!Kt(n)&&!this._evaluator.canOverrideMethod(l,s,e,o)){const r=null!==(i=s.details.declaration)&&void 0!==i?i:Vo(t);if(r){const t=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,$o.reportIncompatibleMethodOverride,ml.Diagnostic.incompatibleMethodOverride().format({name:n,className:a.classType.details.name})+e.getString(),3===r.type?r.node.name:r.node),i=Vo(a.symbol);t&&i&&t.addRelatedInfo(ml.DiagnosticAddendum.overriddenMethod(),i.path,i.range)}}if(Eo(l)&&!Kt(n)&&Xs.isFinal(l)){const e=Vo(t);if(e&&3===e.type){const t=this._evaluator.addError(ml.Diagnostic.finalMethodOverride().format({name:n,className:a.classType.details.name}),e.node.name),i=Vo(a.symbol);t&&i&&t.addRelatedInfo(ml.DiagnosticAddendum.finalMethod(),i.path,i.range)}}}else if(!ho(r)&&!Zs.isBuiltIn(a.classType,"_TypedDict")){const e=t.getDeclarations();if(e.length>0){const t=e[e.length-1],i=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,$o.reportIncompatibleMethodOverride,ml.Diagnostic.methodOverridden().format({name:n,className:a.classType.details.name,type:this._evaluator.printType(r,!1)}),t.node),s=Vo(a.symbol);i&&s&&i.addRelatedInfo(ml.DiagnosticAddendum.overriddenMethod(),s.path,s.range)}}}else if(ua(l))if(ua(r)){const i=l.details.fields,s=r.details.fields,o=a.classType;["fget","fset","fdel"].forEach((r=>{const a=new il,l=i.get(r),c=s.get(r);if(l){const i=ha(this._evaluator.getEffectiveTypeOfSymbol(l),o);if(Eo(i))if(c){const t=ha(this._evaluator.getEffectiveTypeOfSymbol(c),e);if(Eo(t)&&!this._evaluator.canOverrideMethod(i,t,a.createAddendum())){a.addMessage(ml.DiagnosticAddendum.propertyMethodIncompatible().format({name:r}));const e=t.details.declaration;if(e&&3===e.type){const t=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,$o.reportIncompatibleMethodOverride,ml.Diagnostic.propertyOverridden().format({name:n,className:o.details.name})+a.getString(),e.node.name),r=i.details.declaration;t&&r&&t.addRelatedInfo(ml.DiagnosticAddendum.overriddenMethod(),r.path,r.range)}}}else{a.addMessage(ml.DiagnosticAddendum.propertyMethodMissing().format({name:r}));const e=t.getDeclarations();if(e.length>0){const t=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,$o.reportIncompatibleMethodOverride,ml.Diagnostic.propertyOverridden().format({name:n,className:o.details.name})+a.getString(),e[e.length-1].node),r=i.details.declaration;t&&r&&t.addRelatedInfo(ml.DiagnosticAddendum.overriddenMethod(),r.path,r.range)}}}}))}else{const e=t.getDeclarations();e.length>0&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,$o.reportIncompatibleMethodOverride,ml.Diagnostic.propertyOverridden().format({name:n,className:a.classType.details.name}),e[e.length-1].node)}else if("none"!==this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride){const e=t.getDeclarations();if(e.length>0){const i=e[e.length-1],s=new il;if(!this._evaluator.canAssignType(l,r,s)){const e=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride,$o.reportIncompatibleVariableOverride,ml.Diagnostic.symbolOverridden().format({name:n,className:a.classType.details.name})+s.getString(),i.node),t=Vo(a.symbol);e&&t&&e.addRelatedInfo(ml.DiagnosticAddendum.overriddenSymbol(),t.path,t.range)}const o=a.symbol.isClassVar();let c=t.isClassVar();if(o&&!c&&(t.hasTypedDeclarations()||(c=!0),t.getTypedDeclarations().every((e=>4===e.type))&&(c=!0)),o!==c){const e=t.isClassVar()?ml.Diagnostic.classVarOverridesInstanceVar():ml.Diagnostic.instanceVarOverridesClassVar(),r=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride,$o.reportIncompatibleVariableOverride,e.format({name:n,className:a.classType.details.name}),i.node),s=Vo(a.symbol);r&&s&&r.addRelatedInfo(ml.DiagnosticAddendum.overriddenSymbol(),s.path,s.range)}}}}}))}_validateMethod(e,t,n){const i=this._evaluator.getTypeOfClass(n),r=null==i?void 0:i.classType;if(e.name&&r&&["__init__","__init_subclass__","__enter__","__exit__"].some((t=>t===e.name.value))&&(Xs.isAbstractMethod(t)||Xs.isOverloaded(t)||this._fileInfo.isStubFile||this._validateSuperCallForMethod(e,t,r)),e.name&&"__new__"===e.name.value)0!==e.parameters.length&&e.parameters[0].name&&["cls","_cls","__cls","__mcls"].some((t=>e.parameters[0].name.value===t))||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,$o.reportSelfClsParameterName,ml.Diagnostic.newClsParam(),e.parameters.length>0?e.parameters[0]:e.name),r&&this._validateClsSelfParameterType(t,r,!0);else if(e.name&&"__init_subclass__"===e.name.value)0!==e.parameters.length&&e.parameters[0].name&&"cls"===e.parameters[0].name.value||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,$o.reportSelfClsParameterName,ml.Diagnostic.initSubclassClsParam(),e.parameters.length>0?e.parameters[0]:e.name),r&&this._validateClsSelfParameterType(t,r,!0);else if(e.name&&"__class_getitem__"===e.name.value)0!==e.parameters.length&&e.parameters[0].name&&"cls"===e.parameters[0].name.value||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,$o.reportSelfClsParameterName,ml.Diagnostic.classGetItemClsParam(),e.parameters.length>0?e.parameters[0]:e.name),r&&this._validateClsSelfParameterType(t,r,!0);else if(Xs.isStaticMethod(t)){if(e.parameters.length>0&&e.parameters[0].name){const t=e.parameters[0].name.value;"self"!==t&&"cls"!==t||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,$o.reportSelfClsParameterName,ml.Diagnostic.staticClsSelfParam(),e.parameters[0].name)}}else if(Xs.isClassMethod(t)){let n="";e.parameters.length>0&&e.parameters[0].name&&(n=e.parameters[0].name.value),"cls"!==n&&(this._fileInfo.isStubFile&&(n.startsWith("_")||"metacls"===n)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,$o.reportSelfClsParameterName,ml.Diagnostic.classMethodClsParam(),e.parameters.length>0?e.parameters[0]:e.name)),r&&this._validateClsSelfParameterType(t,r,!0)}else{if(0===e.decorators.length){let t="",i=!0;if(e.parameters.length>0&&(e.parameters[0].name&&(t=e.parameters[0].name.value),0!==e.parameters[0].category&&(i=!1)),i&&"self"!==t){let i=!1;if("cls"===t){const e=this._evaluator.getTypeOfClass(n),t=this._evaluator.getBuiltInType(n,"type");t&&_o(t)&&e&&_o(e.classType)&&Da(e.classType,t,!0)&&(i=!0)}const r=Yt(t);i||r||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,$o.reportSelfClsParameterName,ml.Diagnostic.instanceMethodSelfParam(),e.parameters.length>0?e.parameters[0]:e.name)}}r&&this._validateClsSelfParameterType(t,r,!1)}}_validateSuperCallForMethod(e,t,n){if("none"===this._fileInfo.diagnosticRuleSet.reportMissingSuperCall)return;let i=9;if(Zs.isFinal(n)&&(i|=4),!va(n,t.details.name,i))return;let r=!1;new Wr((e=>{if(35===e.leftExpression.nodeType&&e.leftExpression.memberName.value===t.details.name){const t=e.leftExpression.leftExpression;if(9===t.nodeType&&38===t.leftExpression.nodeType&&"super"===t.leftExpression.value)r=!0;else{const e=this._evaluator.getType(t);e&&_o(e)&&(r=!0)}}})).walk(e.suite),r||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingSuperCall,$o.reportMissingSuperCall,ml.Diagnostic.missingSuperCall().format({methodName:t.details.name}),e.name)}_validateClsSelfParameterType(e,t,n){if(e.details.parameters.length<1)return;const i=e.details.parameters[0];if(!i.typeAnnotation||!i.name)return;if(Zs.isProtocolClass(t))return;const r=this._evaluator.makeTopLevelTypeVarsConcrete(i.type),s=n?t:Fa(t);_o(r)&&Zs.isProtocolClass(r)||vo(r)&&Zs.isProtocolClass(r)||Xs.isOverloaded(e)||this._evaluator.canAssignType(r,s)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.clsSelfParamTypeMismatch().format({name:i.name,classType:this._evaluator.printType(s,!1)}),i.typeAnnotation)}_validateYieldType(e,t){let n,i;const r=kr(e);if(r){const e=this._evaluator.getTypeOfFunction(r);e&&(w(Eo(e.functionType)),n=Xs.getSpecializedReturnType(e.functionType),n&&(i=function(e,t){let n=!0;const i=Ko(e,(e=>ho(e)?e:vo(e)&&[["AsyncIterable","Iterable"],["AsyncIterator","Iterator"],["AsyncGenerator","Generator"],["","AwaitableGenerator"]].some((n=>Zs.isBuiltIn(e,t?n[0]:n[1])))?e.typeArguments&&e.typeArguments.length>=1?e.typeArguments[0]:Ys.create():void(n=!1)));return n?i:void 0}(n,!!r.isAsync)),n&&!i&&r.returnTypeAnnotation&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,r.isAsync?ml.Diagnostic.generatorAsyncReturnType():ml.Diagnostic.generatorSyncReturnType(),r.returnTypeAnnotation))}if(this._evaluator.isNodeReachable(e,void 0))if(n&&ao(n))this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.noReturnContainsYield(),e);else if(i){const n=new il;this._evaluator.canAssignType(i,t,n)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.yieldTypeMismatch().format({exprType:this._evaluator.printType(t,!1),yieldType:this._evaluator.printType(i,!1)})+n.getString(),e.expression||e)}}_reportUnusedExceptStatements(e){let t=!1;const n=[];e.exceptClauses.forEach((e=>{if(t||e.isExceptGroup||!e.typeExpression)return;const i=this._evaluator.getType(e.typeExpression);if(!i||ho(i))return void(t=!0);const r=[];if(_o(i)?(i.includeSubclasses&&(t=!0),r.push(i)):vo(i)&&Jo(this._evaluator.getTypeFromIterator(i,!1,void 0)||Ys.create(),(e=>{ho(e)&&(t=!0),_o(e)&&(e.includeSubclasses&&(t=!0),r.push(e))})),n.length>0){const t=new il;let i=0;r.forEach((e=>{const r=n.find((t=>Da(e,t,!0)));r&&(t.addMessage(ml.DiagnosticAddendum.unreachableExcept().format({exceptionType:this._evaluator.printType(Fa(e)),parentType:this._evaluator.printType(Fa(r))})),i++)})),r.length===i&&(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.unreachableExcept()+t.getString(),e.typeExpression),this._evaluator.addUnusedCode(e,e.exceptSuite))}n.push(...r)}))}_reportDuplicateImports(){const e=tn(this._moduleNode),t=new Map;e.orderedImports.forEach((e=>{if(22===e.node.nodeType){const t=new Map;e.node.imports.forEach((e=>{e.alias||(t.get(e.name.value)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportDuplicateImport,$o.reportDuplicateImport,ml.Diagnostic.duplicateImport().format({importName:e.name.value}),e.name):t.set(e.name.value,e))}))}else e.subnode&&!e.subnode.alias&&(t.get(e.moduleName)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportDuplicateImport,$o.reportDuplicateImport,ml.Diagnostic.duplicateImport().format({importName:e.moduleName}),e.subnode):t.set(e.moduleName,e.subnode))}))}}function wu(e){Eu(e,{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!1,omitConditionalConstraint:!1,pep604Printing:!0,strictListInference:!0,strictSetInference:!0,strictDictionaryInference:!0,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"none",reportFunctionMemberAccess:"error",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"error",reportImportCycles:"error",reportUnusedImport:"error",reportUnusedClass:"error",reportUnusedFunction:"error",reportUnusedVariable:"error",reportDuplicateImport:"error",reportWildcardImportFromLibrary:"error",reportOptionalSubscript:"error",reportOptionalMemberAccess:"error",reportOptionalCall:"error",reportOptionalIterable:"error",reportOptionalContextManager:"error",reportOptionalOperand:"error",reportTypedDictNotRequiredAccess:"error",reportUntypedFunctionDecorator:"error",reportUntypedClassDecorator:"error",reportUntypedBaseClass:"error",reportUntypedNamedTuple:"error",reportPrivateUsage:"error",reportPrivateImportUsage:"error",reportConstantRedefinition:"error",reportIncompatibleMethodOverride:"error",reportIncompatibleVariableOverride:"error",reportInconsistentConstructor:"error",reportOverlappingOverload:"error",reportMissingSuperCall:"none",reportUninitializedInstanceVariable:"none",reportInvalidStringEscapeSequence:"error",reportUnknownParameterType:"error",reportUnknownArgumentType:"error",reportUnknownLambdaType:"error",reportUnknownVariableType:"error",reportUnknownMemberType:"error",reportMissingParameterType:"error",reportMissingTypeArgument:"error",reportInvalidTypeVarUse:"error",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"error",reportUnnecessaryCast:"error",reportUnnecessaryComparison:"error",reportAssertAlwaysTrue:"error",reportSelfClsParameterName:"error",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"error",reportIncompleteStub:"error",reportUnsupportedDunderAll:"error",reportUnusedCallResult:"none",reportUnusedCoroutine:"error",reportUnnecessaryTypeIgnoreComment:"none",reportMatchNotExhaustive:"error"},[$o.reportMissingModuleSource])}function Eu(e,t,n){const i=Cc(),r=wc();for(const r of i)n.find((e=>e===r))||t[r]&&(e[r]=!0);for(const i of r){if(n.find((e=>e===i)))continue;const r=t[i],s=e[i];("error"===r||"warning"===r&&"error"!==s||"information"===r&&"error"!==s&&"warning"!==s)&&(e[i]=r)}}function ku(e,t){const n=["pyright:","mspython:"].find((t=>e.startsWith(t)));if(n){const i=e.substr(n.length).trim().split(",").map((e=>e.trim()));i.some((e=>"strict"===e))?wu(t):i.some((e=>"basic"===e))&&function(e){Eu(e,{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!0,omitConditionalConstraint:!1,pep604Printing:!0,strictListInference:!1,strictSetInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"none",reportFunctionMemberAccess:"none",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"warning",reportOptionalSubscript:"error",reportOptionalMemberAccess:"error",reportOptionalCall:"error",reportOptionalIterable:"error",reportOptionalContextManager:"error",reportOptionalOperand:"error",reportTypedDictNotRequiredAccess:"error",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportPrivateImportUsage:"error",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportInconsistentConstructor:"none",reportOverlappingOverload:"none",reportMissingSuperCall:"none",reportUninitializedInstanceVariable:"none",reportInvalidStringEscapeSequence:"warning",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingParameterType:"none",reportMissingTypeArgument:"none",reportInvalidTypeVarUse:"warning",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportUnnecessaryComparison:"none",reportAssertAlwaysTrue:"warning",reportSelfClsParameterName:"warning",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"none",reportIncompleteStub:"none",reportUnsupportedDunderAll:"warning",reportUnusedCallResult:"none",reportUnusedCoroutine:"error",reportUnnecessaryTypeIgnoreComment:"none",reportMatchNotExhaustive:"none"},[])}(t);for(const e of i)t=Du(e,t)}return t}function Du(e,t){const n=e.split("=").map((e=>e.trim()));if(2!==n.length)return t;const i=n[0],r=Cc();if(wc().find((e=>e===i))){const e=function(e){switch(e){case"false":case"none":return"none";case"true":case"error":return"error";case"warning":return"warning";case"information":return"information";default:return}}(n[1]);void 0!==e&&(t[i]=e)}else if(r.find((e=>e===i))){const e="false"!==(s=n[1])&&("true"===s||void 0);void 0!==e&&(t[i]=e)}var s;return t}class Au extends _r{constructor(e){super(),this._parseTree=e}clean(){this.walk(this._parseTree)}visitNode(e){return function(e){const t=e;delete t.scope,delete t.declaration,delete t.flowNode,delete t.afterFlowNode,delete t.fileInfo,delete t.codeFlowExpressions,delete t.codeFlowComplexity,delete t.dunderAllInfo}(e),super.visitNode(e)}}class Pu extends _r{constructor(){super()}visitNode(e){const t=super.visitNode(e);return this._verifyParentChildLinks(e,t),this._verifyChildRanges(e,t),t}_verifyParentChildLinks(e,t){t.forEach((t=>{t&&t.parent!==e&&E(`Child node ${t.nodeType} does not contain a reference to its parent ${e.nodeType}`)}))}_verifyChildRanges(e,t){let n;t.forEach((t=>{if(t){let i=!1;3===e.nodeType&&t===e.typeAnnotationComment&&(i=!0),48===e.nodeType&&t===e.typeAnnotation&&(i=!0),i||((t.start<e.start||dt.getEnd(t)>dt.getEnd(e))&&E(`Child node ${t.nodeType} is not contained within its parent ${e.nodeType}`),n&&t.start<dt.getEnd(n)&&62!==n.nodeType&&E("Child node is not after previous child node"),n=t)}}))}}class Ru{constructor(e,t,n,i,r,s,o,a=!1){this._isFileDeleted=!1,this._diagnosticVersion=0,this._fileContentsVersion=0,this._lastFileContentLength=void 0,this._lastFileContentHash=void 0,this._analyzedFileContentsVersion=-1,this._parseTreeNeedsCleaning=!1,this._isBindingInProgress=!1,this._parseDiagnostics=[],this._bindDiagnostics=[],this._checkerDiagnostics=[],this._typeIgnoreLines=new Map,this._diagnosticRuleSet={printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!0,omitConditionalConstraint:!1,pep604Printing:!0,strictListInference:!1,strictSetInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"none",reportFunctionMemberAccess:"none",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"warning",reportOptionalSubscript:"error",reportOptionalMemberAccess:"error",reportOptionalCall:"error",reportOptionalIterable:"error",reportOptionalContextManager:"error",reportOptionalOperand:"error",reportTypedDictNotRequiredAccess:"error",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportPrivateImportUsage:"error",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportInconsistentConstructor:"none",reportOverlappingOverload:"none",reportMissingSuperCall:"none",reportUninitializedInstanceVariable:"none",reportInvalidStringEscapeSequence:"warning",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingParameterType:"none",reportMissingTypeArgument:"none",reportInvalidTypeVarUse:"warning",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportUnnecessaryComparison:"none",reportAssertAlwaysTrue:"warning",reportSelfClsParameterName:"warning",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"none",reportIncompleteStub:"none",reportUnsupportedDunderAll:"warning",reportUnusedCallResult:"none",reportUnusedCoroutine:"error",reportUnnecessaryTypeIgnoreComment:"none",reportMatchNotExhaustive:"none"},this._circularDependencies=[],this._isBindingNeeded=!0,this._isCheckingNeeded=!0,this._indexingNeeded=!0,this._ipythonMode=!1,this.fileSystem=e,this._console=s||new Un,this._filePath=t,this._moduleName=n,this._isStubFile=t.endsWith(".pyi"),this._isThirdPartyImport=i,this._isThirdPartyPyTypedPresent=r;const l=de(t);this._isTypingStubFile=this._isStubFile&&(this._filePath.endsWith(X("stdlib/typing.pyi"))||"typing_extensions.pyi"===l),this._isTypingExtensionsStubFile=this._isStubFile&&"typing_extensions.pyi"===l,this._isBuiltInStubFile=!1,this._isStubFile&&(this._filePath.endsWith(X("stdlib/collections/__init__.pyi"))||this._filePath.endsWith(X("stdlib/asyncio/futures.pyi"))||this._filePath.endsWith(X("stdlib/asyncio/tasks.pyi"))||this._filePath.endsWith(X("stdlib/builtins.pyi"))||this._filePath.endsWith(X("stdlib/_importlib_modulespec.pyi"))||this._filePath.endsWith(X("stdlib/dataclasses.pyi"))||this._filePath.endsWith(X("stdlib/abc.pyi"))||this._filePath.endsWith(X("stdlib/enum.pyi"))||this._filePath.endsWith(X("stdlib/queue.pyi"))||this._filePath.endsWith(X("stdlib/types.pyi")))&&(this._isBuiltInStubFile=!0),this._logTracker=null!=o?o:new Bn(s,kn()?"BG":"FG"),this._ipythonMode=a}getFilePath(){return this._filePath}getDiagnosticVersion(){return this._diagnosticVersion}isStubFile(){return this._isStubFile}isThirdPartyPyTypedPresent(){return this._isThirdPartyPyTypedPresent}getDiagnostics(e,t){if(this._diagnosticVersion===t)return;let n=!0;this._isThirdPartyImport&&(n=!1);let i=[...this._parseDiagnostics,...this._bindDiagnostics,...this._checkerDiagnostics];const r=i,s=new Map(this._typeIgnoreLines);this._diagnosticRuleSet.enableTypeIgnoreComments&&this._typeIgnoreLines.size>0&&(i=i.filter((e=>{if(3!==e.category&&4!==e.category)for(let t=e.range.start.line;t<=e.range.end.line;t++)if(this._typeIgnoreLines.has(t))return s.delete(t),!1;return!0})));const o=[];if("none"!==this._diagnosticRuleSet.reportUnnecessaryTypeIgnoreComment){const e=tl(this._diagnosticRuleSet.reportUnnecessaryTypeIgnoreComment);0===r.filter((e=>0===e.category||1===e.category||2===e.category)).length&&void 0!==this._typeIgnoreAll&&o.push(new nl(e,ml.Diagnostic.unnecessaryTypeIgnore(),St(this._typeIgnoreAll.start,this._typeIgnoreAll.start+this._typeIgnoreAll.length,this._parseResults.tokenizerOutput.lines))),s.forEach((t=>{var n;(null===(n=this._parseResults)||void 0===n?void 0:n.tokenizerOutput.lines)&&o.push(new nl(e,ml.Diagnostic.unnecessaryTypeIgnore(),St(t.start,t.start+t.length,this._parseResults.tokenizerOutput.lines)))}))}if("none"!==this._diagnosticRuleSet.reportImportCycles&&this._circularDependencies.length>0){const e=tl(this._diagnosticRuleSet.reportImportCycles);this._circularDependencies.forEach((t=>{i.push(new nl(e,ml.Diagnostic.importCycleDetected()+"\n"+t.getPaths().map((e=>"  "+e)).join("\n"),{start:{line:0,character:0},end:{line:0,character:0}}))}))}return void 0!==this._hitMaxImportDepth&&i.push(new nl(0,ml.Diagnostic.importDepthExceeded().format({depth:this._hitMaxImportDepth}),{start:{line:0,character:0},end:{line:0,character:0}})),e.ignore.find((e=>e.regExp.test(this._filePath)))&&(i=[]),this._diagnosticRuleSet.enableTypeIgnoreComments&&void 0!==this._typeIgnoreAll&&(i=i.filter((e=>0!==e.category&&1!==e.category&&2!==e.category))),i.push(...o),n||(i=i.filter((e=>3===e.category||4===e.category))),i}getImports(){return this._imports||[]}getBuiltinsImport(){return this._builtinsImport}getIPythonDisplayImport(){return this._ipythonDisplayImport}getModuleSymbolTable(){return this._moduleSymbolTable}didContentsChangeOnDisk(){if(this._clientDocument)return!1;if(void 0===this._lastFileContentLength)return!1;try{const e=this.fileSystem.readFileSync(this._filePath,"utf8");if(e.length!==this._lastFileContentLength)return!0;if(M(e)!==this._lastFileContentHash)return!0}catch(e){return!0}return!1}dropParseAndBindInfo(){this._parseResults=void 0,this._moduleSymbolTable=void 0,this._isBindingNeeded=!0}markDirty(e=!0){this._fileContentsVersion++,this._isCheckingNeeded=!0,this._isBindingNeeded=!0,this._indexingNeeded=e,this._moduleSymbolTable=void 0,this._cachedIndexResults=void 0}markReanalysisRequired(e){this._isCheckingNeeded=!0,this._parseResults&&(this._parseResults.containsWildcardImport||void 0!==Wt(this._parseResults.parseTree)||e)&&(this._parseTreeNeedsCleaning=!0,this._isBindingNeeded=!0,this._moduleSymbolTable=void 0)}getClientVersion(){var e;return null===(e=this._clientDocument)||void 0===e?void 0:e.version}getOpenFileContents(){var e;return null===(e=this._clientDocument)||void 0===e?void 0:e.getText()}getFileContent(){const e=this.getOpenFileContents();if(e)return e;try{const e=this.fileSystem.statSync(this._filePath);if(e.size>52428800)throw this._console.error(`File length of "${this._filePath}" is ${e.size} which exceeds the maximum supported file size of 52428800`),new Error("File larger than max");return this.fileSystem.readFileSync(this._filePath,"utf8")}catch(e){return}}setClientVersion(e,t){if(null===e)this._clientDocument=void 0;else{this._clientDocument||(this._clientDocument=ic.create(this._filePath,"python",e,"")),this._clientDocument=ic.update(this._clientDocument,t,e);const n=this._clientDocument.getText(),i=M(n);n.length===this._lastFileContentLength&&i===this._lastFileContentHash||this.markDirty(),this._lastFileContentLength=n.length,this._lastFileContentHash=i,this._isFileDeleted=!1}}prepareForClose(){}isFileDeleted(){return this._isFileDeleted}isParseRequired(){return!this._parseResults||this._analyzedFileContentsVersion!==this._fileContentsVersion}isBindingRequired(){return!this._isBindingInProgress&&(!!this.isParseRequired()||this._isBindingNeeded)}isIndexingRequired(){return this._indexingNeeded}isCheckingRequired(){return this._isCheckingNeeded}getParseResults(){if(!this.isParseRequired())return this._parseResults}getCachedIndexResults(){return this._cachedIndexResults}cacheIndexResults(e){this._cachedIndexResults=e}addCircularDependency(e){let t=!1;this._circularDependencies.length<4&&(this._circularDependencies.some((t=>t.isEqual(e)))||(this._circularDependencies.push(e),t=!0)),t&&this._diagnosticVersion++}setHitMaxImportDepth(e){this._hitMaxImportDepth=e}parse(e,t,n){return this._logTracker.log(`parsing: ${this._getPathForLogging(this._filePath)}`,(i=>{var r;if(!this.isParseRequired())return i.suppress(),!1;const s=new kc;let o=this.getOpenFileContents();if(void 0===o)try{const e=Fn.readFileTime.totalTime;Fn.readFileTime.timeOperation((()=>{if(o=null!=n?n:this.getFileContent(),void 0===o)throw new Error("Can't get file content");this._lastFileContentLength=o.length,this._lastFileContentHash=M(o)})),i.add(`fs read ${Fn.readFileTime.totalTime-e}ms`)}catch(e){s.addError("Source file could not be read",{start:{line:0,character:0},end:{line:0,character:0}}),o="",this.fileSystem.existsSync(this._filePath)||(this._isFileDeleted=!0)}const a=e.findExecEnvironment(this._filePath),l=new Jc;l.ipythonMode=this._ipythonMode,this._filePath.endsWith("pyi")&&(l.isStubFile=!0),l.pythonVersion=a.pythonVersion,l.skipFunctionAndClassBody=null!==(r=e.indexGenerationMode)&&void 0!==r&&r;try{const n=(new Qc).parseSourceFile(o,l,s);w(void 0!==n&&void 0!==n.tokenizerOutput),this._parseResults=n,this._typeIgnoreLines=this._parseResults.tokenizerOutput.typeIgnoreLines,this._typeIgnoreAll=this._parseResults.tokenizerOutput.typeIgnoreAll,Fn.resolveImportsTime.timeOperation((()=>{const e=this._resolveImports(t,n.importedModules,a);this._imports=e.imports,this._builtinsImport=e.builtinsImportResult,this._ipythonDisplayImport=e.ipythonDisplayImportResult,this._parseDiagnostics=s.fetchAndClear()}));const i=void 0!==e.strict.find((e=>e.regExp.test(this._filePath)));this._diagnosticRuleSet=function(e,t,n){let i=(r=t,Object.assign({},r));var r;n&&wu(i);for(let t=0;t<e.count;t++){const n=e.getItemAt(t);if(n.comments)for(const e of n.comments)i=ku(e.value.trim(),i)}return i}(this._parseResults.tokenizerOutput.tokens,e.diagnosticRuleSet,i)}catch(e){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.error(ml.Diagnostic.internalParseError().format({file:this.getFilePath(),message:t})),this._parseResults={text:"",parseTree:Yn.create({start:0,length:0}),importedModules:[],futureImports:new Map,tokenizerOutput:{tokens:new Ac([]),lines:new Ac([]),typeIgnoreAll:void 0,typeIgnoreLines:new Map,predominantEndOfLineSequence:"\n",predominantTabSequence:"    ",predominantSingleQuoteCharacter:"'"},containsWildcardImport:!1,typingSymbolAliases:new Map},this._imports=void 0,this._builtinsImport=void 0,this._ipythonDisplayImport=void 0;const n=new kc;n.addError(ml.Diagnostic.internalParseError().format({file:this.getFilePath(),message:t}),{start:{line:0,character:0},end:{line:0,character:0}}),this._parseDiagnostics=n.fetchAndClear()}return this._analyzedFileContentsVersion=this._fileContentsVersion,this._indexingNeeded=!0,this._isBindingNeeded=!0,this._isCheckingNeeded=!0,this._parseTreeNeedsCleaning=!1,this._hitMaxImportDepth=void 0,this._diagnosticVersion++,!0}))}index(e,t){return this._logTracker.log(`indexing: ${this._getPathForLogging(this._filePath)}`,(n=>{if(!this._parseResults||!this.isIndexingRequired())return void n.suppress();this._indexingNeeded=!1;const i=Fc.indexSymbols(Vt(this._parseResults.parseTree),this._parseResults,e,t);return n.add(`found ${i.length}`),{privateOrProtected:Yt(he(de(this._filePath))),symbols:i}}))}getDefinitionsForPosition(e,t,n,i,r){if(this._parseResults)return Pc.getDefinitionsForPosition(e,this._parseResults,t,n,i,r)}getTypeDefinitionsForPosition(e,t,n,i,r){if(this._parseResults)return Pc.getTypeDefinitionsForPosition(e,this._parseResults,t,n,i,r)}getDeclarationForNode(e,t,n,i,r){if(this._parseResults)return tc.getDeclarationForNode(e,this._filePath,t,n,i,r)}getDeclarationForPosition(e,t,n,i,r){if(this._parseResults)return tc.getDeclarationForPosition(e,this._parseResults,this._filePath,t,n,i,r)}addReferences(e,t,n,i){this._parseResults&&tc.addReferences(this._parseResults,this._filePath,e,t,n,i)}addHierarchicalSymbolsForDocument(e,t){(this._parseResults||this._cachedIndexResults)&&Fc.addHierarchicalSymbolsForDocument(this._parseResults?Vt(this._parseResults.parseTree):void 0,this.getCachedIndexResults(),this._parseResults,e,t)}getSymbolsForDocument(e,t){return this._parseResults||this._cachedIndexResults?Fc.getSymbolsForDocument(this._parseResults?Vt(this._parseResults.parseTree):void 0,this.getCachedIndexResults(),this._parseResults,this._filePath,e,t):[]}getHoverForPosition(e,t,n,i,r){if(!this._isBindingNeeded&&this._parseResults)return class{static getHoverForPosition(e,t,n,i,r,s){ct(s);const o=xt(n,t.tokenizerOutput.lines);if(void 0===o)return;const a=Tr(t.parseTree,o);if(void 0===a)return;const l={parts:[],range:{start:It(a.start,t.tokenizerOutput.lines),end:It(dt.getEnd(a),t.tokenizerOutput.lines)}};if(38===a.nodeType){const t=r.getDeclarationsForNameNode(a);if(t&&t.length>0){let n=t[0];6===n.type&&t.length>1&&(n=t[1]),this._addResultsForDeclaration(i,e,l.parts,n,a,r)}else if((!a.parent||37!==a.parent.nodeType)&&0===l.parts.length){const t=r.getType(a)||Ys.create();let n="";n=To(t)?"(module) "+a.value:a.value+": "+r.printType(t,!1),this._addResultsPart(l.parts,n,!0),this._addDocumentationPart(i,e,l.parts,a,r,void 0)}}return l.parts.length>0?l:void 0}static _addResultsForDeclaration(e,t,n,i,r,s){var o;const a=s.resolveAliasDeclaration(i,!0);if(a)switch(a.type){case 0:this._addResultsPart(n,r.value+this._getTypeText(r,s),!0),this._addDocumentationPart(e,t,n,r,s,a);break;case 1:{let l=a.isConstant||a.isFinal?"constant":"variable",c=r;21===i.node.nodeType||23===i.node.nodeType?i.node.alias&&r!==i.node.alias&&38===a.node.nodeType&&(c=a.node):1===(null===(o=r.parent)||void 0===o?void 0:o.nodeType)&&r.parent.name===r&&38===i.node.nodeType&&(c=i.node);const u=s.getType(c);let p,d=!1;if(null==u?void 0:u.typeAliasInfo){const e=Do(u);(null==e?void 0:e.name)===c.value&&(bo(u)?(l=u.details.isParamSpec?"param spec":"type variable",p=u.details.name):(d=!0,l="type alias"))}const h=p||r.value+this._getTypeText(c,s,d);this._addResultsPart(n,`(${l}) ${h}`,!0),this._addDocumentationPart(e,t,n,r,s,a);break}case 2:this._addResultsPart(n,"(parameter) "+r.value+this._getTypeText(r,s),!0),this._addDocumentationPart(e,t,n,r,s,a);break;case 4:case 5:if(this._addInitMethodInsteadIfCallNode(e,r,s,n,t,a))return;this._addResultsPart(n,"(class) "+r.value,!0),this._addDocumentationPart(e,t,n,r,s,a);break;case 3:{let i="function";if(a.isMethod){const e=s.getTypeForDeclaration(a);i=e&&ua(e)?"property":"method"}const o=s.getType(r);o&&ko(o)?this._addResultsPart(n,`(${i})\n${Ol(o,s)}`,!0):this._addResultsPart(n,`(${i}) `+r.value+this._getTypeText(r,s),!0),this._addDocumentationPart(e,t,n,r,s,a);break}case 6:this._addResultsPart(n,"(module) "+r.value,!0),this._addDocumentationPart(e,t,n,r,s,a)}else this._addResultsPart(n,"(import) "+r.value+this._getTypeText(r,s),!0)}static _addInitMethodInsteadIfCallNode(e,t,n,i,r,s){let o=t;if(o.parent&&35===o.parent.nodeType&&t===o.parent.memberName&&(o=t.parent),!o||!o.parent||9!==o.parent.nodeType||o.parent.leftExpression!==o)return!1;const a=n.getType(t);if(!a||!_o(a))return!1;const l=va(a,"__init__",8);if(!l)return!1;const c=n.getType(o.parent),u=n.getTypeOfMember(l);if(!(c&&u&&vo(c)&&Eo(u)))return!1;const p=n.bindFunctionToClassOrObject(c,u);if(!p||!Eo(p))return!1;const d=n.printFunctionParts(p),h=`${t.value}(${d[0].join(", ")})`;return this._addResultsPart(i,"(class) "+h,!0),this._addDocumentationPartForType(e,r,i,p,s,n)||this._addDocumentationPartForType(e,r,i,a,s,n),!0}static _getTypeText(e,t,n=!1){const i=t.getType(e)||Ys.create();return": "+t.printType(i,n)}static _addDocumentationPart(e,t,n,i,r,s){const o=r.getType(i);o&&this._addDocumentationPartForType(e,t,n,o,s,r)}static _addDocumentationPartForType(e,t,n,i,r,s){const o=ql(t,i,r,s);let a=!1;for(const t of o)t&&(a=!0,this._addDocumentationResultsPart(e,n,t));return a}static _addDocumentationResultsPart(e,t,n){if(n)if(e===ot.MarkupKind.Markdown){const e=ds(n);t.length>0&&e.length>0&&t.push({text:"---\n"}),this._addResultsPart(t,e)}else e===ot.MarkupKind.PlainText?this._addResultsPart(t,hs(n)):E(`Unsupported markup type: ${e}`)}static _addResultsPart(e,t,n=!1){e.push({python:n,text:t})}}.getHoverForPosition(e,this._parseResults,t,n,i,r)}getDocumentHighlight(e,t,n,i){if(!this._isBindingNeeded&&this._parseResults)return class{static getDocumentHighlight(e,t,n,i){ct(i);const r=xt(t,e.tokenizerOutput.lines);if(void 0===r)return;const s=Tr(e.parseTree,r);return void 0!==s&&38===s.nodeType?Ml.collectFromNode(s,n,i,e.parseTree,!0).map((t=>({kind:38===t.node.nodeType&&$r(t.node)?ot.DocumentHighlightKind.Write:ot.DocumentHighlightKind.Read,range:St(t.range.start,dt.getEnd(t.range),e.tokenizerOutput.lines)}))):void 0}}.getDocumentHighlight(this._parseResults,t,n,i)}getSignatureHelpForPosition(e,t,n,i,r){if(this._parseResults)return class{static getSignatureHelpForPosition(e,t,n,i,r,s){var o;ct(s);const a=xt(t,e.tokenizerOutput.lines);if(void 0===a)return;let l=Tr(e.parseTree,a);const c=l,u=l?vr(l):0;let p=a-1;for(;p>=0&&","!==e.text.substr(p,1);){const t=Tr(e.parseTree,p);if(t&&t!==c){vr(t)>u&&(l=t);break}p--}if(void 0===l)return;const d=zr(l,a,e.tokenizerOutput.tokens);if(!d)return;const h=i.getCallSignatureInfo(d.callNode,d.activeIndex,d.activeOrFake);return h?{signatures:h.signatures.map((e=>this._makeSignature(h.callNode,e,n,i,r))),callHasParameters:!!(null===(o=h.callNode.arguments)||void 0===o?void 0:o.length)}:void 0}static _makeSignature(e,t,n,i,r){var s;const o=t.type,a=[],l=null!==(s=Ll(o,n,i))&&void 0!==s?s:this._getDocStringFromCallNode(e,n,i);let c=o.details.fullName+"(";const u=o.details.parameters.filter(((e,t)=>!(0===t&&"self"===e.name)));let p;u.forEach(((e,t)=>{const n=e.name||"";let i=e.name||"";1===e.category?i="*"+i:2===e.category&&(i="**"+i),e.hasDefault&&e.defaultValueExpression&&(i+="=",i+=xr(e.defaultValueExpression,1)),a.push({startOffset:c.length,endOffset:c.length+i.length,text:i,documentation:ps(l||"",n)}),c+=i,t<u.length-1&&(c+=", ")})),c+=")",t.activeParam&&(p=u.indexOf(t.activeParam),-1===p&&(p=void 0));const d={label:c,parameters:a,activeParameter:p};return l&&(r===ot.MarkupKind.Markdown?d.documentation={kind:ot.MarkupKind.Markdown,value:ds(l)}:d.documentation={kind:ot.MarkupKind.PlainText,value:hs(l)}),d}static _getDocStringFromCallNode(e,t,n){var i;let r;const s=e.leftExpression;if(38===s.nodeType?r=s:35===s.nodeType&&(r=s.memberName),r)for(const e of null!==(i=n.getDeclarationsForNameNode(r))&&void 0!==i?i:[]){const i=n.resolveAliasDeclaration(e,!0);if(!i)continue;const s=n.getType(r);if(!s)continue;const o=ql(t,s,i,n);if(o.length>0)return o.join("\n\n")}}}.getSignatureHelpForPosition(this._parseResults,e,t,n,i,r)}getCompletionsForPosition(e,t,n,i,r,s,o,a,l,c,u,p){if(!this._parseResults)return;const d=this.getOpenFileContents();return void 0!==d?new jl(t,this._parseResults,d,i,e,this._filePath,n,r,s,o,a,{nameMap:l,libraryMap:c,getModuleSymbolsMap:u},p).getCompletionsForPosition():void 0}resolveCompletionItem(e,t,n,i,r,s,o,a,l,c,u){const p=this.getOpenFileContents();if(!this._parseResults||void 0===p)return;const d=c.data;new jl(d.workspacePath,this._parseResults,p,t,d.position,this._filePath,e,n,i,r,s,{nameMap:o,libraryMap:a,getModuleSymbolsMap:l},u).resolveCompletionItem(c)}performQuickAction(e,t,n){if(this._parseResults&&void 0!==this.getClientVersion())return function(e,t,n,i){return"pyright.organizeimports"===e?new qc(n,i).sort():"pyright.addoptionalforparam"===e&&t.length>=1?function(e,t,n){ct(n);let i=Tr(e.parseTree,t);for(;i&&41!==i.nodeType;)i=i.parent;if(!i)return[];const r=i.typeAnnotation||i.typeAnnotationComment;if(!r)return[];const s=[],o=It(r.start,e.tokenizerOutput.lines),a=It(dt.getEnd(r),e.tokenizerOutput.lines);s.push({range:{start:o,end:o},replacementText:"Optional["}),s.push({range:{start:a,end:a},replacementText:"]"});const l=tn(e.parseTree),c=l.orderedImports.find((e=>"typing"===e.moduleName));if(c&&22===c.node.nodeType&&!c.node.isWildcardImport){const t=rn({name:"Optional"},c,e);s.push(...t)}else{const t=an({name:"Optional"},l,"typing",0,e,o);s.push(...t)}return s}(n,parseInt(t[0],10),i):[]}(e,t,this._parseResults,n)}bind(e,t,n){return w(!this.isParseRequired(),"Bind called before parsing"),w(this.isBindingRequired(),"Bind called unnecessarily"),w(!this._isBindingInProgress,"Bind called while binding in progress"),w(void 0!==this._parseResults,"Parse results not available"),this._logTracker.log(`binding: ${this._getPathForLogging(this._filePath)}`,(()=>{try{Fn.bindTime.timeOperation((()=>{this._cleanParseTreeIfRequired();const i=this._buildFileInfo(e,this._parseResults.text,t,n);!function(e,t){e.fileInfo=t}(this._parseResults.parseTree,i);const r=new ru(i,e.indexGenerationMode);this._isBindingInProgress=!0,r.bindModule(this._parseResults.parseTree),e.internalTestMode&&(new Pu).walk(this._parseResults.parseTree),this._bindDiagnostics=i.diagnosticSink.fetchAndClear();const s=Ft(this._parseResults.parseTree);w(void 0!==s,"Module scope not returned by binder"),this._moduleSymbolTable=s.symbolTable}))}catch(e){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.error(ml.Diagnostic.internalBindError().format({file:this.getFilePath(),message:t}));const n=new kc;n.addError(ml.Diagnostic.internalBindError().format({file:this.getFilePath(),message:t}),{start:{line:0,character:0},end:{line:0,character:0}}),this._bindDiagnostics=n.fetchAndClear()}finally{this._isBindingInProgress=!1}this._diagnosticVersion++,this._isCheckingNeeded=!0,this._indexingNeeded=!0,this._isBindingNeeded=!1}))}check(e){return w(!this.isParseRequired(),"Check called before parsing"),w(!this.isBindingRequired(),"Check called before binding"),w(!this._isBindingInProgress,"Check called while binding in progress"),w(this.isCheckingRequired(),"Check called unnecessarily"),w(void 0!==this._parseResults,"Parse results not available"),this._logTracker.log(`checking: ${this._getPathForLogging(this._filePath)}`,(()=>{try{Fn.typeCheckerTime.timeOperation((()=>{new Cu(this._parseResults.parseTree,e).check(),this._isCheckingNeeded=!1;const t=Vt(this._parseResults.parseTree);this._checkerDiagnostics=t.diagnosticSink.fetchAndClear()}))}catch(e){if(!lt.is(e)){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.error(ml.Diagnostic.internalTypeCheckingError().format({file:this.getFilePath(),message:t}));const n=new kc;n.addError(ml.Diagnostic.internalTypeCheckingError().format({file:this.getFilePath(),message:t}),{start:{line:0,character:0},end:{line:0,character:0}}),this._checkerDiagnostics=n.fetchAndClear(),this._isCheckingNeeded=!1}throw e}finally{this._circularDependencies=[],this._diagnosticVersion++}}))}test_enableIPythonMode(e){this._ipythonMode=e}_buildFileInfo(e,t,n,i){w(void 0!==this._parseResults,"Parse results not available");const r=new Dc(this._parseResults.tokenizerOutput.lines);return{importLookup:n,futureImports:this._parseResults.futureImports,builtinsScope:i,diagnosticSink:r,executionEnvironment:e.findExecEnvironment(this._filePath),diagnosticRuleSet:this._diagnosticRuleSet,fileContents:t,lines:this._parseResults.tokenizerOutput.lines,typingSymbolAliases:this._parseResults.typingSymbolAliases,filePath:this._filePath,moduleName:this._moduleName,isStubFile:this._isStubFile,isTypingStubFile:this._isTypingStubFile,isTypingExtensionsStubFile:this._isTypingExtensionsStubFile,isBuiltInStubFile:this._isBuiltInStubFile,isInPyTypedPackage:this._isThirdPartyPyTypedPresent,isIPythonMode:this._ipythonMode,accessedSymbolMap:new Map}}_cleanParseTreeIfRequired(){this._parseResults&&this._parseTreeNeedsCleaning&&(new Au(this._parseResults.parseTree).clean(),this._parseTreeNeedsCleaning=!1)}_resolveImports(e,t,n){const i=[],r=(t,r=!1)=>{const s=e.resolveImport(this._filePath,n,{leadingDots:0,nameParts:t,importedSymbols:void 0});if(!r||s.isImportFound)return 0===s.resolvedPaths.length||s.resolvedPaths[0]!==this._filePath?(i.push(s),s):void 0};let s;this._isThirdPartyImport||this._isStubFile||(s=r(["__builtins__"],!0)),s||(s=r(["builtins"]));const o=this._ipythonMode?r(["IPython","display"]):void 0;for(const r of t){const t=e.resolveImport(this._filePath,n,{leadingDots:r.leadingDots,nameParts:r.nameParts,importedSymbols:r.importedSymbols});i.push(t),a=t,r.nameNode.importInfo=a}var a;return{imports:i,builtinsImportResult:s,ipythonDisplayImportResult:o}}_getPathForLogging(e){return this.fileSystem.isMappedFilePath(e)?"[virtual] "+e:e}}function Fu(e){function t(e,t="'"){return e?`${t}${e}${t}`:""}e=e.map((e=>le(e))).sort(((e,t)=>e.localeCompare(t))).reverse();const n=/[\\/]/g;function i(t){if(t){if("string"==typeof t){for(const i of e)if(t.startsWith(i))return he(t.substring(i.length)).replace(n,".");return t}return t.nameParts.join(".")}return""}function o(e){var n,i,r,s,a,l;if(e)switch(e.category){case 2:return`Any ${t(null===(n=e.typeAliasInfo)||void 0===n?void 0:n.fullName)}`;case 7:return Ks.isInstantiable(e)?`Class '${e.details.name}' (${e.details.moduleName})`:`Object '${e.details.name}' (${e.details.moduleName})`;case 5:return`Function '${e.details.name}' (${e.details.moduleName})`;case 8:return`Module '${e.moduleName}' (${e.moduleName})`;case 4:return`Never ${t(null===(i=e.typeAliasInfo)||void 0===i?void 0:i.fullName)}`;case 3:return`None ${t(null===(r=e.typeAliasInfo)||void 0===r?void 0:r.fullName)}`;case 6:return`OverloadedFunction [${e.overloads.map((e=>t(o(e),'"'))).join(",")}]`;case 10:return`TypeVar '${e.details.name}' ${t(null===(s=e.typeAliasInfo)||void 0===s?void 0:s.fullName)}`;case 0:return`Unbound ${t(null===(a=e.typeAliasInfo)||void 0===a?void 0:a.fullName)}`;case 9:return`Union [${e.subtypes.map((e=>t(o(e),'"'))).join(",")}]`;case 1:return`Unknown ${t(null===(l=e.typeAliasInfo)||void 0===l?void 0:l.fullName)}`;default:k(e)}return""}function a(e){if(e)switch(e.type){case 6:return`Alias, ${l(e.node)} (${i(e.path)})`;case 4:return`Class, ${l(e.node)} (${i(e.path)})`;case 3:return`Function, ${l(e.node)} (${i(e.path)})`;case 0:return`Intrinsic, ${l(e.node)} ${e.intrinsicType} (${i(e.path)})`;case 2:return`Parameter, ${l(e.node)} (${i(e.path)})`;case 5:return`SpecialBuiltInClass, ${l(e.node)} (${i(e.path)})`;case 1:return`Variable, ${l(e.node)} (${i(e.path)})`;default:k(e)}return""}function l(e,n=!1){var r;if(!e)return"";const s=n?`(${i(null===(r=function(e){for(;36!==e.nodeType&&e.parent;)e=e.parent;return 36===e.nodeType?Vt(e):void 0}(e))||void 0===r?void 0:r.filePath)})`:"";if(yr(e))return t(function(e,t=30){return e.length<t?e:e.substring(0,t)+" <shortened> "}(xr(e)),'"')+` ${s}`;switch(e.nodeType){case 21:return`importAs '${l(e.module)}' ${t(e.alias?l(e.alias):"")} ${s}`;case 22:return`importFrom [${e.imports.map((e=>t(l(e),'"'))).join(",")}]`;case 23:return`ImportFromAs '${l(e.name)}' ${t(e.alias?l(e.alias):"")} ${s}`;case 36:return`module ${s}`;case 10:return`class '${l(e.name)}' ${s}`;case 28:return`function '${l(e.name)}' ${s}`;case 37:return`moduleName '${e.nameParts.map((e=>l(e))).join(".")}' ${s}`;case 1:return`argument '${e.name?l(e.name):"N/A"}' ${s}`;case 41:return`parameter '${e.name?l(e.name):"N/A"}' ${s}`;default:return`${function(e){switch(e){case 0:return"Error";case 1:return"Argument";case 2:return"Assert";case 3:return"Assignment";case 4:return"AssignmentExpression";case 5:return"AugmentedAssignment";case 6:return"Await";case 7:return"BinaryOperation";case 8:return"Break";case 9:return"Call";case 10:return"Class";case 11:return"Constant";case 12:return"Continue";case 13:return"Decorator";case 14:return"Del";case 15:return"Dictionary";case 16:return"DictionaryExpandEntry";case 17:return"DictionaryKeyEntry";case 18:return"Ellipsis";case 19:return"If";case 20:return"Import";case 21:return"ImportAs";case 22:return"ImportFrom";case 23:return"ImportFromAs";case 24:return"Index";case 25:return"Except";case 26:return"For";case 27:return"FormatString";case 28:return"Function";case 29:return"Global";case 30:return"Lambda";case 31:return"List";case 32:return"ListComprehension";case 33:return"ListComprehensionFor";case 34:return"ListComprehensionIf";case 35:return"MemberAccess";case 36:return"Module";case 37:return"ModuleName";case 38:return"Name";case 39:return"Nonlocal";case 40:return"Number";case 41:return"Parameter";case 42:return"Pass";case 43:return"Raise";case 44:return"Return";case 45:return"Set";case 46:return"Slice";case 47:return"StatementList";case 48:return"StringList";case 49:return"String";case 50:return"Suite";case 51:return"Ternary";case 52:return"Tuple";case 53:return"Try";case 54:return"TypeAnnotation";case 55:return"UnaryOperation";case 56:return"Unpack";case 57:return"While";case 58:return"With";case 59:return"WithItem";case 60:return"Yield";case 61:return"YieldFrom";case 62:return"FunctionAnnotation";case 63:return"Match";case 64:return"Case";case 65:return"PatternSequence";case 66:return"PatternAs";case 67:return"PatternLiteral";case 68:return"PatternClass";case 69:return"PatternCapture";case 70:return"PatternMapping";case 71:return"PatternMappingKeyEntry";case 72:return"PatternMappingExpandEntry";case 73:return"PatternValue";case 74:return"PatternClassArgument"}k(e)}(e.nodeType)} ${s}`}}return{print:function(e){return e?function(e){return e&&s(e.nodeType)}(e)?l(e,!0):function(e){const t=e;return t&&s(t.type)&&r(t.path)&&r(t.moduleName)}(e)?a(e):e instanceof qo?(t=e)?t.hasDeclarations()?`symbol ${a(t.getDeclarations()[0])}`:"<symbol>":"":function(e){const t=e;return t&&s(t.category)&&s(t.flags)}(e)?o(e):void k(e):"";var t},printFileOrModuleName:i}}function Nu(e){return!!e.isIncompleteType}class Mu{constructor(){this._speculativeContextStack=[],this._speculativeTypeCache=new Map}enterSpeculativeContext(e,t){this._speculativeContextStack.push({speculativeRootNode:e,entriesToUndo:[],allowCacheRetention:t})}leaveSpeculativeContext(){w(this._speculativeContextStack.length>0),this._speculativeContextStack.pop().entriesToUndo.forEach((e=>{e.cache.delete(e.id)}))}isSpeculative(e){if(0===this._speculativeContextStack.length)return!1;if(!e)return!0;for(let t=this._speculativeContextStack.length-1;t>=0;t--)if(Mr(e,this._speculativeContextStack[t].speculativeRootNode))return!0;return!1}trackEntry(e,t){const n=this._speculativeContextStack.length;n>0&&this._speculativeContextStack[n-1].entriesToUndo.push({cache:e,id:t})}disableSpeculativeMode(){const e=this._speculativeContextStack;return this._speculativeContextStack=[],e}enableSpeculativeMode(e){w(0===this._speculativeContextStack.length),this._speculativeContextStack=e}addSpeculativeType(e,t,n){if(w(this._speculativeContextStack.length>0),this._speculativeContextStack.some((e=>!e.allowCacheRetention)))return;let i=this._speculativeTypeCache.get(e.id);i||(i=[],this._speculativeTypeCache.set(e.id,i)),i.push({type:t,expectedType:n})}getSpeculativeType(e,t){if(this._speculativeContextStack.some((t=>Mr(e,t.speculativeRootNode)))){const n=this._speculativeTypeCache.get(e.id);if(n)for(const e of n)if(t){if(e.expectedType&&Ao(t,e.expectedType))return e.type}else if(!e.expectedType)return e.type}}}class Ou{constructor(){this._trackerStack=[],this._isUndoTrackingEnabled=!1}trackEntry(e,t){this._isUndoTrackingEnabled&&this._trackerStack[this._trackerStack.length-1].push({cache:e,id:t})}enterTrackingScope(){this._trackerStack.push([])}exitTrackingScope(){this._trackerStack.pop().forEach((e=>{e.cache.delete(e.id)})),0===this._trackerStack.length&&(this._isUndoTrackingEnabled=!1)}enableUndoTracking(){this._trackerStack.length>0&&(this._isUndoTrackingEnabled=!0)}isUndoTrackingEnabled(){return this._isUndoTrackingEnabled}}function Lu(e,t,n,i){var r,s,o;const a=Vt(t);let l="namedtuple";if(0===n.length)e.addError(ml.Diagnostic.namedTupleFirstArg(),t);else{const i=n[0];0!==i.argumentCategory?e.addError(ml.Diagnostic.namedTupleFirstArg(),n[0].valueExpression||t):i.valueExpression&&48===i.valueExpression.nodeType&&(l=i.valueExpression.strings.map((e=>e.value)).join(""))}const c=n.find((e=>{var t;return"defaults"===(null===(t=e.name)||void 0===t?void 0:t.value)}));let u=0;if(c&&c.valueExpression){const t=e.getTypeOfExpression(c.valueExpression).type;u=vo(t)&&pa(t)&&!da(t)&&t.tupleTypeArguments?t.tupleTypeArguments.length:void 0}const p=e.getTypingType(t,"NamedTuple")||Ys.create(),d=Zs.createInstantiable(l,br(t,a.moduleName,l),a.moduleName,a.filePath,16777216,Ir(t),void 0,_o(p)?p.details.effectiveMetaclass:Ys.create());d.details.baseClasses.push(p),d.details.typeVarScopeId=e.getScopeIdForNode(t);const h=d.details.fields;h.set("__class__",qo.createWithType(68,d));const m=Aa(d,!0),f=Xs.createInstance("__new__","","",65);f.details.declaredReturnType=Fa(m),function(e){var t,n;if(9!==e.nodeType||!e.parent||3!==e.parent.nodeType||38!==e.parent.leftExpression.nodeType||!e.parent.parent||47!==e.parent.parent.nodeType)return!1;const i=e.parent.leftExpression.value,r=e.parent.parent;if(r.statements[0]!==e.parent||!r.parent||36!==r.parent.nodeType&&50!==r.parent.nodeType)return!1;const s=r.parent;let o=s.statements.findIndex((e=>e===r));if(o<0)return!1;for(o++;o<s.statements.length;){const e=s.statements[o];if(47!==e.nodeType)break;if(48!==(null===(t=e.statements[0])||void 0===t?void 0:t.nodeType)){if(3===(null===(n=e.statements[0])||void 0===n?void 0:n.nodeType)){const t=e.statements[0];if(35===t.leftExpression.nodeType&&"__defaults__"===t.leftExpression.memberName.value){const e=t.leftExpression.leftExpression;if(35===e.nodeType&&"__new__"===e.memberName.value&&38===e.leftExpression.nodeType&&e.leftExpression.value===i)return!0}}break}o++}return!1}(t)&&(f.details.flags|=32),Xs.addParameter(f,{category:0,name:"cls",type:m,hasDeclaredType:!0});const g=[],y={category:0,name:"self",type:Aa(d,!1),hasDeclaredType:!0};let _=!1;const v=[];if(n.length<2)e.addError(ml.Diagnostic.namedTupleSecondArg(),t),_=!0;else{const t=n[1];if(0!==t.argumentCategory)_=!0;else if(!i&&t.valueExpression&&48===t.valueExpression.nodeType){const e=t.valueExpression.strings.map((e=>e.value)).join("").split(/[,\s]+/),n=void 0===u?0:Math.max(0,e.length-u);e.forEach(((e,r)=>{if(e=e.trim()){const s=Ys.create(),o={category:0,name:e,type:s,hasDeclaredType:i,hasDefault:r>=n};Xs.addParameter(f,o);const l=qo.createWithType(8,s);g.push(e);const c=t.valueExpression,u={type:1,node:c,isRuntimeTypeExpression:!0,path:a.filePath,range:St(c.start,dt.getEnd(c),a.lines),moduleName:a.moduleName,isInExceptSuite:!1};l.addDeclaration(u),h.set(e,l),v.push(s)}}))}else if(31===(null===(r=t.valueExpression)||void 0===r?void 0:r.nodeType)||52===(null===(s=t.valueExpression)||void 0===s?void 0:s.nodeType)){const n=t.valueExpression,r=new Map,s=31===(null===(o=t.valueExpression)||void 0===o?void 0:o.nodeType)?t.valueExpression.entries:t.valueExpression.expressions,l=void 0===u?0:Math.max(0,s.length-u);s.forEach(((t,n)=>{let s,o,c,u="";i?52===t.nodeType&&2===t.expressions.length?(c=t.expressions[0],s=t.expressions[1],o=Fa(e.getTypeForExpressionExpectingType(s,!1).type)):e.addError(ml.Diagnostic.namedTupleNameType(),t):(c=t,o=Ys.create()),c&&48===c.nodeType?(u=c.strings.map((e=>e.value)).join(""),u||e.addError(ml.Diagnostic.namedTupleEmptyName(),c)):_=!0,u||(u=`_${n.toString()}`),r.has(u)&&e.addError(ml.Diagnostic.namedTupleNameUnique(),c||t),r.set(u,u),o||(o=Ys.create());const p={category:0,name:u,type:o,hasDeclaredType:i,hasDefault:n>=l};Xs.addParameter(f,p),v.push(o),g.push(u);const d=qo.createWithType(8,o);if(c&&48===c.nodeType){const e={type:1,node:c,path:a.filePath,typeAnnotationNode:s,range:St(c.start,dt.getEnd(c),a.lines),moduleName:a.moduleName,isInExceptSuite:!1};d.addDeclaration(e)}h.set(u,d)})),e.setTypeForNode(n)}else _=!0}_&&(f.details.parameters=[],Xs.addDefaultParameters(f),v.push(io.create(!1)),v.push(io.create(!0)));const T=Xs.createInstance("__init__","","",192);Xs.addParameter(T,y),Xs.addDefaultParameters(T),T.details.declaredReturnType=to.createInstance(),h.set("__new__",qo.createWithType(4,f)),h.set("__init__",qo.createWithType(4,T));const b=Xs.createInstance("keys","","",64),I=Xs.createInstance("items","","",64);b.details.declaredReturnType=e.getBuiltInObject(t,"list",[e.getBuiltInObject(t,"str")]),I.details.declaredReturnType=b.details.declaredReturnType,h.set("keys",qo.createWithType(8,b)),h.set("items",qo.createWithType(8,I));const S=Xs.createInstance("__len__","","",64);if(S.details.declaredReturnType=e.getBuiltInObject(t,"int"),Xs.addParameter(S,y),h.set("__len__",qo.createWithType(4,S)),_){const n=Xs.createInstance("__getattribute__","","",64);n.details.declaredReturnType=io.create(),Xs.addParameter(n,y),Xs.addParameter(n,{category:0,name:"name",type:e.getBuiltInObject(t,"str")}),h.set("__getattribute__",qo.createWithType(4,n))}const x=e.getBuiltInType(t,"tuple"),C=e.getBuiltInType(t,"str");if(!_&&C&&_o(C)&&x&&_o(x)){const e=g.map((e=>({type:Zs.cloneAsInstance(Zs.cloneWithLiteral(C,e)),isUnbounded:!1}))),t=Zs.cloneAsInstance(Va(x,e));h.set("__match_args__",qo.createWithType(4,t))}return Ha(d),Uu(d,v,!_),d}function Uu(e,t,n){const i=e.details.mro.findIndex((e=>_o(e)&&Zs.isBuiltIn(e,"NamedTuple")));if(i<0||e.details.mro.length<i+2)return;const r=e.details.mro[i],s=e.details.mro[i+1];if(!_o(s)||!pa(s))return;const o=[];n?t.forEach((e=>{o.push({type:e,isUnbounded:!1})})):o.push({type:t.length>0?Oo(t):Ys.create(),isUnbounded:!0});const a=Va(s,o,n),l=Zs.cloneForSpecialization(r,[],n);l.details={...l.details},l.details.mro=[...l.details.mro],l.details.mro[1]=a.details.mro[0],l.details.baseClasses=l.details.baseClasses.map((e=>_o(e)&&pa(e)?a:e)),e.details.mro[i]=l,e.details.mro[i+1]=a,e.details.baseClasses=e.details.baseClasses.map((e=>_o(e)&&Zs.isBuiltIn(e,"NamedTuple")?l:e))}function qu(e,t){const n={keywordOnlyParams:!1,generateEq:!0,generateOrder:!1,transformDescriptorTypes:!1,fieldDescriptorNames:[]},i=Vt(t);return t.arguments.forEach((t=>{if(t.name&&0===t.argumentCategory)switch(t.name.value){case"kw_only_default":{const r=Xc(t.valueExpression,i.executionEnvironment);if(void 0===r)return void e.addError(ml.Diagnostic.dataClassTransformExpectedBoolLiteral(),t.valueExpression);n.keywordOnlyParams=r;break}case"eq_default":{const r=Xc(t.valueExpression,i.executionEnvironment);if(void 0===r)return void e.addError(ml.Diagnostic.dataClassTransformExpectedBoolLiteral(),t.valueExpression);n.generateEq=r;break}case"order_default":{const r=Xc(t.valueExpression,i.executionEnvironment);if(void 0===r)return void e.addError(ml.Diagnostic.dataClassTransformExpectedBoolLiteral(),t.valueExpression);n.generateOrder=r;break}case"transform_descriptor_types":{const r=Xc(t.valueExpression,i.executionEnvironment);if(void 0===r)return void e.addError(ml.Diagnostic.dataClassTransformExpectedBoolLiteral(),t.valueExpression);n.transformDescriptorTypes=r;break}case"field_descriptors":{const i=e.getTypeOfExpression(t.valueExpression).type;if(!vo(i)||!Zs.isBuiltIn(i,"tuple")||!i.tupleTypeArguments||i.tupleTypeArguments.some((e=>!_o(e.type)&&!Eo(e.type)&&!ko(e.type))))return void e.addError(ml.Diagnostic.dataClassTransformFieldDescriptor().format({type:e.printType(i)}),t.valueExpression);n.fieldDescriptorNames||(n.fieldDescriptorNames=[]),i.tupleTypeArguments.forEach((e=>{_o(e.type)||Eo(e.type)?n.fieldDescriptorNames.push(e.type.details.fullName):ko(e.type)&&n.fieldDescriptorNames.push(e.type.overloads[0].details.fullName)}));break}default:e.addError(ml.Diagnostic.dataClassTransformUnknownArgument().format({name:t.name.value}),t.valueExpression)}else e.addError(ml.Diagnostic.dataClassTransformPositionalParam(),t)})),n}function Vu(e){let t;if(Eo(e)?t=e:ko(e)&&(t=e.overloads[0]),t)return t.details.decoratorDataClassBehaviors?t.details.decoratorDataClassBehaviors:"dataclasses.dataclass"===t.details.fullName?{keywordOnlyParams:!1,generateEq:!0,generateOrder:!1,transformDescriptorTypes:!1,fieldDescriptorNames:["dataclasses.field","dataclasses.Field"]}:void 0}function Bu(e,t,n){n.forEach((n=>{n.valueExpression&&n.name&&function(e,t,n,i,r){const s=Vt(t),o=Xc(r,s.executionEnvironment);switch(i){case"order":!0===o?n.details.flags|=64:!1===o&&(n.details.flags&=-65);break;case"kw_only":!1===o?n.details.flags&=-2097153:!0===o&&(n.details.flags|=2097152);break;case"frozen":{let i=!1,r=!1;n.details.baseClasses.forEach((e=>{_o(e)&&Zs.isDataClass(e)&&(Zs.isFrozenDataClass(e)?r=!0:e.details.classDataClassTransform||e.details.declaredMetaclass&&_o(e.details.declaredMetaclass)&&e.details.declaredMetaclass.details.classDataClassTransform||(i=!0))})),(!0===o||r)&&(n.details.flags|=8,i&&e.addDiagnostic(s.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.dataClassBaseClassNotFrozen(),t));break}case"init":!1===o?n.details.flags|=16:!0===o&&(n.details.flags&=-17);break;case"eq":!1===o?n.details.flags|=32:!0===o&&(n.details.flags&=-33);break;case"slots":!0===o?(n.details.flags|=33554432,n.details.localSlotsNames&&e.addDiagnostic(s.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.dataClassSlotsOverwrite(),t)):!1===o&&(n.details.flags&=-33554433);break;case"hash":case"unsafe_hash":!0===o&&(n.details.flags|=67108864)}}(e,n.name,t,n.name.value,n.valueExpression)}))}function Wu(e,t){e.details.dataClassBehaviors=t,e.details.flags|=4,t.keywordOnlyParams&&(e.details.flags|=2097152),t.generateEq||(e.details.flags|=32),t.generateOrder&&(e.details.flags|=64)}function ju(e,t,n,i){Wu(t,n),(null==i?void 0:i.arguments)&&Bu(e,t,i.arguments)}function zu(e,t,n,i,r){return Eo(i)&&"functools.total_ordering"===i.details.fullName?function(e,t,n,i){if(1!==n.length)return i;const r=n[0].type;if(!r||!_o(r)||r.includeSubclasses)return i;const s=["__lt__","__le__","__gt__","__ge__"],o=Zs.cloneAsInstance(r),a=s.filter((e=>!_a(o,e,8)));if(a.length===s.length)return e.addDiagnostic(Vt(t).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.totalOrderingMissingMethod(),t),i;const l=e.getBuiltInObject(t,"object");if(!l||!vo(l))return i;const c=e.getBuiltInObject(t,"bool");if(!c||!vo(c))return i;const u={category:0,name:"self",type:Aa(r,!1),hasDeclaredType:!0},p={category:0,name:"__value",type:l,hasDeclaredType:!0};return a.forEach((e=>{const t=Xs.createInstance(e,"","",64);Xs.addParameter(t,u),Xs.addParameter(t,p),t.details.declaredReturnType=c,r.details.fields.set(e,qo.createWithType(4,t))})),i}(e,t,n,r):r}function $u(e,t,n){Xs.isStaticMethod(t)&&e.addDiagnostic(Vt(n).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.propertyStaticMethod(),n)}function Hu(e,t,n,i){const r=Vt(t),s=e.getBuiltInType(t,"type"),o=Zs.isBuiltIn(n,"property")?Ir(t):n.details.typeSourceId,a=Zs.createInstantiable(n.details.name,br(t,r.moduleName,`__property_${i.details.name}`),r.moduleName,r.filePath,2048,o,void 0,_o(s)?s:Ys.create());a.details.typeVarScopeId=n.details.typeVarScopeId,Ha(a);const l=a.details.fields;n.details.fields.forEach(((e,t)=>{e.isIgnoredForProtocolMatch()||["__get__","__set__","__delete__","fget","fset","fdel"].some((e=>e===t))||l.set(t,e)}));const c=Zs.cloneAsInstance(a);a.isAsymmetricDescriptor=!1;const u=qo.createWithType(4,i);l.set("fget",u),Xs.isClassMethod(i)&&(a.details.flags|=4194304);const p=Xs.createInstance("__get__","","",320);Xs.addParameter(p,{category:0,name:"self",type:c,hasDeclaredType:!0}),Xs.addParameter(p,{category:0,name:"obj",type:to.createInstance(),hasDeclaredType:!0}),Xs.addParameter(p,{category:0,name:"objtype",type:io.create(),hasDeclaredType:!0,hasDefault:!0,defaultType:io.create()}),p.details.declaredReturnType=Xs.isClassMethod(i)?Xs.getSpecializedReturnType(i):c,p.details.declaration=i.details.declaration;const d=Xs.createInstance("__get__","","",320);Xs.addParameter(d,{category:0,name:"self",type:c,hasDeclaredType:!0});const h=i.details.parameters.length>0?i.details.parameters[0].type:io.create();Xs.addParameter(d,{category:0,name:"obj",type:h,hasDeclaredType:!0}),Xs.addParameter(d,{category:0,name:"objtype",type:io.create(),hasDeclaredType:!0,hasDefault:!0,defaultType:io.create()}),d.details.declaredReturnType=Xs.getSpecializedReturnType(i),d.details.declaration=i.details.declaration,d.details.typeVarScopeId=na(i);const m=eo.create([p,d]),f=qo.createWithType(4,m);return l.set("__get__",f),["getter","setter","deleter"].forEach((e=>{const t=Xs.createInstance(e,"","",64);Xs.addParameter(t,{category:0,name:"self",type:io.create(),hasDeclaredType:!0}),Xs.addParameter(t,{category:0,name:"accessor",type:io.create(),hasDeclaredType:!0}),t.details.declaredReturnType=c;const n=qo.createWithType(4,t);l.set(e,n)})),c}function Gu(e,t,n,i,r,s,o=0){const a=Zs.cloneAsInstance(i);let l=!0;return[{name:"fget",missingDiagMsg:ml.DiagnosticAddendum.missingGetter,incompatibleDiagMsg:ml.DiagnosticAddendum.incompatibleGetter},{name:"fset",missingDiagMsg:ml.DiagnosticAddendum.missingSetter,incompatibleDiagMsg:ml.DiagnosticAddendum.incompatibleSetter},{name:"fdel",missingDiagMsg:ml.DiagnosticAddendum.missingDeleter,incompatibleDiagMsg:ml.DiagnosticAddendum.incompatibleDeleter}].forEach((i=>{const c=t.details.fields.get(i.name),u=c?e.getDeclaredTypeOfSymbol(c):void 0;if(u&&Eo(u)){const t=n.details.fields.get(i.name),c=t?e.getDeclaredTypeOfSymbol(t):void 0;if(!c||!Eo(c))return r&&r.addMessage(i.missingDiagMsg()),void(l=!1);const p=e.bindFunctionToClassOrObject(a,u,void 0,void 0,o),d=e.bindFunctionToClassOrObject(a,c,void 0,void 0,o);if(!p||!d||!e.canAssignType(p,d,null==r?void 0:r.createAddendum(),s,0,o))return r&&r.addMessage("getter type is incompatible"),void(l=!1)}})),l}const Ku={0:["__add__","__radd__",!1],33:["__sub__","__rsub__",!1],26:["__mul__","__rmul__",!1],13:["__floordiv__","__rfloordiv__",!1],10:["__truediv__","__rtruediv__",!1],24:["__mod__","__rmod__",!1],29:["__pow__","__rpow__",!1],22:["__matmul__","__rmatmul__",!1],3:["__and__","__rand__",!1],6:["__or__","__ror__",!1],8:["__xor__","__rxor__",!1],17:["__lshift__","__rlshift__",!1],31:["__rshift__","__rrshift__",!1],12:["__eq__","__ne__",!0],28:["__ne__","__eq__",!0],20:["__lt__","__ge__",!0],21:["__le__","__gt__",!0],15:["__gt__","__le__",!0],16:["__ge__","__lt__",!0]},Ju={36:!1,37:!1,39:!0,40:!0,41:!0,42:!0},Yu=new Map([["asyncio.futures.Future",De.V3_9],["asyncio.tasks.Task",De.V3_9],["builtins.dict",De.V3_9],["builtins.frozenset",De.V3_9],["builtins.list",De.V3_9],["builtins._PathLike",De.V3_9],["builtins.set",De.V3_9],["builtins.tuple",De.V3_9],["collections.ChainMap",De.V3_9],["collections.Counter",De.V3_9],["collections.defaultdict",De.V3_9],["collections.DefaultDict",De.V3_9],["collections.deque",De.V3_9],["collections.OrderedDict",De.V3_9],["queue.Queue",De.V3_9]]),Qu=new Map([["builtins.float",["builtins.int"]],["builtins.complex",["builtins.float","builtins.int"]],["builtins.bytes",["builtins.bytearray","builtins.memoryview"]]]);function Zu(e,t){const n=[],i=new Map,r=new Map,s=new Map,o=new Map,a=new Set,l=new Map,c=new Mu,u=new Map,p=[],d=new Ou,h=[];let m,f,g,y,_,v,T,b,I,S,x,C,k=!1;const D=[];let A;function P(){m&&ct(m)}function R(e){let t;return t=A&&L(e)?A.get(e.id):s.get(e.id),void 0!==t}function F(e,n){let i;if(i=A&&L(e)?A.get(e.id):s.get(e.id),void 0!==i){if(t.verifyTypeCacheEvaluatorFlags&&void 0!==n){const t=o.get(e.id);void 0!==t&&n!==t&&E(`Type cache flag mismatch for node type ${e.nodeType}: cached flags = ${t}, access flags = ${n}`)}return w(!Nu(i)),i}}function N(e,n,i,r,a,l=!1){if(r)return void(C&&C.set(e.id,n));const u=A&&L(e)?A:s;u.set(e.id,n),t.verifyTypeCacheEvaluatorFlags&&u===s&&void 0!==i&&o.set(e.id,i),c.isSpeculative(e)&&(c.trackEntry(u,e.id),l&&c.addSpeculativeType(e,n,a)),d.trackEntry(u,e.id)}function M(e){(A&&L(e)?A:s).delete(e.id)}function O(e,t=Ys.create(),n=0){N(e,t,n,!1)}function L(e){const t=D.length;if(0===t)return!1;const n=D[t-1];let i=e;for(;i;){if(i===n.functionNode)return!0;i=i.parent}return!1}function U(e,t){return n.findIndex((n=>n.symbolId===e.id&&n.declaration===t))}function q(e,t){const i=U(e,t);if(i>=0){for(let e=i+1;e<n.length;e++)n[e].isResultValid=!1;return!1}return n.push({symbolId:e.id,declaration:t,isResultValid:!0}),!0}function V(e){const t=n.pop();return w(t.symbolId===e.id),t.isResultValid}function B(e,t,i){const r=U(e,t);r>=0&&(n[r].partialType=i)}function W(e,t){const i=U(e,t);if(i>=0)return n[i].partialType}function j(e){var t;return null===(t=gn(e,(()=>{hn(e)})))||void 0===t?void 0:t.type}function z(e){k||(k=!0,y=Cn(e,"object"),_=xn(e,"type"),v=Cn(e,"function"),ce(e,"Collection"),f=function(e,t){return ue(e,"NoneType",["_typeshed"])}(e)||io.create(),T=xn(e,"tuple"),b=xn(e,"bool"),I=xn(e,"str"),S=xn(e,"dict"),x=ce(e,"_TypedDict"))}function $(e,n,i=0){var r;const s=F(e,i);if(s)return{type:s,node:e};{const t=c.getSpeculativeType(e,n);if(t)return{type:t,node:e}}P();const o=ta(n);let a;z(e);let u=0!=(64&i);switch(e.nodeType){case 38:a=function(e,n){const i=Vt(e),r=e.value;let s,o=!1;const a=0!=(4&n)||i.isStubFile;if(!t.analyzeUnannotatedFunctions){const t=kr(e);if(t&&function(e){return void 0===e.returnTypeAnnotation&&e.parameters.every((e=>void 0===e.typeAnnotation&&void 0===e.typeAnnotationComment))}(t))return{node:e,type:io.create(),isIncomplete:!1}}const l=wn(e,r,!a,a&&0!=(1024&n));if(l){let t=!a;4===l.scope.type&&(t=!1);const c=l.symbol,u=Mn(c,t?e:void 0),p=ta(u.type);u.isIncomplete&&(o=!0),u.isRecursiveDefinition&&pe(e)&&_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.recursiveDefinition().format({name:r}),e);const d=!!p&&_o(p)&&Zs.isSpecialBuiltIn(p);if(s=p,t&&!d){const t=l.isBeyondExecutionScope||!c.isInitiallyUnbound()?p:Js.create(),n=_n(e,c.id,t,!1);if(n.type&&(s=n.type),n.isIncomplete&&(o=!0),!n.type&&l.isBeyondExecutionScope){const t=function(e,t,n){if(!t.symbol.getDeclarations().every((e=>1===e.type||2===e.type)))return;const i=function(e,t){const n=[];let i=e;for(;i;){const e=zs(i);if(!e)return;if(0!==n.length&&n[n.length-1]===e||n.push(e),e===t)return n;i=i.parent}return t?void 0:n}(e,t.scope);if(i&&i.length>=2&&i.every((e=>1===e.type||3===e.type))){const r=function(e,t){let n,i=e,r=!1;for(;i;){if(Ft(i)===t)r=!0;else if(r)return n;n=i,i=i.parent}}(e,i[i.length-2]);if(r&&(28===r.nodeType||30===r.nodeType)){const i=Lt(r);if(i&&t.symbol.getDeclarations().every((e=>{if(2===e.type)return!0;const t=Lt(e.node);return!(!t||t!==i&&ci.isFlowNodeReachable(t,i))})))return _n(e,t.symbol.id,n,!1,r)}}}(e,l,p);(null==t?void 0:t.type)&&(s=t.type),(null==t?void 0:t.isIncomplete)&&(o=!0)}}s=Ae(e,s,n),we(i,c,e),0!=(1024&n)&&u.includesVariableDecl&&!s.typeAliasInfo&&(ea(s)||bo(s)||po(s)||i.isTypingStubFile||Ks.isInstantiable(s)&&0==(2&n)||(_e(i.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeAnnotationVariable(),e),s=Ys.create()))}else{if("true"===r||"false"===r){const t=r.split("");t[0]=t[0].toUpperCase();const n=t.join("");_e(i.diagnosticRuleSet.reportUndefinedVariable,$o.reportUndefinedVariable,ml.Diagnostic.booleanIsLowerCase().format({name:r,booleanName:n}),e)}else"reveal_type"!==r&&"reveal_locals"!==r&&_e(i.diagnosticRuleSet.reportUndefinedVariable,$o.reportUndefinedVariable,ml.Diagnostic.symbolIsUndefined().format({name:r}),e);s=Ys.create()}if(wo(s)&&32&n&&(fe(ml.Diagnostic.paramSpecContext(),e),s=Ys.create()),bo(s)&&0==(64&n)&&s.details.name===r){const t=s.details.isVariadic?ce(e,"TypeVarTuple"):ce(e,"TypeVar");s=t&&_o(t)?Zs.cloneAsInstance(t):Ys.create()}return 0!=(64&n)&&0==(512&n)&&_o(s)&&Zs.isBuiltIn(s,"Generic")&&_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.genericNotAllowed(),e),bo(s)&&!s.details.isSynthesized&&(s=ke(e,s,n)),{type:s,node:e,isIncomplete:o}}(e,i);break;case 35:a=function(e,t){const n=2|572484&t,i=$(e.leftExpression,void 0,n);if(ea(i.type))return{node:e,type:Ys.create(),isIncomplete:!0};const r=Fe(e,i,{method:"get"},t);if(Dt(e)){N(e,r.type,t,!0),N(e.memberName,r.type,t,!0);let n=r.type,s=!!r.isIncomplete;if(mo(n)){const t=Ie(i.type);let r;_o(t)?r=va(t,e.memberName.value,1):vo(t)&&(r=_a(t,e.memberName.value,1)),r&&(n=Bn(r),s=!1)}const o=_n(e,0,n,s);o.type&&(r.type=o.type),o.isIncomplete&&(r.isIncomplete=!0),r.type=Ae(e,r.type,t),M(e),M(e.memberName)}return i.isIncomplete&&(r.isIncomplete=!0),r}(e,i),ea(a.type)||N(e.memberName,a.type,i,!!a.isIncomplete);break;case 24:a=function(e,t=0){const n=$(e.baseExpression,void 0,2|t);if(64&t&&48===e.baseExpression.nodeType){const t=Vt(e);!t.isStubFile&&t.executionEnvironment.pythonVersion<De.V3_10&&fe(ml.Diagnostic.stringNotSubscriptable(),e.baseExpression)}if(0==(4&t)){let i=0!=(32768&t);if(i){const t=Rr(e);36===(null==t?void 0:t.nodeType)&&(i=!1)}if(!i){const t=Vt(e);if(_o(n.type)&&Zs.isBuiltIn(n.type)&&!n.type.aliasName){const i=Yu.get(n.type.details.fullName);void 0!==i&&t.executionEnvironment.pythonVersion<i&&!t.isStubFile&&fe(ml.Diagnostic.classNotRuntimeSubscriptable().format({name:n.type.aliasName||n.type.details.name}),e.baseExpression)}}}const i=Le(e,n.type,{method:"get"},t);if(Dt(e)){let r=!0;if(Se(n.type,void 0,(e=>{vo(e)&&(Zs.isBuiltIn(e)||Zs.isTypedDictClass(e))||(r=!1)})),r){N(e,i.type,t,!1);const r=_n(e,0,i.type,!!n.isIncomplete||!!i.isIncomplete);r.type&&(i.type=r.type),r.isIncomplete&&(i.isIncomplete=!0),M(e)}}return n.isIncomplete&&(i.isIncomplete=!0),0!=(1048576&t)&&_o(n.type)&&(Zs.isBuiltIn(n.type,"Required")?i.isRequired=!0:Zs.isBuiltIn(n.type,"NotRequired")&&(i.isNotRequired=!0)),i}(e,i);break;case 9:0!=(1024&i)?(ze(e,o),_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeAnnotationCall(),e),a={node:e,type:Ys.create()}):a=ze(e,o);break;case 52:a=function(e,t,n){if(0!=(64&n)&&0===e.expressions.length&&!t)return{type:Ue([]),node:e,isEmptyTupleShorthand:!0};let i=t,r=t&&uo(t);if(t&&fo(t)){let n;Jo(t,(t=>{if(uo(t)&&(r=!0),!n){const i=kn(e,(()=>We(e,t)));i&&Jn(t,i.type)&&(n=t)}})),i=n}if(i){const t=We(e,i);if(t)return t}const s=function(e){const t=e.expressions.map((e=>$(e))),n=t.some((e=>e.isIncomplete));return T&&_o(T)?{type:Fa(Va(T,je(t))),node:e,isIncomplete:n}:{type:Ys.create(),node:e}}(e);return r&&(s.type=io.create()),s}(e,o,i);break;case 11:a=function(e,t){let n;if(26===e.constType?n=0!=(64&t)?to.createType():to.createInstance():33!==e.constType&&15!==e.constType&&9!==e.constType||(n=Cn(e,"bool"),n&&vo(n)&&(33===e.constType?n=Zs.cloneWithLiteral(n,!0):15===e.constType&&(n=Zs.cloneWithLiteral(n,!1)))),n)return{type:n,node:e}}(e,i);break;case 48:if(0==(8&i)||function(e){if(e.parent&&24===e.parent.nodeType){const t=$(e.parent.baseExpression).type;if(t&&_o(t)&&Zs.isSpecialBuiltIn(t,"Literal"))return!0}return!1}(e)){e.strings.forEach((e=>{27===e.nodeType&&e.expressions.forEach((e=>{$(e)}))}));const t=0!=(32&e.strings[0].token.flags);a=e.strings.some((e=>27===e.nodeType))?{node:e,type:Cn(e,t?"bytes":"str")}:{node:e,type:kt(e,t?"bytes":"str",e.strings.map((e=>e.value)).join(""))}}else{let t=68|i;if(0==(4194304&i)&&(t|=524288),e.typeAnnotation)a=$(e.typeAnnotation,void 0,t);else if(!e.typeAnnotation&&1===e.strings.length){const n=function(e){const t=Vt(e),n=new Qc,i=e.strings[0].value,r=e.strings[0].start+e.strings[0].token.prefixLength+e.strings[0].token.quoteMarkLength,s=new Jc;s.isStubFile=t.isStubFile,s.pythonVersion=t.executionEnvironment.pythonVersion;const o=n.parseTextExpression(t.fileContents,r,i.length,s,void 0,void 0,t.typingSymbolAliases);if(o.parseTree)return o.diagnostics.forEach((t=>{fe(t.message,e)})),o.parseTree.parent=e,o.parseTree}(e);n&&(a=$(n,void 0,t))}a||(_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.expectedTypeNotString(),e),a={node:e,type:Ys.create()}),u=!1}break;case 40:a=e.isImaginary?{node:e,type:Cn(e,"complex")}:e.isInteger?{node:e,type:kt(e,"int",e.value)}:{node:e,type:Cn(e,"float")};break;case 18:a=0!=(1&i)?{type:io.create(!0),node:e}:0!=(256&i)?{type:Ys.create(),node:e}:{type:Cn(e,"ellipsis")||io.create(),node:e};break;case 55:a=function(e,t){const n=$(e.expression);let i=Ie(n.type);const r=n.isIncomplete;if(ao(i))return{node:e,type:no.createNever(),isIncomplete:r};const s={0:"__pos__",33:"__neg__",5:"__invert__"};let o;if(38!==e.operator&&Go(i)&&(_e(Vt(e).diagnosticRuleSet.reportOptionalOperand,$o.reportOptionalOperand,ml.Diagnostic.noneOperator().format({operator:Cr(e.operator)}),e.expression),i=Fo(i)),!n.isIncomplete){const t=aa(i);"int"===t?0===e.operator?o=i:33===e.operator&&(o=Ko(i,(e=>{const t=e;return Zs.cloneWithLiteral(t,-t.literalValue)}))):"bool"===t&&38===e.operator&&(o=Ko(i,(e=>{const t=e;return Zs.cloneWithLiteral(t,!t.literalValue)})))}if(!o)if(38===e.operator)o=Cn(e,"bool"),o||(o=Ys.create());else if(o=ho(i)?i:gt(i,[],s[e.operator],e,t),!o){_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,t?ml.Diagnostic.typeNotSupportUnaryOperatorBidirectional().format({operator:Cr(e.operator),type:ai(i),expectedType:ai(t)}):ml.Diagnostic.typeNotSupportUnaryOperator().format({operator:Cr(e.operator),type:ai(i)}),e),o=Ys.create()}return{type:o,node:e,isIncomplete:r}}(e,o);break;case 7:a=ut(e,o,i);break;case 5:a=ht(e,o),xe(e.destExpression,a.type,!!a.isIncomplete,e.rightExpression);break;case 31:case 45:a=function(e,t){let n=t;if(t&&fo(t)){let i;Jo(t,(t=>{if(!i){const n=kn(e,(()=>bt(e,t)));n&&Jn(t,n.type)&&(i=t)}})),n=i}if(n){const t=bt(e,n);if(t)return t}return function(e,t){const n=31===e.nodeType?"list":"set";let i=!1,r=!1,s=[];e.entries.forEach(((e,n)=>{let i;i=32===e.nodeType?wt(e):$(e,t?no.createNever():void 0),i.isIncomplete&&(r=!0),n<64&&s.push(i.type)})),s=s.map((e=>Qo(e)));let o=t?io.create():Ys.create();if(s.length>0){const i=Vt(e);o="list"===n&&i.diagnosticRuleSet.strictListInference||"set"===n&&i.diagnosticRuleSet.strictSetInference||t?Oo(s,64):Yo(s,!0)?s[0]:o}else i=!0;const a=xn(e,n);return{type:_o(a)?Zs.cloneAsInstance(Zs.cloneForSpecialization(a,[o],!0,void 0,void 0,i)):Ys.create(),node:e,isIncomplete:r}}(e,void 0!==t)}(e,o);break;case 46:a=function(e){return e.startValue&&$(e.startValue),e.endValue&&$(e.endValue),e.stepValue&&$(e.stepValue),{type:Cn(e,"slice"),node:e}}(e);break;case 6:{const t=n?nn(e,n,!1):void 0,r=$(e.expression,t,i);a={type:oe(r.type,e.expression),node:e},r.isIncomplete&&(a.isIncomplete=!0);break}case 51:a=function(e,t,n){$(e.testExpression);const i=[];let r=!1;if(pe(e.ifExpression)){const s=$(e.ifExpression,n,t);i.push(s.type),s.isIncomplete&&(r=!0)}if(pe(e.elseExpression)){const s=$(e.elseExpression,n,t);i.push(s.type),s.isIncomplete&&(r=!0)}return{type:Oo(i),node:e,isIncomplete:r}}(e,i,o);break;case 32:a=function(e,t){let n=!1;const i=wt(e);i.isIncomplete&&(n=!0);const r=i.type;let s=e.forIfNodes.some((e=>33===e.nodeType&&e.isAsync||34===e.nodeType&&6===e.testExpression.nodeType)),o=Ys.create();6===e.expression.nodeType&&(s=!0),!s&&t&&vo(t)&&Zs.isBuiltIn(t,"AsyncGenerator")&&(s=!0);const a=ce(e,s?"AsyncGenerator":"Generator");return a&&_o(a)&&(o=Zs.cloneAsInstance(Zs.cloneForSpecialization(a,s?[r,to.createInstance()]:[r,to.createInstance(),to.createInstance()],!0))),{type:o,node:e,isIncomplete:n}}(e,o);break;case 15:a=function(e,t){let n,i=t;if(t&&fo(t)){let n;Jo(t,(t=>{if(!n){const i=kn(e,(()=>_t(e,t)));i&&Jn(t,i.type)&&(n=t)}})),i=n}if(i){n=new il;const t=_t(e,i,n);if(t)return t}return{...vt(e,!!t),expectedTypeDiagAddendum:n}}(e,o);break;case 30:a=function(e,t){const n=Xs.createInstance("","","",0);n.details.typeVarScopeId=Pe(e),N(e,n,0,!1);let i=[];if(t){Ko(t,(e=>{if(Eo(e)&&i.push(e),vo(e)){const t=_a(e,"__call__");if(t){const n=Bn(t);if(n&&Eo(n)){const t=ri(e,n);t&&i.push(t)}}}}));const n=e.parameters.filter((e=>0===e.category&&void 0===e.defaultValue)).length,r=e.parameters.filter((e=>0===e.category)).length;i=i.filter((e=>{const t=e.details.parameters.filter((e=>!!e.name&&!e.hasDefault)).length;return e.details.parameters.some((e=>!!e.name&&0!==e.category))||t>=n&&t<=r}))}const r=i.length>0?i[0]:void 0;e.parameters.forEach(((t,i)=>{let s=Ys.create();r&&i<r.details.parameters.length&&(s=Xs.getEffectiveParameterType(r,i)),t.name&&N(t.name,Xt(e,t.category,s),0,!1),t.defaultValue&&$(t.defaultValue,void 0,1);const o={category:t.category,name:t.name?t.name.value:void 0,hasDefault:!!t.defaultValue,defaultValueExpression:t.defaultValue,hasDeclaredType:!0,type:s};Xs.addParameter(n,o)}));const s=r?Un(r):void 0;return c.isSpeculative(e)?kn(e.expression,(()=>{n.inferredReturnType=$(e.expression,s).type}),!1):n.inferredReturnType=$(e.expression,s).type,{type:n,node:e}}(e,o);break;case 3:a=$(e.rightExpression),xe(e.leftExpression,a.type,!1,e.rightExpression,!0,!0);break;case 4:a=$(e.rightExpression),xe(e.name,a.type,!1,e.rightExpression,!0);break;case 60:a=function(e){let t,n,i=!1;const r=kr(e);if(r){const e=Gt(r);if(e){const i=Xs.getSpecializedReturnType(e.functionType);if(i){const e=za(i);e&&(e.length>=1&&(t=e[0]),e.length>=2&&(n=e[1]))}}}return e.expression&&$(e.expression,t).isIncomplete&&(i=!0),{type:n||Ys.create(),node:e,isIncomplete:i}}(e);break;case 61:a=function(e){const t=$(e.expression).type;let n,i=za(t);return i?n=i.length>=2?i[2]:Ys.create():vo(t)&&Zs.isBuiltIn(t,"Coroutine")?n=Ys.create():(i=za(le(t,!1,e)||Ys.create()),i&&(n=i.length>=2?i[2]:Ys.create())),{type:n||Ys.create(),node:e}}(e);break;case 56:{let t;if(o){const n=xn(e,"Iterable");n&&_o(n)&&(t=Zs.cloneAsInstance(Zs.cloneForSpecialization(n,[o],!0)))}const n=$(e.expression,t,i),r=n.type;a=0==(128&i)&&Io(r)&&!r.isVariadicUnpacked?{type:oo.cloneForUnpacked(r),node:e}:0!=(2097152&i)&&_o(r)&&Zs.isBuiltIn(r,"tuple")?{type:Zs.cloneForUnpacked(r),node:e}:{type:ae(r,!1,e)||Ys.create(),unpackedType:r,node:e,isIncomplete:n.isIncomplete};break}case 54:a=$(e.typeAnnotation,void 0,34024);break;case 0:En(e,(()=>{e.child&&$(e.child)})),a={type:Ys.create(),node:e}}return a||E(`Unhandled expression type '${xr(e)}'`),!u||a.isIncomplete||(128&i&&bo(a.type)&&a.type.details.isVariadic&&!a.type.isVariadicInUnion&&(fe(ml.Diagnostic.typeVarTupleContext(),e),a.type=Ys.create()),Ks.isInstantiable(a.type))||vo(a.type)&&Zs.isTupleClass(a.type)&&0===(null===(r=a.type.tupleTypeArguments)||void 0===r?void 0:r.length)||(ve(a.type,e),a.type=Ys.create()),65536&i&&ea(a.type)&&(a.type.details.illegalRecursionDetected=!0),ea(a.type)||(N(e,a.type,i,!!a.isIncomplete,n,!0),!n||ho(n)||ao(n)||l.set(e.id,n)),a}function H(e){return void 0!==e.futureImports.get("annotations")||e.executionEnvironment.pythonVersion>=De.V3_11||e.isStubFile}function G(e,t){return K(e,{associateTypeVarsWithScope:!0,allowTypeVarTuple:1===t,disallowRecursiveTypeAlias:!0,allowUnpackedTypedDict:2===t,allowUnpackedTuple:1===t})}function K(e,t){var n,i,r;const s=Vt(e);if(s.isTypingStubFile||s.isTypingExtensionsStubFile){const t=function(e){if(!e.parent||54!==e.parent.nodeType)return;if(38!==e.parent.valueExpression.nodeType)return;const t=e.parent.valueExpression.value,n=new Map([["Tuple",{alias:"tuple",module:"builtins"}],["Generic",{alias:"",module:"builtins"}],["Protocol",{alias:"",module:"builtins"}],["Callable",{alias:"",module:"builtins"}],["Type",{alias:"type",module:"builtins"}],["ClassVar",{alias:"",module:"builtins"}],["Final",{alias:"",module:"builtins"}],["Literal",{alias:"",module:"builtins"}],["TypedDict",{alias:"_TypedDict",module:"self"}],["Union",{alias:"",module:"builtins"}],["Optional",{alias:"",module:"builtins"}],["Annotated",{alias:"",module:"builtins"}],["TypeAlias",{alias:"",module:"builtins"}],["Concatenate",{alias:"",module:"builtins"}],["TypeGuard",{alias:"",module:"builtins"}],["StrictTypeGuard",{alias:"",module:"builtins"}],["Unpack",{alias:"",module:"builtins"}],["Required",{alias:"",module:"builtins"}],["NotRequired",{alias:"",module:"builtins"}],["Self",{alias:"",module:"builtins"}],["NoReturn",{alias:"",module:"builtins"}],["Never",{alias:"",module:"builtins"}],["LiteralString",{alias:"",module:"builtins"}]]).get(t);if(n){const i=F(e,0);if(i)return w(_o(i)),i;const r=Bt(e,t,n);return N(e,r,0,!1),r}}(e);if(t)return t}let o=1097;(null==t?void 0:t.isVariableAnnotation)&&(o|=32768),(null==t?void 0:t.allowFinal)||(o|=16),(null==t?void 0:t.allowClassVar)||(o|=131072),(null==t?void 0:t.allowTypeVarTuple)?o|=2097152:o|=128,(null==t?void 0:t.allowParamSpec)||(o|=32),(null==t?void 0:t.associateTypeVarsWithScope)?o|=8192:o|=4096,(null==t?void 0:t.disallowRecursiveTypeAlias)&&(o|=65536),(null==t?void 0:t.allowUnpackedTypedDict)&&(o|=8388608),(null==t?void 0:t.allowUnpackedTuple)&&(o|=2097152),(null==t?void 0:t.notParsedByInterpreter)&&(o|=524288),H(s)&&(o|=4),3===(null===(n=null==e?void 0:e.parent)||void 0===n?void 0:n.nodeType)&&e.parent.typeAnnotationComment===e?o|=524292:62===(null===(i=null==e?void 0:e.parent)||void 0===i?void 0:i.nodeType)?(e.parent.returnTypeAnnotation===e||e.parent.paramTypeAnnotations.some((t=>t===e)))&&(o|=524292):41===(null===(r=null==e?void 0:e.parent)||void 0===r?void 0:r.nodeType)&&e.parent.typeAnnotationComment===e&&(o|=524292);const a=$(e,void 0,o).type;return To(a)&&_e(s.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.moduleAsType(),e),Fa(a)}function J(e,t){let n=Vt(e).isStubFile?4:0;9!==e.expression.nodeType&&(n|=2);const i=$(e.expression,void 0,n);if(_o(i.type)&&Zs.isBuiltIn(i.type,"classmethod")&&ua(t))return t;const r=[{argumentCategory:0,type:t}],s=et(e.expression,r,i.type,void 0,!0).returnType||Ys.create();return!Eo(s)||s.details.declaredReturnType||s.details.parameters.some(((e,t)=>!(e.name&&!e.hasDeclaredType&&(0!==e.category||0===t&&e.isTypeInferred))))?La(s)&&Eo(i.type)&&!i.type.details.parameters.find((e=>void 0!==e.typeAnnotation))&&void 0===i.type.details.declaredReturnType?t:s:t}function Y(e,t=0){if(t>Gs)return!0;switch(t++,e.category){case 0:case 1:case 2:case 4:case 3:return!0;case 9:return void 0!==Mo(e,(e=>Y(e,t)));case 5:case 6:case 8:case 10:return!1;case 7:{if(Ks.isInstantiable(e))return!1;if(pa(e)&&e.tupleTypeArguments)return da(e)||0===e.tupleTypeArguments.length;if(Zs.isBuiltIn(e,"bool")&&void 0!==e.literalValue)return!1===e.literalValue;if(Zs.isProtocolClass(e))return!0;if(_a(e,"__len__"))return!0;const t=_a(e,"__bool__");if(t){const e=Bn(t);if(Eo(e)&&e.details.declaredReturnType){const t=e.details.declaredReturnType;if(vo(t)&&Zs.isBuiltIn(t,"bool")&&!0===t.literalValue)return!1}return!0}return!1}}}function Q(e,t=0){if(t>Gs)return!0;switch(t++,e.category){case 1:case 5:case 6:case 8:case 10:case 4:case 2:return!0;case 9:return void 0!==Mo(e,(e=>Q(e,t)));case 0:case 3:return!1;case 7:{if(Ks.isInstantiable(e))return!0;if(pa(e)&&e.tupleTypeArguments&&0===e.tupleTypeArguments.length)return!1;if(!1===e.literalValue||0===e.literalValue||e.literalValue===BigInt(0)||""===e.literalValue)return!1;if(Zs.isProtocolClass(e))return!0;const t=_a(e,"__bool__");if(t){const e=Bn(t);if(Eo(e)&&e.details.declaredReturnType){const t=e.details.declaredReturnType;if(vo(t)&&Zs.isBuiltIn(t,"bool")&&!1===t.literalValue)return!1}}return!0}}}function Z(e){return Ko(e,(e=>{if(vo(e)){if(void 0!==e.literalValue)return e.literalValue?void 0:e;if(Zs.isBuiltIn(e,"bool"))return Zs.cloneWithLiteral(e,!1)}if(Y(e))return e}))}function X(e){return Ko(e,(e=>{if(vo(e)){if(void 0!==e.literalValue)return e.literalValue?e:void 0;if(Zs.isBuiltIn(e,"bool"))return Zs.cloneWithLiteral(e,!0)}if(Q(e))return e}))}function ee(e,t,n,i={method:"get"},r,s=0,o){const a=Ne(e,Zs.cloneAsInstantiable(t),n,i,r,8|s,o);if(a)return{node:e,type:a.type,isIncomplete:!!a.isTypeIncomplete,isAsymmetricDescriptor:a.isAsymmetricDescriptor}}function te(e,t,n,i={method:"get"},r,s=0,o){let a;if(Zs.isPartiallyConstructed(t))return _e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.classDefinitionCycle().format({name:t.details.name}),e),{node:e,type:Ys.create()};if(0==(32&s)&&(a=Ne(e,t,n,i,r,1|s,o)),a&&a.classType&&a.symbol&&yo(a.classType)&&Zs.isProtocolClass(a.classType)){const t=Vo(a.symbol);t&&1===t.type&&!a.isClassVar&&_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.protocolMemberNotClassVar().format({memberName:n,className:a.classType.details.name}),e)}if(!a){const r=t.details.effectiveMetaclass;r&&_o(r)&&!Zs.isSameGenericClass(r,t)&&(a=Ne(e,r,n,i,void 0,s,t))}return a?{node:e,type:a.type,isIncomplete:!!a.isTypeIncomplete,isAsymmetricDescriptor:a.isAsymmetricDescriptor}:void 0}function ne(e,t,n=!1){const i=va(e,t,8);if(i){const t=Bn(i);if(Eo(t)||ko(t)){const i=ri(Zs.cloneAsInstance(e),t,void 0,void 0,void 0,n);if(i)return i}}}function ie(e,t){if(t>=e.parameters.length)return;const n=e.parameters[t];if(n.typeAnnotation)return n.typeAnnotation;if(n.typeAnnotationComment)return n.typeAnnotationComment;if(!e.functionAnnotationComment||e.functionAnnotationComment.isParamListEllipsis)return;let i=0;const r=e.functionAnnotationComment.paramTypeAnnotations;r.length<e.parameters.length&&(i=1);const s=t-i;return s<0||s>=r.length?void 0:r[s]}function re(e){if(54===e.nodeType&&38===e.valueExpression.nodeType){const t=wn(e,e.valueExpression.value,!1);if(t)return void 0!==t.symbol.getDeclarations().find((e=>ss(e)))}return!1}function se(e,t){let n,i,r,s=!0;switch(e.nodeType){case 38:{const t=wn(e,e.value,!0);if(t&&(n=t.symbol,void 0===On(n)&&2===t.scope.type)){const t=Dr(e);if(t&&10===t.nodeType){const i=$t(t);if(i){const t=va(i.classType,e.value,24);t&&(n=t.symbol)}}}break}case 54:return se(e.valueExpression);case 35:{const t=Ie($(e.leftExpression,void 0,2).type);let o;vo(t)?(o=_a(t,e.memberName.value,16),i=t,r=null==o?void 0:o.classType,(null==o?void 0:o.isInstanceMember)&&(s=!1)):_o(t)&&(o=va(t,e.memberName.value,24),i=t,r=null==o?void 0:o.classType),o&&(n=o.symbol);break}case 24:{const n=se(e.baseExpression);if(n&&vo(n)){const i=va(n,"__setitem__");if(i){const t=Bn(i);if(Eo(t)){const r=ri(n,t,_o(i.classType)?i.classType:void 0,e,void 0,!1);if(r&&Eo(r)&&2===r.details.parameters.length){const e=Xs.getEffectiveParameterType(r,1);if(!ho(e))return e}}}else if(Zs.isTypedDictClass(n)){const i=vl(li,e,n,t||{method:"get"});if(i)return i.type}}break}}if(n){let t=On(n);if(t){if(ua(t)){const e=va(t,"fset"),n=e?Bn(e):void 0;if(!n||!Eo(n)||n.details.parameters.length<2)return;t=n.details.parameters[1].type}return i&&(r&&_o(r)&&(t=ha(t,r)),(Eo(t)||ko(t))&&s&&(t=ri(i,t,void 0,e))),t}}}function oe(e,t){return Ko(e,(e=>{if(ho(e))return e;if(vo(e)){const n=Ee(e,"__await__",t);if(n){if(ho(n))return n;if(vo(n)&&Ee(n,"__iter__",t)){const e=function(e){if(ho(e))return e;if(vo(e)&&Zs.isBuiltIn(e,"Generator")){const t=e.typeArguments;if(t&&t.length>=3)return t[2]}}(n);if(e)return e}}}return t&&_e(Vt(t).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeNotAwaitable().format({type:ai(e)}),t),Ys.create()}))}function ae(e,t,n){const i=t?"__aiter__":"__iter__",r=t?"__anext__":"__next__";let s=!0;Go(e=Ie(e))&&(n&&_e(Vt(n).diagnosticRuleSet.reportOptionalIterable,$o.reportOptionalIterable,ml.Diagnostic.noneNotIterable(),n),e=Fo(e));const o=Ko(e,(e=>{if(ho(e=Ie(e)))return e;const o=new il;if(yo(e)){let s;if(Ks.isInstance(e)){if(pa(e)&&e.tupleTypeArguments&&0===e.tupleTypeArguments.length)return no.createNever();s=Ee(e,i,n)}else Ks.isInstantiable(e)&&e.details.effectiveMetaclass&&_o(e.details.effectiveMetaclass)&&(s=Ee(Zs.cloneAsInstance(e.details.effectiveMetaclass),i,n,e));if(s){const e=new il,a=Se(s,void 0,(s=>{if(ho(s))return s;if(vo(s)){const i=Ee(s,r,n);if(i)return t?oe(i,n):i;e.addMessage(ml.Diagnostic.methodNotDefinedOnType().format({name:r,type:ai(s)}))}else e.addMessage(ml.Diagnostic.methodReturnsNonObject().format({name:i}))}));if(e.isEmpty())return a;o.addAddendum(e)}else{if(vo(e)){const t=Ee(e,"__getitem__",n);if(t)return t}o.addMessage(ml.Diagnostic.methodNotDefined().format({name:i}))}}n&&_e(Vt(n).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeNotIterable().format({type:ai(e)})+al(o),n),s=!1}));return s?o:void 0}function le(e,t,n){const i=t?"__aiter__":"__iter__";let r=!0;Go(e=Ie(e))&&(n&&_e(Vt(n).diagnosticRuleSet.reportOptionalIterable,$o.reportOptionalIterable,ml.Diagnostic.noneNotIterable(),n),e=Fo(e));const s=Ko(e,(e=>{if(ho(e))return e;if(yo(e)){let t;if(Ks.isInstance(e)?t=Ee(e,i,n):Ks.isInstantiable(e)&&e.details.effectiveMetaclass&&_o(e.details.effectiveMetaclass)&&(t=Ee(Zs.cloneAsInstance(e.details.effectiveMetaclass),i,n,e)),t)return Ie(t)}n&&_e(Vt(n).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeNotIterable().format({type:ai(e)}),n),r=!1}));return r?s:void 0}function ce(e,t){return ue(e,t,["typing"])}function ue(t,n,i){const r=Vt(t),s=e({nameParts:i,importingFilePath:r.filePath});if(!s)return;const o=s.symbolTable.get(n);return o?Nn(o):void 0}function pe(e,t){const n=Lt(e);if(!n)return!!e.parent&&pe(e.parent,t);const i=t?Lt(t):void 0;return!!ci.isFlowNodeReachable(n,i)}function de(e){const t=function(e){return e.afterFlowNode}(e);return!!t&&!!ci.isFlowNodeReachable(t)&&!!function(e,t){return void 0!==vn(yn(e.id),t,void 0,void 0,Js.create(),!1).type}(e,t)}function he(e,t,n=!0){const i=Lt(e),r=Lt(t);return!(!i||!r)&&(i===r?n:ci.isFlowNodeReachable(r,i))}function me(e,t,n){return ge("information",e,t,n)}function fe(e,t,n){return ge("error",e,t,n)}function ge(e,t,n,i){if(!ye(n))return Vt(n).diagnosticSink.addDiagnosticWithTextRange(e,t,i||n)}function ye(e){return p.some((t=>Mr(e,t)))||c.isSpeculative(e)||d.isUndoTrackingEnabled()}function _e(e,t,n,i){if("none"===e)return;const r=ge(e,n,i);return r&&r.setRule(t),r}function ve(e,t){const n=Vt(t),i=new il;fo(e)&&Jo(e,(e=>{Ks.isInstantiable(e)||i.addMessage(ml.DiagnosticAddendum.typeNotClass().format({type:ai(e)}))})),_e(n.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeExpectedClass().format({type:ai(e)})+i.getString(),t)}function Te(e,t,n,i,r=!1,s){const o=e.value,a=wn(e,o,!1);if(!a)return;const l=a.symbol.getDeclarations();let c=On(a.symbol);const u=Vt(e);if(void 0===c&&2===a.scope.type){const t=Er(e);if(t){const n=$t(t);if(n){const t=va(n.classType,e.value,1);(null==t?void 0:t.isTypeDeclared)&&(c=Bn(t))}}}let p=t;if(c&&i){let n=new il;Jn(c,t,n)?p=ni(c,t):(s&&(n=s),_e(u.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeAssignmentMismatch().format({sourceType:ai(t),destType:ai(c)})+n.getString(),i||e),p=c)}else{const t=zs(e);2===(null==t?void 0:t.type)&&(!Ks.isInstance(p)||Zt(o)||Wo(a.symbol)||(p=Qo(p)))}const d=l.find((e=>1===e.type));d&&1===d.type&&i&&(d.isConstant?e!==l[0].node&&_e(u.diagnosticRuleSet.reportConstantRedefinition,$o.reportConstantRedefinition,ml.Diagnostic.constantRedefinition().format({name:o}),e):d.isFinal&&!r&&_e(u.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.finalReassigned().format({name:o}),e)),N(e,p,0,n,void 0,!1)}function be(e,t,n,i,r){const s=e.memberName.value,o=Vt(e),a=Er(e);if(!a)return;const l=$t(a);if(l&&_o(l.classType)){let a=va(l.classType,s,i?0:8);const c=l.classType.details.fields;if(a){const n=_o(a.classType)?a.classType:void 0,u=n&&Zs.isSameGenericClass(l.classType,n);if(u&&i&&(null==n?void 0:n.details.inheritedSlotsNames)&&(null==n?void 0:n.details.localSlotsNames)&&n.details.localSlotsNames.length>0&&!n.details.inheritedSlotsNames.some((e=>e===s))){const t=On(a.symbol);t&&ua(t)||_e(o.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.slotsAttributeError().format({name:s}),e.memberName)}if(u&&a.isInstanceMember===i){const t=c.get(s);w(void 0!==t);const n=t.getDeclarations();n.length>0&&1===n[0].type&&r&&e.memberName!==n[0].node&&n[0].isConstant&&_e(o.diagnosticRuleSet.reportConstantRedefinition,$o.reportConstantRedefinition,ml.Diagnostic.constantRedefinition().format({name:e.memberName.value}),e.memberName)}else{const n=On(a.symbol);n&&!ua(n)&&!a.isInstanceMember&&i&&(we(o,a.symbol,e.memberName),t=Oo([t,Bn(a)]))}}a=va(l.classType,s,16),a||!r||n||xt(o.diagnosticRuleSet.reportUnknownMemberType,$o.reportUnknownMemberType,e.memberName,t,e,!0)}}function Ie(e,t){return Ko(e,(e=>{if(wo(e)){if("args"===e.paramSpecAccess)return T&&_o(T)&&y&&vo(y)?Zs.cloneAsInstance(Va(T,[{type:y,isUnbounded:!0}])):Ys.create();if("kwargs"===e.paramSpecAccess)return S&&_o(S)&&I&&_o(I)&&y&&vo(y)?Zs.cloneAsInstance(Zs.cloneForSpecialization(S,[Fa(I),y],!0)):Ys.create()}if(Io(e)&&T&&_o(T))return Fa(Va(T,[],!0,!0,!0));if(bo(e)&&!e.details.recursiveTypeAliasName){if(e.details.boundType){const t=Ks.isInstantiable(e)?Na(e.details.boundType):e.details.boundType;return e.details.isSynthesized?t:Zo(t,[{typeVarName:oo.getNameWithScope(e),constraintIndex:0,isConstrainedTypeVar:!1}])}if(e.details.recursiveTypeAliasName)return e;if(e.details.constraints.length>0){const n=[];return e.details.constraints.forEach(((i,r)=>{if(t){const n=oo.getNameWithScope(e),i=t.find((e=>e.typeVarName===n));if(i&&i.constraintIndex!==r)return}Ks.isInstantiable(e)&&(i=Na(i)),n.push(Zo(i,[{typeVarName:oo.getNameWithScope(e),constraintIndex:r,isConstrainedTypeVar:!0}]))})),Oo(n)}if(e.details.isExemptFromBoundCheck)return io.create();if(Ks.isInstantiable(e)){if(_&&_o(_))return e.details.isSynthesized?_:Zo(Zs.cloneAsInstance(_),[{typeVarName:oo.getNameWithScope(e),constraintIndex:0,isConstrainedTypeVar:!1}])}else if(y)return e.details.isSynthesized?y:Zo(y,[{typeVarName:oo.getNameWithScope(e),constraintIndex:0,isConstrainedTypeVar:!1}]);return io.create()}return e}))}function Se(e,t,n){const i=[];let r=!1;const s=e=>{let s=fo(e)?e:Ie(e);s=ta(s),Jo(s,(s=>{var o;if(t&&!ro.isCompatible(Xo(s),t))return;let a=n(s,e);if(a!==e&&(r=!0),a){const e=null===(o=Xo(s))||void 0===o?void 0:o.filter((e=>e.isConstrainedTypeVar));e&&e.length>0&&(a=Zo(a,e)),i.push(a)}}))};if(fo(e)?e.subtypes.forEach((e=>{s(e)})):s(e),!r)return e;const o=Oo(i);return 9===o.category&&so.addTypeAliasSource(o,e),o}function xe(e,t,n,i,r=!1,s=!1,o){if(bo(t)&&i&&9===i.nodeType){const n=$(i.leftExpression,void 0,2).type;_o(n)&&(Zs.isBuiltIn(n,"TypeVar")||Zs.isBuiltIn(n,"TypeVarTuple")||Zs.isBuiltIn(n,"ParamSpec"))&&(38===e.nodeType&&e.value===t.details.name||fe(t.details.isParamSpec?ml.Diagnostic.paramSpecAssignedName().format({name:oo.getReadableName(t)}):ml.Diagnostic.typeVarAssignedName().format({name:oo.getReadableName(t)}),e))}switch(t=Ro(t),e.nodeType){case 38:n||xt(Vt(e).diagnosticRuleSet.reportUnknownVariableType,$o.reportUnknownVariableType,e,t,e,r),Te(e,t,n,i,s,o);break;case 35:!function(e,t,n,i,r){const s=$(e.leftExpression,void 0,2),o=Ie(s.type);if(38===e.leftExpression.nodeType){const r=Er(e);if(r){const s=$t(r);if(s&&_o(s.classType)&&(vo(o)?Zs.isSameGenericClass(o,s.classType)&&be(e,t,n,!0,i):_o(o)&&Zs.isSameGenericClass(o,s.classType)&&be(e,t,n,!1,i),Zs.isProtocolClass(s.classType))){const t=s.classType.details.fields.get(e.memberName.value);t&&0===t.getDeclarations().filter((e=>!kr(e.node))).length&&fe(ml.Diagnostic.assignmentInProtocol(),e.memberName)}}}var l;Fe(e,s,{method:"set",setType:t,setErrorNode:i,setExpectedTypeDiag:r},0).isAsymmetricDescriptor&&(l=e,c.isSpeculative(void 0)||a.add(l.id)),N(e.memberName,t,0,n,void 0,!1),N(e,t,0,n,void 0,!1)}(e,t,n,i,o);break;case 24:{const r=$(e.baseExpression,void 0,2);Le(e,r.type,{method:"set",setType:t,setErrorNode:i,setExpectedTypeDiag:o},0),N(e,t,0,n);break}case 31:case 52:!function(e,t,n,i){const r=31===e.nodeType?e.entries:e.expressions,s=new Array(r.length);for(let e=0;e<r.length;e++)s[e]=[];const o=r.findIndex((e=>56===e.nodeType)),a=r.findIndex((e=>56===e.nodeType));t=Ie(t);const l=new il;if(Jo(t,(t=>{const n=ia(t);if(n&&n.tupleTypeArguments){const i=n.tupleTypeArguments.map((e=>Zo(e.type,Xo(t)))),c=n.tupleTypeArguments.findIndex((e=>e.isUnbounded));if(c>=0)if(i.length>s.length)i.splice(c,1);else if(i.length<s.length){const e=i.length>0?i[c]:io.create();for(;i.length<s.length;)i.splice(c,0,e)}if(o>=0)if(i.length>s.length){let t=Oo(i.splice(o,i.length-s.length+1));31===e.nodeType&&(t=Qo(t)),i.splice(o,0,t)}else i.length===s.length-1&&i.splice(o,0,no.createNever());if(i.forEach(((e,t)=>{t<s.length&&s[t].push(e)})),i.length!==r.length){const n=a>=0?r.length-1:r.length,s=l.createAddendum();s.addMessage((31===e.nodeType?ml.DiagnosticAddendum.listAssignmentMismatch():ml.DiagnosticAddendum.tupleAssignmentMismatch()).format({type:ai(t)})),s.createAddendum().addMessage(ml.DiagnosticAddendum.tupleSizeMismatch().format({expected:n,received:i.length}))}}else{const e=ae(t,!1,i)||Ys.create();for(let n=0;n<r.length;n++)s[n].push(Zo(e,Xo(t)))}})),!l.isEmpty()){const n=1===l.getChildren().length&&ol();_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,n?l.getChildren()[0].getChildren()[0].getString().trim():(31===e.nodeType?ml.Diagnostic.listAssignmentMismatch():ml.Diagnostic.tupleAssignmentMismatch()).format({type:ai(t)})+l.getString(),e)}r.forEach(((e,t)=>{const r=s[t];xe(e,0===r.length?Ys.create():Oo(r),n,i,!0)})),N(e,t,0,n)}(e,t,n,i);break;case 54:{const n=K(e.typeAnnotation,{isVariableAnnotation:!0,allowFinal:Fr(e.valueExpression),allowClassVar:Nr(e.valueExpression)});vo(n)&&(Zs.isBuiltIn(n,"Final")||Zs.isBuiltIn(n,"ClassVar"))||vo(n)&&Zs.isBuiltIn(n,"TypeAlias")||Jn(n,t)&&(vo(t)&&Zs.isEnumClass(t)||(t=ni(n,t))),xe(e.valueExpression,t,!1,i,r,s,o);break}case 56:38===e.expression.nodeType&&Te(e.expression,Cn(e.expression,"list",[t]),!1,i);break;case 0:e.child&&En(e.child,(()=>{$(e.child)}));break;default:fe(ml.Diagnostic.assignmentTargetExpr(),e)}}function Ce(e){switch(e.nodeType){case 38:$(e);break;case 35:{const t=$(e.leftExpression),n=Fe(e,t,{method:"del"},0);N(e.memberName,n.type,0,!1),N(e,n.type,0,!1);break}case 24:{const t=$(e.baseExpression,void 0,2);Le(e,t.type,{method:"del"},0),N(e,Js.create(),0,!1);break}case 52:e.expressions.forEach((e=>{Ce(e)}));break;case 0:e.child&&En(e.child,(()=>{$(e.child,void 0)}));break;default:_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.delTargetExpr(),e)}}function we(e,t,n){c.isSpeculative(n)||d.isUndoTrackingEnabled()||e.accessedSymbolMap.set(t.id,!0)}function Ee(e,t,n,i){const r=_a(e,t,8);if(!r)return;const s=Bn(r);if(ho(s))return s;if(Eo(s)){const t=ri(i||e,s,r&&_o(r.classType)?r.classType:void 0,n,void 0,!1,i);if(t)return Un(t)}}function ke(e,t,n){var i;if(Ks.isInstantiable(t)&&!ea(t)){const r=function(e,t){var n;let i=e,r=0;for(w(Ks.isInstantiable(t));i&&(i=Pr(i,35===(null===(n=e.parent)||void 0===n?void 0:n.nodeType)),i);){let e;if(10===i.nodeType){const t=$t(i);t&&(e=t.classType.details.typeParameters),r++}else if(28===i.nodeType){const t=Gt(i);t&&(e=[],t.functionType.details.parameters.forEach((t=>{t.hasDeclaredType&&Ia(e,Sa(t.type))})),t.functionType.details.declaredReturnType&&Ia(e,Sa(t.functionType.details.declaredReturnType)))}else if(36===i.nodeType)break;if(e){const n=e.find((e=>e.details.name===t.details.name));if(n&&n.scopeId)return{type:r>1?t:Na(n),foundInterveningClass:r>1}}i=i.parent}for(i=e;i;){if(3===i.nodeType){const e=F(i.leftExpression,0);if(e&&bo(e)&&e.details.recursiveTypeAliasScopeId&&e.details.recursiveTypeAliasName)return{type:oo.cloneForScopeId(t,e.details.recursiveTypeAliasScopeId,e.details.recursiveTypeAliasName,2),foundInterveningClass:!1}}i=i.parent}return{type:t,foundInterveningClass:!1}}(e,t);if(t=r.type,0!=(2048&n)&&void 0!==t.scopeId)t.details.isSynthesized||t.details.isParamSpec||_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeVarUsedByOuterScope().format({name:t.details.name}),e);else if(0!=(8192&n)){if(void 0===t.scopeId)if(r.foundInterveningClass)_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeVarUsedByOuterScope().format({name:t.details.name}),e);else{let n=Dr(e);if(n&&35===(null===(i=e.parent)||void 0===i?void 0:i.nodeType)&&e.parent.leftExpression===e){const i=e.parent.memberName.value;if("args"===i||"kwargs"===i){const i=Dr(n);28===(null==i?void 0:i.nodeType)?n=i:r.type.scopeId||_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.paramSpecNotUsedByOuterScope().format({name:t.details.name}),e)}}n?t=oo.cloneForScopeId(t,Pe(n),n.name.value,28===n.nodeType?1:0):E("AssociateTypeVarsWithCurrentScope flag was set but enclosing scope not found")}}else if(0!=(4096&n)&&(void 0===t.scopeId||r.foundInterveningClass)&&!t.details.isSynthesized){const n=wo(t)?ml.Diagnostic.paramSpecNotUsedByOuterScope():ml.Diagnostic.typeVarNotUsedByOuterScope();_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,n.format({name:t.details.name}),e)}}return t.isVariadicUnpacked&&(t=oo.cloneForPacked(t)),t}function Ae(e,t,n){return 0==(2&n)&&(_o(t)&&(0!=(64&n)&&((i=t).details.typeParameters.length>0?!i.details.typeParameters[0].details.isSynthesized:!(!Zs.isSpecialBuiltIn(i)||!["Tuple","Callable","Generic","Type","Optional","Union","Literal","Annotated","TypeGuard","StrictTypeGuard"].some((e=>e===(i.aliasName||i.details.name)))))&&!t.typeArguments&&_e(Vt(e).diagnosticRuleSet.reportMissingTypeArgument,$o.reportMissingTypeArgument,ml.Diagnostic.typeArgsMissingForClass().format({name:t.aliasName||t.details.name}),e),t.typeArguments||(t=Tn(t,void 0,n,e))),0!=(64&n)&&t.typeAliasInfo&&t.typeAliasInfo.typeParameters&&t.typeAliasInfo.typeParameters.length>0&&!t.typeAliasInfo.typeArguments&&(_e(Vt(e).diagnosticRuleSet.reportMissingTypeArgument,$o.reportMissingTypeArgument,ml.Diagnostic.typeArgsMissingForAlias().format({name:t.typeAliasInfo.name}),e),t=Ks.cloneForTypeAlias(t,t.typeAliasInfo.name,t.typeAliasInfo.fullName,t.typeAliasInfo.typeVarScopeId,t.typeAliasInfo.typeParameters,t.typeAliasInfo.typeParameters.map((e=>Ys.create()))))),t;var i}function Pe(e){let t="";return(10===e.nodeType||28===e.nodeType)&&(t=e.name.value),`${Vt(e).filePath}.${e.start.toString()}-${t}`}function Re(e){const t=[];let n=e;for(;n&&(n=Pr(n),n);)t.push(Pe(n)),n=n.parent;return t}function Fe(e,n,i,r){var s;let o=n.type;const a=e.memberName.value;let l=new il;const c=Vt(e);let u,p,d=!!n.isIncomplete;if(n.isIncomplete&&mo(n.type))return{type:Ys.create(),node:e,isIncomplete:!0};fo(o)&&Ks.isSpecialForm(o)&&y&&(o=y);const h=()=>{if(f&&_o(f))return ee(e.memberName,f,a,i,l,void 0,n.bindToType)};switch(wo(o)&&o.paramSpecAccess&&(o=Ie(o)),o.category){case 2:case 1:u=o;break;case 4:u=Ys.create();break;case 10:if(o.details.isParamSpec){if("args"===a){const t=jr(e);return t&&1===t.category?{type:oo.cloneForParamSpecAccess(o,"args"),node:e,isIncomplete:d}:(fe(ml.Diagnostic.paramSpecArgsUsage(),e),{type:Ys.create(),node:e,isIncomplete:d})}if("kwargs"===a){const t=jr(e);return t&&2===t.category?{type:oo.cloneForParamSpecAccess(o,"kwargs"),node:e,isIncomplete:d}:(fe(ml.Diagnostic.paramSpecKwargsUsage(),e),{type:Ys.create(),node:e,isIncomplete:d})}return d||_e(c.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.paramSpecUnknownMember().format({name:a}),e),{type:Ys.create(),node:e,isIncomplete:d}}return 64&r?(d||_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeVarNoMember().format({type:ai(o),name:a}),e.leftExpression),{type:Ys.create(),node:e,isIncomplete:d}):o.details.recursiveTypeAliasName?{type:Ys.create(),node:e,isIncomplete:!0}:Fe(e,{type:Ie(o),node:e,bindToType:o,isIncomplete:d},i,0);case 7:if(Ks.isInstantiable(o)){const t=te(e.memberName,o,a,i,l,0,n.bindToType);u=null==t?void 0:t.type,(null==t?void 0:t.isIncomplete)&&(d=!0),(null==t?void 0:t.isAsymmetricDescriptor)&&(p=!0)}else if(Zs.isBuiltIn(o,"type")&&y&&vo(y)&&!n.isSuperCall){const t=te(e.memberName,Zs.cloneAsInstantiable(y),a,i,l,0,n.bindToType?Fa(n.bindToType):void 0);u=null==t?void 0:t.type,(null==t?void 0:t.isIncomplete)&&(d=!0),(null==t?void 0:t.isAsymmetricDescriptor)&&(p=!0)}else{if(Zs.isBuiltIn(o,"LiteralString")&&I&&_o(I)&&(o=Zs.cloneAsInstance(I)),Zs.isEnumClass(o)){const t=o.literalValue;if(t instanceof Hs)if("name"===a||"_name_"===a){const n=xn(e,"str");if(_o(n))return{node:e,type:Zs.cloneAsInstance(Zs.cloneWithLiteral(n,t.itemName)),isIncomplete:d}}else if("value"===a||"_value_"===a)return{node:e,type:t.itemType,isIncomplete:d}}const t=ee(e.memberName,o,a,i,l,void 0,n.bindToType);t&&(u=Zo(t.type,Xo(o))),(null==t?void 0:t.isIncomplete)&&(d=!0),(null==t?void 0:t.isAsymmetricDescriptor)&&(p=!0)}break;case 8:{const n=Qs.getField(o,a);if(n&&!n.isExternallyHidden())"get"===i.method&&we(Vt(e),n,e.memberName),u=Mn(n,void 0,!0).type,bo(u)&&(u=ke(e,u,r)),mo(u)&&(u=Ys.create()),n.isPrivateMember()&&_e(Vt(e).diagnosticRuleSet.reportPrivateUsage,$o.reportPrivateUsage,ml.Diagnostic.privateUsedOutsideOfModule().format({name:a}),e.memberName),n.isPrivatePyTypedImport()&&_e(Vt(e).diagnosticRuleSet.reportPrivateImportUsage,$o.reportPrivateImportUsage,ml.Diagnostic.privateImportFromPyTypedModule().format({name:a,module:o.moduleName}),e.memberName);else{if("get"===i.method){const e=Qs.getField(o,"__getattr__");if(e&&(c.executionEnvironment.pythonVersion>=De.V3_7||e.getDeclarations().some((e=>e.path.toLowerCase().endsWith(".pyi"))))){const t=Mn(e);Eo(t.type)&&(u=Un(t.type),t.isIncomplete&&(d=!0))}}u||(d||_e(c.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.moduleUnknownMember().format({name:a,module:o.moduleName}),e.memberName),u=t.evaluateUnknownImportsAsAny?io.create():Ys.create())}break}case 9:u=Ko(o,(t=>{if(lo(t)){const t=h();return t?(u=Zo(t.type,Xo(o)),t.isIncomplete&&(d=!0),u):void(d||_e(Vt(e).diagnosticRuleSet.reportOptionalMemberAccess,$o.reportOptionalMemberAccess,ml.Diagnostic.noneUnknownMember().format({name:a}),e.memberName))}if(!mo(t)){const r=Fe(e,{type:t,node:e,isIncomplete:n.isIncomplete},i,0);return r.isIncomplete&&(d=!0),r.type}}));break;case 5:case 6:if("__defaults__"===a)u=io.create();else if("__self__"===a){const e=Eo(o)?o:o.overloads[0];void 0!==e.preBoundFlags&&0==(4&e.preBoundFlags)&&(u=e.boundToType)}else u=v?Fe(e,{type:v,node:e},i,r).type:io.create();break;case 3:{const e=h();e&&(u=Zo(e.type,Xo(o)),e.isIncomplete&&(d=!0));break}default:l.addMessage(ml.DiagnosticAddendum.typeUnsupported().format({type:ai(o)}))}if(!u){const t=Eo(o)||ko(o)||vo(o)&&Zs.isBuiltIn(o,"function");if(!n.isIncomplete){let n=ml.Diagnostic.memberAccess();"set"===i.method?n=ml.Diagnostic.memberSet():"del"===i.method&&(n=ml.Diagnostic.memberDelete()),i.setExpectedTypeDiag&&(l=i.setExpectedTypeDiag);const[r,s]=t?[c.diagnosticRuleSet.reportFunctionMemberAccess,$o.reportFunctionMemberAccess]:[c.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues];_e(r,s,n.format({name:a,type:ai(o)})+al(l),e.memberName)}u=t?io.create():Ys.create()}if(0==(2&r)&&_o(u)&&!u.typeArguments&&(u=Tn(u,void 0,r,e)),"get"===i.method){let t=d;if(_o(u)){const n=function(e,t){let n=e;for(;n;){if(n.nodeType===t)return n;n=n.parent}}(e,1);n&&9===(null===(s=null==n?void 0:n.parent)||void 0===s?void 0:s.nodeType)&&(t=!0)}t||xt(c.diagnosticRuleSet.reportUnknownMemberType,$o.reportUnknownMemberType,e.memberName,u,e,!1)}return{type:u,node:e,isIncomplete:d,isAsymmetricDescriptor:p}}function Ne(e,t,n,i,r,s,o){var a;let l=0;1&s&&(l|=8),2&s&&(l|=2),4&s&&(l|=4),256&s&&(l|=32),128&s&&(l|=1);let c=va(t,n,16|l);if(c||(c=va(t,n,l)),c){let l,u=!1;if(c.symbol.isInitVar())return void(r&&r.addMessage(ml.DiagnosticAddendum.memberIsInitVar().format({name:n})));if("get"!==i.method){const n=Er(e);if(n){const e=null===(a=$t(n))||void 0===a?void 0:a.classType;e&&_o(e)&&Zs.isSameGenericClass(e,t)&&(l=On(c.symbol)||Ys.create(),l&&_o(c.classType)&&(l=ha(l,c.classType)))}}if(!l){const n=function(e,t,n){if(_o(t.classType)){const i=Mn(t.symbol);if(i)return Ln(i.type),{node:e,type:ha(i.type,t.classType,n),isIncomplete:!!i.isIncomplete}}}(e,c,o?void 0:t);n?(l=n.type,n.isIncomplete&&(u=!0)):l=Ys.create()}if(Zs.isTypedDictClass(t)){const e=c.symbol.getTypedDeclarations();if(e.length>0&&1===e[0].type)return void(r&&r.addMessage(ml.DiagnosticAddendum.memberUnknown().format({name:n})))}"get"===i.method&&_o(c.classType)&&Zs.isSameGenericClass(c.classType,t)&&we(Vt(e),c.symbol,e);const p=function(e,t,n,i,r,s,o,a,l,c){const u=0!=(16&s);let p=!0,d=!1;if(e=Ko(e,(e=>{const h=Ie(e);if(yo(h)){let e=h,u=!1;if(Ks.isInstantiable(h)&&(h.details.effectiveMetaclass&&_o(h.details.effectiveMetaclass)&&(r||"get"===l.method)?(e=Fa(h.details.effectiveMetaclass),u=!0):e=void 0),e){let m;m="get"===l.method?"__get__":"set"===l.method?"__set__":"__delete__";const f=va(e,m,8);if(Zs.isPropertyClass(e))if("set"===l.method){if(!f)return c&&c.addMessage(ml.DiagnosticAddendum.propertyMissingSetter().format({name:a})),void(p=!1)}else if("del"===l.method&&!f)return c&&c.addMessage(ml.DiagnosticAddendum.propertyMissingDeleter().format({name:a})),void(p=!1);if(f){let a=Bn(f);const g=[{argumentCategory:0,type:Zs.isClassProperty(e)?n:r?i||Zs.cloneAsInstance(n):to.createInstance()}];if("get"===l.method?g.push({argumentCategory:0,type:n}):"set"===l.method&&g.push({argumentCategory:0,type:l.setType||Ys.create()}),Zs.isPropertyClass(e)&&t&&_o(t.classType)&&(Ln(a),a=ha(a,t.classType),0!=(1&s)&&Zs.isProtocolClass(n)&&(c&&c.addMessage(ml.DiagnosticAddendum.propertyAccessFromProtocolClass()),p=!1)),a&&(Eo(a)||ko(a))){const n=a,i=En(o,(()=>{let i;Zs.isPropertyClass(h)&&!u?t&&_o(t.classType)&&(i=t.classType):_o(f.classType)&&(i=f.classType);const r=ri(e,n,i,o,void 0,void 0,u?h:void 0);if(r&&(Eo(r)||ko(r))){const e=new jo(na(r));i&&e.addSolveForScope(na(i));const t=et(o,g,r,e,!0);if(t.argumentErrors){if("set"===l.method)if(l.setType&&Eo(r)&&r.details.parameters.length>=2){const e=Xs.getEffectiveParameterType(r,1);null==c||c.addMessage(ml.DiagnosticAddendum.typeIncompatible().format({destType:ai(e),sourceType:ai(l.setType)}))}else ko(r)&&(null==c||c.addMessage(ml.Diagnostic.noOverload().format({name:m})));return p=!1,io.create()}return"get"===l.method?t.returnType||Ys.create():io.create()}}));if("set"===l.method&&yo(f.classType)&&function(e){var t;if(void 0!==e.isAsymmetricDescriptor)return e.isAsymmetricDescriptor;let n=!1;const i=va(e,"__get__",2),r=va(e,"__set__",2);if(i&&r){const e=Nn(i.symbol),s=Nn(r.symbol);Eo(e)&&Eo(s)&&s.details.parameters.length>=3&&e.details.declaredReturnType&&(Ao(Xs.getEffectiveParameterType(s,2),null!==(t=Xs.getSpecializedReturnType(e))&&void 0!==t?t:Ys.create())||(n=!0))}else n=!1;return e.isAsymmetricDescriptor=n,n}(f.classType)&&(d=!0),i)return i}}}}else if((Eo(h)||ko(h))&&(!r||t&&!t.isInstanceMember))return ri(r?Zs.cloneAsInstance(n):n,h,t&&_o(t.classType)?t.classType:void 0,o,void 0,u,i);if("set"===l.method){if((null==t?void 0:t.symbol.isClassVar())&&8&s)return c&&c.addMessage(ml.DiagnosticAddendum.memberSetClassVar().format({name:a})),void(p=!1);const e=null==t?void 0:t.symbol.getDeclarations().find((e=>rs(e)));if(e&&!Mr(o,e.node)){const e=kr(o);if(!e||"__init__"!==e.name.value)return c&&c.addMessage(ml.Diagnostic.finalReassigned().format({name:a})),void(p=!1)}if((null==t?void 0:t.isInstanceMember)&&yo(t.classType)&&Zs.isReadOnlyInstanceVariables(t.classType))return c&&c.addMessage(ml.DiagnosticAddendum.readOnlyAttribute().format({name:a})),void(p=!1);let n=!1;if((t&&t.symbol.hasTypedDeclarations()||t&&!t.symbol.getDeclarations().some((e=>e.node===o)))&&(n=!0),n){let e=h;return r&&!t.isInstanceMember&&Eo(h)&&(Xs.isClassMethod(h)||Xs.isInstanceMethod(h))&&(e=Xs.clone(h,!0)),e}}return e})),p)return{type:e,isAsymmetricDescriptor:d}}(l,c,t,o,0==(1&s),s,e,n,i,r);if(!p)return;if(l=p.type,"set"===i.method&&i.setType){if(!Jn(l,i.setType,null==r?void 0:r.createAddendum()))return void(r&&r.addMessage(ml.DiagnosticAddendum.memberAssignment().format({type:ai(i.setType),name:n,classType:oi(t)})));if(_o(c.classType)&&Zs.isFrozenDataClass(c.classType)&&0==(1&s))return void(r&&r.addMessage(ml.DiagnosticAddendum.dataClassFrozen().format({name:ai(Zs.cloneAsInstance(c.classType))})))}return{symbol:c.symbol,type:l,isTypeIncomplete:u,isClassMember:!c.isInstanceMember,isClassVar:c.isClassVar,classType:c.classType,isAsymmetricDescriptor:p.isAsymmetricDescriptor}}if(0==(65&s)){const r=function(e,t,n,i){var r,s,o,a;if("get"===n.method){let n=null===(r=te(t,e,"__getattribute__",{method:"get"},void 0,68))||void 0===r?void 0:r.type;if(n||(n=null===(s=te(t,e,"__getattr__",{method:"get"},void 0,68))||void 0===s?void 0:s.type),n&&ko(n)){let e=io.create();I&&_o(I)&&(e=Zs.cloneWithLiteral(Zs.cloneAsInstance(I),i)),n=Ge(t,n,[{argumentCategory:0,type:io.create()},{argumentCategory:0,type:e}])}if(n&&Eo(n))return Un(n)}else if("set"===n.method){if(null===(o=te(t,e,"__setattr__",{method:"get"},void 0,68))||void 0===o?void 0:o.type)return io.create()}else if(w("del"===n.method),null===(a=te(t,e,"__detattr__",{method:"get"},void 0,68))||void 0===a?void 0:a.type)return io.create()}(t,e,i,n);if(r)return{symbol:void 0,type:r,isTypeIncomplete:!1,isClassMember:!1,isClassVar:!1,isAsymmetricDescriptor:!1}}r&&r.addMessage(ml.DiagnosticAddendum.memberUnknown().format({name:n}))}function Me(e,t,n){const i=t.findIndex((e=>Io(e)));if(i>=0&&T&&_o(T))if(i<e.length){const n=e.slice(i,i+1+e.length-t.length);if(1===n.length&&Io(n[0].type))Oe(n[0].type,n[0].node);else{n.forEach(((e,t)=>{Et(e,{allowEmptyTuple:0===t,allowVariadicTypeVar:!0,allowUnpackedTuples:!0})}));const r=[];1===n.length&&n[0].isEmptyTupleShorthand||n.forEach((e=>{xo(e.type)&&e.type.tupleTypeArguments?r.push(...e.type.tupleTypeArguments):r.push({type:Fa(e.type),isUnbounded:!1})}));const s=Fa(Va(T,r,!0,!0,!0));e=[...e.slice(0,i),{node:e[i].node,type:s},...e.slice(i+1+e.length-t.length,e.length)]}}else e.push({node:n,type:Fa(Va(T,[],!0,!0,!0))});return e}function Oe(e,t){return!!e.isVariadicUnpacked||(fe(ml.Diagnostic.unpackedTypeVarTupleExpected().format({name1:e.details.name,name2:e.details.name}),t),!1)}function Le(e,t,n,i){const r=function(e,t,n){var i,r;if(!(null===(i=t.typeAliasInfo)||void 0===i?void 0:i.typeParameters)||0===t.typeAliasInfo.typeParameters.length&&t.typeAliasInfo.typeArguments)return;if(!Ks.isInstantiable(t))return;if(t.typeAliasInfo.typeArguments)return;const s=t.typeAliasInfo.typeParameters;let o=Me(Be(e,n),s,e);1===s.length&&s[0].details.isParamSpec&&o&&o.every((e=>!ca(e.type)&&!e.typeList&&!wo(e.type)))&&(o=[{type:Ys.create(),node:o[0].node,typeList:o}]),o.length>s.length&&!s.some((e=>e.details.isVariadic))&&fe(ml.Diagnostic.typeArgsTooMany().format({name:ai(t),expected:s.length,received:o.length}),o[s.length].node);const a=new jo(t.typeAliasInfo.typeVarScopeId),l=new il;s.forEach(((e,t)=>{if(e.details.isParamSpec&&t<o.length)if(o[t].typeList){const n=Xs.createInstantiable("","","",65536);Ks.setSpecialForm(n),o[t].typeList.forEach(((e,t)=>{Xs.addParameter(n,{category:0,name:`__p${t}`,isNameSynthesized:!0,type:Fa(e.type),hasDeclaredType:!0})})),Kn(e,n,l,a)}else if(wo(o[t].type))Kn(e,Fa(o[t].type),l,a);else if(ca(o[t].type)){const t=Xs.createInstantiable("","","",98304);Ks.setSpecialForm(t),Xs.addDefaultParameters(t),Kn(e,t,l,a)}else fe(ml.Diagnostic.typeArgListExpected(),o[t].node);else t<o.length&&o[t].typeList&&fe(ml.Diagnostic.typeArgListNotAllowed(),o[t].node),Kn(e,t<o.length?Fa(o[t].type):Ys.create(),l,a)})),l.isEmpty()||fe(ml.Diagnostic.typeNotSpecializable().format({type:ai(t)})+l.getString(),e);const c=[];return null===(r=t.typeAliasInfo.typeParameters)||void 0===r||r.forEach((e=>{let t;if(wo(e)){const n=a.getParamSpec(e);t=n?Ja(n):Ys.create()}else t=a.getTypeVarType(e);c.push(t||Ys.create())})),{type:Ks.cloneForTypeAlias(fa(t,a),t.typeAliasInfo.name,t.typeAliasInfo.fullName,t.typeAliasInfo.typeVarScopeId,t.typeAliasInfo.typeParameters,c),node:e}}(e,t,i);if(r)return r;if(ea(t)){const n=Be(e,i).map((e=>Fa(e.type)));return{type:Ks.cloneForTypeAlias(t,t.details.recursiveTypeAliasName,"",t.details.recursiveTypeAliasScopeId,void 0,n),node:e}}let s=!1;const o=Se(t,void 0,((t,r)=>{var o;if(ho(t))return t;if(64&i&&bo(r))return _e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeVarNotSubscriptable().format({type:ai(r)}),e.baseExpression),Be(e,i,!1,!1),Ys.create();if(_o(t)){if(t.details.effectiveMetaclass&&_o(t.details.effectiveMetaclass)&&!Zs.isBuiltIn(t.details.effectiveMetaclass,"type")&&te(e,t,qe(n),void 0,void 0,96))return Ve(e,t,n).type;if("set"===n.method?fe(ml.Diagnostic.genericClassAssigned(),e.baseExpression):"del"===n.method&&fe(ml.Diagnostic.genericClassDeleted(),e.baseExpression),Zs.isSpecialBuiltIn(t,"Literal"))return function(e,t){if(0===e.items.length)return fe(ml.Diagnostic.literalEmptyArgs(),e.baseExpression),Ys.create();const n=[];for(const t of e.items){let i;const r=t.valueExpression;if(0!==t.argumentCategory)fe(ml.Diagnostic.unpackedArgInTypeArgument(),r),i=Ys.create();else if(t.name)fe(ml.Diagnostic.keywordArgInTypeArgument(),r),i=Ys.create();else if(48===r.nodeType){i=Nt(e,0!=(32&r.strings[0].token.flags)?"bytes":"str",r.strings.map((e=>e.value)).join(""))}else 40===r.nodeType?!r.isImaginary&&r.isInteger&&(i=Nt(e,"int",r.value)):11===r.nodeType?33===r.constType?i=Nt(e,"bool",!0):15===r.constType?i=Nt(e,"bool",!1):26===r.constType&&(i=to.createType()):55===r.nodeType&&33===r.operator&&40===r.expression.nodeType&&!r.expression.isImaginary&&r.expression.isInteger&&(i=Nt(e,"int",-r.expression.value));if(!i){const e=$(r);if(vo(e.type)&&Zs.isEnumClass(e.type)&&void 0!==e.type.literalValue)i=Zs.cloneAsInstantiable(e.type);else{let t=!0;Jo(e.type,(e=>{_o(e)&&void 0!==e.literalValue||(t=!1)})),t&&(i=e.type)}}i||(fe(ml.Diagnostic.literalUnsupportedType(),t),i=Ys.create()),n.push(i)}return Oo(n)}(e);if(Zs.isBuiltIn(t,"InitVar")){const t=Be(e,i);return 1===t.length?t[0].type:(fe(ml.Diagnostic.typeArgsMismatchOne().format({received:t.length}),e.baseExpression),Ys.create())}if(Zs.isEnumClass(t))return Zs.cloneAsInstance(t);const r=_o(t)&&Zs.isBuiltIn(t,"Annotated"),s=_o(t)&&Zs.hasCustomClassGetItem(t),a=(null===(o=t.details.typeParameters)||void 0===o?void 0:o.length)>0||Zs.isSpecialBuiltIn(t)||Zs.isBuiltIn(t,"type")||Zs.isPartiallyConstructed(t),l=_o(t)&&Zs.isBuiltIn(t,"Final"),c=_o(t)&&Zs.isBuiltIn(t,"ClassVar");let u=Be(e,i,r,s||!a,l,c);return r||(u=Me(u,t.details.typeParameters,e)),s?t:t.typeArguments?(fe(ml.Diagnostic.classAlreadySpecialized().format({type:ai(Fa(t),!0)}),e.baseExpression),t):Tn(t,u,i,e)}if(vo(t)){const i=Ve(e,t,n);return i.isIncomplete&&(s=!0),i.type}return ao(t)?Ys.create():lo(t)?(_e(Vt(e).diagnosticRuleSet.reportOptionalSubscript,$o.reportOptionalSubscript,ml.Diagnostic.noneNotSubscriptable(),e.baseExpression),Ys.create()):(mo(t)||_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeNotSubscriptable().format({type:ai(t)}),e.baseExpression),Ys.create())}));return e.items.forEach((e=>{R(e.valueExpression)||$(e.valueExpression,void 0,4&i)})),{type:o,node:e,isIncomplete:s}}function Ue(e,t=!1){return T&&_o(T)?Fa(Va(T,e.map((e=>({type:e,isUnbounded:t}))))):Ys.create()}function qe(e){return"get"===e.method?"__getitem__":"set"===e.method?"__setitem__":(w("del"===e.method),"__delitem__")}function Ve(e,t,n){var i,r;if(vo(t)&&Zs.isTypedDictClass(t)){const i=vl(li,e,t,n);if(i)return i}const s=qe(n),o=vo(t)?null===(i=ee(e,t,s,void 0,void 0,64))||void 0===i?void 0:i.type:null===(r=te(e,t,s,void 0,void 0,96))||void 0===r?void 0:r.type;if(!o)return _e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.methodNotDefinedOnType().format({name:s,type:ai(t)}),e.baseExpression),{node:e,type:Ys.create()};if(1===e.items.length&&!e.trailingComma&&!e.items[0].name&&0===e.items[0].argumentCategory&&vo(t)){const n=e.items[0].valueExpression,i=$(n).type;if(vo(i)&&Zs.isBuiltIn(i,"int")&&ra(i)&&"number"==typeof i.literalValue){const n=i.literalValue,r=ia(t);if(r&&r.tupleTypeArguments&&!da(r)){if(n>=0&&n<r.tupleTypeArguments.length)return{node:e,type:r.tupleTypeArguments[n].type};if(n<0&&r.tupleTypeArguments.length+n>=0)return{node:e,type:r.tupleTypeArguments[r.tupleTypeArguments.length+n].type}}}else if(vo(i)&&Zs.isBuiltIn(i,"slice")){const i=ia(t);if(i&&i.tupleTypeArguments&&!da(i)&&46===n.nodeType&&!n.stepValue){const t=(e,t)=>{let n=t;if(e){const t=$(e).type;vo(t)&&Zs.isBuiltIn(t,"int")&&ra(t)&&"number"==typeof t.literalValue?(n=t.literalValue,n<0&&(n=i.tupleTypeArguments.length+n)):n=-1}return n},r=t(n.startValue,0),s=t(n.endValue,i.tupleTypeArguments.length);if(r>=0&&s>0&&s<=i.tupleTypeArguments.length&&T&&_o(T))return{node:e,type:Zs.cloneAsInstance(Va(T,i.tupleTypeArguments.slice(r,s)))}}}}const a=e.items.filter((e=>0===e.argumentCategory&&!e.name)),l=e.items.filter((e=>1===e.argumentCategory)),c=e.items.filter((e=>0===e.argumentCategory&&!!e.name)),u=e.items.filter((e=>2===e.argumentCategory));let p;if(1!==a.length||0!==l.length||e.trailingComma)if(0===a.length&&0===l.length)p=T&&_o(T)?Fa(Va(T,[])):Ys.create();else{const e=[];a.forEach((t=>{e.push($(t.valueExpression).type)})),l.forEach((t=>{const n=ae($(t.valueExpression).type,!1,t)||Ys.create();e.push(n)})),p=Ue(e,l.length>0)}else p=$(a[0].valueExpression).type;let d,h=[{argumentCategory:0,type:p}];if("set"===n.method){let e=n.setType||io.create();bo(e)&&e.details.constraints.length>0&&(e=Ie(e,vo(t)?t.condition:void 0)),h.push({argumentCategory:0,type:e})}return c.forEach((e=>{h.push({argumentCategory:0,valueExpression:e.valueExpression,node:e,name:e.name})})),u.forEach((e=>{h.push({argumentCategory:2,valueExpression:e.valueExpression,node:e})})),kn(e,(()=>{if(d=et(e,h,o),d.argumentErrors&&vo(p)&&0===c.length&&0===u.length){const t=[...h];if(t[0]={...t[0]},ee(e,p,"__index__")){const n=Cn(e,"int");vo(n)&&(t[0].type=n)}d=et(e,t,o),d.argumentErrors||(h=t)}})),d=et(e,h,o),{node:e,type:d.returnType||Ys.create(),isIncomplete:!!d.isTypeIncomplete}}function Be(e,t,n=!1,i=!1,r=!1,s=!1){const o=[];let a=t;r||s?a|=131088:(a&=-1048739,n||(a|=131088),a|=2097152);const l=(e,t)=>{let r;return r=i||n&&t>0?$(e,void 0,131234):function(e,t){let n,i=1097|t;return Vt(e).isStubFile&&(i|=4),31===e.nodeType?(n={type:Ys.create(),typeList:e.entries.map((e=>$(e,void 0,i))),node:e},O(e)):(n=$(e,void 0,i),yo(n.type)&&Zs.isBuiltIn(n.type,"Protocol")&&fe(ml.Diagnostic.protocolNotAllowedInTypeArgument(),e),0!=(131072&t)&&yo(n.type)&&Zs.isBuiltIn(n.type,"ClassVar")&&fe(ml.Diagnostic.classVarNotAllowed(),e)),n}(e,a),r};return 1===e.items.length&&!e.trailingComma&&!e.items[0].name&&52===e.items[0].valueExpression.nodeType&&e.items[0].valueExpression.expressions.length>0?(e.items[0].valueExpression.expressions.forEach(((e,t)=>{o.push(l(e,t))})),O(e.items[0].valueExpression)):e.items.forEach(((e,t)=>{const n=l(e.valueExpression,t);0!==e.argumentCategory&&1===e.argumentCategory&&(Io(n.type)&&!n.type.isVariadicUnpacked?n.type=oo.cloneForUnpacked(n.type):_o(n.type)&&!n.type.includeSubclasses&&pa(n.type)&&(n.type=Zs.cloneForUnpacked(n.type))),e.name&&fe(ml.Diagnostic.keywordArgInTypeArgument(),e.valueExpression),o.push(n)})),o}function We(e,t){if(!vo(t=ta(t)))return;if(!T||!_o(T))return;let n=[];if(pa(t)&&t.tupleTypeArguments){n=t.tupleTypeArguments.map((e=>ta(e.type)));const i=t.tupleTypeArguments.findIndex((e=>e.isUnbounded));if(i>=0)if(n.length>e.expressions.length)n.splice(i,1);else for(;n.length<e.expressions.length;)n.splice(i,0,n[i])}else{const i=new jo(na(T));if(!Xe(Zs.cloneAsInstance(T),t,i,Re(e)))return;const r=fa(T,i);if(!r.typeArguments||1!==r.typeArguments.length)return;const s=ta(r.typeArguments[0]);for(let t=0;t<e.expressions.length;t++)n.push(s)}const i=e.expressions.map(((e,t)=>$(e,t<n.length?n[t]:void 0))),r=n.some((e=>sa(e)));return{type:Fa(Va(T,je(i),!0,!r)),node:e}}function je(e){const t=[];for(const n of e){let e;if(n.unpackedType?e=n.unpackedType:Co(n.type)&&(e=n.type),e&&vo(e)&&e.tupleTypeArguments){const n=e.tupleTypeArguments;n?t.push(...n):t.push({type:Ys.create(),isUnbounded:!0})}else t.push({type:n.type,isUnbounded:!!n.unpackedType})}if(t.filter((e=>e.isUnbounded)).length>1){const e=t.findIndex((e=>e.isUnbounded)),n=t.splice(e);t.push({type:Oo(n.map((e=>e.type))),isUnbounded:!0})}return t}function ze(e,t){const n=$(e.leftExpression,void 0,2),i=e.arguments.map((e=>({valueExpression:e.valueExpression,argumentCategory:e.argumentCategory,node:e,name:e.name})));let r={node:e,type:Ys.create()};if(ea(n.type))r.isIncomplete=!0;else{if(38===e.leftExpression.nodeType&&"super"===e.leftExpression.value)r=function(e){let t,n;if(e.arguments.length>2&&fe(ml.Diagnostic.superCallArgCount(),e.arguments[2]),e.arguments.length>0){t=$(e.arguments[0].valueExpression).type;const n=Ie(t);ho(n)||_o(n)||_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.superCallFirstArg().format({type:ai(t)}),e.arguments[0].valueExpression)}else{const n=Er(e);if(n){const e=$t(n);t=e?e.classType:Ys.create()}else fe(ml.Diagnostic.superCallZeroArgForm(),e.leftExpression),t=Ys.create()}if(e.arguments.length>1){const i=Ie($(e.arguments[1].valueExpression).type);let r=!1;ho(i)||(vo(i)?(_o(t)&&(Da(Zs.cloneAsInstantiable(i),t,!0)||(r=!0)),n=i):_o(i)?(_o(t)&&(Da(i,t,!0)||(r=!0)),n=i):r=!0),r&&_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.superCallSecondArg().format({type:ai(t)}),e.arguments[1].valueExpression)}else{const i=kr(e);let r;if(i){const e=Gt(i);if(e){const t=e.functionType;Xs.isClassMethod(t)?t.details.parameters.length>0&&t.details.parameters[0].hasDeclaredType&&(r=Ie(t.details.parameters[0].type)):Xs.isInstanceMethod(t)&&t.details.parameters.length>0&&t.details.parameters[0].hasDeclaredType&&(r=Ie(Na(t.details.parameters[0].type)))}}r&&_o(r)?n=r:_o(t)&&(n=t)}let i=!0;if(e.arguments.length<=1){const t=kr(e);if(t){const e=Gt(t);e&&(Xs.isStaticMethod(e.functionType)||Xs.isConstructorMethod(e.functionType)||Xs.isClassMethod(e.functionType))&&(i=!1)}}const r=e.parent;if(35===r.nodeType){const s=va(t,r.memberName.value,1);if(s&&_o(s.classType))return{type:i?Zs.cloneAsInstance(s.classType):s.classType,node:e,bindToType:i&&n&&_o(n)?Zs.cloneAsInstance(n):n,isSuperCall:!0}}if(_o(t)){if(t.details.mro.some((e=>ho(e))))return{type:Ys.create(),isSuperCall:!0,node:e};const n=t.details.baseClasses;if(n.length>0){const t=n[0];if(_o(t))return{type:i?Zs.cloneAsInstance(t):t,isSuperCall:!0,node:e}}}return{type:Ys.create(),isSuperCall:!0,node:e}}(e);else if(ho(n.type)&&38===e.leftExpression.nodeType&&"reveal_type"===e.leftExpression.value)r=$e(e,t);else if(Eo(n.type)&&"reveal_type"===n.type.details.builtInName)r=$e(e,t);else if(ho(n.type)&&38===e.leftExpression.nodeType&&"reveal_locals"===e.leftExpression.value)0===e.arguments.length?r.type=function(e){let t,n=e;for(;n&&(t=zs(n),!t||0===t.type);)n=n.parent;const i=[];return t&&t.symbolTable.forEach(((e,t)=>{if(!e.isIgnoredForProtocolMatch()){const n=Nn(e);i.push(ml.DiagnosticAddendum.typeOfSymbol().format({name:t,type:ai(n,!0)}))}})),i.length>0?me(i.join("\n"),e):me(ml.Diagnostic.revealLocalsNone(),e),to.createInstance()}(e):fe(ml.Diagnostic.revealLocalsArgs(),e);else{const s=et(e,i,n.type,void 0,!1,t);r.type=s.returnType||Ys.create(),s.argumentErrors&&(r.typeErrors=!0,t&&(r.isIncomplete=!0)),s.isTypeIncomplete&&(r.isIncomplete=!0)}n.isIncomplete&&(r.isIncomplete=!0)}return _o(n.type)&&Zs.isBuiltIn(n.type,"TypeVar")&&Vt(e).isTypingStubFile||i.forEach((e=>{e.valueExpression&&48!==e.valueExpression.nodeType&&!R(e.valueExpression)&&$(e.valueExpression)})),r}function $e(e,t){let n,i,r,s,o;if(e.arguments.forEach(((e,t)=>{if(0===t)0!==e.argumentCategory||e.name||(n=e.valueExpression);else if(0===e.argumentCategory&&e.name)if("expected_text"===e.name.value){s=e.valueExpression;const t=$(e.valueExpression).type;vo(t)&&Zs.isBuiltIn(t,"str")&&"string"==typeof t.literalValue?o=t.literalValue:fe(ml.Diagnostic.revealTypeExpectedTextArg(),e.valueExpression)}else"expected_type"===e.name.value&&(i=e.valueExpression,r=Fa(In(e).type));else n=void 0})),!n)return fe(ml.Diagnostic.revealTypeArgs(),e),{node:e,type:Ys.create()};const a=$(n,t),l=a.type,c=xr(n),u=ai(l,!0);if(void 0!==o&&o!==u&&fe(ml.Diagnostic.revealTypeExpectedTextMismatch().format({expected:o,received:u}),null!=s?s:n),r&&!Ao(r,l)){const e=ai(r);fe(ml.Diagnostic.revealTypeExpectedTypeMismatch().format({expected:e,received:u}),null!=i?i:n)}return me(ml.DiagnosticAddendum.typeOfSymbol().format({name:c,type:u}),e.arguments[0]),{node:e,type:l,isIncomplete:a.isIncomplete}}function He(e,t,n,i,r,s){const o=[],a=[];let l=!1;for(let r=0;r<t.length;r++){let c;const u=t[r],p=u.some((e=>void 0!==e));for(let t=0;t<n.length;t++){const r=n[t].overload;let d=n[t];p&&(d={...n[t]},d.argParams=d.argParams.map(((e,t)=>{if(!u[t])return e;const n={...e};return n.argType=u[t],n})));const h=i?i.clone():new jo(na(r));h.addSolveForScope(na(r));const m=kn(e,(()=>nt(e,d,h,!0,s)));if(m.isTypeIncomplete&&(l=!0),!m.argumentErrors&&m.returnType){c=r,a.push({overload:c,matchResults:d,typeVarMap:h}),o.push(m.returnType);break}}if(!c)return{argumentErrors:!0,isTypeIncomplete:l}}if(i)for(let n=0;n<t.length;n++){const t=a[n].overload,r=a[n].matchResults;kn(e,(()=>(i.addSolveForScope(na(t)),i.unlock(),nt(e,r,i,!0,s))))}a[0].typeVarMap.unlock();const c=nt(e,a[0].matchResults,a[0].typeVarMap,r,s);return c.isTypeIncomplete&&(l=!0),{argumentErrors:!1,returnType:Oo(o),isTypeIncomplete:l,specializedInitSelfType:c.specializedInitSelfType}}function Ge(e,t,n){let i,r=0,s=[];return t.overloads.forEach((t=>{kn(e,(()=>{if(Xs.isOverloaded(t)){const i=tt(e,n,t,r);i.argumentErrors||s.push(i),r++}}))})),s=Ke(s),s.forEach(((t,n)=>{void 0===i&&kn(e,(()=>{const r=it(e,t,new jo(na(t.overload)),!0);r&&!r.argumentErrors&&(i=n)}))})),void 0===i?void 0:s[i].overload}function Ke(e){return e.sort(((e,t)=>e.relevance!==t.relevance?t.relevance-e.relevance:e.overloadIndex-t.overloadIndex))}function Je(e,t){let n,i=e.length-1;for(;i>=0&&!t[0][i];)i--;if(i++,i>=e.length)return;for(;i<e.length;){const t=e[i];if(fo(t)){n=t;break}i++}if(!n)return;const r=[];return t.forEach((e=>{Jo(n,(t=>{const n=[...e];n[i]=t,r.push(n)}))})),r}function Ye(e,t,n,i,r){var s;let o,a=!1,l=!1,u=!1,p=!1;const d=e=>Eo(e)&&Xs.isSkipConstructorCheck(e),h=null===(s=ee(e,Zs.cloneAsInstance(n),"__init__",{method:"get"},void 0,68))||void 0===s?void 0:s.type;if(h&&!d(h)){if(r&&(o=Ko(r,(r=>{r=ta(r);const s=new jo(na(n));if(Xe(Zs.cloneAsInstance(n),r,s,Re(e))){let o;if(kn(e,(()=>{o=et(e,t,h,s.clone(),i,to.createInstance())})),!(null==o?void 0:o.argumentErrors))return et(e,t,h,s,i,to.createInstance()).isTypeIncomplete&&(u=!0),Qe(n,r,s)}})),ao(o)&&(o=void 0)),!o){const r=n.typeArguments?wa(n,!1):new jo(na(n));r.addSolveForScope(na(h));const s=et(e,t,h,r,i);if(s.argumentErrors)l=!0;else{let e=n;s.specializedInitSelfType&&vo(s.specializedInitSelfType)&&Zs.isSameGenericClass(s.specializedInitSelfType,n)&&(e=Zs.cloneAsInstantiable(s.specializedInitSelfType)),o=Ze(e,void 0,r),s.isTypeIncomplete&&(u=!0)}}a=!0,i=!0}if(!l){const s=n.details.effectiveMetaclass;let c;if(s&&_o(s)&&!Zs.isSameGenericClass(s,n)&&(c=Ne(e,s,"__call__",{method:"get"},void 0,352,n),c&&(p=!0)),c||(c=Ne(e,n,"__new__",{method:"get"},void 0,21,n)),c&&!d(c.type)){const s=new jo(na(n));n.typeAliasInfo&&s.addSolveForScope(n.typeAliasInfo.typeVarScopeId),s.addSolveForScope(na(c.type));const p=et(e,t,c.type,s,i);if(p.argumentErrors)l=!0;else{let e=p.returnType;p.isTypeIncomplete&&(u=!0),e&&(vo(e)&&Zs.isSameGenericClass(e,n)?(La(e)||$a(e))&&void 0!==o||(vo(e)&&Zs.isTupleClass(e)&&!e.tupleTypeArguments&&e.typeArguments&&1===e.typeArguments.length&&(e=Va(e,[{type:e.typeArguments[0],isUnbounded:!0}])),o=e):o||po(e)||(o=e))}o?vo(o)&&pa(o)&&!o.tupleTypeArguments&&(o=function(e,t){let n=e;return t&&vo(t)&&pa(t)&&t.tupleTypeArguments&&(n=Va(e,t.tupleTypeArguments)),n}(o,r)):o=Ze(n,r,s),a=!0}}if(a||t.forEach((e=>{e.valueExpression&&!c.isSpeculative(e.valueExpression)&&$(e.valueExpression)})),!a&&t.length>0&&(n.details.effectiveMetaclass&&_o(n.details.effectiveMetaclass)&&!Zs.isBuiltIn(n.details.effectiveMetaclass)||p||_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.constructorNoArgs().format({type:n.aliasName||n.details.name}),e)),!o)if(!r&&n.typeArguments)o=Fa(n);else{const t=new jo(na(n));r&&Xe(Zs.cloneAsInstance(n),r,t,Re(e)),o=Ze(n,r,t)}if(!l){const i=function(e,t,n,i,r){return"functools.partial"===i.details.fullName?function(e,t,n,i){if(!vo(i.returnType)||"functools.partial"!==i.returnType.details.fullName)return i;const r=_a(i.returnType,"__call__");if(!r||!Ao(Fa(r.classType),i.returnType))return i;const s=e.getTypeOfMember(r);if(!Eo(s)||s.details.parameters.length<1)return i;if(n.length<1)return i;const o=e.getTypeForArgument(n[0]).type;if(e.inferReturnTypeIfNecessary(o),!Eo(o))return i;if(n.some((e=>0!==e.argumentCategory)))return i;const a=new Map,l=Ho(o);let c=!1,u=!1;const p=new jo(na(o));n.slice(1).forEach(((n,i)=>{var r,s,d,h,m,f,g,y;const _=e.getTypeForArgument(n);if(n.name){const i=l.params.find((e=>{var t;return e.param.name===(null===(t=n.name)||void 0===t?void 0:t.value)&&e.source!==zo.PositionOnly}));if(i){const r=i.param.name,s=Xs.getEffectiveParameterType(o,i.index);if(a.has(r))e.addDiagnostic(Vt(t).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.paramAlreadyAssigned().format({name:n.name.value}),n.name),c=!0;else{const i=new il;e.canAssignType(s,_.type,i,p)||(e.addDiagnostic(Vt(t).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.argAssignmentParamFunction().format({argType:e.printType(_.type),paramType:e.printType(s),functionName:o.details.name,paramName:r}),null!==(y=n.valueExpression)&&void 0!==y?y:t),c=!0),a.set(r,!0)}}else if(void 0===l.kwargsIndex)e.addDiagnostic(Vt(t).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.paramNameMissing().format({name:n.name.value}),n.name),c=!0;else{const i=Xs.getEffectiveParameterType(o,l.params[l.kwargsIndex].index),r=new il;e.canAssignType(i,_.type,r,p)||(e.addDiagnostic(Vt(t).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.argAssignmentParamFunction().format({argType:e.printType(_.type),paramType:e.printType(i),functionName:o.details.name,paramName:null!==(f=l.params[l.kwargsIndex].param.name)&&void 0!==f?f:""}),null!==(g=n.valueExpression)&&void 0!==g?g:t),c=!0)}}else if(i>=l.params.length||l.params[i].source===zo.KeywordOnly)if(void 0!==l.argsIndex){const i=Xs.getEffectiveParameterType(o,l.params[l.argsIndex].index),a=new il;e.canAssignType(i,_.type,a,p)||(e.addDiagnostic(Vt(t).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.argAssignmentParamFunction().format({argType:e.printType(_.type),paramType:e.printType(i),functionName:o.details.name,paramName:null!==(r=l.params[l.argsIndex].param.name)&&void 0!==r?r:""}),null!==(s=n.valueExpression)&&void 0!==s?s:t),c=!0)}else u||e.addDiagnostic(Vt(t).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,1===l.positionParamCount?ml.Diagnostic.argPositionalExpectedOne():ml.Diagnostic.argPositionalExpectedCount().format({expected:l.positionParamCount}),null!==(d=n.valueExpression)&&void 0!==d?d:t),u=!0,c=!0;else{const r=Xs.getEffectiveParameterType(o,i),s=new il,u=null!==(h=l.params[i].param.name)&&void 0!==h?h:"";e.canAssignType(r,_.type,s,p)||(e.addDiagnostic(Vt(t).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.argAssignmentParamFunction().format({argType:e.printType(_.type),paramType:e.printType(r),functionName:o.details.name,paramName:u}),null!==(m=n.valueExpression)&&void 0!==m?m:t),c=!0),a.set(u,!1)}}));const d=fa(o,p);if(!Eo(d))return i;const h=d.details.parameters.map(((e,t)=>{const n={...e};return n.type=Xs.getEffectiveParameterType(d,t),e.name&&a.get(e.name)&&(n.hasDefault=!0),n})),m=[...h.filter((e=>!(2===e.category||1!==e.category&&e.name&&a.has(e.name)))),...h.filter((e=>e.name&&a.get(e.name))),...h.filter((e=>2===e.category))],f=Xs.createInstance(s.details.name,s.details.fullName,s.details.moduleName,s.details.flags,d.details.docString);s.details.parameters.length>0&&Xs.addParameter(f,s.details.parameters[0]),m.forEach((e=>{Xs.addParameter(f,e)})),f.details.declaredReturnType=d.details.declaredReturnType?Xs.getSpecializedReturnType(d):d.inferredReturnType,f.details.declaration=s.details.declaration,f.details.typeVarScopeId=d.details.typeVarScopeId;const g=Zs.cloneForSymbolTableUpdate(i.returnType);return g.details.fields.set("__call__",qo.createWithType(4,f)),{returnType:g,isTypeIncomplete:!1,argumentErrors:c}}(e,t,n,r):r}(li,e,t,n,{argumentErrors:l,returnType:o,isTypeIncomplete:u});o=i.returnType,i.isTypeIncomplete&&(u=!0),i.argumentErrors&&(l=!0)}return{argumentErrors:l,returnType:o,isTypeIncomplete:u}}function Qe(e,t,n){const i=fa(Zs.cloneAsInstance(e),n);if(Jn(t,i))return uo(t)?t:i}function Ze(e,t,n){if(t){const i=Ko(t,(t=>Qe(e,t,n)));if(!ao(i))return i}const i=fa(e,n,!0);return Zs.cloneAsInstance(i)}function Xe(e,t,n,i){if(uo(t))return e.details.typeParameters.forEach((e=>{n.setTypeVarType(e,t)})),!0;if(!yo(t))return!1;const r=t.typeArguments;if(!r)return Jn(e,t,void 0,n,1024);if(Zs.isSameGenericClass(t,e)){const i=wa(t);return i.getTypeVars().forEach((t=>{const r=i.getTypeVarType(t.typeVar);r&&(bo(r)&&r.scopeId===e.details.typeVarScopeId||n.setTypeVarType(t.typeVar,1===t.typeVar.details.variance?void 0:r,2===t.typeVar.details.variance?void 0:r,t.retainLiteral))})),!0}const s=na(t),o=Zs.getTypeParameters(t).map(((e,t)=>{const n=oo.createInstance(`__dest${t}`);return n.details.isSynthesized=!0,n.details.variance=0,n.scopeId=s,n})),a=Zs.cloneForSpecialization(t,o,!0),l=Zs.getTypeParameters(e).map(((e,t)=>{const n=oo.createInstance(`__source${t}`);return n.details.isSynthesized=!0,n.details.synthesizedIndex=t,n.details.isExemptFromBoundCheck=!0,n})),c=Zs.cloneForSpecialization(e,l,!0),u=new jo(s);if(Jn(a,c,void 0,u,1024)){let e=!0;return o.forEach(((t,s)=>{const o=u.getTypeVarType(t);if(o&&bo(o)&&o.details.isSynthesized&&void 0!==o.details.synthesizedIndex){const a=Zs.getTypeParameters(c)[o.details.synthesizedIndex];if(s<r.length){let o=r[s];i&&(o=function(e,t,n){return bo(e)?(i=e,n.some((e=>i.scopeId===e))?e:void 0):new Za(t,n).apply(e);var i}(o,n,i)),o?n.setTypeVarType(a,1===t.details.variance?void 0:o,2===t.details.variance?void 0:o):e=!1}}})),e}return!1}function et(e,t,n,i,r=!1,s,o=0){let a,l=!1,u=!1;if(o>Gs)return{returnType:Ys.create(),argumentErrors:!0};if(o++,Ks.isSpecialForm(n)){const t=9===e.nodeType?e.leftExpression:e;return _e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeNotCallable().format({expression:xr(t),type:ai(n,!0)}),t),{returnType:Ys.create(),argumentErrors:!0}}const p=Se(n,void 0,((n,p)=>{var d,h,m;switch(n.category){case 1:case 2:return t.forEach((e=>{e.valueExpression&&!c.isSpeculative(e.valueExpression)&&bn(e)})),n;case 5:{if("namedtuple"===n.details.builtInName)return _e(Vt(e).diagnosticRuleSet.reportUntypedNamedTuple,$o.reportUntypedNamedTuple,ml.Diagnostic.namedTupleNoTypes(),e),Lu(li,e,t,!1);let o=i;o||(o=new jo(na(n)),!o.getSolveForScopes()&&Xs.isConstructorMethod(n)&&o.addSolveForScope($s));const c=rt(e,t,n,o,r,s);if(c.isTypeIncomplete&&(u=!0),c.argumentErrors)l=!0;else{a=c.specializedInitSelfType;const i=zu(li,e,t,n,{argumentErrors:c.argumentErrors,returnType:null!==(d=c.returnType)&&void 0!==d?d:Ys.create(),isTypeIncomplete:u});c.returnType=i.returnType,i.isTypeIncomplete&&(u=!0),i.argumentErrors&&(l=!0)}return c.argumentErrors||"NewType"!==n.details.builtInName?"__import__"===n.details.builtInName?io.create():c.returnType:at(e,t)}case 6:{if("cast"===n.overloads[0].details.builtInName&&2===t.length){const n=In(t[0]).type,i=bn(t[1]).type;return _o(n)&&vo(i)&&Ao(n,Zs.cloneAsInstantiable(i),!0)&&_e(Vt(e).diagnosticRuleSet.reportUnnecessaryCast,$o.reportUnnecessaryCast,ml.Diagnostic.unnecessaryCast().format({type:ai(i)}),e),Fa(n)}const o=function(e,t,n,i,r,s){let o=[],a=[];if(kn(e,(()=>{let i=0;n.overloads.forEach((n=>{if(Xs.isOverloaded(n)){const r=tt(e,t,n,i);r.argumentErrors||o.push(r),i++}})),a=t.map((e=>{if(e.type)return e.type;if(e.valueExpression){const t=e.valueExpression;return kn(t,(()=>$(t).type))}return io.create()}))})),o=Ke(o),0===o.length){if(!ye(e)){const i=n.overloads[0].details.name||"<anonymous function>",r=new il,s=t.map((e=>ai(bn(e).type)));r.addMessage(ml.DiagnosticAddendum.argumentTypes().format({types:s.join(", ")})),_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.noOverload().format({name:i})+al(r),e)}return{argumentErrors:!0,isTypeIncomplete:!1}}const l=t=>{const n=o.reduce(((e,t)=>t.overloadIndex>e.overloadIndex?t:e)),r=null!=i?i:new jo;return r.addSolveForScope(na(n.overload)),r.unlock(),nt(e,n,r,t,s)};if(1===o.length)return l(!1);let c=[t.map((e=>{}))],u=!1;for(;;){const t=He(e,c,o,i,r,s);if(t.isTypeIncomplete&&(u=!0),!t.argumentErrors)return t;if(c=Je(a,c),!c||c.length>64)break}if(!ye(e)&&!u){const e=l(!0);return e.returnType=Ys.create(),e}return{argumentErrors:!0,isTypeIncomplete:!1}}(e,t,n,i,r,s);if(o.isTypeIncomplete&&(u=!0),o.argumentErrors)l=!0;else{a=o.specializedInitSelfType;const i=zu(li,e,t,n,{argumentErrors:o.argumentErrors,returnType:null!==(h=o.returnType)&&void 0!==h?h:Ys.create(),isTypeIncomplete:u});o.returnType=i.returnType,i.isTypeIncomplete&&(u=!0),i.argumentErrors&&(l=!0)}return o.returnType||Ys.create()}case 7:if(Ks.isInstantiable(n)){if(void 0!==n.literalValue)return _e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.literalNotCallable(),e),l=!0,Ys.create();if(Zs.isBuiltIn(n)){const i=n.aliasName||n.details.name;if("type"===i)return Ye(e,t,n,r,s),1===t.length?Ko(bn(t[0]).type,(e=>vo(e)||bo(e)&&Ks.isInstance(e)||lo(e)?Na(Qo(e)):io.create())):t.length>=2&&function(e,t){const n=Vt(e),i=bn(t[0]).type;if(!vo(i)||!Zs.isBuiltIn(i,"str"))return;const r=i.literalValue||"_",s=bn(t[1]).type;if(!vo(s)||!pa(s)||void 0===s.tupleTypeArguments)return;const o=Zs.createInstantiable(r,br(e,n.moduleName,r),n.moduleName,n.filePath,0,Ir(e),void 0,s.details.effectiveMetaclass);return s.tupleTypeArguments.forEach((n=>{_o(n.type)||ho(n.type)?o.details.baseClasses.push(n.type):ve(n.type,t[1].valueExpression||e)})),Ha(o)||fe(ml.Diagnostic.methodOrdering(),e),o}(e,t)||io.create();if("TypeVar"===i)return function(e,t){var n,i,r;let s,o="";if(0===t.length)return void fe(ml.Diagnostic.typeVarFirstArg(),e);const a=t[0];a.valueExpression&&48===a.valueExpression.nodeType?o=a.valueExpression.strings.map((e=>e.value)).join(""):fe(ml.Diagnostic.typeVarFirstArg(),a.valueExpression||e);const l=oo.createInstantiable(o,!1);for(let o=1;o<t.length;o++){const a=t[o].name,c=a?a.value:void 0,u=new Map;if(c){if(u.get(c)&&fe(ml.Diagnostic.duplicateParam().format({name:c}),t[o].valueExpression||e),"bound"===c)if(l.details.constraints.length>0)fe(ml.Diagnostic.typeVarBoundAndConstrained(),t[o].valueExpression||e);else{const i=null!==(n=t[o].type)&&void 0!==n?n:Sn(t[o].valueExpression,void 0,void 0,!0).type;$a(i,!0)&&fe(ml.Diagnostic.typeVarGeneric(),t[o].valueExpression||e),l.details.boundType=Fa(i)}else"covariant"===c?t[o].valueExpression&&ot(t[o].valueExpression)&&(2===l.details.variance?fe(ml.Diagnostic.typeVarVariance(),t[o].valueExpression):l.details.variance=1):"contravariant"===c?t[o].valueExpression&&ot(t[o].valueExpression)&&(1===l.details.variance?fe(ml.Diagnostic.typeVarVariance(),t[o].valueExpression):l.details.variance=2):fe(ml.Diagnostic.typeVarUnknownParam().format({name:c}),(null===(i=t[o].node)||void 0===i?void 0:i.name)||t[o].valueExpression||e);u.set(c,c)}else if(l.details.boundType)fe(ml.Diagnostic.typeVarBoundAndConstrained(),t[o].valueExpression||e);else{const n=null!==(r=t[o].type)&&void 0!==r?r:Sn(t[o].valueExpression,void 0,void 0,!0).type;$a(n,!0)&&fe(ml.Diagnostic.typeVarGeneric(),t[o].valueExpression||e),oo.addConstraint(l,Fa(n)),void 0===s&&(s=t[o])}}return 1===l.details.constraints.length&&s&&_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeVarSingleConstraint(),s.valueExpression||e),l}(e,t);if("TypeVarTuple"===i)return function(e,t){var n,i;let r="";if(0===t.length)return void fe(ml.Diagnostic.typeVarFirstArg(),e);const s=t[0];s.valueExpression&&48===s.valueExpression.nodeType?r=s.valueExpression.strings.map((e=>e.value)).join(""):fe(ml.Diagnostic.typeVarFirstArg(),s.valueExpression||e);const o=oo.createInstantiable(r,!1);o.details.isVariadic=!0;for(let r=1;r<t.length;r++)fe(ml.Diagnostic.typeVarUnknownParam().format({name:(null===(n=t[r].name)||void 0===n?void 0:n.value)||"?"}),(null===(i=t[r].node)||void 0===i?void 0:i.name)||t[r].valueExpression||e);return o}(e,t);if("ParamSpec"===i)return function(e,t){var n,i;if(0===t.length)return void fe(ml.Diagnostic.paramSpecFirstArg(),e);const r=t[0];let s="";r.valueExpression&&48===r.valueExpression.nodeType?s=r.valueExpression.strings.map((e=>e.value)).join(""):fe(ml.Diagnostic.paramSpecFirstArg(),r.valueExpression||e);const o=oo.createInstantiable(s,!0);for(let r=1;r<t.length;r++){if(!(null===(n=t[r].name)||void 0===n?void 0:n.value)){fe(ml.Diagnostic.paramSpecUnknownArg(),t[r].valueExpression||e);break}fe(ml.Diagnostic.paramSpecUnknownParam().format({name:t[r].name.value}),(null===(i=t[r].node)||void 0===i?void 0:i.name)||t[r].valueExpression||e)}return o}(e,t);if("NamedTuple"===i)return Lu(li,e,t,!0);if("NewType"===i)return at(e,t);if("Protocol"===i||"Generic"===i||"Callable"===i||"Concatenate"===i||"Type"===i)return _e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeNotIntantiable().format({type:i}),e),io.create();if("Enum"===i||"IntEnum"===i||"StrEnum"===i||"Flag"===i||"IntFlag"===i)return function(e,t,n){const i=Vt(e);let r="enum";if(0===n.length)return;{const e=n[0];if(0!==e.argumentCategory||!e.valueExpression||48!==e.valueExpression.nodeType)return;r=e.valueExpression.strings.map((e=>e.value)).join("")}const s=Zs.createInstantiable(r,br(e,i.moduleName,r),i.moduleName,i.filePath,1048576,Ir(e),void 0,t.details.effectiveMetaclass);s.details.baseClasses.push(t),Ha(s);const o=s.details.fields;if(o.set("__class__",qo.createWithType(68,s)),!(n.length<2)){{const t=n[1];if(0!==t.argumentCategory||!t.valueExpression||48!==t.valueExpression.nodeType)return;t.valueExpression.strings.map((e=>e.value)).join("").split(" ").forEach((n=>{if(n=n.trim()){const i=Ys.create(),r=qo.createWithType(4,i),s=t.valueExpression;w(48===s.nodeType);const a=Vt(e),l={type:1,node:s,isRuntimeTypeExpression:!0,path:a.filePath,range:St(s.start,dt.getEnd(s),a.lines),moduleName:a.moduleName,isInExceptSuite:!1};r.addDeclaration(l),o.set(n,r)}}))}return s}}(e,n,t);if("TypedDict"===i)return function(e,t,n,i){const r=Vt(t);let s="TypedDict";if(0===i.length)e.addError(ml.Diagnostic.typedDictFirstArg(),t);else{const n=i[0];0===n.argumentCategory&&n.valueExpression&&48===n.valueExpression.nodeType?s=n.valueExpression.strings.map((e=>e.value)).join(""):e.addError(ml.Diagnostic.typedDictFirstArg(),i[0].valueExpression||t)}const o=Zs.createInstantiable(s,br(t,r.moduleName,s),r.moduleName,r.filePath,128,Ir(t),void 0,n.details.effectiveMetaclass);o.details.baseClasses.push(n),Ha(o);const a=o.details.fields;a.set("__class__",qo.createWithType(68,o));let l=!1;if(i.length<2)e.addError(ml.Diagnostic.typedDictSecondArgDict(),t);else{const n=i[1],s=new Map;if(0===n.argumentCategory&&n.valueExpression&&15===n.valueExpression.nodeType){l=!0;const t=n.valueExpression;t.entries.forEach((t=>{if(17!==t.nodeType)return void e.addError(ml.Diagnostic.typedDictSecondArgDictEntry(),t);if(48!==t.keyExpression.nodeType)return void e.addError(ml.Diagnostic.typedDictEntryName(),t.keyExpression);const n=t.keyExpression.strings.map((e=>e.value)).join("");if(!n)return void e.addError(ml.Diagnostic.typedDictEmptyName(),t.keyExpression);if(s.has(n))return void e.addError(ml.Diagnostic.typedDictEntryUnique(),t.keyExpression);s.set(n,!0);const i=e.getTypeForExpressionExpectingType(t.valueExpression,!0,!0),o=new qo(8),l={type:1,node:t.keyExpression,path:r.filePath,typeAnnotationNode:t.valueExpression,isRequired:i.isRequired,isNotRequired:i.isNotRequired,isRuntimeTypeExpression:!0,range:St(t.keyExpression.start,dt.getEnd(t.keyExpression),r.lines),moduleName:r.moduleName,isInExceptSuite:!1};o.addDeclaration(l),a.set(n,o)})),e.setTypeForNode(t)}else if(n.name)for(let n=1;n<i.length;n++){const r=i[n];if(!r.name||!r.valueExpression)continue;if(s.has(r.name.value)){e.addError(ml.Diagnostic.typedDictEntryUnique(),r.valueExpression);continue}s.set(r.name.value,!0);const o=e.getTypeForExpressionExpectingType(r.valueExpression,!0,!0),l=new qo(8),c=Vt(t),u={type:1,node:r.name,path:c.filePath,typeAnnotationNode:r.valueExpression,isRequired:o.isRequired,isNotRequired:o.isNotRequired,isRuntimeTypeExpression:!0,range:St(r.name.start,dt.getEnd(r.valueExpression),c.lines),moduleName:c.moduleName,isInExceptSuite:!1};l.addDeclaration(u),a.set(r.name.value,l)}else e.addError(ml.Diagnostic.typedDictSecondArgDict(),t)}return l&&(i.length>=3&&(!i[2].name||"total"!==i[2].name.value||!i[2].valueExpression||11!==i[2].valueExpression.nodeType||15!==i[2].valueExpression.constType&&33!==i[2].valueExpression.constType?e.addError(ml.Diagnostic.typedDictTotalParam(),i[2].valueExpression||t):15===i[2].valueExpression.constType&&(o.details.flags|=256)),i.length>3&&e.addError(ml.Diagnostic.typedDictExtraArgs(),i[3].valueExpression||t)),fl(e,t,o),o}(li,e,n,t);if("auto"===i&&0===t.length)return Cn(e,"int")}if(Zs.supportsAbstractMethods(n)){const t=ii(n);if(t.length>0&&!n.includeSubclasses&&!bo(p)){const i=new il,r=2;t.forEach(((e,n)=>{if(n===r)i.addMessage(ml.DiagnosticAddendum.memberIsAbstractMore().format({count:t.length-r}));else if(n<r&&_o(e.classType)){const t=e.classType.details.name;i.addMessage(ml.DiagnosticAddendum.memberIsAbstract().format({type:t,name:e.symbolName}))}})),_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.instantiateAbstract().format({type:n.details.name})+i.getString(),e)}}Zs.isProtocolClass(n)&&!n.includeSubclasses&&_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.instantiateProtocol().format({type:n.details.name}),e);const i=Ye(e,t,n,r,s);i.argumentErrors&&(l=!0),i.isTypeIncomplete&&(u=!0);let o=i.returnType;if(bo(p)&&(o=Fa(p)),o&&vo(o)&&o.details.mro.some((e=>_o(e)&&Zs.isBuiltIn(e,"type")))){let i="__class_"+o.details.name;if(3===t.length){const e=bn(t[0]).type;vo(e)&&Zs.isBuiltIn(e,"str")&&"string"==typeof e.literalValue&&(i=e.literalValue)}const r=Zs.createInstantiable(i,"","",Vt(e).filePath,0,Ir(e),Zs.cloneAsInstantiable(o),Zs.cloneAsInstantiable(o));return r.details.baseClasses.push(xn(e,"object")),r.details.effectiveMetaclass=n,Ha(r),r}return o}{let a=null===(m=ee(e,n,"__call__"))||void 0===m?void 0:m.type;if(a&&(Eo(a)||ko(a))){a=Ba(a);const n=et(e,t,a,i,r,s,o);return n.argumentErrors&&(l=!0),n.returnType||Ys.create()}return a&&ho(a)||_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.objectNotCallable().format({type:ai(n)}),e),Ys.create()}case 3:return void _e(Vt(e).diagnosticRuleSet.reportOptionalCall,$o.reportOptionalCall,ml.Diagnostic.noneNotCallable(),e);case 10:{n=ta(n);const a=et(e,t,n,i,r,s,o);return a.argumentErrors&&(l=!0),a.returnType||Ys.create()}case 8:return void _e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.moduleNotCallable(),e)}}));return{argumentErrors:l,returnType:ao(p)&&!p.isNoReturn?void 0:p,isTypeIncomplete:u,specializedInitSelfType:a}}function tt(e,t,n,i){var r;const s=Ho(n);let o=0,a=!1,l=!1,u=!1,p=!1;const d=new Map;s.params.forEach((e=>{const t=e.param;t.name&&0===t.category&&d.set(t.name,{argsNeeded:0!==t.category||t.hasDefault?0:1,argsReceived:0,isPositionalOnly:e.source===zo.PositionOnly})}));let h=s.positionOnlyParamCount,m=null!==(r=s.firstKeywordOnlyIndex)&&void 0!==r?r:s.params.length;const f=s.argsIndex,g=s.kwargsIndex;let y,_,v=!1;if(void 0!==f&&void 0!==g){w(s.params[f],"varArgListParamIndex params entry is undefined");const e=s.params[f].param;w(s.params[g],"varArgDictParamIndex params entry is undefined");const t=s.params[g].param;wo(e.type)&&"args"===e.type.paramSpecAccess&&wo(t.type)&&"kwargs"===t.type.paramSpecAccess&&e.type.details.name===t.type.details.name&&(v=!0,e.type.scopeId===n.details.typeVarScopeId?(y=[],_=oo.cloneForParamSpecAccess(e.type,void 0)):h=f)}t.forEach((e=>{if(e.name){const t=s.params.findIndex((t=>t.param.name===e.name.value&&0===t.param.category));t>=0&&t>=h&&(m<0||t<m)&&(m=t)}})),m<0&&(m=s.params.length);let b=t.findIndex((e=>2===e.argumentCategory||void 0!==e.name));b<0&&(b=t.length);let I,S=[];function x(e,t){e.active&&(I=t)}let C=void 0!==t.find((e=>1===e.argumentCategory)),E=0,k=0;for(;o<b;){if(o<h&&t[o].name&&(_e(Vt(t[o].name).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.argPositional(),t[o].name),l=!0),E>=m){C&&1===t[o].argumentCategory||(_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,1===m?ml.Diagnostic.argPositionalExpectedOne():ml.Diagnostic.argPositionalExpectedCount().format({expected:m}),t[o].valueExpression||e),l=!0);break}if(E>=s.params.length)break;w(s.params[E],"paramIndex params entry is undefined");const i=s.params[E].type;if(1===t[o].argumentCategory){if(!t[o].valueExpression)break;const r=1===s.params[E].param.category&&Io(i);let c=!1;const h=bn(t[o]),f=h.type;let g,_=!1;n.details.paramSpec&&E<m&&(_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,1===m?ml.Diagnostic.argPositionalExpectedOne():ml.Diagnostic.argPositionalExpectedCount().format({expected:m}),t[o].valueExpression||e),l=!0);const v=qa(Ie(f),T);!r&&v&&vo(v)&&v.tupleTypeArguments&&v.tupleTypeArguments.length>0&&k<v.tupleTypeArguments.length?(g=v.tupleTypeArguments[k].type,C=void 0!==t.find(((e,t)=>t>o&&1===e.argumentCategory)),k++,k>=v.tupleTypeArguments.length&&(k=0,_=!0)):r&&Io(f)?(g=f,c=!0,_=!0,p=!0):vo(f)&&pa(f)&&f.tupleTypeArguments&&1===f.tupleTypeArguments.length&&Io(f.tupleTypeArguments[0].type)?(g=f.tupleTypeArguments[0].type,c=!0,_=!0,p=!0):wo(f)&&"args"===f.paramSpecAccess?g=void 0:(g=ae(f,!1,t[o].valueExpression)||Ys.create(),1!==s.params[E].param.category&&(a=!0));const b=g?{argumentCategory:0,type:g}:void 0;b&&h.isIncomplete&&(u=!0);const I=s.params[E].param.name;r&&!c?(_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.unpackedArgWithVariadicParam(),t[o].valueExpression||e),l=!0):(y&&y.push(t[o]),b&&S.push({paramCategory:s.params[E].param.category,paramType:i,requiresTypeVarMatching:$a(i),argument:b,errorNode:t[o].valueExpression||e,paramName:s.params[E].param.isNameSynthesized?void 0:I})),x(t[o],s.params[E].param),I&&0===s.params[E].param.category&&d.has(I)&&d.get(I).argsReceived++,(_||1===s.params[E].param.category)&&o++,(p||1!==s.params[E].param.category)&&E++}else if(1===s.params[E].param.category)if(x(t[o],s.params[E].param),y)y.push(t[o]),o++;else{let n=s.params[E].param.category,r=i;const a=s.params[E].param.name;xo(i)&&i.tupleTypeArguments&&i.tupleTypeArguments.length>0&&(r=i.tupleTypeArguments[0].type),n=Io(r)?1:0;const c=b-o,u=m-E-1;c<=u?(c<u&&(_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,1===c?ml.Diagnostic.argMorePositionalExpectedOne():ml.Diagnostic.argMorePositionalExpectedCount().format({expected:c}),t[o].valueExpression||e),l=!0),E++):(S.push({paramCategory:n,paramType:r,requiresTypeVarMatching:$a(i),argument:t[o],errorNode:t[o].valueExpression||e,paramName:a,mapsToVarArgList:!0}),o++)}else{const n=s.params[E].param.name;S.push({paramCategory:s.params[E].param.category,paramType:i,requiresTypeVarMatching:$a(i),argument:t[o],errorNode:t[o].valueExpression||e,paramName:s.params[E].param.isNameSynthesized?void 0:n}),x(t[o],s.params[E].param),n&&d.has(n)&&d.get(n).argsReceived++,o++,E++}}if(h>=0&&E<h&&(!C||v)){const n=s.params.findIndex((e=>e.param.hasDefault)),i=(n>=0&&n<h?n:h)-b;i>0&&(_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,1===i?ml.Diagnostic.argMorePositionalExpectedOne():ml.Diagnostic.argMorePositionalExpectedCount().format({expected:i}),t.length>b&&t[b].valueExpression||e),l=!0)}if(!l){let i;for(;o<t.length;){if(2===t[o].argumentCategory){const n=bn(t[o]).type;if(ho(n))i=n;else if(vo(n)&&Zs.isTypedDictClass(n)){const i=gl(li,n),r=new il;i.forEach(((n,i)=>{const a=d.get(i);if(a&&!a.isPositionalOnly)if(a.argsReceived>0)r.addMessage(ml.Diagnostic.paramAlreadyAssigned().format({name:i}));else{a.argsReceived++;const r=s.params.findIndex((e=>e.param.name===i));w(r>=0);const l=s.params[r].type;S.push({paramCategory:0,paramType:l,requiresTypeVarMatching:$a(l),argument:{argumentCategory:0,type:n.valueType},errorNode:t[o].valueExpression||e,paramName:i})}else if(void 0!==s.kwargsIndex){const r=s.params[s.kwargsIndex].type;S.push({paramCategory:2,paramType:r,requiresTypeVarMatching:$a(r),argument:{argumentCategory:0,type:n.valueType},errorNode:t[o].valueExpression||e,paramName:i}),d.set(i,{argsNeeded:1,argsReceived:1,isPositionalOnly:!1})}else r.addMessage(ml.Diagnostic.paramNameMissing().format({name:i}))})),r.isEmpty()||(_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.unpackedTypedDictArgument()+r.getString(),t[o].valueExpression||e),l=!0)}else if(wo(n)&&"kwargs"===n.paramSpecAccess)i=io.create();else{const r=ce(e,"Mapping"),s=Cn(e,"str");if(r&&_o(r)&&s&&vo(s)){const a=new jo(na(r));let c=!1;if(bo(n))c=!0;else if(Jn(Zs.cloneAsInstance(r),n,void 0,a)){const e=fa(r,a).typeArguments;e&&e.length>=2?(Jn(s,e[0])&&(c=!0),i=e[1]):(c=!0,i=Ys.create())}c||(_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.unpackedDictArgumentNotMapping(),t[o].valueExpression||e),l=!0)}}y&&y.push(t[o])}else{const n=t[o].name;if(n){const i=n.value,r=d.get(i);if(r&&!r.isPositionalOnly)if(r.argsReceived>0)_e(Vt(n).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.paramAlreadyAssigned().format({name:i}),n),l=!0;else{r.argsReceived++;const n=s.params.findIndex((e=>e.param.name===i));w(n>=0);const a=s.params[n].type;S.push({paramCategory:0,paramType:a,requiresTypeVarMatching:$a(a),argument:t[o],errorNode:t[o].valueExpression||e,paramName:i}),x(t[o],s.params[n].param)}else if(void 0!==s.kwargsIndex){if(y)y.push(t[o]);else{const n=s.params[s.kwargsIndex].type;S.push({paramCategory:2,paramType:n,requiresTypeVarMatching:$a(n),argument:t[o],errorNode:t[o].valueExpression||e,paramName:i}),d.set(i,{argsNeeded:1,argsReceived:1,isPositionalOnly:!1})}w(s.params[s.kwargsIndex],"paramDetails.kwargsIndex params entry is undefined"),x(t[o],s.params[s.kwargsIndex].param)}else _e(Vt(n).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.paramNameMissing().format({name:n.value}),n),l=!0}else 0===t[o].argumentCategory&&(_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,1===m?ml.Diagnostic.argPositionalExpectedOne():ml.Diagnostic.argPositionalExpectedCount().format({expected:m}),t[o].valueExpression||e),l=!0)}o++}if(!i||C&&void 0===s.argsIndex||s.params.forEach(((n,r)=>{var o,a;const l=n.param;if(r>=s.firstPositionOrKeywordIndex&&0===l.category&&l.name&&!l.hasDefault&&d.has(l.name)&&0===d.get(l.name).argsReceived){const n=s.params[r].type;S.push({paramCategory:0,paramType:n,requiresTypeVarMatching:$a(n),argument:{argumentCategory:0,type:i},errorNode:null!==(a=null===(o=t.find((e=>2===e.argumentCategory)))||void 0===o?void 0:o.valueExpression)&&void 0!==a?a:e,paramName:l.isNameSynthesized?void 0:l.name}),d.get(l.name).argsReceived=1}})),!i&&!Xs.isDefaultParameterCheckDisabled(n)){const t=[...d.keys()].filter((e=>{const t=d.get(e);return!t||t.argsReceived<t.argsNeeded}));if(t.length>0){const n=t.map((e=>`"${e}"`)).join(", ");_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,1===t.length?ml.Diagnostic.argMissingForParam().format({name:n}):ml.Diagnostic.argMissingForParams().format({names:n}),e),l=!0}s.params.forEach((t=>{const n=t.param;if(0===n.category&&n.name){const t=d.get(n.name);0===t.argsNeeded&&0===t.argsReceived&&n.defaultType&&!ca(n.defaultType)&&$a(n.type)&&S.push({paramCategory:n.category,paramType:n.type,requiresTypeVarMatching:!0,argument:{argumentCategory:0,type:n.defaultType},errorNode:e,paramName:n.isNameSynthesized?void 0:n.name})}}))}}if((!l||!c.isSpeculative(void 0))&&void 0!==s.argsIndex&&s.argsIndex>=0&&s.params[s.argsIndex].param.hasDeclaredType&&!p){const t=s.params[s.argsIndex].type,n=S.filter((e=>e.mapsToVarArgList));if(bo(t)&&t.details.isVariadic&&T&&_o(T)){const i=n.map((t=>{var n;const i=bn(t.argument).type;return(So(i)||vo(i)&&pa(i)&&i.tupleTypeArguments&&i.tupleTypeArguments.some((e=>So(e.type))))&&1!==t.argument.argumentCategory&&_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeVarTupleMustBeUnpacked(),null!==(n=t.argument.valueExpression)&&void 0!==n?n:e),{type:Qo(i),isUnbounded:1===t.argument.argumentCategory}})),r={paramCategory:1,paramType:t,requiresTypeVarMatching:!0,argument:{argumentCategory:0,type:Zs.cloneAsInstance(Va(T,i,!0,!0,!0))},errorNode:e,paramName:s.params[s.argsIndex].param.name,mapsToVarArgList:!0};S=[...S.filter((e=>!e.mapsToVarArgList)),r]}}let D=0;return a&&D--,["isinstance","issubclass"].some((e=>e===n.details.builtInName))&&2===S.length&&(S[1].expectingType=!0),{overload:n,overloadIndex:i,argumentErrors:l,isTypeIncomplete:u,argParams:S,paramSpecTarget:_,paramSpecArgList:y,activeParam:I,relevance:D}}function nt(e,t,n,i=!1,r){const s=t.overload;if(!r||ho(r)||ao(r)||$a(r)||!s.details.declaredReturnType)return it(e,t,n,i);const o=Un(s);let a=r,l=4;if(oa(a,!0)&&(l|=128),fo(r)){let r;kn(e,(()=>{const s=n.clone();Jn(o,a,void 0,s,1024|l),r=it(e,t,s,i)})),r&&r.argumentErrors&&(a=void 0)}if(a){if(vo(o)&&vo(a)&&!Zs.isSameGenericClass(o,a)){const t=new jo(na(o));Xe(o,a,t,Re(e));const n=Zs.cloneForSpecialization(o,void 0,!1);a=fa(n,t)}Jn(o,a,void 0,n,1024|l)}return it(e,t,n,i)}function it(e,t,n,i=!1){const r=t.overload;let s,o=t.isTypeIncomplete,a=!1;const l=Xo(r);if(r.boundTypeVarScopeId&&(void 0!==r.preBoundFlags&&r.boundToType&&$a(r.boundToType)&&6&r.preBoundFlags&&n.addSolveForScope(r.boundTypeVarScopeId),"__init__"===r.details.name&&Xs.isOverloaded(r)&&r.strippedFirstParamType&&r.boundToType&&vo(r.strippedFirstParamType)&&vo(r.boundToType)&&Zs.isSameGenericClass(r.strippedFirstParamType,r.boundToType)&&r.strippedFirstParamType.typeArguments)){const e=r.strippedFirstParamType.details.typeParameters;s=r.strippedFirstParamType,r.strippedFirstParamType.typeArguments.forEach(((t,i)=>{i<e.length&&(Ao(e[i],t,!0)||n.setTypeVarType(e[i],t))}))}["cast","isinstance","issubclass"].some((e=>e===r.details.builtInName))&&(i=!0);const c=t.argParams.filter((e=>e.requiresTypeVarMatching)).length;if(c>0){let s=Math.min(c,2);for(let a=0;a<s;a++)kn(e,(()=>{t.argParams.forEach((e=>{if(e.requiresTypeVarMatching){const t=st(e,n,r,i,0===a,s>1&&0===a,l);t.isTypeIncomplete&&(o=!0),0===a&&t.skippedOverloadArg&&s++}}))}));n.lock()}t.argParams.forEach((e=>{const t=st(e,n,r,i,!1,!1,l);t.isCompatible||(a=!0),t.isTypeIncomplete&&(o=!0)})),t.paramSpecArgList&&t.paramSpecTarget&&(function(e,t,n,i,r){var s;const o=i.getParamSpec(n);if(!o)return _e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.paramSpecNotBound().format({type:ai(n)}),(null===(s=t[0])||void 0===s?void 0:s.valueExpression)||e),!1;i.addSolveForScope(o.typeVarScopeId);let a=!1;const l=new Map,c=o.parameters;c.forEach((e=>{e.name&&l.set(e.name,e)}));let u=0,p=c.findIndex((e=>0!==e.category));p<0&&(p=c.length);const d=c.find((e=>1===e.category)),h=c.find((e=>2===e.category));if(t.forEach((t=>{if(0===t.argumentCategory){let n;if(t.name){const i=l.get(t.name.value);i?(n=i.type,l.delete(t.name.value)):h?n=h.type:(_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.paramNameMissing().format({name:t.name.value}),t.valueExpression||e),a=!0)}else{if(u<p){const e=c[u];n=e.type,e.name&&l.delete(e.name)}else d?n=d.type:(_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,1===c.length?ml.Diagnostic.argPositionalExpectedOne():ml.Diagnostic.argPositionalExpectedCount().format({expected:c.length}),t.valueExpression||e),a=!0);u++}n&&(st({paramCategory:0,paramType:n,requiresTypeVarMatching:!1,argument:t,errorNode:t.valueExpression||e},i,void 0,!1,!1,!1,r)||(a=!0))}else l.clear()})),!a){let t=[...l.keys()];if(t=t.filter((e=>{const t=l.get(e);return 0===t.category&&!t.hasDefault})),t.length>0&&!o.paramSpec){const n=t.map((e=>`"${e}"`)).join(", ");_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,1===t.length?ml.Diagnostic.argMissingForParam().format({name:n}):ml.Diagnostic.argMissingForParams().format({names:n}),e),a=!0}}return!a}(e,t.paramSpecArgList,t.paramSpecTarget,n,l)||(a=!0));const u=Un(r,t.argParams);let p=!0,d=e;for(;;){const e=Pr(d);if(!e)break;const t=Pe(e);n.hasSolveForScope(t)&&(p=!1),d=e}(Eo(u)||ko(u))&&(p=!1);let h=Zo(fa(u,n,!1,!1,p),l);return xo(h)&&(h=Zs.cloneForUnpacked(h,!1)),vo(h)&&Zs.isBuiltIn(h,["TypeGuard","StrictTypeGuard"])&&h.typeArguments&&h.typeArguments.length>0&&b&&_o(b)&&(h=Zs.cloneAsInstance(Zs.cloneForTypeGuard(b,h.typeArguments[0],Zs.isBuiltIn(h,"StrictTypeGuard")))),Eo(h)&&!h.details.name&&(h.details={...h.details,typeVarScopeId:$s}),s&&(s=fa(s,n)),{argumentErrors:a,returnType:h,isTypeIncomplete:o,activeParam:t.activeParam,specializedInitSelfType:s}}function rt(e,t,n,i,r=!1,s){const o=tt(e,t,n,0);return o.argumentErrors?(d.isUndoTrackingEnabled()||t.forEach((e=>{e.valueExpression&&!c.isSpeculative(e.valueExpression)&&$(e.valueExpression)})),{argumentErrors:!0,activeParam:o.activeParam}):nt(e,o,i,r,s)}function st(e,t,n,i,r,s,o){let a,l,u=!1,p=!0;const d=null==n?void 0:n.details.name;if(e.argument.valueExpression){let i=bo(e.paramType)&&void 0!==n&&e.paramType.scopeId===n.details.typeVarScopeId?void 0:fa(e.paramType,t,!1,s);if(i&&po(i)&&(i=void 0),e.argType)a=e.argType;else{const t=e.expectingType?168:0,n=$(e.argument.valueExpression,i,t);a=n.type,n.isIncomplete&&(u=!0),n.typeErrors&&(p=!1),l=n.expectedTypeDiagAddendum}e.argument&&e.argument.name&&!c.isSpeculative(e.errorNode)&&N(e.argument.name,i||a,0,u)}else if(e.argType)a=e.argType;else if(e.expectingType&&!e.argument.type&&e.argument.valueExpression){const t=$(e.argument.valueExpression,void 0,168);a=t.type,t.isIncomplete&&(u=!0)}else{const t=bn(e.argument);a=t.type,t.isIncomplete&&(u=!0)}2===e.paramCategory&&bo(e.paramType)&&(a=Qo(a)),o&&(a=Se(a,o,(e=>e)));let h=new il;if(wo(e.paramType)&&void 0!==e.paramType.paramSpecAccess)return{isCompatible:p,isTypeIncomplete:u};if(r){if(ko(a))return{isCompatible:p,isTypeIncomplete:u,skippedOverloadArg:!0};const t=Ie(e.paramType);if(Eo(t)||ko(t)){if(_o(a)){const e=Zn(a);if(e&&ko(e))return{isCompatible:p,isTypeIncomplete:u,skippedOverloadArg:!0}}if(vo(a)){const e=_a(a,"__call__");if(e&&ko(Bn(e)))return{isCompatible:p,isTypeIncomplete:u,skippedOverloadArg:!0}}}}if(!Jn(e.paramType,a,h.createAddendum(),t)){if("none"!==Vt(e.errorNode).diagnosticRuleSet.reportGeneralTypeIssues&&!ye(e.errorNode)){const t=Vt(e.errorNode),n=ai(a),i=ai(e.paramType);let r;r=e.paramName?d?ml.Diagnostic.argAssignmentParamFunction().format({argType:n,paramType:i,functionName:d,paramName:e.paramName}):ml.Diagnostic.argAssignmentParam().format({argType:n,paramType:i,paramName:e.paramName}):d?ml.Diagnostic.argAssignmentFunction().format({argType:n,paramType:i,functionName:d}):ml.Diagnostic.argAssignment().format({argType:n,paramType:i}),l&&(h=l),_e(t.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,r+al(h),e.errorNode)}return{isCompatible:!1,isTypeIncomplete:u}}if(!i){const t=Ro(a),n=Vt(e.errorNode),i=()=>{const t=new il;return e.paramName&&t.addMessage((d?ml.DiagnosticAddendum.argParamFunction().format({paramName:e.paramName,functionName:d}):ml.DiagnosticAddendum.argParam().format({paramName:e.paramName}))+t.getString()),t};if("none"!==n.diagnosticRuleSet.reportUnknownArgumentType&&!uo(e.paramType)&&!u)if(po(t)){const t=i();_e(n.diagnosticRuleSet.reportUnknownArgumentType,$o.reportUnknownArgumentType,ml.Diagnostic.argTypeUnknown()+t.getString(),e.errorNode)}else if(La(t,!0)){let r=!1;if(_o(t)&&(r=!0),La(e.paramType)&&(r=!0),vo(t)&&t.isEmptyContainer&&(r=!0),!r){const r=i();r.addMessage(ml.DiagnosticAddendum.argumentType().format({type:ai(t,!0)})),_e(n.diagnosticRuleSet.reportUnknownArgumentType,$o.reportUnknownArgumentType,ml.Diagnostic.argTypePartiallyUnknown()+r.getString(),e.errorNode)}}}return{isCompatible:p,isTypeIncomplete:u}}function ot(e){if(11===e.nodeType){if(15===e.constType)return!1;if(33===e.constType)return!0}return fe(ml.Diagnostic.expectedBoolLiteral(),e),!1}function at(e,t){const n=Vt(e);let i="_";if(t.length>=1){const e=t[0];0===e.argumentCategory&&e.valueExpression&&48===e.valueExpression.nodeType&&(i=e.valueExpression.strings.map((e=>e.value)).join(""))}if(t.length>=2){const r=In(t[1]).type;if(_o(r)){Zs.isProtocolClass(r)?fe(ml.Diagnostic.newTypeProtocolClass(),t[1].node||e):void 0!==r.literalValue&&fe(ml.Diagnostic.newTypeLiteral(),t[1].node||e);const s=-4&r.details.flags,o=Zs.createInstantiable(i,br(e,n.moduleName,i),n.moduleName,n.filePath,s,Ir(e),void 0,r.details.effectiveMetaclass);o.details.baseClasses.push(r),Ha(o);const a=Xs.createInstance("__init__","","",64);Xs.addParameter(a,{category:0,name:"self",type:Zs.cloneAsInstance(o),hasDeclaredType:!0}),Xs.addParameter(a,{category:0,name:"_x",type:Zs.cloneAsInstance(r),hasDeclaredType:!0}),a.details.declaredReturnType=to.createInstance(),o.details.fields.set("__init__",qo.createWithType(4,a));const l=Xs.createInstance("__new__","","",65);return Xs.addParameter(l,{category:0,name:"cls",type:o,hasDeclaredType:!0}),Xs.addDefaultParameters(l),l.details.declaredReturnType=Zs.cloneAsInstance(o),o.details.fields.set("__new__",qo.createWithType(4,l)),o}ho(r)||fe(ml.Diagnostic.newTypeNotAClass(),t[1].node||e)}}function lt(e){return!(!Ku[e]||!Ku[e][2])||!!Ju[e]}function ut(e,t,n){const i=e.leftExpression;let r=e.rightExpression,s=!1;lt(e.operator)&&7===r.nodeType&&!r.parenthesized&&lt(r.operator)&&(ut(r,t,n),r=r.leftExpression);let o,a=37===e.operator||36===e.operator?t:void 0;26===e.operator&&t&&vo(t)&&Zs.isBuiltIn(t,"list")&&t.typeArguments&&t.typeArguments.length>=1&&31===e.leftExpression.nodeType&&(o=t);const l=$(i,a||o,n);let c=l.type;a||(37===e.operator||36===e.operator||0===e.operator&&31===e.rightExpression.nodeType||6===e.operator)&&(a=c);const u=$(r,a,n);let p=u.type;if((l.isIncomplete||u.isIncomplete)&&(s=!0),6===e.operator&&!pt(c,"__or__")&&!pt(p,"__ror__")){let t=p;if(!lo(c)&&lo(p)&&Ks.isInstance(p)&&(t=to.createType()),function(e){let t=3;for(const n of e)t&=n.flags;return 0!=(1&t)&&0==(2&t)}([c,t])){const i=Vt(e);i.isStubFile||0!=(4&n)||i.executionEnvironment.pythonVersion>=De.V3_10||ho(c)||fe(ml.Diagnostic.unionSyntaxIllegal(),e,e.operatorToken);const r=Oo([c,t]);return fo(r)&&Ks.setSpecialForm(r),{type:r,node:e}}}let d=!1;void 0===Ju[e.operator]&&(12===e.operator||28===e.operator?c=Fo(c):d=Go(c),12!==e.operator&&28!==e.operator||(p=Fo(p)));const h=new il,m=!l.isIncomplete&&!u.isIncomplete;let f=mt(e.operator,c,p,e,t,h,m);if(!h.isEmpty()||!f){if(!s){const t=Vt(e);d&&1===h.getMessages().length?_e(Vt(e).diagnosticRuleSet.reportOptionalOperand,$o.reportOptionalOperand,ml.Diagnostic.noneOperator().format({operator:Cr(e.operator)}),e.leftExpression):_e(t.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeNotSupportBinaryOperator().format({operator:Cr(e.operator),leftType:ai(c),rightType:ai(p)})+al(h),e)}f=Ys.create()}return{type:f,node:e,isIncomplete:s}}function pt(e,t){if(!_o(e))return!1;const n=e.details.effectiveMetaclass;if(!n||!_o(n))return!1;if(Zs.isBuiltIn(n,"type"))return!1;const i=va(n,t);return!(!i||_o(i.classType)&&Zs.isBuiltIn(i.classType,"type"))}function ht(e,t){const n={1:["__iadd__",0],34:["__isub__",33],27:["__imul__",26],14:["__ifloordiv__",13],11:["__itruediv__",10],25:["__imod__",24],30:["__ipow__",29],23:["__imatmul__",22],4:["__iand__",3],7:["__ior__",6],9:["__ixor__",8],18:["__ilshift__",17],32:["__irshift__",31]};let i;const r=new il,s=$(e.leftExpression),o=s.type;let a;7===e.operator&&(a=o);const l=$(e.rightExpression,a),c=l.type,u=!!l.isIncomplete||!!s.isIncomplete;return ao(o)||ao(c)?{node:e,type:no.createNever(),isIncomplete:u}:(i=Se(o,void 0,((i,o)=>Se(c,Xo(i),((a,c)=>{if(ho(o)||ho(c))return po(o)||po(c)?Ys.create():io.create();const u=n[e.operator][0];let p=gt(o,[c],u,e,t);if(p||o===i||(p=gt(i,[c],u,e,t)),p||c===a||(p=gt(i,[a],u,e,t)),!p){const i=n[e.operator][1],a=!s.isIncomplete&&!l.isIncomplete;p=mt(i,o,c,e,t,r,a)}return p})))),r.isEmpty()&&i&&!ao(i)||(u||_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeNotSupportBinaryOperator().format({operator:Cr(e.operator),leftType:ai(o),rightType:ai(c)})+al(r),e),i=Ys.create()),{node:e,type:i,isIncomplete:u})}function mt(e,t,n,i,r,s,o){let a,l=Ie(t);if(void 0!==Ju[e]){if(36===e){if(!Q(l))return t;if(!Y(l))return n;l=Z(l)}else if(37===e){if(!Y(l))return t;if(!Q(l))return n;l=X(l)}if(ao(t)||ao(n))return no.createNever();41===e||42===e?(a=Se(n,void 0,((t,n)=>Se(l,Xo(t),(r=>{if(ho(r)||ho(n))return po(r)||po(n)?Ys.create():io.create();let o=gt(t,[r],"__contains__",i,void 0);if(!o){const e=ae(t,!1,void 0);e&&Jn(e,r)&&(o=Cn(i,"bool"))}return o||s.addMessage(ml.Diagnostic.typeNotSupportBinaryOperator().format({operator:Cr(e),leftType:ai(r),rightType:ai(t)})),o})))),a&&!ao(a)&&(a=Cn(i,"bool"))):a=Se(l,void 0,((t,r)=>Se(n,Xo(t),((t,n)=>36===e||37===e?Oo([r,n]):Cn(i,"bool")))))}else if(Ku[e]){if(ao(t)||ao(n))return no.createNever();if(o){const i=aa(t);if(i&&!Xo(t)){const r=64;if(i===aa(n)&&!Xo(n)&&la(t)*la(n)<r)if("str"===i||"bytes"===i)0===e&&(a=Ko(t,(e=>Ko(n,(t=>{const n=e,i=t;return Zs.cloneWithLiteral(n,n.literalValue+i.literalValue)})))));else if("int"===i&&(0===e||33===e||26===e||13===e||24===e)){let i=!0;a=Ko(t,(t=>Ko(n,(n=>{try{const r=t,s=n,o=BigInt(r.literalValue),a=BigInt(s.literalValue);let l;return 0===e?l=o+a:33===e?l=o-a:26===e?l=o*a:13===e?a!==BigInt(0)&&(l=o/a):24===e&&a!==BigInt(0)&&(l=o%a),void 0===l||"number"==typeof l&&isNaN(l)?void(i=!1):(l===BigInt(Number(l))&&(l=Number(l)),Zs.cloneWithLiteral(r,l))}catch{return void(i=!1)}})))),i||(a=void 0)}}}a||(a=Se(t,void 0,((t,o)=>Se(n,Xo(t),((n,a)=>{if(ho(o)||ho(a))return po(o)||po(a)?Ys.create():io.create();if(0===e&&vo(t)&&pa(t)&&t.tupleTypeArguments&&!da(t)&&vo(n)&&pa(n)&&n.tupleTypeArguments&&!da(n)&&T&&_o(T))return Zs.cloneAsInstance(Va(T,[...t.tupleTypeArguments,...n.tupleTypeArguments]));const l=Ku[e][0];let c=gt(yt(o),[a],l,i,r);if(c||o===t||(c=gt(yt(t),[a],l,i,r)),c||a===n||(c=gt(yt(t),[n],l,i,r)),!c){const s=Ku[e][1];c=gt(yt(a),[o],s,i,r),c||a===n||(c=gt(yt(n),[o],s,i,r)),c||o===t||(c=gt(yt(n),[t],s,i,r))}return c||(r?s.addMessage(ml.Diagnostic.typeNotSupportBinaryOperatorBidirectional().format({operator:Cr(e),leftType:ai(t),rightType:ai(n),expectedType:ai(r)})):s.addMessage(ml.Diagnostic.typeNotSupportBinaryOperator().format({operator:Cr(e),leftType:ai(t),rightType:ai(n)}))),c})))))}return a&&ao(a)?void 0:a}function gt(e,t,n,i,r){let s=!0;const o=e=>{var o,a;let l;const c=Ie(e);if(vo(c)?l=null===(o=ee(i,c,n,void 0,void 0,64,e))||void 0===o?void 0:o.type:_o(c)&&(l=null===(a=te(i,c,n,void 0,void 0,96))||void 0===a?void 0:a.type),l){const e=t.map((e=>({argumentCategory:0,type:e})));let n;return kn(i,(()=>{n=et(i,e,l,void 0,!0,r)})),n.argumentErrors&&(s=!1),n.returnType}s=!1},a=Ko(e,(e=>{if(ho(e))return e;if(vo(e)||_o(e)||bo(e))return o(e);if(lo(e)){const e=Cn(i,"object");if(vo(e))return o(e)}s=!1}));if(s)return a}function yt(e){return(Eo(e)||ko(e))&&y?y:e}function _t(e,t,n){if(!vo(t=ta(t)))return;const i=[],r=[];let s=!1;if(Zs.isTypedDictClass(t)){if(Tt(e,i,r,!0,void 0,void 0,gl(li,t),n)&&(s=!0),Zs.isTypedDictClass(t)){const o=function(e,t,n,i,r){w(vo(t)),w(Zs.isTypedDictClass(t)),w(n.length===i.length);let s=!0;const o=new Map,a=gl(e,t);if(n.forEach(((n,l)=>{if(vo(n)&&Zs.isBuiltIn(n,"str")&&ra(n)){const c=n.literalValue,u=a.get(c);u?(e.canAssignType(u.valueType,i[l])||(r&&r.addMessage(ml.DiagnosticAddendum.typedDictFieldTypeMismatch().format({name:n.literalValue,type:e.printType(i[l])})),s=!1),u.isRequired||o.set(c,{valueType:i[l],isRequired:!1,isProvided:!0}),u.isProvided=!0):(s=!1,r&&r.addMessage(ml.DiagnosticAddendum.typedDictFieldUndefined().format({name:n.literalValue,type:e.printType(Zs.cloneAsInstance(t))})))}else s=!1})),s&&(a.forEach(((n,i)=>{n.isRequired&&!n.isProvided&&(r&&r.addMessage(ml.DiagnosticAddendum.typedDictFieldRequired().format({name:i,type:e.printType(t)})),s=!1)})),s))return 0===o.size?t:Zs.cloneForNarrowedTypedDictEntries(t,o)}(li,t,i,r,n);if(o)return{type:o,node:e,isIncomplete:s}}return}const o=Cn(e,"dict");if(!vo(o))return;const a=new jo(na(o));if(!Xe(o,t,a,Re(e)))return;const l=fa(Zs.cloneAsInstantiable(o),a);if(!l.typeArguments||2!==l.typeArguments.length)return;const c=l.typeArguments[0],u=l.typeArguments[1];Tt(e,i,r,!0,c,u,void 0,n)&&(s=!0);const p=vo(t)&&(Zs.isBuiltIn(t,"dict")||Zs.isBuiltIn(t,"MutableMapping")),d=It(c,i,!1),h=It(u,r,!p);return d&&h?{type:Cn(e,"dict",[d,h]),node:e,isIncomplete:s}:void 0}function vt(e,t){const n=t?io.create():Ys.create();let i=n,r=n,s=[],o=[],a=!1,l=!1;Tt(e,s,o,t)&&(l=!0),s=s.map((e=>Qo(e))),o=o.map((e=>Qo(e))),i=s.length>0?Oo(s):n,o.length>0?r=Vt(e).diagnosticRuleSet.strictDictionaryInference||t?Oo(o):Yo(o,!0)?o[0]:n:(r=n,a=!0);const c=xn(e,"dict");return{type:_o(c)?Zs.cloneAsInstance(Zs.cloneForSpecialization(c,[i,r],!0,void 0,void 0,a)):Ys.create(),node:e,isIncomplete:l}}function Tt(e,t,n,i,r,s,o,a){let l=!1;return e.entries.forEach(((c,u)=>{var p;let d=!0;if(17===c.nodeType){const e=$(c.keyExpression,null!=r?r:i?no.createNever():void 0);e.isIncomplete&&(l=!0);let p,h=e.type;if(r){const e=Ie(r);ho(e)||Jn(e,h)&&(h=e)}p=o&&vo(h)&&Zs.isBuiltIn(h,"str")&&ra(h)&&o.has(h.literalValue)?$(c.valueExpression,o.get(h.literalValue).valueType):$(c.valueExpression,null!=s?s:i?no.createNever():void 0),a&&p.expectedTypeDiagAddendum&&a.addAddendum(p.expectedTypeDiagAddendum);const m=p.type;p.isIncomplete&&(l=!0),(i||u<64)&&(t.push(h),n.push(m)),d=!1}else if(16===c.nodeType){const r=$(c.expandExpression);r.isIncomplete&&(l=!0);const s=r.type;if(ho(s))d=!1;else{const r=ce(e,"Mapping");if(r&&_o(r)){const o=new jo(na(r));if(Jn(Zs.cloneAsInstance(r),s,void 0,o)){const e=fa(r,o).typeArguments;e&&e.length>=2&&((i||u<64)&&(t.push(e[0]),n.push(e[1])),d=!1)}else _e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.dictUnpackIsNotMapping(),c)}}}else if(32===c.nodeType){const e=wt(c,s,r),o=e.type;if(e.isIncomplete&&(l=!0),vo(o)&&pa(o)){const e=null===(p=o.tupleTypeArguments)||void 0===p?void 0:p.map((e=>e.type));e&&2===e.length&&((i||u<64)&&(t.push(e[0]),n.push(e[1])),d=!1)}}d&&(i||u<64)&&(t.push(Ys.create()),n.push(Ys.create()))})),l}function bt(e,t){const n=31===e.nodeType?"list":"set";t=ta(t);let i=!1;if(!vo(t))return;const r=Cn(e,n);if(!vo(r))return;const s=new jo(na(r));if(!Xe(r,t,s,Re(e)))return;const o=fa(Zs.cloneAsInstantiable(r),s);if(!o.typeArguments||1!==o.typeArguments.length)return;const a=o.typeArguments[0],l=[];e.entries.forEach((e=>{let t;t=32===e.nodeType?wt(e,a):$(e,a),l.push(t.type),t.isIncomplete&&(i=!0)}));const c=vo(t)&&Zs.isBuiltIn(t,n),u=It(a,l,!c);return u?{type:Cn(e,n,[u]),node:e,isIncomplete:i}:void 0}function It(e,t,n){const i=oo.createInstance("__typeArg");i.details.isSynthesized=!0,i.details.boundType=e,i.scopeId="__typeArgScopeId";let r=new jo($s);if(r.setTypeVarType(i,n?void 0:e,e),!t.some((e=>!Jn(i,Qo(e),void 0,r)))||(r=new jo($s),r.setTypeVarType(i,n?void 0:e,e,!0),!t.some((e=>!Jn(i,e,void 0,r)))))return fa(i,r)}function xt(e,t,n,i,r,s){if("none"===e)return;const o=n.value,a=Ro(i);if(po(a))_e(e,t,ml.Diagnostic.typeUnknown().format({name:o}),r);else if(La(a)&&(!s||!vo(i)||!i.isEmptyContainer)){const n=new il;n.addMessage(ml.DiagnosticAddendum.typeOfSymbol().format({name:o,type:ai(a,!0)})),_e(e,t,ml.Diagnostic.typePartiallyUnknown().format({name:o})+n.getString(),r)}}function Ct(e){let t=!1;if(33===e.nodeType){const n=$(e.iterableExpression);n.isIncomplete&&(t=!0);const i=ae(Qo(n.type),!!e.isAsync,e.iterableExpression)||Ys.create();xe(e.targetExpression,i,!!n.isIncomplete,e.iterableExpression)}else w(34===e.nodeType),c.isSpeculative(e.testExpression)||$(e.testExpression);return t}function wt(e,t,n){let i=!1;for(const t of e.forIfNodes)Ct(t)&&(i=!0);let r=Ys.create();if(17===e.expression.nodeType){const s=$(e.expression.keyExpression,n);s.isIncomplete&&(i=!0);let o=s.type;n&&oa(n)||(o=Qo(o));const a=$(e.expression.valueExpression,t);a.isIncomplete&&(i=!0);let l=a.type;t&&oa(t)||(l=Qo(l)),r=Ue([o,l])}else if(16===e.expression.nodeType)$(e.expression.expandExpression,t);else if(yr(e)){const n=$(e.expression,t);n.isIncomplete&&(i=!0),r=n.type}return{type:r,node:e,isIncomplete:i}}function Et(e,t){if(e.typeList){if(!(null==t?void 0:t.allowTypeArgList))return fe(ml.Diagnostic.typeArgListNotAllowed(),e.node),!1;e.typeList.forEach((e=>{Et(e)}))}if(ca(e.type)&&!(null==t?void 0:t.allowTypeArgList))return fe(ml.Diagnostic.ellipsisContext(),e.node),!1;if(To(e.type))return fe(ml.Diagnostic.moduleAsType(),e.node),!1;if(wo(e.type)&&!(null==t?void 0:t.allowParamSpec))return fe(ml.Diagnostic.paramSpecContext(),e.node),!1;if(Io(e.type)&&!e.type.isVariadicInUnion){if(!(null==t?void 0:t.allowVariadicTypeVar))return fe(ml.Diagnostic.typeVarTupleContext(),e.node),!1;Oe(e.type,e.node)}return!(null==t?void 0:t.allowEmptyTuple)&&e.isEmptyTupleShorthand?(fe(ml.Diagnostic.zeroLengthTupleNotAllowed(),e.node),!1):!(xo(e.type)&&!(null==t?void 0:t.allowUnpackedTuples)&&(fe(ml.Diagnostic.unpackedArgInTypeArgument(),e.node),1))}function kt(e,t,n){const i=Cn(e,t);return vo(i)?Zs.cloneWithLiteral(i,n):Ys.create()}function Nt(e,t,n){const i=xn(e,t);return _o(i)?Zs.cloneWithLiteral(i,n):Ys.create()}function Ot(e,t,n,i=!1,r=!1){const s=Zs.isTupleClass(e);if(t)if(s&&1===t.length&&t[0].isEmptyTupleShorthand)t=[];else{let e=!1;const r=t=>{e&&(o||(fe(ml.Diagnostic.variadicTypeArgsTooMany(),t.node),o=!0)),e=!0};let o=!1;t.forEach(((e,o)=>{ca(e.type)?s?2!==t.length||1!==o?fe(ml.Diagnostic.ellipsisSecondArg(),e.node):bo(t[0].type)&&Io(t[0].type)&&!t[0].type.isVariadicInUnion&&fe(ml.Diagnostic.typeVarTupleContext(),t[0].node):fe(ml.Diagnostic.ellipsisContext(),e.node):wo(e.type)&&i||(Io(e.type)&&void 0===n?(r(e),Oe(e.type,e.node)):void 0===n&&Co(e.type)?(r(e),Et(e,{allowUnpackedTuples:!0})):Et(e))}))}let o,a=t?t.map((e=>Fa(e.type))):[];if(void 0!==n)if(t&&a.length>n)fe(ml.Diagnostic.typeArgsTooMany().format({name:e.aliasName||e.details.name,expected:n,received:a.length}),t[n].node),a=a.slice(0,n);else if(a.length<n)for(;a.length<n;)a.push(Ys.create());if(s){const n=[];t?t.forEach(((e,t)=>{1===t&&ca(a[t])?1!==n.length||n[0].isUnbounded?fe(ml.Diagnostic.ellipsisSecondArg(),e.node):n[0]={type:n[0].type,isUnbounded:!0}:xo(e.type)&&e.type.tupleTypeArguments?n.push(...e.type.tupleTypeArguments):n.push({type:a[t],isUnbounded:!1})})):n.push({type:Ys.create(),isUnbounded:!0}),o=Va(e,n,void 0!==t,!1)}else o=Zs.cloneForSpecialization(e,a,void 0!==t);return r||Ks.setSpecialForm(o),o}function Ut(e,t){var n,i,r,s;const o=Er(e,!0);if(o){const l=$t(o);if(l&&Zs.isEnumClass(l.classType)){let o=3===(null===(n=e.parent)||void 0===n?void 0:n.nodeType)&&e.parent.leftExpression===e||54===(null===(i=e.parent)||void 0===i?void 0:i.nodeType)&&e.parent.valueExpression===e&&3===(null===(r=e.parent.parent)||void 0===r?void 0:r.nodeType)||Vt(e).isStubFile&&54===(null===(s=e.parent)||void 0===s?void 0:s.nodeType)&&e.parent.valueExpression===e;(a=e.value).length>2&&a.startsWith("_")&&a.endsWith("_")&&(o=!1),"name"!==e.value&&"value"!==e.value||(o=!1);const c=t();if(vo(c)&&c.details.fields.get("__get__")&&(o=!1),o)return Zs.cloneAsInstance(Zs.cloneWithLiteral(l.classType,new Hs(l.classType.details.name,e.value,c)))}}var a}function qt(e,t,n){if(!Ks.isInstantiable(e))return e;if(ea(e))return e;let i=[];bo(e)&&!Ks.isAnnotated(e)||Jo(e,(e=>{Ia(i,Sa(e))})),i=i.filter((e=>!e.details.isSynthesized)),i=i.map((e=>Ks.isInstance(e)?e:Fa(e)));const r=i.filter((e=>Io(e)));r.length>1&&fe(ml.Diagnostic.variadicTypeParamTooManyAlias().format({names:r.map((e=>`"${e.details.name}"`)).join(", ")}),n);const s=Vt(t),o=Pe(t),a=i.filter((e=>e.scopeId!==o&&0===e.scopeType));return a.length>0&&fe(ml.Diagnostic.genericTypeAliasBoundTypeVar().format({names:a.map((e=>`${e.details.name}`)).join(", ")}),n),Ks.cloneForTypeAlias(e,t.value,`${s.moduleName}.${t.value}`,o,i.length>0?i:void 0)}function Bt(e,t,n){const i=Vt(e);let r=Zs.createInstantiable(t,br(e,i.moduleName,t),i.moduleName,i.filePath,3,0,void 0,void 0);i.isTypingExtensionsStubFile&&(r.details.flags|=65536);const s=n.alias||"object";let o;if("builtins"===n.module)o=xn(e,s);else if("collections"===n.module)o=ue(e,s,["collections"]);else if("self"===n.module){const t=wn(e,s,!1);t&&(o=Nn(t.symbol),_o(o)&&Zs.isBuiltIn(o,"_TypedDict")&&(o.details.flags&=-513))}return o&&_o(o)?n.alias?r=Zs.cloneForTypingAlias(o,t):(r.details.baseClasses.push(o),r.details.effectiveMetaclass=o.details.effectiveMetaclass,Ha(r)):(r.details.baseClasses.push(Ys.create()),r.details.effectiveMetaclass=Ys.create(),Ha(r)),r}function Wt(e){var t;const n=Vt(e);if(F(e,0))return;let i,r=F(e.rightExpression,0),s=!1;if(!r&&((n.isTypingStubFile||n.isTypingExtensionsStubFile)&&(r=function(e){if(38!==e.leftExpression.nodeType)return;const t=e.leftExpression.value;if("Any"===t)return io.create();const n=new Map([["overload",{alias:"",module:"builtins"}],["TypeVar",{alias:"",module:"builtins"}],["_promote",{alias:"",module:"builtins"}],["no_type_check",{alias:"",module:"builtins"}],["NoReturn",{alias:"",module:"builtins"}],["Never",{alias:"",module:"builtins"}],["Counter",{alias:"Counter",module:"collections"}],["List",{alias:"list",module:"builtins"}],["Dict",{alias:"dict",module:"builtins"}],["DefaultDict",{alias:"defaultdict",module:"collections"}],["Set",{alias:"set",module:"builtins"}],["FrozenSet",{alias:"frozenset",module:"builtins"}],["Deque",{alias:"deque",module:"collections"}],["ChainMap",{alias:"ChainMap",module:"collections"}],["OrderedDict",{alias:"OrderedDict",module:"collections"}]]).get(t);return n?($(e.rightExpression),Bt(e,t,n)):void 0}(e),r&&N(e.rightExpression,r,0,!1)),!r)){const l=se(e.leftExpression,{method:"set"});let c,u=0;n.isStubFile&&(u|=256),38!==e.rightExpression.nodeType&&35!==e.rightExpression.nodeType||(u|=2);let p,d=!1;if(re(e.leftExpression))u|=232,u&=-3,c=e.leftExpression.valueExpression;else if(38===e.leftExpression.nodeType){const t=wn(e.leftExpression,e.leftExpression.value,!1);if(t){const n=t.symbol.getDeclarations();1===n.length&&os(n[0])&&(c=e.leftExpression,d=!0)}}if(c){p=oo.createInstantiable(`__type_alias_${c.value}`),p.details.isSynthesized=!0,p.details.recursiveTypeAliasName=c.value;const t=Pe(c);p.details.recursiveTypeAliasScopeId=t,p.scopeId=t,N(e,p,void 0,!1),N(e.leftExpression,p,void 0,!1),54===e.leftExpression.nodeType&&N(e.leftExpression.valueExpression,p,void 0,!1)}const h=$(e.rightExpression,l,u);let m=h.type;i=h.expectedTypeDiagAddendum,h.isIncomplete&&(s=!0);const f=Xc(e.rightExpression,n.executionEnvironment);if(void 0!==f){const t=Cn(e,"bool");vo(t)&&(m=Zs.cloneWithLiteral(t,f))}l&&Jn(l,m)&&(ho(m)||(m=ni(l,m))),r=m,38!==e.leftExpression.nodeType||e.typeAnnotationComment||(r=Ut(e.leftExpression,(()=>r))||r),c&&(M(e),M(e.leftExpression),54===e.leftExpression.nodeType&&M(e.leftExpression.valueExpression),(!d||Ks.isInstantiable(r)&&!po(r))&&(r=qt(r,c,e.rightExpression),o=p,(9!==(a=r).category?a===o||mo(a)&&a.typeAliasInfo&&a.typeAliasInfo.name===o.details.recursiveTypeAliasName:void 0!==Mo(a,(e=>Ao(o,e))))&&_e(n.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeAliasIsRecursiveDirect().format({name:c.value}),e.rightExpression),p.details.boundType=r,p.details.recursiveTypeParameters=null===(t=r.typeAliasInfo)||void 0===t?void 0:t.typeParameters),p.details.illegalRecursionDetected&&_e(n.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeAliasIsRecursiveIndirect().format({name:c.value}),e.leftExpression))}var o,a;xe(e.leftExpression,r,s,e.rightExpression,!0,!0,i),N(e,r,0,s)}function jt(e){if(F(e,0))return;const t=ht(e,void 0);xe(e.destExpression,t.type,!!t.isIncomplete,e.rightExpression),N(e,t.type,0,!!t.isIncomplete)}function $t(e){const t=F(e.name,0);if(t){if(!_o(t))return;return{classType:t,decoratedType:F(e,0)||Ys.create()}}const n=zs(e),i=Vt(e);let r=0;(4===(null==n?void 0:n.type)||i.isTypingStubFile||i.isTypingExtensionsStubFile||i.isBuiltInStubFile)&&(r|=1,i.isTypingExtensionsStubFile&&(r|=65536),"property"===e.name.value&&(r|=2048),"tuple"===e.name.value&&(r|=524288)),i.isStubFile&&(r|=8388608);const s=Zs.createInstantiable(e.name.value,br(e,i.moduleName,e.name.value),i.moduleName,i.filePath,r,0,void 0,void 0,qr(e.suite.statements));s.details.typeVarScopeId=Pe(e);const o=null==n?void 0:n.lookUpSymbol(e.name.value);let a;const l=Mt(e);l&&(a=l),a&&o&&B(o,a,s),s.details.flags|=131072,N(e,s,void 0,!1),N(e.name,s,void 0,!1);const c=[];let u;const p=[];let d,h=272960;i.isStubFile&&(h|=4),e.arguments.forEach((e=>{if(e.name)if("metaclass"===e.name.value)d?fe(ml.Diagnostic.metaclassDuplicate(),e):d=e.valueExpression;else if("total"===e.name.value&&Zs.isTypedDictClass(s)){const t=Xc(e.valueExpression,i.executionEnvironment);void 0===t?fe(ml.Diagnostic.typedDictTotalParam(),e.valueExpression):t||(s.details.flags|=256)}else p.push({argumentCategory:0,node:e,name:e.name,valueExpression:e.valueExpression});else{let t=$(e.valueExpression,void 0,h).type;if(fo(t)&&(t=Ro(t)),ho(t)||mo(t)||(_o(t)?(Zs.isBuiltIn(t,"Protocol")&&(!i.isStubFile&&!Zs.isTypingExtensionClass(t)&&i.executionEnvironment.pythonVersion<De.V3_7&&fe(ml.Diagnostic.protocolIllegal(),e.valueExpression),s.details.flags|=8192),Zs.isBuiltIn(t,"property")&&(s.details.flags|=2048),i.executionEnvironment.pythonVersion>=De.V3_6&&Zs.isBuiltIn(t,"NamedTuple")&&(s.details.flags|=16777220),Zs.isBuiltIn(t,"TypedDict")||Zs.isTypedDictClass(t)?s.details.flags|=128:Zs.isTypedDictClass(s)&&!Zs.isTypedDictClass(t)&&fe(ml.Diagnostic.typedDictBaseClass(),e),Da(t,s,!0)&&(fe(ml.Diagnostic.baseClassCircular(),e),t=Ys.create())):(_e(i.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.baseClassInvalid(),e),t=Ys.create())),po(t)&&_e(i.diagnosticRuleSet.reportUntypedBaseClass,$o.reportUntypedBaseClass,ml.Diagnostic.baseClassUnknown(),e),s.details.baseClasses.some((e=>_o(e)&&_o(t)&&Zs.isSameGenericClass(t,e)))&&_e(i.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.duplicateBaseClass(),e.name||e),s.details.baseClasses.push(t),_o(t)&&(Zs.isEnumClass(t)&&(s.details.flags|=1048576),(Zs.supportsAbstractMethods(t)||Zs.isProtocolClass(t)&&!Zs.isBuiltIn(t))&&(s.details.flags|=512),Zs.isPropertyClass(t)&&(s.details.flags|=2048),Zs.isFinal(t))){const n=oi(t);fe(ml.Diagnostic.baseClassFinal().format({type:n}),e.valueExpression)}Ia(c,Sa(t)),_o(t)&&Zs.isBuiltIn(t,"Generic")&&(u||(u=[],Ia(u,Sa(t))))}})),s.details.baseClasses.length>1&&s.details.baseClasses.some((e=>_o(e)&&Zs.isBuiltIn(e,"NamedTuple")))&&_e(i.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.namedTupleMultipleInheritance(),e.name),Zs.isBuiltIn(s,"object")||0!==s.details.baseClasses.filter((e=>yo(e))).length||s.details.baseClasses.push(xn(e,"object")),u&&function(e,t,n){const i=t.filter((e=>!n.some((t=>t.details.name===e.details.name))));if(i.length>0){const t=new il;t.addMessage(ml.DiagnosticAddendum.typeVarsMissing().format({names:i.map((e=>`"${e.details.name}"`)).join(", ")})),_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeVarsNotInGeneric()+t.getString(),e)}}(e.name,c,u),s.details.typeParameters=u||c;const m=s.details.typeParameters.filter((e=>Io(e)));m.length>1&&fe(ml.Diagnostic.variadicTypeParamTooManyClass().format({names:m.map((e=>`"${e.details.name}"`)).join(", ")}),e.name,dt.combine(e.arguments)||e.name),Ha(s)||fe(ml.Diagnostic.methodOrdering(),e.name);const f=zs(e.suite);s.details.fields=(null==f?void 0:f.symbolTable)||new Map;const y=null==f?void 0:f.getSlotsNames();if(y&&(s.details.localSlotsNames=y),Zs.isTypedDictClass(s)&&fl(li,e,s),!i.isStubFile&&0===s.details.typeParameters.length){const t=s.details.fields.get("__init__");if(t){const n=t.getTypedDeclarations();if(1===n.length&&3===n[0].type){const t=n[0].node,i=t.parameters;if(i.length>1&&!i.some(((e,n)=>!!ie(t,n)))){const n=i.filter(((e,t)=>t>0&&e.name&&0===e.category));n.length>0&&(s.details.flags|=16384,s.details.typeParameters=n.map((n=>{const i=oo.createInstance(`__type_of_${n.name.value}`);return i.details.isSynthesized=!0,i.scopeId=Pe(t),i.details.boundType=Ys.create(),oo.cloneForScopeId(i,Pe(e),e.name.value,0)})))}}}}if(0!==s.details.typeParameters.length||Zs.isBuiltIn(s,"type")||(s.details.baseClasses.some((e=>_o(e)&&Zs.hasCustomClassGetItem(e)))||s.details.fields.has("__class_getitem__"))&&(s.details.flags|=262144),d){const e=$(d,void 0,h).type;(_o(e)||po(e))&&($a(e)&&_e(i.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.metaclassIsGeneric(),d),s.details.declaredMetaclass=e,_o(e)&&(Zs.isBuiltIn(e,"EnumMeta")?s.details.flags|=1048576:Zs.isBuiltIn(e,"ABCMeta")&&(s.details.flags|=512)))}let v=s.details.declaredMetaclass,T=!1;if(!v||_o(v))for(const t of s.details.baseClasses){if(!_o(t)){v=Ys.create();break}{const n=t.details.effectiveMetaclass||_;if(!n||!_o(n)){v=n?Ys.create():void 0;break}v?Da(n,v,!1)?v=n:Da(v,n,!1)||T||(_e(i.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.metaclassConflict(),e.name),T=!0):v=n}}if(!v){const t=xn(e,"type");v=t&&_o(t)?t:Ys.create()}s.details.effectiveMetaclass=v;let b,I=s,S=!1;for(let t=e.decorators.length-1;t>=0;t--){const n=e.decorators[t],r=Ht(I,s,n);Oa(r)?S||(_e(i.diagnosticRuleSet.reportUntypedClassDecorator,$o.reportUntypedClassDecorator,ml.Diagnostic.classDecoratorTypeUnknown(),e.decorators[t].expression),S=!0):I=r}if(_o(v)&&v.details.classDataClassTransform)b=v.details.classDataClassTransform;else{const e=s.details.mro.find((e=>yo(e)&&void 0!==e.details.classDataClassTransform));e&&(b=e.details.classDataClassTransform)}if(b&&(Wu(s,b),Bu(li,s,p)),s.details.flags&=-131073,Zs.isDataClass(s)){const t=Zs.isSkipSynthesizedDataClassInit(s);let n=t;if(!t){const e=va(s,"__init__",2);if(e){const t=Bn(e);Eo(t)&&Xs.isSynthesizedMethod(t)||(n=!0)}}let i=!1;const r=va(s,"__hash__",2);if(r){const e=Bn(r);Eo(e)&&!Xs.isSynthesizedMethod(e)&&(i=!0)}!function(e,t,n,i,r,s){w(Zs.isDataClass(n));const o=Aa(n,!0),a=Xs.createInstance("__new__","","",65),l=Xs.createInstance("__init__","","",64);Xs.addParameter(a,{category:0,name:"cls",type:o,hasDeclaredType:!0}),Xs.addDefaultParameters(a),a.details.declaredReturnType=Fa(o);const c={category:0,name:"self",type:Aa(n,!1),hasDeclaredType:!0};Xs.addParameter(l,c),l.details.declaredReturnType=to.createInstance();const u=[],p=[],d=function(e,t){let n=!0;for(let i=e.details.mro.length-1;i>=0;i--){const r=e.details.mro[i];if(_o(r)){const e=wa(r,!1);Zs.getDataClassEntries(r).forEach((n=>{const i=t.findIndex((e=>e.name===n.name)),r={...n};r.type=fa(r.type,e),n.isClassVar?i>=0&&t.splice(i,1):i>=0?t[i]=r:t.push(r)}))}else n=!1}return n}(n,p);d||Xs.addDefaultParameters(l);const h=[];let m=!1;t.suite.statements.forEach((r=>{47===r.nodeType&&r.statements.forEach((r=>{var s;let o,a,l,c,d=!1,f=Zs.isDataClassKeywordOnlyParams(n)||m,g=!0;if(3===r.nodeType){if(54===r.leftExpression.nodeType&&38===r.leftExpression.valueExpression.nodeType&&(o=r.leftExpression.valueExpression,l=()=>e.getTypeOfAnnotation(r.leftExpression.typeAnnotation,{isVariableAnnotation:!0,allowFinal:!0,allowClassVar:!0})),d=!0,c=r.rightExpression,9===r.rightExpression.nodeType){const i=e.getTypeOfExpression(r.rightExpression.leftExpression,void 0,2).type;if(function(e,t){let n;return Eo(e)?n=e.details.fullName:ko(e)?n=e.overloads[0].details.fullName:_o(e)&&(n=e.details.fullName),!!n&&t.some((e=>e===n))}(i,(null===(s=n.details.dataClassBehaviors)||void 0===s?void 0:s.fieldDescriptorNames)||[])){const n=r.rightExpression.arguments.find((e=>{var t;return"init"===(null===(t=e.name)||void 0===t?void 0:t.value)}));if(n&&n.valueExpression)!1===Xc(n.valueExpression,Vt(t).executionEnvironment)&&(g=!1);else{let t;if(Eo(i))t=i;else if(ko(i))t=e.getBestOverloadForArguments(r.rightExpression,i,r.rightExpression.arguments);else if(_o(i)){const n=e.getBoundMethod(i,"__init__");n&&(Eo(n)?t=n:ko(n)&&(t=e.getBestOverloadForArguments(r.rightExpression,n,r.rightExpression.arguments)))}if(t){const e=t.details.parameters.find((e=>"init"===e.name));e&&e.defaultValueExpression&&e.hasDeclaredType&&yo(e.type)&&Zs.isBuiltIn(e.type,"bool")&&ra(e.type)&&!1===e.type.literalValue&&(g=!1)}}const s=r.rightExpression.arguments.find((e=>{var t;return"kw_only"===(null===(t=e.name)||void 0===t?void 0:t.value)}));if(s&&s.valueExpression){const e=Xc(s.valueExpression,Vt(t).executionEnvironment);!1===e?f=!1:!0===e&&(f=!0)}const o=r.rightExpression.arguments.find((e=>{var t,n,i;return"default"===(null===(t=e.name)||void 0===t?void 0:t.value)||"default_factory"===(null===(n=e.name)||void 0===n?void 0:n.value)||"factory"===(null===(i=e.name)||void 0===i?void 0:i.value)}));d=!!o,(null==o?void 0:o.valueExpression)&&(c=o.valueExpression);const l=r.rightExpression.arguments.find((e=>{var t;return"alias"===(null===(t=e.name)||void 0===t?void 0:t.value)}));if(l){const t=e.getTypeOfExpression(l.valueExpression).type;vo(t)&&Zs.isBuiltIn(t,"str")&&ra(t)&&(a=t.literalValue)}}}}else if(54===r.nodeType&&38===r.valueExpression.nodeType&&(o=r.valueExpression,l=()=>e.getTypeOfAnnotation(r.typeAnnotation,{isVariableAnnotation:!0,allowFinal:!0,allowClassVar:!0}),"_"===r.valueExpression.value)){const e=l();vo(e)&&Zs.isBuiltIn(e,"KW_ONLY")&&(m=!0,o=void 0,l=void 0)}if(o&&l){const t=o.value,r=n.details.fields.get(t),s=null==r?void 0:r.getDeclarations().some((e=>1===e.type&&e.isFinal));if((null==r?void 0:r.isClassVar())&&!s){const e=p.findIndex((e=>e.name===t));e>=0&&p.splice(e,1);const i={name:t,classType:n,alias:a,isKeywordOnly:!1,hasDefault:d,defaultValueExpression:c,includeInInit:g,type:Ys.create(),isClassVar:!0};u.push(i)}else{const r={name:t,classType:n,alias:a,isKeywordOnly:f,hasDefault:d,defaultValueExpression:c,includeInInit:g,type:Ys.create(),isClassVar:!1};h.push({entry:r,evaluator:l});let s=u.findIndex((e=>e.name===t));if(s>=0?u[s]=r:u.push(r),s=p.findIndex((e=>e.name===t)),s>=0){const e=p[s];!r.hasDefault&&e.hasDefault&&(r.hasDefault=!0,r.defaultValueExpression=e.defaultValueExpression,d=!0),p[s]=r}else p.push(r),s=p.length-1;if(!f&&g&&!i&&!d){const t=p.findIndex((e=>e.hasDefault&&e.includeInInit&&!e.isKeywordOnly));t>=0&&t<s&&e.addError(ml.Diagnostic.dataClassFieldWithDefault(),o)}}}}))})),n.details.dataClassEntries=u,h.forEach((e=>{e.entry.type=e.evaluator()}));const f=n.details.fields,g=[];i||r||!d||(p.forEach((t=>{var i;if(t.includeInInit){let r=t.type;if(t.classType!==n&&$a(r)){const e=new jo(na(t.classType));ma(e,t.classType,n),r=fa(r,e)}(null===(i=n.details.dataClassBehaviors)||void 0===i?void 0:i.transformDescriptorTypes)&&(r=function(e,t){if(!vo(t))return t;const n=_a(t,"__set__");if(!n)return t;const i=e.getTypeOfMember(n);if(!Eo(i))return t;const r=e.bindFunctionToClassOrObject(t,i);return!r||!Eo(r)||r.details.parameters.length<2?t:Xs.getEffectiveParameterType(r,1)}(e,r));const s={category:0,name:t.alias||t.name,hasDefault:t.hasDefault,defaultValueExpression:t.defaultValueExpression,type:r,hasDeclaredType:!0};t.isKeywordOnly?g.push(s):Xs.addParameter(l,s)}})),g.length>0&&(Xs.addParameter(l,{category:1,type:io.create()}),g.forEach((e=>{Xs.addParameter(l,e)}))),f.set("__init__",qo.createWithType(4,l)),f.set("__new__",qo.createWithType(4,a)));const y=e.getBuiltInType(t,"str"),_=e.getBuiltInType(t,"tuple");if(_&&_o(_)&&y&&_o(y)&&!f.has("__match_args__")){const e=[];p.forEach((t=>{t.includeInInit&&!t.isKeywordOnly&&e.push(t.name)}));const t=e.map((e=>({type:Zs.cloneAsInstance(Zs.cloneWithLiteral(y,e)),isUnbounded:!1}))),n=Zs.cloneAsInstance(Va(_,t));f.set("__match_args__",qo.createWithType(4,n))}const v=(n,i)=>{const r=Xs.createInstance(n,"","",64);Xs.addParameter(r,c),Xs.addParameter(r,{category:0,name:"other",type:i,hasDeclaredType:!0}),r.details.declaredReturnType=e.getBuiltInObject(t,"bool"),f.set(n,qo.createWithType(4,r))};if(Zs.isSkipSynthesizedDataClassEq(n)||v("__eq__",e.getBuiltInObject(t,"object")),Zs.isSynthesizedDataclassOrder(n)){const e=Zs.cloneAsInstance(n);["__lt__","__le__","__gt__","__ge__"].forEach((t=>{v(t,e)}))}let T=!Zs.isSkipSynthesizedDataClassEq(n)&&Zs.isFrozenDataClass(n);const b=!Zs.isSkipSynthesizedDataClassEq(n)&&!Zs.isFrozenDataClass(n);if(s&&(T=!1),Zs.isSynthesizeDataClassUnsafeHash(n)&&(T=!0),T){const n=Xs.createInstance("__hash__","","",64);Xs.addParameter(n,c),n.details.declaredReturnType=e.getBuiltInObject(t,"int"),f.set("__hash__",qo.createWithType(4,n))}else b&&!s&&f.set("__hash__",qo.createWithType(4,to.createInstance()));let I=e.getBuiltInType(t,"dict");_o(I)&&(I=Zs.cloneAsInstance(Zs.cloneForSpecialization(I,[e.getBuiltInObject(t,"str"),io.create()],!0))),f.set("__dataclass_fields__",qo.createWithType(4,I)),Zs.isGeneratedDataClassSlots(n)&&void 0===n.details.localSlotsNames&&(n.details.localSlotsNames=u.map((e=>e.name))),Uu(n,p.map((e=>e.type)),!0)}(li,e,s,t,n,i)}if(s.details.localSlotsNames){let e=!0;const t=[...s.details.localSlotsNames];s.details.baseClasses.forEach((n=>{_o(n)?Zs.isBuiltIn(n,"object")||Zs.isBuiltIn(n,"type")||Zs.isBuiltIn(n,"Generic")||(void 0===n.details.inheritedSlotsNames?e=!1:t.push(...n.details.inheritedSlotsNames)):e=!1})),e&&(s.details.inheritedSlotsNames=t)}return N(e.name,s,0,!1),N(e,I,0,!1),function(e,t,n){const i=n.length>0?n[0].node.name:e.name,r=Ne(i,t,"__init_subclass__",{method:"get"},void 0,133,t);if(r){const e=r.type;e&&et(i,n,e,void 0,!1,to.createInstance())}else if(t.details.effectiveMetaclass&&yo(t.details.effectiveMetaclass)){const r=va(t.details.effectiveMetaclass,"__new__",32);if(r){const t=Bn(r);if(Eo(t)){const r=Ho(t);if(void 0!==r.firstKeywordOnlyIndex){const s=new Map;for(let e=r.firstKeywordOnlyIndex;e<r.params.length;e++){const t=r.params[e];0===t.param.category&&t.param.name&&s.set(t.param.name,e)}n.forEach((n=>{var o,a,l;if(0===n.argumentCategory&&n.name){const c=null!==(o=s.get(n.name.value))&&void 0!==o?o:r.kwargsIndex;if(void 0!==c){const e=r.params[c];st({paramCategory:e.param.category,paramType:Xs.getEffectiveParameterType(t,e.index),requiresTypeVarMatching:!1,argument:n,errorNode:null!==(a=n.valueExpression)&&void 0!==a?a:i},new jo,t,!0,!0,!1,void 0),s.delete(n.name.value)}else _e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.paramNameMissing().format({name:n.name.value}),null!==(l=n.name)&&void 0!==l?l:i)}}));const o=[];if(s.forEach(((e,t)=>{r.params[e].param.hasDefault||o.push(t)})),o.length>0){const e=o.map((e=>`"${e}"`)).join(", ");_e(Vt(i).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,1===o.length?ml.Diagnostic.argMissingForParam().format({name:e}):ml.Diagnostic.argMissingForParams().format({names:e}),i)}}}}}n.forEach((e=>{e.valueExpression&&$(e.valueExpression)}))}(e,s,p),Zs.isBuiltIn(s,"UnionType")&&(g=Zs.cloneAsInstance(s)),{classType:s,decoratedType:I}}function Ht(e,t,n){let i=Vt(n).isStubFile?4:0;9!==n.expression.nodeType&&(i|=2);const r=$(n.expression,void 0,i).type;if(9===n.expression.nodeType){const e=$(n.expression.leftExpression,void 0,2|i).type;Eo(e)&&("__dataclass_transform__"!==e.details.name&&"dataclass_transform"!==e.details.builtInName||(t.details.classDataClassTransform=qu(li,n.expression)))}if(ko(r)){const n=Vu(r);if(n)return ju(li,t,n,void 0),e}else if(Eo(r)){if("final"===r.details.builtInName)return t.details.flags|=4096,e;if("runtime_checkable"===r.details.builtInName)return t.details.flags|=32768,e;let s,o;if(9===n.expression.nodeType?(o=n.expression,s=Vu($(o.leftExpression,void 0,2|i).type)):s=Vu($(n.expression,void 0,i).type),s)return ju(li,t,s,o),e}return J(n,e)}function Gt(e){const t=Vt(e),n=F(e.name,0);if(n){if(!Eo(n))return;return{functionType:n,decoratedType:F(e,0)||Ys.create()}}let i;const r=Mt(e);r&&(i=r);const s=Er(e,!0);let o;if(s){const e=$t(s);if(!e)return;o=e.classType}let a=en(e,!!s);(null==i?void 0:i.isGenerator)&&(a|=16),s&&"__class_getitem__"===e.name.value&&(a|=2),t.isStubFile?a|=2048:t.isInPyTypedPackage&&(a|=4096),e.isAsync&&(a|=512);const l=Xs.createInstance(e.name.value,function(e,t,n){const i=[n];let r=e;for(;r;)r=Dr(r),r&&i.push(r.name.value);return i.push(t),i.reverse().join(".")}(e,t.moduleName,e.name.value),t.moduleName,a,qr(e.suite.statements));l.details.typeVarScopeId=Pe(e),(t.isBuiltInStubFile||t.isTypingStubFile||t.isTypingExtensionsStubFile)&&(l.details.builtInName=e.name.value),l.details.declaration=i;const c=zs(e),u=null==c?void 0:c.lookUpSymbolRecursive(e.name.value);i&&u&&B(u.symbol,i,l),N(e,l,void 0,!1),N(e.name,l,void 0,!1);const p=o&&Zs.isPseudoGenericClass(o)&&"__init__"===e.name.value,d=[];let h=0,m=0;if(o&&0==(4&l.details.flags)&&(m=1),e.functionAnnotationComment&&!e.functionAnnotationComment.isParamListEllipsis){const t=e.parameters.length-m,n=e.functionAnnotationComment.paramTypeAnnotations.length;m>0&&n===e.parameters.length?m=0:n!==t&&fe(ml.Diagnostic.annotatedParamCountMismatch().format({expected:t,received:n}),e.functionAnnotationComment)}const f=e=>{if(e.name){const n=wn(e.name,e.name.value,!1);n&&we(t,n.symbol,e.name)}};let g=!0;if(e.parameters.forEach(((n,i)=>{let r,s,a,c,u=!1;if(n.name&&(0===i&&o&&(Xs.isClassMethod(l)||Xs.isInstanceMethod(l)||Xs.isConstructorMethod(l))||Xs.isAbstractMethod(l)||o&&Zs.isProtocolClass(o))&&f(n),n.typeAnnotation)a=n.typeAnnotation;else if(n.typeAnnotationComment)a=n.typeAnnotationComment;else if(e.functionAnnotationComment&&!e.functionAnnotationComment.isParamListEllipsis){const t=i-m;t>=0&&t<e.functionAnnotationComment.paramTypeAnnotations.length&&(a=e.functionAnnotationComment.paramTypeAnnotations[t])}if(a&&(s=G(a,n.category),Io(s)&&!s.isVariadicUnpacked&&(fe(ml.Diagnostic.unpackedTypeVarTupleExpected().format({name1:s.details.name,name2:s.details.name}),a),s=Ys.create())),!s&&p&&i>0&&0===n.category&&n.name&&(s=o.details.typeParameters[h],h++),s){const e=Jt(n,s);e!==s&&(s=e,u=!0)}if(n.defaultValue&&(c=$(n.defaultValue,s,1).type),s){if(n.defaultValue&&c){const i=new il,r=new jo(l.details.typeVarScopeId);if(o&&void 0!==o.details.typeVarScopeId&&("__init__"!==e.name.value&&"__new__"!==e.name.value||r.addSolveForScope(o.details.typeVarScopeId)),!Jn(s,c,i,r)){const e=_e(t.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.paramAssignmentMismatch().format({sourceType:ai(c),paramType:ai(s)})+i.getString(),n.defaultValue);if(u&&a){const t={action:"pyright.addoptionalforparam",offsetOfTypeNode:a.start+1};e&&e.addAction(t)}}}r=s}const y=0===n.category&&n.name&&Kt(n.name.value),_=0===n.category&&!n.name;i>0&&g&&!y&&!_&&Xs.addParameter(l,{category:0,type:Ys.create()}),y&&!_||(g=!1);let v=!1;r||(v=!0,r=Qt(e,l.details.flags,i,o));const T={category:n.category,name:n.name?n.name.value:void 0,hasDefault:!!n.defaultValue,defaultValueExpression:n.defaultValue,defaultType:c,type:null!=r?r:Ys.create(),typeAnnotation:a,hasDeclaredType:!!a,isTypeInferred:v};if(Xs.addParameter(l,T),n.name){const t=Xt(e,n.category,T.type);d.push(t)}else d.push(T.type)})),g&&l.details.parameters.length>0&&Xs.addParameter(l,{category:0,type:Ys.create()}),d.forEach(((t,n)=>{const i=e.parameters[n].name;i&&(po(t)&&(l.details.flags|=16384),N(i,t,0,!1))})),d.length>=2){const e=d[d.length-2],t=d[d.length-1];wo(e)&&"args"===e.paramSpecAccess&&wo(t)&&"kwargs"===t.paramSpecAccess&&(l.details.flags|=32768)}if(e.returnTypeAnnotation){l.details.declaredReturnType=Ys.create();const t=K(e.returnTypeAnnotation,{associateTypeVarsWithScope:!0,disallowRecursiveTypeAlias:!0});l.details.declaredReturnType=t}else if(e.functionAnnotationComment){l.details.declaredReturnType=Ys.create();const t=K(e.functionAnnotationComment.returnTypeAnnotation,{associateTypeVarsWithScope:!0,disallowRecursiveTypeAlias:!0});l.details.declaredReturnType=t}else t.isStubFile&&("__init__"===e.name.value?l.details.declaredReturnType=to.createInstance():l.details.declaredReturnType=Ys.create());(t.isStubFile||Or(e.suite))&&l.details.declaredReturnType&&vo(l.details.declaredReturnType)&&Zs.isBuiltIn(l.details.declaredReturnType,["Generator","AsyncGenerator","AwaitableGenerator"])&&(l.details.flags|=16);let y=e.isAsync?function(e,t){const n=Xs.clone(t);return t.details.declaredReturnType&&(n.details.declaredReturnType=nn(e,t.details.declaredReturnType,Xs.isGenerator(t))),n.details.flags|=1024,n}(e,l):l,_=!1;for(let n=e.decorators.length-1;n>=0;n--){const i=e.decorators[n],r=tn(y,l,i,e);Oa(r)?_||(_e(t.diagnosticRuleSet.reportUntypedFunctionDecorator,$o.reportUntypedFunctionDecorator,ml.Diagnostic.functionDecoratorTypeUnknown(),e.decorators[n].expression),_=!0):y=r}return Eo(y)&&(Xs.isOverloaded(y)&&e.parameters.forEach((e=>{f(e)})),y=function(e,t){let n;const i=Mt(e);i&&(n=i);const r=wn(e,e.name.value,!1);if(r){const i=r.symbol.getDeclarations(),s=i.findIndex((e=>e===n));if(s>0){for(let e=0;e<s;e++){const t=i[e];3===t.type&&Gt(t.node)}const n=[],r=i[s-1];if(3===r.type){const e=Gt(r.node);e&&(Eo(e.decoratedType)?Xs.isOverloaded(e.decoratedType)&&n.push(e.decoratedType):ko(e.decoratedType)&&n.push(...e.decoratedType.overloads))}if(n.push(t),1===n.length)return n[0];const o=eo.create(n),a=n[n.length-2];return Xs.isAbstractMethod(a)!==Xs.isAbstractMethod(t)&&_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.overloadAbstractMismatch().format({name:e.name.value}),e.name),o}}return t}(e,y)),N(e.name,l,0,!1),N(e,y,0,!1),{functionType:l,decoratedType:y}}function Jt(e,t){var n;if(11!==(null===(n=e.defaultValue)||void 0===n?void 0:n.nodeType)||26!==e.defaultValue.constType||Go(t)||Vt(e).diagnosticRuleSet.strictParameterNoneValue){if(bo(t)&&e.defaultValue&&1===t.scopeType){const n=$(e.defaultValue,t,1).type;uo(n)||(t=Oo([t,n]))}}else t=Oo([t,to.createInstance()]);return t}function Qt(e,t,n,i){var r;if(i){if(0===n&&0==(4&t))return Aa(i,0!=(3&t));const s=va(i,e.name.value,1);if(s){const t=s.symbol.getDeclarations();if(1===t.length&&3===t[0].type){const i=t[0].node;if(i.parameters.length===e.parameters.length&&i.parameters.every(((t,n)=>{var i,r;const s=e.parameters[n];return(null===(i=s.name)||void 0===i?void 0:i.value)===(null===(r=t.name)||void 0===r?void 0:r.value)&&s.category===t.category}))){const t=i.parameters[n],s=null!==(r=t.typeAnnotation)&&void 0!==r?r:t.typeAnnotationComment;if(s){let t=G(s,e.parameters[n].category);const i=Vt(e);return i.isInPyTypedPackage&&!i.isStubFile&&(t=Ks.cloneForAmbiguousType(t)),t}}}}}const s=e.parameters[n].defaultValue;if(s){const t=$(s,void 0,1).type;let n;if(lo(t)?n=Oo([to.createInstance(),Ys.create()]):vo(t)&&Zs.isBuiltIn(t,["tuple","list","set","dict"])||(n=Qo(t)),n){const t=Vt(e);t.isInPyTypedPackage&&!t.isStubFile&&(n=Ks.cloneForAmbiguousType(n))}return n}}function Xt(e,t,n){switch(t){case 0:return n;case 1:return bo(n)&&n.paramSpecAccess?n:xo(n)?Zs.cloneForUnpacked(n,!1):T&&_o(T)?Zs.cloneAsInstance(Va(T,[{type:n,isUnbounded:!Io(n)}],!0,!0)):Ys.create();case 2:{if(bo(n)&&n.paramSpecAccess)return n;if(vo(n)&&Zs.isTypedDictClass(n)&&n.isUnpacked)return n;const t=xn(e,"dict"),i=Cn(e,"str");return _o(t)&&vo(i)?Zs.cloneAsInstance(Zs.cloneForSpecialization(t,[i,n],!0)):Ys.create()}}}function en(e,t){const n=Vt(e);let i=0;"__new__"===e.name.value&&t&&(i|=1),"__init_subclass__"===e.name.value&&t&&(i|=2);for(const r of e.decorators){let e=n.isStubFile?4:0;9!==r.expression.nodeType&&(e|=2);const s=$(r.expression,void 0,e).type;Eo(s)?"abstractmethod"===s.details.builtInName?t&&(i|=8):"final"===s.details.builtInName&&(i|=8192):_o(s)&&(Zs.isBuiltIn(s,"staticmethod")?t&&(i|=4):Zs.isBuiltIn(s,"classmethod")&&t&&(i|=2))}return i}function tn(e,t,n,i){let r=Vt(n).isStubFile?4:0;9!==n.expression.nodeType&&(r|=2);const s=$(n.expression,void 0,r).type;if((_o(s)&&Zs.isSpecialBuiltIn(s,"overload")||Eo(s)&&"overload"===s.details.builtInName)&&Eo(e))return e.details.flags|=256,t.details.flags|=256,e;if(9===n.expression.nodeType){const i=$(n.expression.leftExpression,void 0,2|r).type;if(Eo(i)&&("__dataclass_transform__"===i.details.name||"dataclass_transform"===i.details.builtInName))return t.details.decoratorDataClassBehaviors=qu(li,n.expression),e}let o=J(n,e);if(Eo(s)){if("abstractmethod"===s.details.builtInName)return e;if(35===n.expression.nodeType){const t=$(n.expression.leftExpression,void 0,2|r).type;if(ua(t)){const r=n.expression.memberName.value;if("setter"===r)return Eo(e)?($u(li,e,n),function(e,t,n,i){if(!ua(t))return t;const r=t,s=r.details.flags;let o=!!r.isAsymmetricDescriptor;const a=Vt(i);if(i.parameters.length>=2){const t=e.getTypeAnnotationForParameter(i,1);if(t){const n=e.getGetterTypeFromProperty(r,!1);if(n&&!ho(n)){const i=e.getTypeOfAnnotation(t,{associateTypeVarsWithScope:!0,disallowRecursiveTypeAlias:!0});if("none"!==a.diagnosticRuleSet.reportPropertyTypeMismatch){const r=new il;e.canAssignType(n,i,r)||e.addDiagnostic(a.diagnosticRuleSet.reportPropertyTypeMismatch,$o.reportPropertyTypeMismatch,ml.Diagnostic.setterGetterTypeMismatch()+r.getString(),t)}Ao(n,i)||(o=!0)}}}const l=Zs.createInstantiable(r.details.name,r.details.fullName,r.details.moduleName,Vt(i).filePath,s,r.details.typeSourceId,r.details.declaredMetaclass,r.details.effectiveMetaclass);l.details.typeVarScopeId=r.details.typeVarScopeId,Ha(l);const c=Zs.cloneAsInstance(l);l.isAsymmetricDescriptor=o;const u=l.details.fields;r.details.fields.forEach(((e,t)=>{e.isIgnoredForProtocolMatch()||u.set(t,e)}));const p=qo.createWithType(4,n);u.set("fset",p);const d=Xs.createInstance("__set__","","",64);Xs.addParameter(d,{category:0,name:"self",type:t,hasDeclaredType:!0});let h=n.details.parameters.length>0?n.details.parameters[0].type:io.create();bo(h)&&h.details.isSynthesizedSelf&&(h=e.makeTopLevelTypeVarsConcrete(h)),Xs.addParameter(d,{category:0,name:"obj",type:Oo([h,to.createInstance()]),hasDeclaredType:!0}),d.details.declaredReturnType=to.createInstance();let m=Ys.create();n.details.parameters.length>=2&&0===n.details.parameters[1].category&&n.details.parameters[1].name&&(m=n.details.parameters[1].type),Xs.addParameter(d,{category:0,name:"value",type:m,hasDeclaredType:!0});const f=qo.createWithType(4,d);return u.set("__set__",f),c}(li,t,e,i)):e;if("deleter"===r)return Eo(e)?($u(li,e,n),function(e,t,n,i){var r;if(!ua(t))return t;const s=t,o=Zs.createInstantiable(s.details.name,s.details.fullName,s.details.moduleName,Vt(i).filePath,s.details.flags,s.details.typeSourceId,s.details.declaredMetaclass,s.details.effectiveMetaclass);o.details.typeVarScopeId=s.details.typeVarScopeId,Ha(o);const a=Zs.cloneAsInstance(o);o.isAsymmetricDescriptor=null!==(r=s.isAsymmetricDescriptor)&&void 0!==r&&r;const l=o.details.fields;s.details.fields.forEach(((e,t)=>{e.isIgnoredForProtocolMatch()||l.set(t,e)}));const c=qo.createWithType(4,n);l.set("fdel",c);const u=Xs.createInstance("__delete__","","",64);Xs.addParameter(u,{category:0,name:"self",type:t,hasDeclaredType:!0});let p=n.details.parameters.length>0?n.details.parameters[0].type:io.create();bo(p)&&p.details.isSynthesizedSelf&&(p=e.makeTopLevelTypeVarsConcrete(p)),Xs.addParameter(u,{category:0,name:"obj",type:Oo([p,to.createInstance()]),hasDeclaredType:!0}),u.details.declaredReturnType=to.createInstance();const d=qo.createWithType(4,u);return l.set("__delete__",d),a}(li,t,e,i)):e}}}else if(_o(s)){if(Zs.isBuiltIn(s))switch(s.details.name){case"classmethod":case"staticmethod":{const t="classmethod"===s.details.name?2:4;if(Eo(e)&&0==(e.details.flags&t)){const n=Xs.clone(e);return n.details.flags&=-8,n.details.flags|=t,n}return e}}if(Zs.isPropertyClass(s)){if(Eo(e))return $u(li,e,n),Hu(li,n,s,e);if(vo(e)){const t=_a(e,"__call__");if(t){const i=Bn(t);if(Eo(i)||ko(i)){const t=ri(e,i);if(t&&Eo(t))return Hu(li,n,s,t)}}return Ys.create()}}}return Eo(e)&&Eo(o)&&(o=Xs.clone(o),Xs.isOverloaded(e)&&(o.details.flags|=256),o.details.docString||(o.details.docString=e.details.docString)),o}function nn(e,t,n){let i;if(vo(t)&&Zs.isBuiltIn(t))if("Generator"===t.details.name){const n=ce(e,"AsyncGenerator");if(n&&_o(n)){const e=[],r=t.typeArguments;r&&r.length>0&&e.push(r[0]),r&&r.length>1&&e.push(r[1]),i=Zs.cloneAsInstance(Zs.cloneForSpecialization(n,e,!0))}}else["AsyncGenerator","AsyncIterator","AsyncIterable"].some((e=>e===t.details.name))&&(i=t);if(!i||!n){const n=ce(e,"Coroutine");i=n&&_o(n)?Zs.cloneAsInstance(Zs.cloneForSpecialization(n,[io.create(),io.create(),t],!0)):Ys.create()}return i}function rn(e,t){var n;if(e.returnTypeAnnotation||(null===(n=e.functionAnnotationComment)||void 0===n?void 0:n.returnTypeAnnotation))return;let r=F(e.suite,0);if(r)return r;if(!i.has(e.id)){i.set(e.id,!0);try{let n;const s=Mt(e);s&&(n=s);const o=!de(e),a=de(e.suite);if(Vt(e).isStubFile)r=Ys.create();else{if(o)r=t||function(e){if(!e||!e.isMethod||e.returnStatements||e.yieldStatements||!e.raiseStatements)return!1;for(const t of e.raiseStatements){if(!t.typeExpression||t.valueExpression)return!1;const e=$(t.typeExpression).type,n=_o(e)||vo(e)?e:void 0;if(!n||!Zs.isBuiltIn(n,"NotImplementedError"))return!1}return!0}(n)?Ys.create():no.createNoReturn();else{const e=[];(null==n?void 0:n.returnStatements)&&n.returnStatements.forEach((t=>{if(pe(t))if(t.returnExpression){const n=$(t.returnExpression).type;e.push(n||Ys.create())}else e.push(to.createInstance())})),!o&&a&&e.push(to.createInstance()),r=Oo(e),r=Ro(r)}if(null==n?void 0:n.isGenerator){const t=[];let i=!1;n.yieldStatements&&n.yieldStatements.forEach((e=>{if(pe(e))if(61===e.nodeType){const n=$(e.expression).type;if(vo(n)&&Zs.isBuiltIn(n,"Coroutine"))t.push(),i=!0;else{const i=ae(n,!1,e);t.push(i||Ys.create())}}else if(e.expression){const n=$(e.expression).type;t.push(n||Ys.create())}else t.push(to.createInstance())})),0===t.length&&t.push(to.createInstance());const s=Oo(t),o=ce(e,i?"AwaitableGenerator":"Generator");if(o&&_o(o)){const e=[];i&&e.push(io.create()),e.push(s,to.createInstance(),ao(r)?to.createInstance():r),r=Zs.cloneAsInstance(Zs.cloneForSpecialization(o,e,!0))}else r=Ys.create()}}N(e.suite,r,0,!1)}finally{i.delete(e.id)}}return r}function sn(e){if(F(e,0))return;const t=$(e.iterableExpression),n=ae(t.type,!!e.isAsync,e.iterableExpression)||Ys.create();xe(e.targetExpression,n,!!t.isIncomplete,e.targetExpression),N(e,n,0,!!t.isIncomplete)}function on(e){if(w(void 0!==e.typeExpression),F(e,0))return;function t(e,t){return ho(e=Ie(e))?e:_o(e)?Zs.cloneAsInstance(e):vo(e)?Ko(ae(e,!1,t)||Ys.create(),(e=>ho(e)?e:Ys.create())):Ys.create()}const n=Ko($(e.typeExpression).type,(n=>{const i=ia(n);return i&&i.tupleTypeArguments?Oo(i.tupleTypeArguments.map((n=>t(n.type,e.typeExpression)))):t(n,e.typeExpression)}));e.name&&xe(e.name,n,!1,e.name),N(e,n,0,!1)}function an(e){if(F(e,0))return;const t=$(e.expression);let n=t.type;const i=e.parent&&58===e.parent.nodeType&&!!e.parent.isAsync;Go(n)&&(_e(Vt(e).diagnosticRuleSet.reportOptionalContextManager,$o.reportOptionalContextManager,ml.Diagnostic.noneNotUsableWith(),e.expression),n=Fo(n));const r=i?"__aenter__":"__enter__",s=Ko(n,(t=>{var n;if(ho(t=Ie(t)))return t;const s=new il,o=new il;if(vo(t)){const a=null===(n=ee(e.expression,t,r,{method:"get"},s))||void 0===n?void 0:n.type;if(a){let t;return t=Eo(a)?Un(a):Ys.create(),i&&(t=oe(t,e)),t}i||ee(e.expression,t,"__aenter__",{method:"get"},s)&&o.addMessage(ml.DiagnosticAddendum.asyncHelp())}return _e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeNotUsableWith().format({type:ai(t),method:r})+o.getString(),e.expression),Ys.create()})),o=i?"__aexit__":"__exit__";Jo(n,(t=>{if(ho(t=Ie(t)))return;const n=new il;vo(t)&&ee(e.expression,t,o,{method:"get"},n)||_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeNotUsableWith().format({type:ai(t),method:o}),e.expression)})),e.target&&xe(e.target,s,!!t.isIncomplete,e.target),N(e,s,0,!!t.isIncomplete)}function ln(e){if(F(e,0))return;let t;if(t=e.alias?e.alias:e.module.nameParts[0],!t)return;let n=dn(e,t.value)||Ys.create();const i=F(e,0);i&&To(i)&&n&&Ao(n,i)&&(n=i),Te(t,n,!1),N(e,n,0,!1)}function cn(t){var n;if(F(t,0))return;const i=t.alias||t.name,r=Vt(t);if((null===(n=t.alias)||void 0===n?void 0:n.value)===t.name.value){const e=wn(t,t.name.value,!0);e&&we(r,e.symbol,t)}let s=dn(t,i.value);if(!s){const n=t.parent;w(n&&22===n.nodeType),w(!n.isWildcardImport);const i=Rt(n.module);if(i&&i.isImportFound&&!i.isNativeLib){const n=i.resolvedPaths[i.resolvedPaths.length-1],o=e(n);let a=!1;if(o){if(a=!0,r.executionEnvironment.pythonVersion>=De.V3_7||r.isStubFile){const e=o.symbolTable.get("__getattr__");if(e){const t=Nn(e);Eo(t)&&(s=Un(t),a=!1)}}}else n||(a=!0);a&&_e(r.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.importSymbolUnknown().format({name:t.name.value,moduleName:i.importName}),t.name)}s||(s=Ys.create())}Te(i,s,!1),N(t,s,0,!1)}function un(e){if(F(e,0))return;if(!e.parent||63!==e.parent.nodeType)return void E("Expected parent of case statement to be match statement");const t=$(e.parent.subjectExpression);let n=t.type;for(const t of e.parent.cases){if(t===e)break;t.guardExpression||(n=fu(li,n,t.pattern,!1))}let i=!1;Jo(Ie(n),(e=>{vo(e)&&Zs.isBuiltIn(e,"object")&&(i=!0)})),n=fu(li,n,e.pattern,!0),bu(li,n,!!t.isIncomplete,i,e.pattern),N(e,n,0,!!t.isIncomplete)}function pn(e){if(F(e,0))return;const t=e.module.nameParts[0];let n=dn(e,t.value)||Ys.create();const i=F(e,0);i&&To(i)&&n&&Ao(n,i)&&(n=i),Te(t,n,!1),N(e,n,0,!1)}function dn(e,n){const i=wn(e,n,!0);if(!i)return;const r=i.symbol.getDeclarations().filter((t=>Mr(e,t.node)&&6===t.type));let s=r.length>0?r[r.length-1]:void 0;if(s||(s=i.symbol.getDeclarations().find((e=>6===e.type))),!s)return;w(6===s.type);const o=Vt(e),a=Fn(s,!0,o.isStubFile);if(a){if(!a.declaration)return t.evaluateUnknownImportsAsAny?io.create():Ys.create();if(23===e.nodeType&&(a.isPrivate&&_e(o.diagnosticRuleSet.reportPrivateUsage,$o.reportPrivateUsage,ml.Diagnostic.privateUsedOutsideOfModule().format({name:e.name.value}),e.name),a.privatePyTypedImporter)){const t=new il;a.privatePyTypedImported&&t.addMessage(ml.DiagnosticAddendum.privateImportFromPyTypedSource().format({module:a.privatePyTypedImported})),_e(o.diagnosticRuleSet.reportPrivateImportUsage,$o.reportPrivateImportUsage,ml.Diagnostic.privateImportFromPyTypedModule().format({name:e.name.value,module:a.privatePyTypedImporter})+t.getString(),e.name)}return Pn(i.symbol,s)}}function hn(e){var t,n,i;let r=e,s=e;function o(e){var t,n,i,r,s;return 41===e.nodeType&&30===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)||1===e.nodeType&&(9===(null===(n=e.parent)||void 0===n?void 0:n.nodeType)||24===(null===(i=e.parent)||void 0===i?void 0:i.nodeType))||54===(null===(r=e.parent)||void 0===r?void 0:r.nodeType)||41===(null===(s=e.parent)||void 0===s?void 0:s.nodeType)&&(e===e.parent.typeAnnotation||e===e.parent.typeAnnotationComment)||9===e.nodeType||24===e.nodeType||15===e.nodeType||27===e.nodeType||31===e.nodeType||30===e.nodeType||35===e.nodeType||45===e.nodeType||49===e.nodeType||48===e.nodeType||52===e.nodeType||56===e.nodeType||17===e.nodeType||16===e.nodeType||32===e.nodeType||33===e.nodeType||34===e.nodeType||65===e.nodeType||67===e.nodeType||68===e.nodeType||74===e.nodeType||66===e.nodeType||69===e.nodeType||70===e.nodeType||73===e.nodeType||71===e.nodeType||72===e.nodeType}if(38===e.nodeType&&e.parent){if(28===e.parent.nodeType&&e.parent.name===e)return void Gt(e.parent);if(10===e.parent.nodeType&&e.parent.name===e)return void $t(e.parent);if(29===e.parent.nodeType||39===e.parent.nodeType)return void $(e,void 0,4)}for(;s;){const e=o(s);if(!e&&!yr(s))break;e&&(r=s),s=s.parent}const a=r.parent;if(3===a.nodeType)return void(r===a.typeAnnotationComment?K(r,{isVariableAnnotation:!0,allowFinal:Fr(a.leftExpression),allowClassVar:Nr(a.leftExpression)}):Wt(a));if(14===a.nodeType)return void Ce(r);if(5===a.nodeType)return void jt(a);if(13===a.nodeType)return void(10===(null===(t=a.parent)||void 0===t?void 0:t.nodeType)?$t(a.parent):28===(null===(n=a.parent)||void 0===n?void 0:n.nodeType)&&Gt(a.parent));const l=e=>{const t=e.parent;if(3===(null==t?void 0:t.nodeType)&&t.leftExpression===a)Wt(t);else{const t=K(e.typeAnnotation,{isVariableAnnotation:!0,allowFinal:Fr(e.valueExpression),allowClassVar:Nr(e.valueExpression)});N(e.valueExpression,t,0,!1)}};if(64===a.nodeType&&r!==a.guardExpression)return void un(a);if(54===a.nodeType)return void l(a);if(41===a.nodeType&&r!==a.defaultValue)return void mn(a);if(28===a.nodeType&&(r===a.returnTypeAnnotation||r===a.functionAnnotationComment))return void K(r,{associateTypeVarsWithScope:!0,disallowRecursiveTypeAlias:!0});if(37===a.nodeType)return;if(1===a.nodeType&&r===a.name)return;if(1===a.nodeType&&10===(null===(i=a.parent)||void 0===i?void 0:i.nodeType))return void $t(a.parent);if(44===a.nodeType&&a.returnExpression){const t=kr(e),n=t?Vn(t):void 0;return void $(a.returnExpression,n,0)}const c=yr(a)&&0!==a.nodeType?a:r;54===c.nodeType?l(c):$(c,void 0,Vt(c).isStubFile?4:0)}function mn(e){if(!e.name)return;const t=e.parent;if(30===t.nodeType)return void hn(t);w(28===t.nodeType);const n=t,i=n.parameters.findIndex((t=>t===e)),r=ie(n,i);if(r){const t=n.parameters[i],s=G(r,n.parameters[i].category),o=Xt(e,e.category,Jt(t,s));return void N(e.name,o,0,!1)}const s=Er(n,!0);if(s){const t=$t(s);if(t){const r=Qt(n,en(n,!0),i,t.classType);if(r)return void N(e.name,Xt(e,e.category,r),0,!1)}}N(e.name,Xt(e,e.category,Ys.create()),0,!1)}function fn(e){z(e);let t=e;for(;t;){switch(t.nodeType){case 3:if(!t.parent||3!==t.parent.nodeType&&4!==t.parent.nodeType&&5!==t.parent.nodeType||t.parent.rightExpression!==t)return void Wt(t);break;case 4:return void $(t);case 5:return void jt(t);case 10:return void $t(t);case 41:return void mn(t);case 30:return void hn(t);case 28:return void Gt(t);case 26:return void sn(t);case 25:return void on(t);case 59:return void an(t);case 33:{const e=t.parent;if(w(32===e.nodeType),t===e.expression)hn(e);else for(const n of e.forIfNodes)if(Ct(n),n===t)break;return}case 21:return void ln(t);case 23:return void cn(t);case 22:return void pn(t);case 64:return void un(t)}t=t.parent}E("Unexpected statement")}function gn(e,t){let n=F(e,void 0);if(n)return{node:e,type:n};const i=C;try{if(C=new Map,t(),n=F(e,void 0),n)return{node:e,type:n};if(n=C.get(e.id),n)return{node:e,type:n,isIncomplete:!0};C=i}catch(e){throw C=i,e}}function yn(e){let t=r.get(e);return t||(t=ci.createCodeFlowAnalyzer(),r.set(e,t)),t}function _n(e,t,n,i,r){var s;const o=At(e),a=Rr(null!==(s=null==r?void 0:r.parent)&&void 0!==s?s:e),l=a.codeFlowExpressions;if(!l||!l.has(o))return{type:void 0,isIncomplete:!1};let c;c=L(a)?function(){const e=D.length;return w(e>0),D[e-1].codeFlowAnalyzer}():yn(a.id);const u=Lt(null!=r?r:e);return void 0===u?{type:void 0,isIncomplete:!1}:vn(c,u,e,t,n,i)}function vn(e,t,n,i,r,s){let o;d.enterTrackingScope();try{o=e.getTypeFromCodeFlow(t,n,i,r,s),d.exitTrackingScope()}catch(e){throw d.exitTrackingScope(),e}return o.isIncomplete&&d.enableUndoTracking(),o}function Tn(e,t,n,i){if(Zs.isSpecialBuiltIn(e)){const r=e.aliasName||e.details.name;switch(r){case"Callable":return function(e,t){const n=Xs.createInstantiable("","","",0);Ks.setSpecialForm(n),n.details.declaredReturnType=Ys.create();const i=Dr(t);if(n.details.typeVarScopeId=i?Pe(i):$s,e&&e.length>0){if(e[0].typeList){const t=e[0].typeList;let i=!1,r=!1;const s=e=>{i&&(r||(fe(ml.Diagnostic.variadicTypeArgsTooMany(),e.node),r=!0)),i=!0};t.forEach(((e,t)=>{let i=e.type,r=0;const o=`__p${t.toString()}`;Io(i)?(Oe(i,e.node),r=1,s(e)):Et(e,{allowUnpackedTuples:!0})?xo(i)&&(r=1,s(e)):i=Ys.create(),Xs.addParameter(n,{category:r,name:o,isNameSynthesized:!0,type:Fa(i),hasDeclaredType:!0})})),Xs.addParameter(n,{category:0,isNameSynthesized:!1,type:Ys.create()})}else if(ca(e[0].type))Xs.addDefaultParameters(n),n.details.flags|=32768;else if(wo(e[0].type))n.details.paramSpec=e[0].type;else if(_o(e[0].type)&&Zs.isBuiltIn(e[0].type,"Concatenate")){const t=e[0].type.typeArguments;t&&t.length>0&&t.forEach(((e,i)=>{i===t.length-1?(Xs.addParameter(n,{category:0,isNameSynthesized:!1,type:Ys.create()}),wo(e)&&(n.details.paramSpec=e)):Xs.addParameter(n,{category:0,name:`__p${i}`,isNameSynthesized:!0,hasDeclaredType:!0,type:e})}))}else fe(ml.Diagnostic.callableFirstArg(),e[0].node);if(e.length>1){let t=e[1].type;Et(e[1])||(t=Ys.create()),n.details.declaredReturnType=Fa(t)}else _e(Vt(t).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.callableSecondArg(),t),n.details.declaredReturnType=Ys.create();e.length>2&&fe(ml.Diagnostic.callableExtraArgs(),e[2].node)}else Xs.addDefaultParameters(n,!0),n.details.flags|=32768;return n}(t,i);case"Never":return t&&t.length>0&&fe(ml.Diagnostic.typeArgsExpectingNone().format({name:"Never"}),t[0].node),no.createNever();case"NoReturn":return t&&t.length>0&&fe(ml.Diagnostic.typeArgsExpectingNone().format({name:"NoReturn"}),t[0].node),no.createNoReturn();case"Optional":return function(e,t,n,i){if(!n)return 0!=(1024&i)?(fe(ml.Diagnostic.optionalExtraArgs(),t),Ys.create()):e;if(n.length>1)return fe(ml.Diagnostic.optionalExtraArgs(),t),Ys.create();let r=n[0].type;Et(n[0])?Ks.isInstantiable(r)||(ve(r,n[0].node),r=Ys.create()):r=Ys.create();const s=Oo([r,to.createType()]);return fo(s)&&Ks.setSpecialForm(s),s}(e,i,t,n);case"Type":{if(1===(null==t?void 0:t.length)&&ho(t[0].type)&&_&&_o(_))return _;let n=Ot(e,t,1);return _o(n)&&(n=Ua(n)),n}case"ClassVar":return function(e,t,n,i){var r;if(131072&i)return fe(ml.Diagnostic.classVarNotAllowed(),t),io.create();if(!n)return e;if(0===n.length)return fe(ml.Diagnostic.classVarFirstArgMissing(),t),Ys.create();if(n.length>1)return fe(ml.Diagnostic.classVarTooManyArgs(),n[1].node),Ys.create();const s=n[0].type;return $a(s,!0,!0)&&_e(Vt(t).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.classVarWithTypeVar(),null!==(r=n[0].node)&&void 0!==r?r:t),s}(e,i,t,n);case"Protocol":return Ot(e,t,void 0,!0);case"Tuple":return Ot(e,t,void 0);case"Union":return function(e,t,n,i){const r=[];if(!n)return 0!=(1024&i)?(fe(ml.Diagnostic.unionTypeArgCount(),t),no.createNever()):e;for(const e of n){let t=e.type;Et(e,{allowVariadicTypeVar:!0,allowUnpackedTuples:!0})?Ks.isInstantiable(t)||(ve(t,e.node),t=Ys.create()):t=Ys.create(),xo(e.type)&&e.type.tupleTypeArguments?e.type.tupleTypeArguments.forEach((e=>{r.push(Na(e.type))})):(bo(t)&&Io(t)&&t.isVariadicUnpacked&&(t=oo.cloneForUnpacked(t,!0)),r.push(t))}1===r.length&&(Io(r[0])||Co(r[0])||lo(r[0])||fe(ml.Diagnostic.unionTypeArgCount(),t));const s=Oo(r);return fo(s)&&Ks.setSpecialForm(s),s}(e,i,t,n);case"Generic":return function(e,t,n,i){if(!n)return 0!=(263168&i)&&fe(ml.Diagnostic.genericTypeArgMissing(),t),e;const r=[];return n&&(0===n.length&&fe(ml.Diagnostic.genericTypeArgMissing(),t),n.forEach((e=>{bo(e.type)?(r.some((t=>Ao(t,e.type)))&&fe(ml.Diagnostic.genericTypeArgUnique(),e.node),r.push(e.type)):fe(ml.Diagnostic.genericTypeArgTypeVar(),e.node)}))),Ot(e,n,void 0,!0)}(e,i,t,n);case"Final":return function(e,t,n,i){return 16&i?(fe(ml.Diagnostic.finalContext(),t),io.create()):n&&0!==n.length?(n.length>1&&fe(ml.Diagnostic.finalTooManyArgs(),t),n[0].type):e}(e,i,t,n);case"Annotated":return function(e,t){return t&&t.length<2&&fe(ml.Diagnostic.annotatedTypeArgMissing(),e),t&&0!==t.length?Ks.cloneForAnnotated(t[0].type):io.create()}(i,t);case"Concatenate":return function(e,t,n){return n&&0!==n.length?n.forEach(((e,t)=>{t===n.length-1?wo(e.type)||fe(ml.Diagnostic.concatenateParamSpecMissing(),e.node):wo(e.type)&&fe(ml.Diagnostic.paramSpecContext(),e.node)})):fe(ml.Diagnostic.concatenateTypeArgsMissing(),e),Ot(t,n,void 0,!0)}(i,e,t);case"TypeGuard":case"StrictTypeGuard":return function(e,t,n,i){if(!n)return 0!=(1024&i)&&fe(ml.Diagnostic.typeGuardArgCount(),e),t;if(1!==n.length)return fe(ml.Diagnostic.typeGuardArgCount(),e),Ys.create();const r=n.map((e=>Fa(Et(e)?e.type:Ys.create())));return Zs.cloneForSpecialization(t,r,!0)}(i,e,t,n);case"Unpack":return function(e,t,n){if(!t||1!==t.length)return fe(ml.Diagnostic.unpackArgCount(),e),Ys.create();let i=t[0].type;fo(i)&&1===i.subtypes.length&&(i=i.subtypes[0]);const r=Vt(e);return 0!=(2097152&n)?_o(i)&&!i.includeSubclasses&&pa(i)?Zs.cloneForUnpacked(i):Io(i)&&!i.isVariadicUnpacked?oo.cloneForUnpacked(i):(_e(r.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.unpackExpectedTypeVarTuple(),e),Ys.create()):0!=(8388608&n)?_o(i)&&Zs.isTypedDictClass(i)?Zs.cloneForUnpacked(i):(_e(r.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.unpackExpectedTypedDict(),e),Ys.create()):(_e(r.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.unpackNotAllowed(),e),Ys.create())}(i,t,n);case"Required":case"NotRequired":return function(e,t,n,i,r){var s;if(!i&&0==(1024&r))return e;if(!i||1!==i.length)return fe(n?ml.Diagnostic.requiredArgCount():ml.Diagnostic.notRequiredArgCount(),t),e;const o=i[0].type,a=Er(t,!0),l=a?$t(a):void 0;let c=!1;return l&&_o(l.classType)&&Zs.isTypedDictClass(l.classType)&&54===(null===(s=t.parent)||void 0===s?void 0:s.nodeType)&&t.parent.typeAnnotation===t&&(c=!0),0!=(1048576&r)&&(c=!0),c?o:(fe(n?ml.Diagnostic.requiredNotInTypedDict():ml.Diagnostic.notRequiredNotInTypedDict(),t),Zs.cloneForSpecialization(e,[Fa(o)],!!i))}(e,i,"Required"===r,t,n);case"Self":return function(e,t,n){var i;const r=Vt(t);n&&_e(r.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeArgsExpectingNone().format({name:e.details.name}),null!==(i=n[0].node)&&void 0!==i?i:t);const s=Er(t),o=s?$t(s):void 0;if(!o)return _e(r.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.selfTypeContext(),t),Ys.create();const a=kr(t);if(a){if(4&en(a,!0))return _e(r.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.selfTypeContext(),t),Ys.create();if(a.parameters.length>0){const e=ie(a,0);if(e&&!Mr(t,e)){const n=K(e,{associateTypeVarsWithScope:!0,disallowRecursiveTypeAlias:!0});bo(n)&&n.details.isSynthesizedSelf||_e(r.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.selfTypeWithTypedSelfOrCls(),t)}}}return Aa(o.classType,!0)}(e,i,t);case"LiteralString":return Ot(e,t,0)}}const r=Vt(i);if(r.isStubFile||r.executionEnvironment.pythonVersion>=De.V3_9||H(Vt(i))||0!=(4&n)){if(Zs.isBuiltIn(e,"type")&&t){if(1===t.length&&ho(t[0].type))return e;const n=ce(i,"Type");if(n&&_o(n)){let e=Ot(n,t,1,void 0,!0);return _o(e)&&(e=Ua(e)),e}}if(pa(e))return Ot(e,t,void 0,void 0,!0)}let s=t?t.length:0;const o=Zs.isPseudoGenericClass(e)?[]:Zs.getTypeParameters(e);if(0===o.length&&0===s)return e;const a=o.findIndex((e=>Io(e)));if(t){if(s>o.length){if(!Zs.isPartiallyConstructed(e)&&!Zs.isTupleClass(e)){const n=Vt(i);0===o.length?_e(n.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeArgsExpectingNone().format({name:e.aliasName||e.details.name}),t[o.length].node):1===o.length&&wo(o[0])||_e(n.diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeArgsTooMany().format({name:e.aliasName||e.details.name,expected:o.length,received:s}),t[o.length].node)}s=o.length}else s<o.length&&_e(Vt(i).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeArgsTooFew().format({name:e.aliasName||e.details.name,expected:o.length,received:s}),t.length>0?t[0].node.parent:i);t.forEach(((e,t)=>{if(t===a){if(vo(e.type)&&pa(e.type))return;if(Io(e.type))return void Oe(e.type,e.node)}const n=t<o.length?o[t]:void 0;Et(e,{allowParamSpec:!0,allowTypeArgList:null==n?void 0:n.details.isParamSpec})}))}let l=[];const c=Zs.getTypeParameters(e);if(1===c.length&&c[0].details.isParamSpec&&t)if(t.every((e=>!ca(e.type)&&!e.typeList&&!wo(e.type))))1===t.length&&_o(t[0].type)&&Zs.isBuiltIn(t[0].type,"Concatenate")||(t=[{type:Ys.create(),node:t[0].node,typeList:t}]);else if(t.length>1){const e=t.find((e=>wo(e.type)));e&&fe(ml.Diagnostic.paramSpecContext(),e.node);const n=t.find((e=>!!e.typeList));n&&fe(ml.Diagnostic.typeArgListNotAllowed(),n.node)}return c.forEach(((e,n)=>{if(t&&n<t.length){if(e.details.isParamSpec){const e=t[n],i=Xs.createInstantiable("","","",65536);if(Ks.setSpecialForm(i),ca(e.type))return Xs.addDefaultParameters(i),i.details.flags|=32768,void l.push(i);if(e.typeList)return e.typeList.forEach(((e,t)=>{Xs.addParameter(i,{category:0,name:`__p${t}`,isNameSynthesized:!0,type:Fa(e.type),hasDeclaredType:!0})})),void l.push(i);if(_o(e.type)&&Zs.isBuiltIn(e.type,"Concatenate")){const t=e.type.typeArguments;return t&&t.length>0&&t.forEach(((e,n)=>{n===t.length-1?wo(e)&&(i.details.paramSpec=e):Xs.addParameter(i,{category:0,name:`__p${n}`,isNameSynthesized:!0,hasDeclaredType:!0,type:e})})),void l.push(i)}}l.push(Fa(t[n].type))}else l.push(Ys.create())})),l=l.map(((e,n)=>{if(n<s){const i=new il,r=function(e,t,n,i=0,r=0){if(r>Gs)return t;if(r++,ho(t))return t;let s=t;if(bo(t)){if(Ao(t,e,void 0,void 0,r))return t;s=Ie(t)}if(e.details.boundType&&!Jn(e.details.boundType,s,n.createAddendum(),void 0,i,r))return void(e.details.isSynthesized||n.addMessage(ml.DiagnosticAddendum.typeBound().format({sourceType:ai(s),destType:ai(e.details.boundType),name:oo.getReadableName(e)})));if(e.details.isParamSpec)return wo(t)||Eo(t)&&Xs.isParamSpecValue(t)||vo(t)&&Zs.isBuiltIn(t,"Concatenate")?t:void n.addMessage(ml.DiagnosticAddendum.typeParamSpec().format({type:ai(t),name:oo.getReadableName(e)}));if(bo(t)&&t.details.isParamSpec)return void n.addMessage(ml.Diagnostic.paramSpecContext());const o=e.details.constraints;if(0===o.length)return t;if(bo(t)&&t.details.constraints.length>0){if(t.details.constraints.every((e=>o.some((t=>Jn(t,e,void 0,void 0,void 0,r))))))return t}else{let e;for(const t of o)Jn(t,s,void 0,void 0,void 0,r)&&(e&&!Jn(e,t,void 0,void 0,void 0,r)||(e=t));if(e)return e}n.addMessage(ml.DiagnosticAddendum.typeConstrainedTypeVar().format({type:ai(t),name:oo.getReadableName(e)}))}(o[n],e,i);r?e=r:vo(e)&&Zs.isPartiallyConstructed(e)||_e(Vt(t[n].node).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.typeVarAssignmentMismatch().format({type:ai(e),name:oo.getReadableName(o[n])})+i.getString(),t[n].node)}return e})),Zs.cloneForSpecialization(e,l,void 0!==t)}function bn(e){return e.type?{type:e.type}:e.valueExpression?$(e.valueExpression):{type:Ys.create()}}function In(e){return e.type?{type:e.type}:Sn(e.valueExpression)}function Sn(e,t=!1,n=!1,i=!1){let r=131304;return Vt(e).isStubFile?r|=4:r|=4194304,t||(r|=16),n&&(r|=1048576),$(e,void 0,r)}function xn(e,t){const n=zs(e);if(n){const e=function(e){let t=e;for(;4!==t.type;)t=t.parent;return t}(n).lookUpSymbol(t);if(e)return Nn(e)}return Ys.create()}function Cn(e,t,n){const i=xn(e,t);if(_o(i)){let e=i;return n&&(e=Zs.cloneForSpecialization(e,n,void 0!==n)),Zs.cloneAsInstance(e)}return i}function wn(e,t,n,i=!1){var r;const s=zs(e);let o=null==s?void 0:s.lookUpSymbolRecursive(t);const a=null!==(r=null==s?void 0:s.type)&&void 0!==r?r:3;if(o&&n&&1!==a&&0!==a&&0===o.symbol.getDeclarations().filter((t=>{if(6!==t.type&&0!==t.type){const n=Rr(e),i=4===t.type||3===t.type?t.node.name:t.node;if(n===Rr(i)&&!he(i,e)){const t=Lt(e);return!(t&&ci.isFlowNodeReachable(t))}}return!0})).length&&(o=1!==o.scope.type&&o.scope.parent?o.scope.parent.lookUpSymbolRecursive(t,o.isOutsideCallerModule||3===o.scope.type,o.isBeyondExecutionScope||o.scope.isIndependentlyExecutable()):void 0),o&&i){let e=o;for(;3!==e.scope.type&&4!==e.scope.type&&e.scope.parent&&(e=e.scope.parent.lookUpSymbolRecursive(t,e.isOutsideCallerModule,e.isBeyondExecutionScope||e.scope.isIndependentlyExecutable()),e););3!==(null==e?void 0:e.scope.type)&&4!==(null==e?void 0:e.scope.type)||(o=e)}return o}function En(e,t){p.push(e);try{const e=t();return p.pop(),e}catch(e){throw p.pop(),e}}function kn(e,t,n=!0){c.enterSpeculativeContext(e,n);try{const e=t();return c.leaveSpeculativeContext(),e}catch(e){throw c.leaveSpeculativeContext(),e}}function Dn(e,t){if(Eo(e)&&e.details.declaration){const n=e.details.declaration;if(3===n.type){const e=Ft(n.node);if(e){const n=e.lookUpSymbol(t);if(n)return n.getDeclarations().find((e=>2===e.type))}}}}function An(e){var t,n;switch(e.type){case 0:{if("Any"===e.intrinsicType)return io.create();if("class"===e.intrinsicType){const t=$t(Er(e.node));return t?t.classType:void 0}const t=Cn(e.node,"str"),n=Cn(e.node,"int");if(vo(n)&&vo(t)){if("str"===e.intrinsicType)return t;if("str | None"===e.intrinsicType)return Oo([t,to.createInstance()]);if("int"===e.intrinsicType)return n;if("Iterable[str]"===e.intrinsicType){const n=xn(e.node,"Iterable");if(_o(n))return Zs.cloneAsInstance(Zs.cloneForSpecialization(n,[t],!0))}if("Dict[str, Any]"===e.intrinsicType){const n=xn(e.node,"dict");if(_o(n))return Zs.cloneAsInstance(Zs.cloneForSpecialization(n,[t,io.create()],!0))}}return Ys.create()}case 4:{const t=$t(e.node);return t?t.decoratedType:void 0}case 5:return K(e.node.typeAnnotation);case 3:{const t=Gt(e.node);return t?t.decoratedType:void 0}case 2:{let n=e.node.typeAnnotation||e.node.typeAnnotationComment;if(!n&&28===(null===(t=e.node.parent)||void 0===t?void 0:t.nodeType)){const t=e.node.parent;if(t.functionAnnotationComment&&!t.functionAnnotationComment.isParamListEllipsis){const i=t.parameters.findIndex((t=>t===e.node));n=ie(t,i)}}if(n){const t=G(n,e.node.category);return Xt(e.node,e.node.category,Jt(e.node,t))}return}case 1:{const t=e.typeAnnotationNode;if(t){const i=re(t)?function(e){let t=e,n=e.parent;for(;n;){if(54===n.nodeType){if(n.typeAnnotation===t)return n;break}t=n,n=n.parent}}(t):void 0;let r;if(e.isRuntimeTypeExpression)r=Fa(Sn(t,!0,!0).type);else{const i=e.isDefinedByMemberAccess&&35===(null===(n=e.node.parent)||void 0===n?void 0:n.nodeType)?e.node.parent:e.node;r=K(t,{isVariableAnnotation:!0,allowClassVar:Nr(i),allowFinal:Fr(i)})}if(r)return 38===e.node.nodeType&&(r=Ut(e.node,(()=>r))||r),i&&38===i.valueExpression.nodeType&&(r=qt(r,i.valueExpression,e.node)),r}return}case 6:return}}function Pn(n,i){var r,s;const o=Rn(i,!0,Vt(i.node).isStubFile);if(!o)return t.evaluateUnknownImportsAsAny?io.create():Ys.create();function a(e,n,i){if(n.path&&n.loadSymbolsFromPath){const r=i(n.path);if(!r)return t.evaluateUnknownImportsAsAny?io.create():Ys.create();e.fields=r.symbolTable,e.docString=r.docString}return n.implicitImports&&n.implicitImports.forEach(((t,n)=>{const r=e.moduleName?e.moduleName+"."+n:"",s=a(Qs.create(r,t.path),t,i),o=qo.createWithType(0,s);e.loaderFields.set(n,o)})),e}if(6===o.type){let t=o.moduleName;if(6===i.type&&(i.symbolName&&(t+="."+i.symbolName),t.startsWith("."))){const e=Vt(i.node).moduleName.split(".");for(t=t.substr(1);t.startsWith(".")&&e.length>0;)t=t.substr(1),e.pop();t=e.join(".")+"."+t}const n=Qs.create(t,o.path);return o.symbolName&&o.submoduleFallback?a(n,o.submoduleFallback,e):a(n,o,e)}const l=An(o);if(l)return l;const c=Vt(o.node);let u=!c.isInPyTypedPackage||c.isStubFile;if(!u&&1===o.type){const e=Er(o.node,!0);if(e){const t=$t(e);t&&Zs.isEnumClass(t.classType)&&(u=!0)}(o.isFinal||o.isConstant)&&(u=!0)}if(2===o.type)return null===(r=gn(o.node.name,(()=>{mn(o.node)})))||void 0===r?void 0:r.type;if(1===o.type&&o.inferredTypeSource){const e=o.typeAliasName&&o.inferredTypeSource.parent?o.inferredTypeSource.parent:o.inferredTypeSource;let t=null===(s=gn(o.node,(()=>{fn(e)})))||void 0===s?void 0:s.type;if(t&&38===o.node.nodeType){const e=Ut(o.node,(()=>{var e;return(null===(e=gn(o.inferredTypeSource,(()=>{fn(o.inferredTypeSource)})))||void 0===e?void 0:e.type)||Ys.create()}));e&&(t=e)}return t&&o.typeAliasName&&(!Ks.isInstantiable(t)||po(t)||ca(t)||(t=qt(t,o.typeAliasName,o.node),u=!0)),t&&c.isInPyTypedPackage&&!c.isStubFile&&(u||function(e,t,n){var i;const r=e.getDeclarations().filter((e=>1!==e.type||!e.isInferenceAllowedInPyTyped));if(r.length>1)return!1;if(1!==t.type)return!1;if(0===r.length)return!0;if(bo(n))return!0;let s;const o=t.node.parent;if(o&&(3===o.nodeType?s=o:35===o.nodeType&&3===(null===(i=o.parent)||void 0===i?void 0:i.nodeType)&&(s=o.parent)),!s)return!1;const a=$(s.rightExpression).type;return!(!vo(a)||!ra(a))||38===s.rightExpression.nodeType&&!Ks.isAmbiguous(a)}(n,i,t)&&(u=!0),u||(t=Ks.cloneForAmbiguousType(t))),t}}function Rn(t,n,i=!1){var r;return null===(r=Rc(e,t,n,i))||void 0===r?void 0:r.declaration}function Fn(t,n,i=!1){return Rc(e,t,n,i)}function Nn(e){return Mn(e).type}function Mn(e,t,n=!1){if(e.hasTypedDeclarations()){const n=On(e,t);return{type:n||Ys.create(),isIncomplete:!1,includesVariableDecl:e.getTypedDeclarations().some((e=>1===e.type)),isRecursiveDefinition:!n}}let i=u.get(e.id);const r=t?t.id:void 0;if(i)for(const e of i)if(e.usageNodeId===r&&e.useLastDecl===n)return e.result;const s=[],o=e.getDeclarations(),a=Wo(e);let l,p=!1,d=!1,h=!1;if(n&&o.forEach(((e,t)=>{e.isInExceptSuite||(l=t)})),o.forEach(((n,i)=>{var r,o;let u=void 0===l||i===l;if(void 0!==t&&6!==n.type&&Rr(t)===Rr(n.node)&&(he(n.node,t)||(u=!1)),u){const t=ss(n);if((t||os(n))&&1===n.type&&3===(null===(o=null===(r=n.inferredTypeSource)||void 0===r?void 0:r.parent)||void 0===o?void 0:o.nodeType)&&(Wt(n.inferredTypeSource.parent),n.typeAliasAnnotation&&K(n.typeAliasAnnotation,{isVariableAnnotation:!0,allowFinal:Fr(n.node),allowClassVar:Nr(n.node)})),q(e,n))try{let i=Pn(e,n);if(V(e)||(p=!0),i){if(1===n.type){d=!0;let e=1===n.type&&!!n.isConstant;vo(i)&&Zs.isEnumClass(i)&&function(e){const t=Er(e.node,!0);if(!t)return!1;const n=$t(t);return!!n&&Zs.isEnumClass(n.classType)}(n)&&(e=!0),!Ks.isInstance(i)||t||e||a||(i=Qo(i))}s.push(i),c.isSpeculative(n.node)&&(h=!0)}else p=!0}catch(t){throw V(e),t}else p=!0}})),s.length>0){const t={type:Oo(s),isIncomplete:!1,includesVariableDecl:d,isRecursiveDefinition:!1};return h||(i||(i=[],u.set(e.id,i)),i.push({usageNodeId:r,useLastDecl:n,result:t})),t}return{type:Js.create(),isIncomplete:p,includesVariableDecl:d,isRecursiveDefinition:!1}}function On(e,t){const n=e.getSynthesizedType();if(n)return n;let i=e.getTypedDeclarations();if(0===i.length)return;if(i.length>1&&t){const e=i.filter((e=>!(6!==e.type&&Rr(t)===Rr(e.node)&&!he(e.node,t,!1))));e.length>0&&(i=e)}let r=i.length-1;for(;r>=0;){const t=i[r],n=W(e,t);if(n)return n;if(U(e,t)<0&&q(e,t))try{const n=An(t);if(V(e)||4===t.type)return n}catch(t){throw V(e),t}r--}}function Ln(e){Eo(e)?Un(e):ko(e)&&e.overloads.forEach((e=>{Un(e)}))}function Un(e,t,n=!0){return Xs.getSpecializedReturnType(e)||(n?qn(e,t):Ys.create())}function qn(e,n){var i;let r;if(Xs.isStubDefinition(e))return Ys.create();if(e.inferredReturnType)r=e.inferredReturnType;else{if(Xs.isInstanceMethod(e)&&"__init__"===e.details.name)r=to.createInstance();else if(e.details.declaration){const n=e.details.declaration.node;if(t.analyzeUnannotatedFunctions){const t=function(e){var t;return null!==(t=e.codeFlowComplexity)&&void 0!==t?t:0}(n);(e.details.parameters.length<=1||e.details.parameters.some((e=>e.hasDeclaredType))||t<15)&&(function(t){const i=c.disableSpeculativeMode();try{r=rn(n,Xs.isAbstractMethod(e)),c.enableSpeculativeMode(i)}catch(e){throw c.enableSpeculativeMode(i),e}}(),r&&Xs.isWrapReturnTypeInAwait(e)&&(r=nn(n,r,!!(null===(i=e.details.declaration)||void 0===i?void 0:i.isGenerator))))}}r||(r=Ys.create()),e.inferredReturnType=r}if(t.analyzeUnannotatedFunctions&&La(r)&&Xs.hasUnannotatedParams(e)&&!Xs.isStubDefinition(e)&&!Xs.isPyTypedDefinition(e)&&n){const t=function(e,t){var n;let i;if(!e.details.declaration)return;const r=e.details.declaration.node;if(t.some((e=>!e.paramName)))return;if(D.some((e=>e.functionNode===r)))return;const s=Gt(r);return s&&!(t.length>6||D.length>=2)?(En(r,(()=>{const n=A;D.push({functionNode:r,codeFlowAnalyzer:ci.createCodeFlowAnalyzer()});try{A=new Map;let o=!0;r.parameters.forEach(((e,n)=>{if(e.name){let i;const a=t.find((t=>e.name.value===t.paramName));a&&a.argument.valueExpression?(i=$(a.argument.valueExpression).type,po(i)||(o=!1)):e.defaultValue?(i=$(e.defaultValue).type,po(i)||(o=!1)):0===n&&(Xs.isInstanceMethod(s.functionType)||Xs.isClassMethod(s.functionType))&&s.functionType.details.parameters.length>0&&r.parameters[0].name&&(i=s.functionType.details.parameters[0].type),i||(i=Ys.create()),N(e.name,i,0,!1)}})),o||(i=rn(r,Xs.isAbstractMethod(e)))}finally{D.pop(),A=n}})),i?(i=Ro(i),Xs.isWrapReturnTypeInAwait(e)&&!ao(i)&&(i=nn(r,i,!!(null===(n=e.details.declaration)||void 0===n?void 0:n.isGenerator))),i):void 0):void 0}(e,n);t&&(r=t)}return r}function Vn(e){const t=Gt(e);return t?Xs.isAbstractMethod(t.functionType)?io.create():Xs.isGenerator(t.functionType)?Pa(t.functionType):t.functionType.details.declaredReturnType:io.create()}function Bn(e){return _o(e.classType)?ha(Nn(e.symbol),e.classType):Ys.create()}function Wn(e,t,n,i,r,s,o){if(o>Gs)return!0;if(o++,h.some((n=>Ao(n.srcType,t)&&Ao(n.destType,e))))return!0;h.push({srcType:t,destType:e});let a=!0;try{a=function(e,t,n,i,r,s,o){const a=e.details.fields,l=Zs.cloneForSpecialization(e,void 0,!1),c=new jo(na(e)),u=new jo(na(e));ma(u,e,t),Zs.isTypedDictClass(t)&&x&&_o(x)&&(t=x);let p=!0;const d=wa(t),h=oa(t,!0)?128:0;if(a.forEach(((e,i)=>{if(e.isClassMember()&&!e.isIgnoredForProtocolMatch()){let r,a=!1;if(!s&&"__class_getitem__"===i)return;if("__slots__"===i)return;if(s&&t.details.effectiveMetaclass&&_o(t.details.effectiveMetaclass)&&(r=va(t.details.effectiveMetaclass,i),r&&(d.addSolveForScope(na(t.details.effectiveMetaclass)),a=!0)),r||(r=va(t,i)),r){let l=On(e);if(l){let d=_o(r.classType)?ha(Nn(r.symbol),r.classType,t):Ys.create();if(Eo(d)||ko(d)){if(a){const e=ri(t,d,void 0,void 0,o,!1,t);if(e&&(d=Ba(e)),Eo(l)||ko(l)){const e=ri(t,l,void 0,void 0,o,!1,t);e&&(l=Ba(e))}}else if(_o(r.classType)){l=fa(l,u);const e=ri(s?t:Zs.cloneAsInstance(t),d,r.classType,void 0,o);if(e&&(d=Ba(e)),Eo(l)||ko(l)){const e=ri(Zs.cloneAsInstance(t),l,r.classType,void 0,o);e&&(l=Ba(e))}}}else l=fa(l,u);const m=null==n?void 0:n.createAddendum();if(vo(l)&&Zs.isPropertyClass(l))if(vo(d)&&Zs.isPropertyClass(d)&&!s)Gu(li,Zs.cloneAsInstantiable(l),Zs.cloneAsInstantiable(d),t,null==m?void 0:m.createAddendum(),c,o)||(m&&m.addMessage(ml.DiagnosticAddendum.memberTypeMismatch().format({name:i})),p=!1);else{const e=Hn(l,!0);e&&Jn(e,d,null==m?void 0:m.createAddendum(),c,h,o)||(m&&m.addMessage(ml.DiagnosticAddendum.memberTypeMismatch().format({name:i})),p=!1)}else Jn(l,d,null==m?void 0:m.createAddendum(),c,h,o)||(m&&m.addMessage(ml.DiagnosticAddendum.memberTypeMismatch().format({name:i})),p=!1);const f=e.getTypedDeclarations().some((e=>1===e.type&&!!e.isFinal));f!==r.symbol.getTypedDeclarations().some((e=>1===e.type&&!!e.isFinal))&&(f?m&&m.addMessage(ml.DiagnosticAddendum.memberIsFinalInProtocol().format({name:i})):m&&m.addMessage(ml.DiagnosticAddendum.memberIsNotFinalInProtocol().format({name:i})),p=!1)}e.isClassVar()&&!r.symbol.isClassMember()&&(n&&n.addMessage(ml.DiagnosticAddendum.protocolMemberClassVar().format({name:i})),p=!1)}else n&&n.addMessage(ml.DiagnosticAddendum.protocolMemberMissing().format({name:i})),p=!1}})),e.details.baseClasses.forEach((a=>{!_o(a)||Zs.isBuiltIn(a,"object")||Zs.isBuiltIn(a,"Protocol")||Wn(ka(e,a),t,null==n?void 0:n.createAddendum(),i,r,s,o)||(p=!1)})),p&&e.details.typeParameters.length>0&&e.typeArguments){const t=fa(l,c);Gn(e,t,n,i,r,o)||(p=!1)}return p}(e,t,n,i,r,s,o)}catch(e){throw h.pop(),e}return h.pop(),a}function jn(e,t,n,i,r,s){if(s>Gs)return!0;s++;let o=!0;const a=e.details.fields,l=Zs.cloneForSpecialization(e,void 0,!1),c=new jo(na(e));if(a.forEach(((i,r)=>{if(i.isClassMember()&&!i.isIgnoredForProtocolMatch()){const a=t.fields.get(r);if(a){let t=On(i);if(t){const i=Nn(a);if((Eo(i)||ko(i))&&(Eo(t)||ko(t))){const n=ri(Zs.cloneAsInstance(e),t,e,void 0,s);n&&(t=n)}const l=null==n?void 0:n.createAddendum();Jn(t,i,null==l?void 0:l.createAddendum(),c,0,s)||(l&&l.addMessage(ml.DiagnosticAddendum.memberTypeMismatch().format({name:r})),o=!1)}}else n&&n.addMessage(ml.DiagnosticAddendum.protocolMemberMissing().format({name:r})),o=!1}})),e.details.baseClasses.forEach((a=>{!_o(a)||Zs.isBuiltIn(a,"object")||Zs.isBuiltIn(a,"Protocol")||jn(ka(e,a),t,null==n?void 0:n.createAddendum(),i,r,s)||(o=!1)})),o&&e.details.typeParameters.length>0&&e.typeArguments){const t=fa(l,c);Gn(e,t,n,i,r,s)||(o=!1)}return o}function zn(e,t,n,i,r,s,o){if(Zs.isTypedDictClass(e)&&Zs.isTypedDictClass(t))return!!_l(li,e,t,n,s)&&(Zs.isFinal(e)!==Zs.isFinal(t)?(n&&n.addMessage(ml.DiagnosticAddendum.typedDictFinalMismatch().format({sourceType:ai(Fa(t)),destType:ai(Fa(e))})),!1):!(0!=(1&r)&&!Zs.isSameGenericClass(e,t))||_l(li,t,e,void 0,s));const a=Qu.get(e.details.fullName);if(a&&a.some((e=>t.details.mro.some((t=>yo(t)&&e===t.details.fullName))))&&0==(1&r))return!0;const l=[],c=Zs.isDerivedFrom(t,e,l);if(Zs.isProtocolClass(e)&&!c)return!!Wn(e,t,null==n?void 0:n.createAddendum(),i,r,!1,s)||(n&&n.addMessage(ml.DiagnosticAddendum.protocolIncompatible().format({sourceType:ai(Fa(t)),destType:ai(Fa(e))})),!1);if((0==(1&r)||Zs.isSameGenericClass(t,e))&&c)return w(l.length>0),function(e,t,n,i,r,s,o){let a=t,l=r||new jo(na(e)),c=s;r||(c&=-9);for(let t=n.length-1;t>=0;t--){const r=n[t];if(po(r))return!0;if(Zs.isBuiltIn(r,"object"))return!0;if(t<n.length-1&&(a=ka(a,r)),0===t&&e.tupleTypeArguments&&a.tupleTypeArguments)return $n(e,a,i,l,s,o);if(0!==Zs.getTypeParameters(r).length){if(!r.typeArguments)return!0;if(!Gn(r,a,i,l,c,o))return!1;l=new jo(na(r)),c&=-9}}if(e.typeArguments){if(!Gn(e,a,i,r,s,o))return!1}else if(r&&e.details.typeParameters.length>0&&a.typeArguments&&!r.isLocked()){const t=a.typeArguments;for(let n=0;n<e.details.typeParameters.length;n++){const i=n<t.length?t[n]:Ys.create();r.setTypeVarType(e.details.typeParameters[n],void 0,i)}}return!0}(e,t,l,n,i,r,s);if(Zs.isBuiltIn(e,"object")&&0==(1&r))return!0;const u=o?Zs.cloneAsInstance(e):e,p=o?Zs.cloneAsInstance(t):t;let d=ai(u),h=ai(p);return d===h&&e.details.fullName&&t.details.fullName&&(d=e.details.fullName,h=t.details.fullName),n&&n.addMessage(ml.DiagnosticAddendum.typeIncompatible().format({sourceType:h,destType:d})),!1}function $n(e,t,n,i,r,s){var o,a;const l=[...null!==(o=e.tupleTypeArguments)&&void 0!==o?o:[]],c=[...null!==(a=t.tupleTypeArguments)&&void 0!==a?a:[]],u=l.findIndex((e=>Io(e.type))),p=l.findIndex((e=>e.isUnbounded)),d=c.findIndex((e=>e.isUnbounded));if(d>=0){const e=u>=0||p>=0?l.length-1:l.length,t=c.length>0?c[d].type:io.create();for(;c.length<e;)c.splice(d,0,{type:t,isUnbounded:!1})}if(u>=0&&d>=0)return n&&n.addMessage(ml.DiagnosticAddendum.typeVarTupleRequiresKnownLength()),!1;if(p>=0||u>=0){const e=c.length-l.length+1;if(e>=0)if(u>=0){if(T&&_o(T)){const t=c.splice(u,e),n=Fa(Va(T,t.map((e=>({type:Qo(e.type),isUnbounded:!1}))),!0,!0,!0));c.splice(u,0,{type:n,isUnbounded:!1})}}else{const t=c.splice(p,e);c.splice(p,0,{type:t.length>0?Oo(t.map((e=>e.type))):io.create(),isUnbounded:!1})}}if(c.length===l.length)for(let e=0;e<c.length;e++){const t=null==n?void 0:n.createAddendum();if(!Jn(l[e].type,c[e].type,null==t?void 0:t.createAddendum(),i,128|r,s))return t&&t.addMessage(ml.DiagnosticAddendum.tupleEntryTypeMismatch().format({entry:e+1})),!1}else{if(!(d>=0))return n&&n.addMessage(ml.DiagnosticAddendum.tupleSizeMismatch().format({expected:l.length,received:c.length})),!1;if(!e.isUnpacked)return n&&n.addMessage(ml.DiagnosticAddendum.tupleSizeMismatchIndeterminate().format({expected:l.length})),!1}return!0}function Hn(e,t){if(!Zs.isPropertyClass(e))return;const n=e.details.fields.get("fget");if(n){const e=On(n);if(e&&Eo(e))return Un(e,void 0,t)}}function Gn(e,t,n,i,r,s){var o,a,l;w(Zs.isSameGenericClass(e,t));const c=Zs.getTypeParameters(e);let u,p;if(!e.typeArguments||!t.typeArguments)return!0;if(Zs.isTupleClass(e)?(u=null!==(a=null===(o=e.tupleTypeArguments)||void 0===o?void 0:o.map((e=>e.type)))&&void 0!==a?a:[],p=null===(l=t.tupleTypeArguments)||void 0===l?void 0:l.map((e=>e.type))):(u=e.typeArguments,p=t.typeArguments),p)for(let t=0;t<p.length;t++){const o=p[t],a=t>=u.length?u.length-1:t,l=a>=0?u[a]:Ys.create(),d=a<c.length?c[a]:void 0,h=new il;if(d&&1!==d.details.variance){if(2===d.details.variance){if(!Jn(o,l,h,i,2^r|128,s)){if(n){const e=n.createAddendum();e.addMessage(ml.DiagnosticAddendum.typeVarIsContravariant().format({name:oo.getReadableName(d)})),e.addAddendum(h)}return!1}}else if(!Jn(l,o,h,i,1|r,s)&&!Zs.isPseudoGenericClass(e)){if(n){const e=n.createAddendum();e.addMessage(ml.DiagnosticAddendum.typeVarIsInvariant().format({name:oo.getReadableName(d)})),e.addAddendum(h)}return!1}}else if(!Jn(l,o,h,i,128|r,s)){if(d&&n){const e=n.createAddendum();e.addMessage(ml.DiagnosticAddendum.typeVarIsCovariant().format({name:oo.getReadableName(d)})),e.addAddendum(h)}return!1}}return!0}function Kn(e,t,n,i,r=0,s=0){var o;let a=!0;const l=0!=(2&r);if(!e.scopeId)return!0;if(!i.hasSolveForScope(e.scopeId)){if(ho(t))return!0;if(0!=(512&r))return!0;if(a=!1,!e.details.isSynthesized)return n&&n.addMessage(ml.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:ai(t),destType:ai(e)})),!1}if(0!=(8&r))return Jn(Ie(e),Ie(t),n,void 0,r,s);if(e.details.isParamSpec)return function(e,t,n,i,r=0){if(bo(t)&&t.details.isParamSpec){const n=i.getParamSpec(e);if(!n)return!i.isLocked()&&i.hasSolveForScope(e.scopeId)&&i.setParamSpec(e,{flags:0,parameters:[],typeVarScopeId:void 0,docString:void 0,paramSpec:t}),!0;if(0===n.parameters.length&&n.paramSpec&&Ao(n.paramSpec,t,void 0,void 0,r))return!0}else if(Eo(t)){const n=t,s=t.details.parameters.map(((e,t)=>({category:e.category,name:e.name,isNameSynthesized:e.isNameSynthesized,hasDefault:!!e.hasDefault,type:Xs.getEffectiveParameterType(n,t)}))),o=i.getParamSpec(e);if(!o)return!i.isLocked()&&i.hasSolveForScope(e.scopeId)&&i.setParamSpec(e,{parameters:s,typeVarScopeId:t.details.typeVarScopeId,flags:t.details.flags,docString:t.details.docString,paramSpec:void 0}),!0;if(!o.paramSpec&&o.parameters.length===s.length&&!o.parameters.some(((e,t)=>{const n=s[t];return e.category!==n.category||e.name!==n.name||e.hasDefault!==n.hasDefault||!Ao(e.type,n.type,void 0,void 0,r)})))return!0}else if(ho(t))return!0;return n&&n.addMessage(ml.DiagnosticAddendum.typeParamSpec().format({type:ai(t),name:e.details.name})),!1}(e,t,n,i,s);e.details.isVariadic&&(Co(t)||(t=T&&_o(T)?Fa(Va(T,[{type:t,isUnbounded:!1}],!0,!0,!0)):Ys.create())),Ks.isInstantiable(e)&&vo(t)&&Zs.isBuiltIn(t,"type")&&!t.typeArguments&&(t=io.create());const c=i.getTypeVar(e),u=null==c?void 0:c.narrowBound,p=null!==(o=null==c?void 0:c.wideBound)&&void 0!==o?o:e.details.boundType;if(e.details.constraints.length>0){let r;const o=Ie(t);if(bo(t))Jn(e,o,void 0,new jo(e.scopeId),void 0,s)&&(r=t,Ks.isInstantiable(t)&&(r=Fa(t)));else{let t,n=!0;r=Ko(o,(i=>{let r,o;return ho(i)?i:(e.details.constraints.forEach(((t,n)=>{const a=Ks.isInstantiable(e)?Na(t):t;Jn(a,i,void 0,void 0,void 0,s)&&(r&&!Jn(r,a,void 0,void 0,void 0,s)||(r=Zo(t,Xo(i)),o=n))})),r||l||(n=!1),void 0===o||Xo(i)||(void 0!==t&&t!==o&&(n=!1),t=o),r)})),!ao(r)&&n||(r=void 0),!r&&fo(o)&&(r=e.details.constraints.find((t=>Jn(Ks.isInstantiable(e)?Na(t):t,o,void 0,void 0,void 0,s))))}if(!r)return n&&n.addMessage(ml.DiagnosticAddendum.typeConstrainedTypeVar().format({type:ai(t),name:e.details.name})),!1;if(u&&!ho(u)){if(!Jn(u,r,void 0,void 0,void 0,s)){if(!Jn(r,u,void 0,void 0,void 0,s))return n&&n.addMessage(ml.DiagnosticAddendum.typeConstrainedTypeVar().format({type:ai(r),name:ai(u)})),!1;!i.isLocked()&&a&&i.setTypeVarType(e,r)}}else!i.isLocked()&&a&&i.setTypeVarType(e,r);return!0}let d=u,h=p;const m=n?new il:void 0,f=0!=(128&r)||i.getRetainLiterals(e)||e.details.boundType&&oa(e.details.boundType)||e.details.constraints.some((e=>oa(e)));let g=f?t:Qo(t);if(Ks.isInstantiable(e)){if(!Ra(g))return n&&n.addMessage(ml.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:ai(g),destType:ai(e)})),!1;g=Fa(g)}if(l||0!=(4&r)){if(p){if(!Ao(p,g,void 0,void 0,s))if(Jn(p,Ie(g),m,void 0,512&r,s))h=g;else if(!Jn(g,p,m,void 0,512&r,s))return n&&m&&(n.addMessage(ml.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:ai(g),destType:ai(p)})),n.addAddendum(m)),!1}else h=g;if(u&&!Jn(h,u,void 0,void 0,512&r,s))return n&&m&&(n.addMessage(ml.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:ai(g),destType:ai(u)})),n.addAddendum(m)),!1}else{if(u){if(!Ao(u,g,void 0,void 0,s))if(Jn(u,g,m,i,r,s))d=La(u)&&!po(g)&&Jn(g,u,void 0,i,512&r,s)?g:u;else{if(i.isLocked()||bo(g))return n&&n.addMessage(ml.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:ai(u),destType:ai(g)})),!1;if(Io(e))return n&&n.addMessage(ml.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:ai(u),destType:ai(g)})),!1;d=Jn(g,u,void 0,i,512&r,s)?g:fo(u)&&u.subtypes.length>64&&void 0!==e.details.boundType&&y&&vo(y)?Oo([u,y]):Oo([u,g])}}else d=g;if(p&&d&&!Ao(p,d,void 0,void 0,s)){let e=!0;if(bo(p)&&(Ao(d,p)||fo(d)&&d.subtypes.some((e=>Ao(e,p))))&&(e=!1),!Jn(e?Ie(p):p,d,void 0,i,512&r,s))return n&&n.addMessage(ml.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:ai(g),destType:ai(p)})),!1}}if(e.details.boundType){const o=d||h;if(Ks.isInstantiable(e)&&!Ks.isInstantiable(t))return!1;if(!Jn(e.details.boundType,Ie(o),null==n?void 0:n.createAddendum(),i,512&r,s))return e.details.isSynthesized||n&&n.addMessage(ml.DiagnosticAddendum.typeBound().format({sourceType:ai(o),destType:ai(e.details.boundType),name:oo.getReadableName(e)})),!1}return!i.isLocked()&&a&&i.setTypeVarType(e,d,h,f),!0}function Jn(e,t,n,i,r=0,s=0){var o,a;if(fo(e)&&1===e.subtypes.length&&Io(e.subtypes[0])&&(e=e.subtypes[0]),fo(t)&&1===t.subtypes.length&&Io(t.subtypes[0])&&(t=t.subtypes[0]),e===t)return!bo(e)||e.details.isParamSpec||e.details.isVariadic||0!==e.scopeType||!i||i.isLocked()||!i.hasSolveForScope(e.scopeId)||i.getTypeVar(e)||0!=(10&r)||i.setTypeVarType(e,t),!0;if(s>Gs)return!0;if(s++,bo(e)&&e.details.recursiveTypeAliasScopeId&&bo(t)&&t.details.recursiveTypeAliasScopeId){if((null===(o=e.typeAliasInfo)||void 0===o?void 0:o.typeArguments)&&(null===(a=t.typeAliasInfo)||void 0===a?void 0:a.typeArguments)&&e.details.recursiveTypeAliasScopeId===t.details.recursiveTypeAliasScopeId){let o=!0;const a=t.typeAliasInfo.typeArguments;return e.typeAliasInfo.typeArguments.forEach(((e,t)=>{Jn(e,t<a.length?a[t]:Ys.create(),n,i,r,s)||(o=!1)})),o}if(0!=(2048&r))return!0;r|=2048}if(e=ta(e),t=ta(t),mo(e)||mo(t))return!0;0!=(16&r)&&(t=Ie(t));const l=r;if(r&=-69,bo(e)){if(function(e,t,n){return!Mo(t,(t=>{var i;if(Ao(e,t,!0,void 0,n))return!1;const r=oo.getNameWithScope(e),s=(null!==(i=Xo(t))&&void 0!==i?i:[]).filter((e=>e.typeVarName===r));return 0===s.length||!s.some((i=>e.details.boundType?(w(0===i.constraintIndex,"Expected constraint for bound TypeVar to have index of 0"),Jn(e.details.boundType,t,void 0,void 0,void 0,n)):!(e.details.constraints.length>0)||(w(i.constraintIndex<e.details.constraints.length,"Constraint for constrained TypeVar is out of bounds"),Jn(e.details.constraints[i.constraintIndex],t,void 0,void 0,void 0,n))))}))}(e,t,s))return!0;if(Ao(e,t))return!0;if(bo(t)&&t.details.isSynthesizedSelf&&t.details.boundType&&e.details.isSynthesizedSelf&&e.details.boundType)return 0==(2&r)&&i&&Kn(e,t,n,i,l,s),!0;if(Io(e)&&vo(t)&&pa(t)&&t.tupleTypeArguments&&1===t.tupleTypeArguments.length&&Ao(e,t.tupleTypeArguments[0].type,void 0,void 0,s))return!0;if(0==(2&r)||!bo(t))return!(!Kn(e,t,n,null!=i?i:new jo,l,s)||ho(t)&&0!=(16&r))}if(bo(t)){if(0!=(2&r)){if(i&&i.hasSolveForScope(na(t))){let r=l;if(0!=(1024&l)?r&=-7:r|=4,Kn(t,e,n,i,r,s))return!0;let o=!1;return fo(e)&&Jo(e,(e=>{Kn(t,e,n,i,4|l,s)&&(o=!0)})),o}return Jn(Ie(e),Ie(t),n,void 0,l,s)}if(0!=(1&r))return!!ho(e)||!!(wo(t)&&Eo(e)&&Xs.shouldSkipArgsKwargsCompatibilityCheck(e)&&e.details.parameters.length<=2)||(n&&n.addMessage(ml.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:ai(t),destType:ai(e)})),!1)}if(ho(e))return!0;if(ho(t)){if(i){const n=ca(t)?io.create():t;Ca(e,n,i,s)}if(0==(16&r))return!0}if(ao(t))return i&&Ca(e,Ys.create(),i,s),!0;if(fo(t)&&Ks.isSpecialForm(t)&&(t=g||y||io.create()),fo(e))if(fo(t)){if(Yn(e,t,void 0,i,l,s))return!0}else{const n=i?i.clone():void 0;if(Qn(e,t,void 0,n,l,s))return i&&n&&i.copyFromClone(n),!0}const c=Ie(t);if(fo(c))return Yn(e,c,n,i,l,s);if(fo(e))return Qn(e,t,n,i,l,s);if(lo(e)&&lo(t))return!0;if(co(e)){if(co(t))return!0;if(_o(t)&&Zs.isBuiltIn(t,"NoneType"))return!0}if(vo(t)&&Zs.isBuiltIn(t,"type")){const o=t.typeArguments;if(o&&o.length>=1){if(ho(o[0]))return!(!vo(e)||!Zs.isBuiltIn(t,"type"))||Ks.isInstantiable(e);if(vo(o[0])||bo(o[0]))return!!Jn(e,Na(o[0]),null==n?void 0:n.createAddendum(),i,r,s)||(n&&n.addMessage(ml.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:ai(t),destType:ai(e)})),!1)}}if(_o(e)){const o=Ie(t);if(_o(o))return Zs.isProtocolClass(e)&&Zs.isProtocolClass(o)&&_o(t)&&!t.includeSubclasses?(n&&n.addMessage(ml.DiagnosticAddendum.protocolSourceIsNotConcrete().format({sourceType:ai(Fa(t)),destType:ai(e)})),!1):!!zn(e,o,n,i,r,s,!1)||(n&&n.addMessage(ml.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:ai(t),destType:ai(e)})),!1)}if(vo(e)){if(Zs.isBuiltIn(e,"Type")){const o=e.typeArguments;if(o&&o.length>=1&&Ks.isInstance(o[0])&&Ks.isInstantiable(t))return Jn(o[0],Fa(t),n,i,r,s)}else if(Zs.isBuiltIn(e,"type")){if(Ks.isInstantiable(t))return!(yo(t)&&void 0!==t.literalValue)}else if(Zs.isBuiltIn(e,["TypeGuard","StrictTypeGuard"])&&0!=(64&l)&&vo(t)&&Zs.isBuiltIn(t,"bool"))return!0;const o=Ie(t);if(yo(o)&&Ks.isInstance(o)){if(void 0!==e.literalValue&&(void 0===o.literalValue||!Zs.isLiteralValueSame(o,e)))return n&&n.addMessage(ml.DiagnosticAddendum.literalAssignmentMismatch().format({sourceType:ai(t),destType:ai(e)})),!1;if(Zs.isBuiltIn(e,"LiteralString")&&Zs.isBuiltIn(o,"str")){if(void 0!==o.literalValue)return!0}else if(Zs.isBuiltIn(o,"LiteralString")&&Zs.isBuiltIn(e,"str")&&void 0===e.literalValue)return!0;return!!zn(Zs.cloneAsInstantiable(e),Zs.cloneAsInstantiable(o),n,i,r,s,!0)}if(Eo(o)||ko(o)){const t=Xn(e);if(t)return Jn(t,o,n,i,r,s);if(y&&vo(y))return Jn(e,y,n,i,r,s)}else if(To(o)){if(Zs.isBuiltIn(e,"ModuleType"))return!0;if(Zs.isProtocolClass(e))return jn(Zs.cloneAsInstantiable(e),o,n,i,r,s)}else if(_o(o)){const t=Xn(e);if(t)return Jn(t,o,n,i,r,s);if(Zs.isProtocolClass(e))return Wn(Zs.cloneAsInstantiable(e),o,n,i,r,!0,s);const a=o.details.effectiveMetaclass;if(a)return!!ho(a)||zn(Zs.cloneAsInstantiable(e),a,n,i,r,s,!1)}else{if(ho(o))return 0==(16&r);if(fo(o))return Jn(e,o,n,i,r,s)}}if(Eo(e)){let o,a=Ie(t);if(vo(a)){const e=_a(a,"__call__");if(e){const t=Bn(e);if(Eo(t)||ko(t)){const e=ri(a,t,void 0,void 0,s);e&&(a=Ba(e))}}}if(_o(a)&&void 0===a.literalValue){const e=Zn(a,s);e&&(a=e)}if(ko(a)){if(e.details.paramSpec)return n&&n.addMessage(ml.DiagnosticAddendum.paramSpecOverload()),!1;const t=a.overloads,l=t.findIndex((t=>{if(!Xs.isOverloaded(t))return!1;const o=i?i.clone():void 0;return Jn(e,t,null==n?void 0:n.createAddendum(),o,r,s)}));if(l<0)return n&&n.addMessage(ml.DiagnosticAddendum.noOverloadAssignable().format({type:ai(e)})),!1;o=t[l]}else if(Eo(a))o=a;else if(ho(a))return 0==(16&r);if(o&&function(e,t,n,i,r,s){var o,a,l,c,u,p,d,h,m;let f=!0;const g=0==(32&r);r&=-33,e=Wa(e),t=Wa(t);const y=Ho(e),_=Ho(t);!function(e,t){var n;if(void 0===t.argsIndex)return;if(e.params.length<t.argsIndex)return;let i=e.params.findIndex(((e,n)=>n>=t.argsIndex&&e.source===zo.KeywordOnly));i<0&&(i=e.params.length);const r=(null!==(n=t.firstKeywordOnlyIndex)&&void 0!==n?n:t.params.length)-t.argsIndex-1,s=e.params.slice(t.argsIndex,i-r),o=[];if(s.forEach((e=>{1===e.param.category?So(e.type)?o.push({type:e.type,isUnbounded:!1}):xo(e.type)&&e.type.tupleTypeArguments?o.push(...e.type.tupleTypeArguments):o.push({type:e.type,isUnbounded:!0}):o.push({type:e.type,isUnbounded:!1})})),1!==o.length||!Io(o[0].type)){let n;n=T&&_o(T)?Fa(Va(T,o,!0,!0,!0)):Ys.create(),e.params=[...e.params.slice(0,t.argsIndex),{param:{category:1,name:"_arg_combined",isNameSynthesized:!0,hasDeclaredType:!0,type:n},type:n,index:-1,source:zo.PositionOrKeyword},...e.params.slice(t.argsIndex+s.length,e.params.length)];const i=e.params.findIndex((e=>1===e.param.category));e.argsIndex=i>=0?i:void 0;const r=e.params.findIndex((e=>2===e.param.category));e.kwargsIndex=r>=0?r:void 0;const a=e.params.findIndex((e=>e.source===zo.KeywordOnly));e.firstKeywordOnlyIndex=a>=0?a:void 0}}(_,y);const v=0==(2&r)?i:new jo(na(e)),I=0!=(2&r)?i:new jo(na(t)),S=0!=(2&r)?!!t.details.paramSpec:!!e.details.paramSpec,x=null!==(a=null!==(o=y.argsIndex)&&void 0!==o?o:y.firstKeywordOnlyIndex)&&void 0!==a?a:y.params.length,C=null!==(c=null!==(l=_.argsIndex)&&void 0!==l?l:_.firstKeywordOnlyIndex)&&void 0!==c?c:_.params.length,w=Math.min(x,C);for(let i=0;i<w;i++){const o=y.params[i],a=_.params[i],l=a.type,c=o.type,d=null!==(u=o.param.name)&&void 0!==u?u:"",h=null!==(p=a.param.name)&&void 0!==p?p:"";!d||Yt(d)||Yt(h)||o.source===zo.PositionOnly||1===o.param.category||1===a.param.category||d===h||(n&&n.createAddendum().addMessage(ml.DiagnosticAddendum.functionParamName().format({srcName:h,destName:d})),f=!1),o.param.hasDefault&&!a.param.hasDefault&&(n&&n.createAddendum().addMessage(ml.DiagnosticAddendum.functionParamDefaultMissing().format({name:h})),f=!1),0===i&&"__init__"===t.details.name&&Xs.isInstanceMethod(t)&&"__init__"===e.details.name&&Xs.isInstanceMethod(e)&&Xs.isOverloaded(e)&&o.param.hasDeclaredType||ei(c,l,i,null==n?void 0:n.createAddendum(),v,I,r,s)||0!=(256&r)&&bo(l)&&l.details.isSynthesized||(f=!1)}if(!Xs.shouldSkipArgsKwargsCompatibilityCheck(e)&&y.firstPositionOrKeywordIndex<_.positionOnlyParamCount&&!S&&(n&&n.createAddendum().addMessage(ml.DiagnosticAddendum.argsPositionOnly().format({expected:_.positionOnlyParamCount,received:y.firstPositionOrKeywordIndex})),f=!1),x<C){if(!S){const e=_.params.filter((e=>!!e.param.name&&!e.param.hasDefault&&0===e.param.category)).length;if(void 0===y.argsIndex)x<e&&y.firstPositionOrKeywordIndex>0&&y.firstPositionOrKeywordIndex<C&&(n&&n.createAddendum().addMessage(ml.DiagnosticAddendum.functionTooFewParams().format({expected:e,received:x})),f=!1);else{const e=y.params[y.argsIndex].type;if(!ho(e))for(let t=x;t<C;t++)ei(e,_.params[t].type,t,null==n?void 0:n.createAddendum(),v,I,r,s)||(f=!1)}}}else if(C<x)if(void 0!==_.argsIndex){const e=_.params[_.argsIndex].type;for(let t=C;t<x;t++){const i=y.params[t].type;Io(i)&&!Io(e)?(n&&n.addMessage(ml.DiagnosticAddendum.typeVarTupleRequiresKnownLength()),f=!1):ei(i,e,t,null==n?void 0:n.createAddendum(),v,I,r,s)||(f=!1)}}else n&&n.addMessage(ml.DiagnosticAddendum.functionTooManyParams().format({expected:C,received:x})),f=!1;if(void 0!==_.argsIndex&&void 0!==y.argsIndex&&!Xs.shouldSkipArgsKwargsCompatibilityCheck(e)){let e=y.params[y.argsIndex].type,t=_.params[_.argsIndex].type;T&&_o(T)&&(Co(e)||(e=Zs.cloneForUnpacked(Zs.cloneAsInstance(Va(T,[{type:e,isUnbounded:!0}],!0,!0)))),Co(t)||(t=Zs.cloneForUnpacked(Zs.cloneAsInstance(Va(T,[{type:t,isUnbounded:!0}],!0,!0))))),ei(e,t,y.params[y.argsIndex].index,null==n?void 0:n.createAddendum(),v,I,r,s)||(f=!1)}if(Xs.shouldSkipArgsKwargsCompatibilityCheck(e)||void 0!==_.argsIndex||void 0===y.argsIndex||y.hasUnpackedVariadicTypeVar||S||(n&&n.createAddendum().addMessage(ml.DiagnosticAddendum.argsParamMissing().format({paramName:null!==(d=y.params[y.argsIndex].param.name)&&void 0!==d?d:""})),f=!1),!S){const t=new Map;void 0!==y.firstKeywordOnlyIndex&&y.params.forEach(((e,n)=>{n>=y.firstKeywordOnlyIndex&&e.param.name&&0===e.param.category&&t.set(e.param.name,e)}));let i=void 0!==_.firstKeywordOnlyIndex?_.firstKeywordOnlyIndex:_.params.length;x<C&&void 0===y.argsIndex&&(i=x),i>=0&&_.params.forEach(((e,o)=>{if(o>=i&&e.param.name&&0===e.param.category){const i=t.get(e.param.name),o=null==n?void 0:n.createAddendum(),a=e.type;if(i){const l=i.type,c=v?fa(l,v):l;Jn(a,c,null==o?void 0:o.createAddendum(),void 0,r,s)||(o&&o.addMessage(ml.DiagnosticAddendum.namedParamTypeMismatch().format({name:e.param.name,sourceType:ai(c),destType:ai(a)})),f=!1),i.param.hasDefault&&!e.param.hasDefault&&(n&&n.createAddendum().addMessage(ml.DiagnosticAddendum.functionParamDefaultMissing().format({name:e.param.name})),f=!1),t.delete(e.param.name)}else void 0!==y.kwargsIndex||e.param.hasDefault?void 0!==y.kwargsIndex&&(ei(y.params[y.kwargsIndex].type,a,y.params[y.kwargsIndex].index,null==n?void 0:n.createAddendum(),v,I,r,s)||(f=!1)):(o&&o.addMessage(ml.DiagnosticAddendum.namedParamMissingInDest().format({name:e.param.name})),f=!1)}})),t.forEach(((e,i)=>{void 0!==_.kwargsIndex&&e.param.name?(ei(e.param.type,_.params[_.kwargsIndex].type,e.index,null==n?void 0:n.createAddendum(),v,I,r,s)||(f=!1),t.delete(i)):(n&&n.createAddendum().addMessage(ml.DiagnosticAddendum.namedParamMissingInSource().format({name:i})),f=!1)})),void 0!==_.kwargsIndex&&void 0!==y.kwargsIndex&&(ei(y.params[y.kwargsIndex].type,_.params[_.kwargsIndex].type,y.params[y.kwargsIndex].index,null==n?void 0:n.createAddendum(),v,I,r,s)||(f=!1)),Xs.shouldSkipArgsKwargsCompatibilityCheck(e)||void 0!==_.kwargsIndex||void 0===y.kwargsIndex||(n&&n.createAddendum().addMessage(ml.DiagnosticAddendum.kwargsParamMissing().format({paramName:y.params[y.kwargsIndex].param.name})),f=!1)}if(S&&(null===(h=t.details.paramSpec)||void 0===h?void 0:h.nameWithScope)===(null===(m=e.details.paramSpec)||void 0===m?void 0:m.nameWithScope)){const n=t.details.parameters.length,i=e.details.parameters.length;n!==i&&(n!==i-1||0!==e.details.parameters[i-1].category||e.details.parameters[i-1].name)&&(f=!1)}if(i&&!i.isLocked()){const n=0==(2&r)?I:v;if(n.getTypeVars().forEach((e=>{Jn(e.typeVar,n.getTypeVarType(e.typeVar),void 0,i,void 0,s)})),i.getTypeVars().forEach((e=>{if(e.narrowBound){const t=fa(e.narrowBound,i);t!==e.narrowBound&&i.setTypeVarType(e.typeVar,t,e.wideBound,e.retainLiteral)}})),S){const n=0==(2&r)?e:t,s=0==(2&r)?t:e;if(n.details.paramSpec){const e=n.details.parameters.filter((e=>!(!e.name||0===e.category&&wo(e.type)))).length;let t=0;const r=[];s.details.parameters.forEach(((n,i)=>{t<e?n.name&&t++:(n.name||0!==n.category||0!==r.length)&&r.push({category:n.category,name:n.name,isNameSynthesized:n.isNameSynthesized,hasDefault:!!n.hasDefault,type:Xs.getEffectiveParameterType(s,i)})})),i.setParamSpec(n.details.paramSpec,{parameters:r,typeVarScopeId:s.details.typeVarScopeId,docString:s.details.docString,flags:s.details.flags,paramSpec:s.details.paramSpec?Fa(s.details.paramSpec):void 0})}}}if(g){const o=Un(e);if(!ho(o)){const e=fa(Un(t),I),a=null==n?void 0:n.createAddendum();let l=!1;(ao(e)||Jn(o,e,null==a?void 0:a.createAddendum(),i,r,s)||vo(e)&&Zs.isBuiltIn(e,["TypeGuard","StrictTypeGuard"])&&b&&_o(b)&&Jn(o,Zs.cloneAsInstance(b),null==a?void 0:a.createAddendum(),i,r,s))&&(l=!0),l||(a&&a.addMessage(ml.DiagnosticAddendum.functionReturnTypeMismatch().format({sourceType:ai(e),destType:ai(o)})),f=!1)}}return f}(e,o,null==n?void 0:n.createAddendum(),null!=i?i:new jo(na(e)),r,s))return!0}if(ko(e)){const o=null==n?void 0:n.createAddendum();return!!e.overloads.every((e=>!Xs.isOverloaded(e)||(i&&i.addSolveForScope(na(e)),Jn(e,t,null==o?void 0:o.createAddendum(),i||new jo(na(e)),r,s))))||(o&&o.addMessage(ml.DiagnosticAddendum.overloadNotAssignable().format({name:e.overloads[0].details.name})),!1)}return!(!vo(e)||!Zs.isBuiltIn(e,"object")||0!=(1&r))||(lo(t)&&vo(e)&&Zs.isProtocolClass(e)&&f&&_o(f)?Wn(Zs.cloneAsInstantiable(e),f,n,i,r,!1,s):lo(e)?(n&&n.addMessage(ml.DiagnosticAddendum.assignToNone()),!1):(n&&n.addMessage(ml.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:ai(t),destType:ai(e)})),!1))}function Yn(e,t,n,i,r,s){if(Ao(t,e,void 0,void 0,s))return!0;if(fo(e)){if(0!=(4&r)){const n=e.subtypes.filter((e=>!ho(e)));if(1===n.length&&bo(n[0]))return Jn(n[0],t,void 0,i,r,s),!0}const o=[];let a=[...t.subtypes],l=!1;if(e.subtypes.forEach((e=>{if($a(e))o.push(e);else{const t=a.findIndex((t=>Ao(t,e,void 0,void 0,s)));t>=0?a.splice(t,1):l=!0}})),l||[...a].forEach((e=>{const t=o.findIndex((t=>yo(e)&&yo(t)&&Ks.isInstance(e)===Ks.isInstance(t)&&Zs.isSameGenericClass(e,t)));t>=0&&(Jn(o[t],e,null==n?void 0:n.createAddendum(),i,r,s)||(l=!0),o.splice(t,1),a=a.filter((t=>t!==e)))})),l||0===o.length&&0===a.length||1===o.length&&bo(o[0])&&Jn(o[0],Oo(a),null==n?void 0:n.createAddendum(),i,r,s)||(l=!0),!l)return!0}let o=!1;return Jo(t,(t=>{Jn(e,t,void 0,i,r,s)||Jn(e,Ie(t),null==n?void 0:n.createAddendum(),i,r,s)||(o=!0)})),!o||(n&&n.addMessage(ml.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:ai(t),destType:ai(e)})),!1)}function Qn(e,t,n,i,r,s){if(1&r){let o=!1;return Jo(e,((a,l)=>{if(!o&&!Jn(a,t,null==n?void 0:n.createAddendum(),i,r,s)){let t=!1;ho(a)||Jo(e,((e,n)=>{l===n||t||Jn(e,a,void 0,void 0,0,s)&&(t=!0)})),t||(o=!0)}})),!o||(n&&n.addMessage(ml.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:ai(t),destType:ai(e)})),!1)}const o=n?new il:void 0;let a=!1;if(lo(t)&&Go(e))a=!0;else{let n,l;if(vo(t)&&ra(t)&&so.containsType(e,t,s))return!0;Jo(e,(e=>{const c=null==i?void 0:i.clone();if(Jn(e,t,null==o?void 0:o.createAddendum(),c,r,s)&&(a=!0,c)){const e=c.getScore();(void 0===l||l<=e)&&(l=e,n=c)}})),i&&n&&i.copyFromClone(n)}return a||bo(t)&&t.details.constraints.length>0&&(a=Jn(e,Ie(t),null==o?void 0:o.createAddendum(),i,r,s)),!!a||(n&&o&&(n.addMessage(ml.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:ai(t),destType:ai(e)})),n.addAddendum(o)),!1)}function Zn(e,t=0){const n=va(e,"__init__",12);if(n){const i=Bn(n),r=Zs.cloneAsInstance(e),s=e=>{let n=ri(r,e,void 0,void 0,t);return n&&(n=Xs.clone(n),n.details.declaredReturnType=r,n.specializedTypes&&(n.specializedTypes.returnType=r)),n};if(Eo(i))return s(i);if(ko(i)){const e=[];if(i.overloads.forEach((t=>{const n=s(t);n&&e.push(n)})),0===e.length)return;return 1===e.length?e[0]:eo.create(e)}}const i=va(e,"__new__",12);if(i){const t=Bn(i),n=t=>ri(e,t,void 0,void 0,void 0,!0);if(Eo(t))return n(t);if(ko(t)){const e=[];if(t.overloads.forEach((t=>{const i=n(t);i&&e.push(i)})),0===e.length)return;return 1===e.length?e[0]:eo.create(e)}}const r=Xs.createInstance("__new__","","",65);return r.details.declaredReturnType=Zs.cloneAsInstance(e),Xs.addDefaultParameters(r),r}function Xn(e){if(!vo(e)||!Zs.isProtocolClass(e))return;for(const t of e.details.mro)if(yo(t)&&Zs.isProtocolClass(t))for(const e of t.details.fields)if("__call__"!==e[0]&&!e[1].isIgnoredForProtocolMatch()){let t=!1;if(v&&yo(v)&&v.details.fields.has(e[0])&&(t=!0),!t)return}const t=_a(e,"__call__");if(!t)return;const n=Bn(t);if(Eo(n)||ko(n)){const t=ri(e,n);if(t)return Ba(t)}}function ei(e,t,n,i,r,s,o,a){if(bo(e)&&e.details.isSynthesized&&e.details.boundType&&vo(e.details.boundType)&&Zs.isProtocolClass(e.details.boundType))return!0;if(Io(e)&&!Co(t))return!1;let l=t,c=e,u=!1;if(0==(2&o))c=fa(e,r),$a(c)&&(u=!Jn(l,c,void 0,r,642|o,a),c=fa(e,r));else if(l=fa(t,s),$a(l)&&$a(l)&&(u=!Jn(l,c,void 0,s,-3&o|512,a),l=fa(t,s)),u)return i&&i.addMessage(ml.DiagnosticAddendum.paramAssignment().format({index:n+1,sourceType:ai(e),destType:ai(t)})),!1;return bo(c)&&c.details.isSynthesizedSelf||bo(l)&&l.details.isSynthesizedSelf&&l.details.boundType&&(l=fa(l.details.boundType,new jo(na(l)),!0)),!(!Jn(l,c,null==i?void 0:i.createAddendum(),0==(2&o)?s:r,o,a)&&!Ao(e,t)&&(i&&i.addMessage(ml.DiagnosticAddendum.paramAssignment().format({index:n+1,sourceType:ai(e),destType:ai(t)})),1))}function ti(e,t){if(t.details.typeParameters.length>0&&t.typeArguments&&t.typeArguments.length<=t.details.typeParameters.length){const n=new jo(na(t));Xe(Zs.cloneForSpecialization(t,void 0,!1),e,n,[]);let i=!1;const r=t.typeArguments.map(((e,r)=>{const s=t.details.typeParameters[r],o=n.getTypeVarType(s);return o&&(uo(o)||ho(e))?(i=!0,o):e}));if(i)return Zs.cloneForSpecialization(t,r,!0)}}function ni(e,t){const n=new il,i=Ko(t,(t=>{const i=Ko(e,(i=>{if(ho(e))return e;if(Jn(i,t,n)){if(_o(i)&&_o(t)){const e=ti(i,t);e&&(t=e)}else if(vo(i)&&vo(t)){const e=ti(Zs.cloneAsInstantiable(i),Zs.cloneAsInstantiable(t));e&&(t=Zs.cloneAsInstance(e))}else{if(!bo(i)&&bo(t))return i;if(ho(t))return i}return t}}));return ao(i)?t:i}));return ho(t)?e:i}function ii(e){const t=new Map;e.details.mro.forEach((e=>{_o(e)&&e.details.fields.forEach(((n,i)=>{if(n.isClassMember()){let r;const s=Vo(n);r=!(!s||3!==s.type)&&!!(8&en(s.node,!0)),t.has(i)||t.set(i,{symbol:n,symbolName:i,isAbstract:r,classType:e})}}))}));const n=[];return t.forEach((e=>{e.isAbstract&&n.push(e)})),n}function ri(e,t,n,i,r=0,s=!1,o){if(Eo(t)){if(!e)return Xs.clone(t,!0);if(Xs.isInstanceMethod(t)){const s=vo(e)?e:Zs.cloneAsInstance(xa(e));return si(e,t,n||Zs.cloneAsInstantiable(s),i,r,o||s,vo(e))}if(Xs.isClassMethod(t)||s&&Xs.isConstructorMethod(t)){const s=_o(e)?e:Zs.cloneAsInstantiable(e),a=o?_o(e)?o:Na(o):s;return si(Ks.isInstance(e)?Zs.cloneAsInstantiable(e):e,t,n||s,i,r,a,!0)}if(Xs.isStaticMethod(t)){const s=_o(e)?e:Zs.cloneAsInstantiable(e);return si(Ks.isInstance(e)?Zs.cloneAsInstantiable(e):e,t,n||s,i,r,void 0,!1)}}else if(ko(t)){const a=eo.create([]);return t.overloads.forEach((t=>{if(Xs.isOverloaded(t)){const i=ri(e,t,n,void 0,r,s,o);i&&eo.addOverload(a,i)}})),1===a.overloads.length?a.overloads[0]:0===a.overloads.length?void(i&&t.overloads.forEach((t=>{ri(e,t,n,i,r,s,o)}))):a}return t}function si(e,t,n,i,r,s,o=!0){const a=new jo(na(n));if(s&&t.details.parameters.length>0){const n=t.details.parameters[0],o=Xs.getEffectiveParameterType(t,0),l=Qo(s);a.addSolveForScope(na(t));const c=new il;if(bo(o)&&o.details.boundType&&vo(o.details.boundType)&&Zs.isProtocolClass(o.details.boundType))a.isLocked()||a.setTypeVarType(o,Ks.isInstantiable(o)?Fa(l):l);else if(!Jn(o,l,c,a,void 0,r)&&n.name&&!n.isNameSynthesized&&n.hasDeclaredType){if(!i)return;{const r=t.details.name||"(unnamed)";_e(Vt(i).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.bindTypeMismatch().format({type:ai(e),methodName:r,paramName:n.name})+c.getString(),i)}}}Un(t);const l=fa(t,a);return Xs.clone(l,o,e,na(e))}function oi(e){return Fl(e,t.printTypeFlags,Un)}function ai(e,n=!1){let i=t.printTypeFlags;return n&&(i|=32),Pl(e,i,Un)}const li={runWithCancellationToken:function(e,t){try{return m=e,t()}finally{m=void 0}},getType:j,getTypeOfExpression:$,getTypeOfAnnotation:K,getTypeOfClass:$t,getTypeOfFunction:Gt,getTypeForExpressionExpectingType:Sn,getExpectedType:function(e){hn(e);let t=e;for(;void 0!==t;){const e=l.get(t.id);if(e)return{type:e,node:t};t=t.parent}},evaluateTypeForSubnode:gn,evaluateTypesForStatement:fn,evaluateTypesForMatchNode:function(e){if(F(e,0))return;const t=$(e.subjectExpression);let n=t.type;for(const t of e.cases)t.guardExpression||(n=fu(li,n,t.pattern,!1));N(e,n,0,!!t.isIncomplete)},evaluateTypesForCaseNode:un,evaluateTypeOfParameter:mn,canBeTruthy:Q,canBeFalsy:Y,removeTruthinessFromType:Z,removeFalsinessFromType:X,verifyRaiseExceptionType:function(e){const t=xn(e,"BaseException");if(e.typeExpression){const n=$(e.typeExpression).type;if(n&&t&&_o(t)){const i=new il;Jo(n,(n=>{const r=Ie(n);if(!ho(r))if(_o(r)&&void 0===r.literalValue)if(Da(r,t,!1)){let t;En(e.typeExpression,(()=>{t=Ye(e.typeExpression,[],r,!1,void 0)})),t&&t.argumentErrors&&i.addMessage(ml.Diagnostic.exceptionTypeNotInstantiable().format({type:ai(n,!1)}))}else i.addMessage(ml.Diagnostic.exceptionTypeIncorrect().format({type:ai(n,!1)}));else vo(r)&&Da(Zs.cloneAsInstantiable(r),t,!1)||i.addMessage(ml.Diagnostic.exceptionTypeIncorrect().format({type:ai(n,!1)}))})),i.isEmpty()||_e(Vt(e).diagnosticRuleSet.reportGeneralTypeIssues,$o.reportGeneralTypeIssues,ml.Diagnostic.expectedExceptionClass()+i.getString(),e.typeExpression)}}},verifyDeleteExpression:Ce,isAfterNodeReachable:de,isNodeReachable:pe,isAsymmetricDescriptorAssignment:function(e){return a.has(e.id)},suppressDiagnostics:En,getDeclarationsForNameNode:function(e){var t;if(zt(e))return;const n=[];if(e.parent&&23===e.parent.nodeType&&e.parent.alias&&e===e.parent.name){const t=zs(e);if(t){const i=t.lookUpSymbolRecursive(e.parent.alias.value);if(i){const t=i.symbol.getDeclarations().filter((t=>6===t.type&&t.node===e.parent));n.push(...ls(t))}}}else if(e.parent&&35===e.parent.nodeType&&e===e.parent.memberName){let t=j(e.parent.leftExpression);if(t){t=Ie(t);const i=e.parent.memberName.value;Jo(t,(e=>{let t;if(_o(e=Ie(e))){let n=va(e,i,16);if(n||(n=va(e,i)),!n){const t=e.details.effectiveMetaclass;t&&_o(t)&&(n=va(t,i))}n&&(t=n.symbol)}else if(vo(e)){let n=_a(e,i,16);n||(n=_a(e,i)),n&&(t=n.symbol)}else To(e)&&(t=Qs.getField(e,i));if(t){const e=t.getTypedDeclarations();e.length>0?n.push(...e):n.push(...t.getDeclarations())}}))}}else if(e.parent&&37===e.parent.nodeType){const t=e.parent.nameParts.findIndex((t=>t===e)),i=Rt(e.parent);t>=0&&i&&!i.isNativeLib&&t<i.resolvedPaths.length&&i.resolvedPaths[t]&&(fn(e),n.push(cs(i.resolvedPaths[t])))}else if(e.parent&&1===e.parent.nodeType&&e===e.parent.name){const i=e.parent,r=e.value;if(i.parent&&9===i.parent.nodeType){const e=$(i.parent.leftExpression,void 0,2).type;if(e)if(Eo(e)&&e.details.declaration){const t=Dn(e,r);t&&n.push(t)}else if(ko(e))e.overloads.forEach((e=>{const t=Dn(e,r);t&&n.push(t)}));else if(_o(e)){const s=null===(t=ee(i.parent.leftExpression,Zs.cloneAsInstance(e),"__init__",{method:"get"},void 0,4))||void 0===t?void 0:t.type;if(s&&Eo(s)){const t=Dn(s,r);if(t)n.push(t);else if(Zs.isDataClass(e)){const t=va(e,r);t&&n.push(...t.symbol.getDeclarations())}}}}}else{const t=Vt(e),i=function(e,t){let n,i=e,r=!1;for(;i;){if(41===i.nodeType&&(n===i.typeAnnotation||n===i.typeAnnotationComment))return r||!t;if(28===i.nodeType&&n===i.returnTypeAnnotation)return r||!t;if(28===i.nodeType&&n===i.functionAnnotationComment)return!0;if(54===i.nodeType&&n===i.typeAnnotation)return r||!t;if(3===i.nodeType&&n===i.typeAnnotationComment)return!0;if(48===i.nodeType&&n===i.typeAnnotation&&(r=!0),30===i.nodeType||28===i.nodeType||10===i.nodeType||36===i.nodeType)return!1;n=i,i=i.parent}return!1}(e,!H(Vt(e))),r=i||t.isStubFile,s=wn(e,e.value,!r,i);s&&n.push(...s.symbol.getDeclarations())}return n},getTypeForDeclaration:An,resolveAliasDeclaration:Rn,resolveAliasDeclarationWithInfo:Fn,getTypeFromIterable:le,getTypeFromIterator:ae,getGetterTypeFromProperty:Hn,getTypeForArgument:bn,markNamesAccessed:function(e,t){const n=Vt(e),i=zs(e);i&&t.forEach((t=>{const r=i.lookUpSymbolRecursive(t);r&&we(n,r.symbol,e)}))},getScopeIdForNode:Pe,makeTopLevelTypeVarsConcrete:Ie,mapSubtypesExpandTypeVars:Se,populateTypeVarMapBasedOnExpectedType:Xe,lookUpSymbolRecursive:wn,getDeclaredTypeOfSymbol:On,getEffectiveTypeOfSymbol:Nn,getEffectiveTypeOfSymbolForUsage:Mn,getInferredTypeOfDeclaration:Pn,getDeclaredTypeForExpression:se,getFunctionDeclaredReturnType:Vn,getFunctionInferredReturnType:qn,getBestOverloadForArguments:Ge,getBuiltInType:xn,getTypeOfMember:Bn,getTypeFromObjectMember:ee,getBoundMethod:ne,getTypeFromMagicMethodReturn:gt,bindFunctionToClassOrObject:ri,getCallSignatureInfo:function(e,t,n){const i=e.leftExpression,r=j(i);if(void 0===r)return;const s=[];let o=0;function a(){s.push({argumentCategory:o,type:Ys.create(),active:!0})}e.arguments.forEach(((e,i)=>{let r=!1;i===t&&(n?r=!0:a()),o=e.argumentCategory,s.push({valueExpression:e.valueExpression,argumentCategory:e.argumentCategory,name:e.name,active:r})})),e.arguments.length<t&&a();const l=[];function c(t){let n;kn(e,(()=>{n=rt(i,s,t,new jo(na(t)),!0)})),l.push({type:t,activeParam:null==n?void 0:n.activeParam})}function u(e){Eo(e)?c(e):e.overloads.forEach((e=>{Xs.isOverloaded(e)&&c(e)}))}return Jo(r,(e=>{switch(e.category){case 5:case 6:u(e);break;case 7:if(Ks.isInstantiable(e)){let t;t=ne(e,"__init__");const n=!!t&&Eo(t)&&"builtins.object.__init__"===t.details.fullName,i=!!t&&Eo(t)&&Xs.isSkipConstructorCheck(t);if(!t||n||i){const n=ne(e,"__new__",!0);n&&(Eo(n)&&"builtins.object.__new__"===n.details.fullName||(t=n))}t&&u(t)}else{const t=ne(e,"__call__");t&&u(t)}}})),0!==l.length?{callNode:e,signatures:l}:void 0},getTypeAnnotationForParameter:ie,getAbstractMethods:ii,narrowConstrainedTypeVar:function(e,t){const n=Lt(e);if(n)return ci.narrowConstrainedTypeVar(n,t)},canAssignType:Jn,canOverrideMethod:function(e,t,n,i=!0){if(ko(e)&&(e=e.overloads[e.overloads.length-1],Xs.isOverloaded(e)))return!0;if(!Eo(e))return n.addMessage(ml.DiagnosticAddendum.overrideType().format({type:ai(e)})),!1;const r=Ho(e),s=Ho(t);let o=!0,a=!1;if(s.params.length<r.params.length)void 0===s.argsIndex&&void 0===s.kwargsIndex&&(a=!0);else if(s.params.length>r.params.length)for(let e=r.params.length;e<s.params.length;e++){const t=s.params[e].param;0===t.category&&t.name&&!t.hasDefault&&(a=!0)}a&&(n.addMessage(ml.DiagnosticAddendum.overrideParamCount().format({baseCount:r.params.length,overrideCount:s.params.length})),o=!1);const l=Math.min(r.params.length,s.params.length);for(let a=0;a<l;a++){if(0===a&&(Xs.isInstanceMethod(t)||Xs.isClassMethod(t)||Xs.isConstructorMethod(t)))continue;const l=r.params[a].param,c=s.params[a].param;if(a>=r.positionOnlyParamCount&&!Yt(l.name||"")&&0===l.category&&l.name!==c.name)0===c.category&&i&&(s.params[a].source===zo.PositionOnly?n.addMessage(ml.DiagnosticAddendum.overrideParamNamePositionOnly().format({index:a+1,baseName:l.name||"*"})):n.addMessage(ml.DiagnosticAddendum.overrideParamName().format({index:a+1,baseName:l.name||"*",overrideName:c.name||"*"})),o=!1);else{const i=Xs.getEffectiveParameterType(e,a),r=Xs.getEffectiveParameterType(t,a),s=bo(i)&&i.details.isSynthesized,u=bo(r)&&r.details.isSynthesized;s||u||l.category===c.category&&Jn(r,i,n.createAddendum(),new jo(na(t)),8)||(n.addMessage(ml.DiagnosticAddendum.overrideParamType().format({index:a+1,baseType:ai(i),overrideType:ai(r)})),o=!1)}}const c=Un(e),u=Un(t);return Jn(c,u,n.createAddendum(),new jo(na(e)),8)||(n.addMessage(ml.DiagnosticAddendum.overrideReturnType().format({baseType:ai(c),overrideType:ai(u)})),o=!1),o},canAssignProtocolClassToSelf:function e(t,n,i=0){w(Zs.isProtocolClass(t)),w(Zs.isProtocolClass(n)),w(Zs.isSameGenericClass(t,n)),w(t.details.typeParameters.length>0);const r=new il,s=new jo;let o=!0;return t.details.fields.forEach(((e,a)=>{if(o&&e.isClassMember()&&!e.isIgnoredForProtocolMatch()){const l=va(n,a);w(void 0!==l);let c=On(e);if(c){const a=Bn(l);if(c=ha(c,t),vo(c)&&Zs.isPropertyClass(c)&&vo(a)&&Zs.isPropertyClass(a))Gu(li,Zs.cloneAsInstantiable(c),Zs.cloneAsInstantiable(a),n,r,s,i)||(o=!1);else{const t=e.getDeclarations()[0],n=1!==(null==t?void 0:t.type)||t.isFinal?0:1;Jn(c,a,r,s,n,i)||(o=!1)}}}})),t.details.baseClasses.forEach((r=>{_o(r)&&Zs.isProtocolClass(r)&&!Zs.isBuiltIn(r,"object")&&!Zs.isBuiltIn(r,"Protocol")&&r.details.typeParameters.length>0&&(e(ka(t,r),ka(n,r),i)||(o=!1))})),o},assignTypeToExpression:xe,getBuiltInObject:Cn,getTypingType:ce,inferReturnTypeIfNecessary:Ln,addError:fe,addWarning:function(e,t,n){return ge("warning",e,t,n)},addInformation:me,addUnusedCode:function(e,t){ye(e)||Vt(e).diagnosticSink.addUnusedCodeWithTextRange(ml.Diagnostic.unreachableCode(),t)},addDeprecated:function(e,t){ye(t)||Vt(t).diagnosticSink.addDeprecatedWithTextRange(e,t)},addDiagnostic:_e,addDiagnosticForTextRange:function(e,t,n,i,r){if("none"===t)return;const s=e.diagnosticSink.addDiagnosticWithTextRange(t,i,r);return n&&s.setRule(n),s},printType:ai,printFunctionParts:function(e){return Nl(e,t.printTypeFlags,Un)},getTypeCacheSize:function(){return s.size},useSpeculativeMode:kn,setTypeForNode:O,checkForCancellation:P},ci=function(e,t){const n=new Map,i=new Map,r=new Map;let s=0,o=1;function a(e,t){const i=new Set;if(n.has(e.id))return!0;n.set(e.id,!0);try{return function e(t,n,r=0){if(r>64)return!0;r++;let s=t;for(;;){if(i.has(s.id))return!1;if(i.add(s.id),s.flags&ft.Unreachable)return!1;if(s===n)return!0;if(s.flags&(ft.VariableAnnotation|ft.Assignment|ft.TrueCondition|ft.FalseCondition|ft.WildcardImport|ft.TrueNeverCondition|ft.FalseNeverCondition|ft.NarrowForPattern|ft.ExhaustedMatch))s=s.antecedent;else{if(!(s.flags&ft.Call)){if(s.flags&(ft.BranchLabel|ft.LoopLabel)){if(s.flags&ft.PostContextManager){const e=s;if(!e.expressions.some((t=>u(t,e.isAsync))))return!1}const t=s;for(const i of t.antecedents)if(e(i,n,r))return!0;return!1}if(s.flags&ft.Start)return!n;if(s.flags&ft.PreFinallyGate)return!s.isGateClosed;if(s.flags&ft.PostFinally){const t=s,i=t.preFinallyGate.isGateClosed;try{return t.preFinallyGate.isGateClosed=!0,e(t.antecedent,n,r)}finally{t.preFinallyGate.isGateClosed=i}}return E("Unexpected flow node flags"),!1}{const e=s;if(c(e.node))return!1;s=e.antecedent}}}}(e,t)}finally{n.delete(e.id)}}function l(e,t){let n=!0;return Jo(e,(e=>{bo(e)?Ao(e,t)||(n=!1):e.condition&&e.condition.some((e=>e.isConstrainedTypeVar&&e.typeVarName===t.nameWithScope))||(n=!1)})),n}function c(t){if(i.has(t.id))return i.get(t.id);i.set(t.id,!1);let n=0,r=0;const s=h(t.leftExpression);s&&Jo(s,(i=>{var s;let o;if(r++,_o(i)){if(i.details.effectiveMetaclass&&yo(i.details.effectiveMetaclass)&&!Zs.isBuiltIn(i.details.effectiveMetaclass,"type")&&va(i.details.effectiveMetaclass,"__call__",12))return;let t=va(i,"__init__",12);if(void 0===t&&(t=va(i,"__new__",12)),t){const n=e.getTypeOfMember(t);if(n&&(Eo(n)||ko(n))){const t=e.bindFunctionToClassOrObject(void 0,n);t&&(i=t)}}}else if(vo(i)){const t=va(i,"__call__",8);if(t){const n=e.getTypeOfMember(t);if(n&&(Eo(n)||ko(n))){const t=e.bindFunctionToClassOrObject(void 0,n);t&&(i=t)}}}if(Eo(i))o=i;else if(ko(i)){const e=i;o=e.overloads[e.overloads.length-1]}if(o){const i=o.details.declaredReturnType;if(Xs.isAsync(o))i&&vo(i)&&Zs.isBuiltIn(i,"Coroutine")&&i.typeArguments&&i.typeArguments.length>=3&&ao(i.typeArguments[2])&&6===(null===(s=t.parent)||void 0===s?void 0:s.nodeType)&&n++;else if(i)ao(i)&&n++;else if(o.details.declaration&&!(o.details.declaration.yieldStatements||Xs.isAbstractMethod(o)||Xs.isStubDefinition(o)||Xs.isPyTypedDefinition(o))){const t=o.details.declaration.node.suite.statements;let i=!1;for(const e of t){if(47!==e.nodeType||1!==e.statements.length)break;const t=e.statements[0];if(48!==t.nodeType){if(43===t.nodeType&&t.typeExpression){const e=e=>38===(null==e?void 0:e.nodeType)&&"NotImplementedError"===e.value;(e(t.typeExpression)||9===t.typeExpression.nodeType&&e(t.typeExpression.leftExpression))&&(i=!0)}break}}i||e.isAfterNodeReachable(o.details.declaration.node)||n++}}}));const o=r>0&&n===r;return i.set(t.id,o),o}function u(t,n){var i;if(r.has(t.id))return r.get(t.id);r.set(t.id,!1);let s,o=!1;if(9===t.nodeType){const e=h(t.leftExpression);if(e)if(_o(e))s=Fa(e);else if(Eo(e))s=e.details.declaredReturnType;else if(ko(e)){const t=e.overloads.find((e=>Xs.isOverloaded(e)));t&&(s=t.details.declaredReturnType)}}else 38===t.nodeType&&(s=e.getDeclaredTypeForExpression(t));if(s&&vo(s)){const r=n?"__aexit__":"__exit__",a=null===(i=e.getTypeFromObjectMember(t,s,r))||void 0===i?void 0:i.type;if(a&&Eo(a)&&a.details.declaredReturnType){const e=a.details.declaredReturnType;o=vo(e)&&Zs.isBuiltIn(e,"bool")}}return r.set(t.id,o),o}function p(t,n){const i=Rt(t.node.module);w(void 0!==i&&i.isImportFound),w(t.node.isWildcardImport);const r=e.lookUpSymbolRecursive(t.node,n,!1);w(void 0!==r);const s=r.symbol.getDeclarations().find((e=>e.node===t.node));return s&&e.getInferredTypeOfDeclaration(r.symbol,s)||Ys.create()}function d(t,n){var i;const r=e.getDeclaredTypeOfSymbol(t);if(r)return r;const s=t.getDeclarations().filter((e=>!e.isInExceptSuite));if(0===s.length)return;const o=s[s.length-1];return 2===o.type?null===(i=e.evaluateTypeForSubnode(o.node.name,(()=>{e.evaluateTypeOfParameter(o.node)})))||void 0===i?void 0:i.type:6===o.type||n?e.getInferredTypeOfDeclaration(t,o):void 0}function h(t){if(38===t.nodeType){const n=e.lookUpSymbolRecursive(t,t.value,!1);if(!n)return;return d(n.symbol,n.isBeyondExecutionScope)}if(35===t.nodeType){const n=t.memberName.value;let i=h(t.leftExpression);if(!i)return;i=e.makeTopLevelTypeVarsConcrete(i);const r=Ko(i,(e=>{var t;let i;if(To(e))i=Qs.getField(e,n);else if(yo(e)){const t=va(e,n);i=t?t.symbol:void 0}return i&&null!==(t=d(i,!1))&&void 0!==t?t:Ys.create()}));if(!ao(r))return r}if(9===t.nodeType){const e=h(t.leftExpression);if(!e)return;if(e&&_o(e))return Fa(e);if(Eo(e))return e.details.declaredReturnType}}return{createCodeFlowAnalyzer:function(){const n=new Map;return{getTypeFromCodeFlow:function(i,r,l,d,h){const m=void 0!==r?At(r):void 0;let f;const g=void 0!==m&&void 0!==l?m+`.${l.toString()}`:".";let y=n.get(g);function _(e,n,i){if(i){const t=y.get(e.id);if(void 0===t)o++;else if(n&&t.isIncompleteType){const e=t;e.type&&!Ao(e.type,n)&&o++}}else o++;const r=i?{isIncompleteType:!0,type:n,incompleteSubtypes:[],generationCount:o}:n;return y.set(e.id,r),t.trackEntry(y,e.id),{type:n,isIncomplete:i,generationCount:o,incompleteSubtypes:i?[]:void 0}}function v(e,t,n,i,r){const s=y.get(e.id);void 0!==s&&Nu(s)||E("setIncompleteSubtype can be called only on a valid incomplete cache entry");const a=s.incompleteSubtypes;if(t<a.length){const e=a[t];e.isIncomplete===i&&void 0!==e.type&&void 0!==n&&Ao(e.type,n)?e.isPending!==r&&(a[t]={type:n,isIncomplete:i,isPending:r}):(a[t]={type:n,isIncomplete:i,isPending:r},o++)}else w(a.length===t),a.push({type:n,isIncomplete:i,isPending:r}),o++;return I(e)}function T(e){var t;const n=y.get(e.id);return void 0!==n&&Nu(n)||E("incrementFlowNodeVisitCount can be called only on a valid incomplete cache entry"),n.recursiveVisitCount=(null!==(t=n.recursiveVisitCount)&&void 0!==t?t:0)+1,n.recursiveVisitCount}function b(e,t=!1){var n;const i=y.get(e.id);return void 0!==i&&Nu(i)?(i.recursiveConvergenceCount=t?0:(null!==(n=i.recursiveConvergenceCount)&&void 0!==n?n:0)+1,i.recursiveConvergenceCount):0}function I(e){if(!y.has(e.id))return;const t=y.get(e.id);if(void 0===t)return{type:t,isIncomplete:!1};if(!Nu(t))return{type:t,isIncomplete:!1};let n=t.type;if(t.incompleteSubtypes.length>0){const e=[];t.incompleteSubtypes.forEach((t=>{t.type&&e.push(t.type)})),n=e.length>0?Oo(e):void 0}return{type:n,isIncomplete:!0,incompleteSubtypes:t.incompleteSubtypes,generationCount:t.generationCount}}function S(e){y.delete(e.id)}function x(t){let n=t.node;const i=t.node.parent;return i&&(28!==i.nodeType&&10!==i.nodeType||(n=i)),e.evaluateTypeForSubnode(n,(()=>{e.evaluateTypesForStatement(t.node)}))}return y||(y=new Map,n.set(g,y)),i?function t(n,i,r,l,d){var h;let g=n;const y=s;for(s++,e.checkForCancellation();;){const C=I(g);if(C){if(!C.isIncomplete)return C;if(C.generationCount===o)return{type:(null==C?void 0:C.type)?Po(C.type):void 0,isIncomplete:!0}}if(g.flags&ft.Unreachable)return _(g,void 0,!1);if(g.flags&ft.VariableAnnotation)g=g.antecedent;else if(g.flags&ft.Call){const e=g;if(c(e.node))return _(g,void 0,!1);g=e.antecedent}else if(g.flags&ft.Assignment){const t=g;if(i){if(r===t.targetSymbolId&&Lr(i,t.node)){if(g.flags&ft.Unbind)return _(g,Js.create(),!1);if(C&&void 0===C.type)return{type:void 0,isIncomplete:!0};_(g,i?void 0:l,!0);let n=x(t);return n&&(ea(n.type)||35===i.nodeType&&e.isAsymmetricDescriptorAssignment(t.node))&&(n=void 0),_(g,null==n?void 0:n.type,!!(null==n?void 0:n.isIncomplete))}if(Ur(i,t.node))return{type:l,isIncomplete:d}}g=t.antecedent}else{if(g.flags&ft.BranchLabel){const e=g;if(g.flags&ft.PostContextManager){const e=g;if(e.expressions.some((t=>u(t,e.isAsync)))===e.blockIfSwallowsExceptions)return _(g,void 0,!1)}if(i&&e.preBranchAntecedent&&e.affectedExpressions&&(f||(f=Pt(i)),!f.some((t=>e.affectedExpressions.has(t)))&&a(g,e.preBranchAntecedent))){g=e.preBranchAntecedent;continue}const n=g,o=[];let c=!1;_(g,i?void 0:l,!0),n.antecedents.forEach((e=>{const n=t(e,i,r,l,d);n.isIncomplete&&(c=!0),n.type&&o.push(n.type)}));const p=i||o.length>0?Oo(o):void 0;return s-y>16384&&(c=!1),_(g,p,c)}if(g.flags&ft.LoopLabel){const e=g;if(i&&(f||(f=Pt(i)),!f.some((t=>e.affectedExpressions.has(t))))){g=e.antecedents[0];continue}let o,a=!1,c=I(g);void 0===c?c=_(g,i?void 0:l,!0):o=c.type;const u=void 0!==c.incompleteSubtypes&&c.incompleteSubtypes.some((e=>e.isPending)),p=T(g);if(u&&(null===(h=c.incompleteSubtypes)||void 0===h?void 0:h.every((e=>e.isPending))))return{type:c.type,isIncomplete:!0};if(e.antecedents.forEach(((e,n)=>{var s;c=I(g);const o=void 0!==c.incompleteSubtypes&&n<c.incompleteSubtypes.length?c.incompleteSubtypes[n]:void 0;if(void 0===o||!(null==o?void 0:o.isPending)&&(null==o?void 0:o.isIncomplete)){c=v(g,n,null!==(s=null==o?void 0:o.type)&&void 0!==s?s:i?void 0:l,!0,!0);try{const s=t(e,i,r,l,d);s.isIncomplete&&(a=!0),c=v(g,n,s.type,s.isIncomplete,!1)}catch(e){throw v(g,n,void 0,!0,!1),e}}})),u){let e=p>=64?c.incompleteSubtypes[0].isIncomplete:void 0!==i;return s-y>16384&&(e=!1),{type:c.type,isIncomplete:e}}return a&&o&&c.type&&(Ao(o,c.type)?b(n)>2&&(a=!1):b(n,!0)),a?{type:(null==c?void 0:c.type)?Po(c.type):void 0,isIncomplete:!1}:_(g,c.type,!1)}if(g.flags&(ft.TrueCondition|ft.FalseCondition)){const n=g;if(i){_(g,i?void 0:l,!0);try{const s=ou(e,i,n.expression,!!(n.flags&(ft.TrueCondition|ft.TrueNeverCondition)));if(s){const e=t(n.antecedent,i,r,l,d);let o=e.type;return o&&(o=s(o)),_(g,o,e.isIncomplete)}S(g)}catch(e){throw S(g),e}}g=n.antecedent}else if(g.flags&(ft.TrueNeverCondition|ft.FalseNeverCondition)){const t=g;if(t.reference&&At(t.reference)!==m){const n=e.lookUpSymbolRecursive(t.reference,t.reference.value,!1);if(n&&n.symbol.getTypedDeclarations().length>0){_(g,i?void 0:l,!0);try{const n=ou(e,t.reference,t.expression,!!(t.flags&(ft.TrueCondition|ft.TrueNeverCondition)));if(n){const i=e.getTypeOfExpression(t.reference);if(ao(n(i.type)||i.type))return _(g,void 0,!!i.isIncomplete)}S(g)}catch(e){throw S(g),e}}}g=t.antecedent}else if(g.flags&ft.ExhaustedMatch){const t=g,n=e.evaluateTypeForSubnode(t.node,(()=>{e.evaluateTypesForMatchNode(t.node)}));if(n&&ao(n.type))return _(g,void 0,!!n.isIncomplete);g=t.antecedent}else if(g.flags&ft.NarrowForPattern){const t=g;if(!i||Lr(i,t.subjectExpression)){const n=e.evaluateTypeForSubnode(t.statement,(()=>{64===t.statement.nodeType?e.evaluateTypesForCaseNode(t.statement):e.evaluateTypesForMatchNode(t.statement)}));if(n){if(i)return _(g,n.type,!!n.isIncomplete);if(ao(n.type))return _(g,void 0,!!n.isIncomplete)}}g=t.antecedent}else{if(g.flags&ft.PreFinallyGate){const e=g;if(e.isGateClosed)return{type:void 0,isIncomplete:!1};_(g,i?void 0:l,!0);try{const n=t(e.antecedent,i,r,l,d);return S(g),{type:n.type,isIncomplete:n.isIncomplete}}catch(e){throw S(g),e}}if(g.flags&ft.PostFinally){const n=g,s=n.preFinallyGate.isGateClosed;try{let o;return n.preFinallyGate.isGateClosed=!0,e.useSpeculativeMode(n.finallyNode,(()=>{o=t(n.antecedent,i,r,l,d)})),o.isIncomplete?o:_(g,o.type,!1)}finally{n.preFinallyGate.isGateClosed=s}}if(g.flags&ft.Start)return _(g,l,d);if(!(g.flags&ft.WildcardImport))return E("Unexpected flow node flags"),_(g,void 0,!1);{const e=g;if(i&&38===i.nodeType){const t=i.value;if(e.names.some((e=>e===t))){_(g,i?void 0:l,!0);try{const n=p(e,t);return _(g,n,!1)}catch(e){throw S(g),e}}}g=e.antecedent}}}}}(i,r,l,d,h):{type:d,isIncomplete:h}}}},isFlowNodeReachable:a,narrowConstrainedTypeVar:function(t,n){w(!n.details.isParamSpec),w(!n.details.isVariadic),w(!n.details.boundType),w(n.details.constraints.length>0);const i=new Set,r=[];for(const e of n.details.constraints){if(!vo(e))return;r.push(e)}const s=function t(n,s){let o=n;for(;;){if(i.has(o.id))return r;if(o.flags&(ft.Unreachable|ft.Start))return r;if(o.flags&(ft.VariableAnnotation|ft.Assignment|ft.WildcardImport|ft.TrueNeverCondition|ft.FalseNeverCondition|ft.NarrowForPattern|ft.ExhaustedMatch|ft.PostFinally|ft.PreFinallyGate|ft.Call))o=o.antecedent;else{if(!(o.flags&(ft.TrueCondition|ft.FalseCondition))){if(o.flags&(ft.BranchLabel|ft.LoopLabel)){const e=o,n=[];i.add(o.id);for(const i of e.antecedents){const e=t(i,s);for(const t of e)n.some((e=>Ao(e,t)))||n.push(t)}return i.delete(o.id),n}return E("Unexpected flow node flags"),r}{const n=o,r=n.expression,a=0!=(o.flags&ft.TrueCondition);if(9===r.nodeType&&38===r.leftExpression.nodeType&&"isinstance"===r.leftExpression.value&&2===r.arguments.length){const c=r.arguments[0].valueExpression;if(l(e.getTypeOfExpression(c).type,s)){i.add(o.id);const l=t(n.antecedent,s);i.delete(o.id);const c=r.arguments[1].valueExpression,u=e.getTypeOfExpression(c,void 0,168).type;if(_o(u))return l.filter((e=>Zs.isSameGenericClass(e,u)?a:!a))}}o=n.antecedent}}}}(t,n);return 1===s.length?s[0]:void 0}}}(li,c);return li}class Xu{constructor(e){this.importName=e,this.isAccessed=!1}}class ep extends Xu{constructor(e,t,n){super(e),this.alias=t,this.symbol=n}}class tp extends Xu{constructor(e,t,n){super(e),this.isWildcardImport=t,this.node=n,this.symbols=[]}addSymbol(e,t,n,i=!1){this.symbols.find((e=>e.name===t))||this.symbols.push({symbol:e,name:t,alias:n,isAccessed:i})}}class np extends _r{constructor(e,t){super(),this._accessedImportedSymbols=e,this._treatStringsAsSymbols=t}analyze(e){this.walk(e)}walk(e){zt(e)||super.walk(e)}visitName(e){return this._accessedImportedSymbols.set(e.value,!0),!0}visitMemberAccess(e){const t=this._getRecursiveModuleAccessExpression(e.leftExpression);return t&&this._accessedImportedSymbols.set(`${t}.${e.memberName.value}`,!0),!0}visitString(e){return this._treatStringsAsSymbols&&this._accessedImportedSymbols.set(e.value,!0),!0}_getRecursiveModuleAccessExpression(e){if(38===e.nodeType)return e.value;if(35===e.nodeType){const t=this._getRecursiveModuleAccessExpression(e.leftExpression);if(!t)return;return`${t}.${e.memberName.value}`}}}class ip extends _r{constructor(e,t,n){super(),this._stubPath=e,this._sourceFile=t,this._evaluator=n,this._indentAmount=0,this._includeAllImports=!1,this._typeStubText="",this._lineEnd="\n",this._tab="    ",this._classNestCount=0,this._functionNestCount=0,this._ifNestCount=0,this._emittedSuite=!1,this._emitDocString=!0,this._trackedImportAs=new Map,this._trackedImportFrom=new Map,this._accessedImportedSymbols=new Map,this._stubPath.endsWith("__init__.pyi")&&(this._includeAllImports=!0)}write(){const e=this._sourceFile.getParseResults();this._lineEnd=e.tokenizerOutput.predominantEndOfLineSequence,this._tab=e.tokenizerOutput.predominantTabSequence,this.walk(e.parseTree),this._writeFile()}walk(e){zt(e)||super.walk(e)}visitClass(e){const t=e.name.value;this._emittedSuite=!0,this._emitDocString=!0,this._emitDecorators(e.decorators);let n=`class ${t}`;const i=e.arguments.filter((e=>void 0!==e.name||0!==e.argumentCategory||38!==e.valueExpression.nodeType||"object"!==e.valueExpression.value));return i.length>0&&(n+=`(${i.map((e=>{let t="";return e.name&&(t=e.name.value+"="),t+=this._printExpression(e.valueExpression),t})).join(", ")})`),n+=":",this._emitLine(n),this._emitSuite((()=>{this._classNestCount++,this.walk(e.suite),this._classNestCount--})),this._emitLine(""),this._emitLine(""),!1}visitFunction(e){const t=e.name.value;if(0===this._functionNestCount&&!Yt(t)){this._emittedSuite=!0,this._emitDocString=!0,this._emitDecorators(e.decorators);let n,i=e.isAsync?"async ":"";if(i+=`def ${t}`,i+=`(${e.parameters.map(((t,n)=>this._printParameter(t,e,n))).join(", ")})`,e.returnTypeAnnotation?n=this._printExpression(e.returnTypeAnnotation,!0):e.functionAnnotationComment?n=this._printExpression(e.functionAnnotationComment.returnTypeAnnotation,!0):"__init__"===e.name.value?n="None":"__str__"===e.name.value?n="str":["__int__","__hash__"].some((t=>t===e.name.value))?n="int":["__eq__","__ne__","__gt__","__lt__","__ge__","__le__"].some((t=>t===e.name.value))&&(n="bool"),n&&(i+=" -> "+n),i+=":",!n){const t=this._evaluator.getTypeOfFunction(e);if(t&&Eo(t.functionType)){let e=this._evaluator.getFunctionInferredReturnType(t.functionType);e=Po(e),ao(e)||po(e)||(i+=` # -> ${this._evaluator.printType(e,!1)}:`)}}this._emitLine(i),this._emitSuite((()=>{this._functionNestCount++,this.walk(e.suite),this._functionNestCount--})),this._emitLine("")}return!1}visitWhile(e){return this._emitDocString=!1,!1}visitFor(e){return this._emitDocString=!1,!1}visitTry(e){return this._emitDocString=!1,!1}visitWith(e){return this._emitDocString=!1,!1}visitIf(e){if(this._emitDocString=!1,0===this._functionNestCount&&0===this._ifNestCount){this._ifNestCount++,this._emittedSuite=!0,this._emitLine("if "+this._printExpression(e.testExpression)+":"),this._emitSuite((()=>{this.walkMultiple(e.ifSuite.statements)}));const t=e.elseSuite;t&&(this._emitLine("else:"),this._emitSuite((()=>{19===t.nodeType?this.walkMultiple([t.testExpression,t.ifSuite,t.elseSuite]):this.walkMultiple(t.statements)}))),this._ifNestCount--}return!1}visitAssignment(e){let t=!1,n="";if(38===e.leftExpression.nodeType){if("__all__"===e.leftExpression.value)return 0===this._functionNestCount&&0===this._ifNestCount&&(this._emittedSuite=!0,n=this._printExpression(e.leftExpression),n+=" = ",n+=this._printExpression(e.rightExpression),this._emitLine(n)),!1;if(0===this._functionNestCount){n=this._printExpression(e.leftExpression),e.typeAnnotationComment&&(n+=": "+this._printExpression(e.typeAnnotationComment,!0));const i=this._evaluator.getType(e.leftExpression);if(null==i?void 0:i.typeAliasInfo)t=!0;else if(9===e.rightExpression.nodeType){const n=this._evaluator.getType(e.rightExpression.leftExpression);n&&_o(n)&&Zs.isBuiltIn(n,["TypeVar","TypeVarTuple","ParamSpec","NewType"])&&(t=!0)}}}else if(54===e.leftExpression.nodeType){const t=e.leftExpression.valueExpression;38===t.nodeType&&0===this._functionNestCount&&(n=`${this._printExpression(t)}: ${this._printExpression(e.leftExpression.typeAnnotation,!0)}`)}return n&&(this._emittedSuite=!0,n+=" = ",n+=t?this._printExpression(e.rightExpression):"...",this._emitLine(n)),!1}visitAugmentedAssignment(e){if(38===e.leftExpression.nodeType&&"__all__"===e.leftExpression.value&&1===e.operator&&0===this._functionNestCount&&0===this._ifNestCount){let t=this._printExpression(e.leftExpression);t+=" += ",t+=this._printExpression(e.rightExpression),this._emitLine(t)}return!1}visitTypeAnnotation(e){if(0===this._functionNestCount){let t="";if(38===e.valueExpression.nodeType)t=this._printExpression(e.valueExpression);else if(35===e.valueExpression.nodeType){const n=e.valueExpression.leftExpression;38===n.nodeType&&"self"===n.value&&(Yt(e.valueExpression.memberName.value)||(t=this._printExpression(e.valueExpression)))}t&&(t+=": "+this._printExpression(e.typeAnnotation,!0),this._emitLine(t))}return!1}visitImport(e){if(this._functionNestCount>0||this._classNestCount>0)return!1;const t=zs(e);return t&&e.list.forEach((e=>{const n=this._printModuleName(e.module);if(!this._trackedImportAs.has(n)){const i=e.alias?e.alias.value:e.module.nameParts.length>0?e.module.nameParts[0].value:"",r=t.lookUpSymbolRecursive(i);if(r){const t=new ep(n,e.alias?e.alias.value:void 0,r.symbol);this._trackedImportAs.set(n,t)}}})),!1}visitImportFrom(e){if(this._functionNestCount>0||this._classNestCount>0)return!1;const t=zs(e);if(t){const n=this._printModuleName(e.module);let i=this._trackedImportFrom.get(n);i||(i=new tp(n,e.isWildcardImport,e),this._trackedImportFrom.set(n,i)),e.imports.forEach((e=>{const n=e.alias?e.alias.value:e.name.value,r=t.lookUpSymbolRecursive(n);r&&i.addSymbol(r.symbol,e.name.value,e.alias?e.alias.value:void 0,!1)}))}return!1}visitStatementList(e){return e.statements.length>0&&48===e.statements[0].nodeType&&!this._emittedSuite&&this._emitDocString&&this._emitLine(this._printExpression(e.statements[0])),this._emitDocString=!1,this.walkMultiple(e.statements),!1}_emitSuite(e){this._increaseIndent((()=>{const t=this._emittedSuite;this._emittedSuite=!1,e(),this._emittedSuite||this._emitLine("..."),this._emittedSuite=t}))}_increaseIndent(e){this._indentAmount++,e(),this._indentAmount--}_emitDecorators(e){e.forEach((e=>{this._emitLine("@"+this._printExpression(e.expression))}))}_printHeaderDocString(){return'"""'+this._lineEnd+"This type stub file was generated by pyright."+this._lineEnd+'"""'+this._lineEnd+this._lineEnd}_emitLine(e){for(let e=0;e<this._indentAmount;e++)this._typeStubText+=this._tab;this._typeStubText+=e+this._lineEnd}_printModuleName(e){let t="";for(let n=0;n<e.leadingDots;n++)t+=".";return t+=e.nameParts.map((e=>e.value)).join("."),t}_printParameter(e,t,n){let i="";1===e.category?i+="*":2===e.category&&(i+="**"),e.name&&(i+=e.name.value);const r=this._evaluator.getTypeAnnotationForParameter(t,n);let s="";return r&&(s=this._printExpression(r,!0)),s&&(i+=": "+s),e.defaultValue&&(i+=s?" = ...":"=..."),i}_printExpression(e,t=!1,n=!1){return new np(this._accessedImportedSymbols,n).analyze(e),xr(e,t?1:0)}_printTrackedImports(){let e="",t=!1;return this._trackedImportAs.forEach((n=>{this._accessedImportedSymbols.get(n.alias||n.importName)&&(n.isAccessed=!0),(n.isAccessed||this._includeAllImports)&&(e+=`import ${n.importName}`,n.alias&&(e+=` as ${n.alias}`),e+=this._lineEnd,t=!0)})),this._trackedImportFrom.forEach((n=>{n.symbols.forEach((e=>{this._accessedImportedSymbols.get(e.alias||e.name)&&(e.isAccessed=!0)})),n.isWildcardImport&&(e+=`from ${n.importName} import *`+this._lineEnd,t=!0);const i=n.symbols.filter((e=>e.isAccessed||this._includeAllImports)).sort(((e,t)=>e.name<t.name?-1:e.name>t.name?1:0));i.length>0&&(e+=`from ${n.importName} import `,e+=i.map((e=>{let t=e.name;return e.alias&&(t+=" as "+e.alias),t})).join(", "),e+=this._lineEnd,t=!0)})),t&&(e+=this._lineEnd),e}_writeFile(){let e=this._printHeaderDocString();e+=this._printTrackedImports(),e+=this._typeStubText,this._sourceFile.fileSystem.writeFileSync(this._stubPath,e,"utf8")}}class rp{constructor(e,t,n,i,r,s){this._extension=i,this._disableChecker=s,this._sourceFileList=[],this._sourceFileMap=new Map,this._parsedFileCount=0,this._lookUpImport=e=>{var t;let n;if("string"==typeof e)n=this._getSourceFileInfoFromPath(e);else{const t=this._importResolver.resolveImport(e.importingFilePath,this._configOptions.findExecEnvironment(e.importingFilePath),{leadingDots:0,nameParts:e.nameParts,importedSymbols:void 0});if(t.isImportFound&&!t.isNativeLib&&t.resolvedPaths.length>0){let e=t.resolvedPaths[t.resolvedPaths.length-1];e&&(n=this._getSourceFileInfoFromPath(e),n||(e=ke(this._fs,e),this.addTrackedFile(e),n=this._getSourceFileInfoFromPath(e)))}}if(!n)return;n.sourceFile.isBindingRequired()&&Fn.typeCheckerTime.subtractFromTime((()=>{this._bindFile(n)}));const i=n.sourceFile.getModuleSymbolTable();if(!i)return;const r=n.sourceFile.getParseResults(),s=r.parseTree,o=Wt(r.parseTree);return{symbolTable:i,dunderAllNames:null==o?void 0:o.names,usesUnsupportedDunderAllForm:null!==(t=null==o?void 0:o.usesUnsupportedDunderAllForm)&&void 0!==t&&t,get docString(){return qr(s.statements)}}},this._console=n||new Un,this._logTracker=null!=r?r:new Bn(n,"FG"),this._importResolver=e,this._configOptions=t,this._createNewEvaluator()}get evaluator(){return this._evaluator}setConfigOptions(e){this._configOptions=e,this._createNewEvaluator()}setImportResolver(e){this._importResolver=e,this._createNewEvaluator()}setTrackedFiles(e){if(this._sourceFileList.length>0){const t=new Map;e.forEach((e=>{t.set(ke(this._fs,e),e)})),this._sourceFileList.forEach((e=>{const n=ke(this._fs,e.sourceFile.getFilePath());t.has(n)||(e.isTracked=!1)}))}return this.addTrackedFiles(e),this._removeUnneededFiles()}setPreCheckCallback(e){this._preCheckCallback=e}setAllowedThirdPartyImports(e){this._allowedThirdPartyImports=e}addTrackedFiles(e,t=!1,n=!1){e.forEach((e=>{this.addTrackedFile(e,t,n)}))}addTrackedFile(e,t=!1,n=!1){let i=this._getSourceFileInfoFromPath(e);if(i)return i.isTracked=!0,i.sourceFile;const r=this._getImportNameForFile(e),s=new Ru(this._fs,e,r,t,n,this._console,this._logTracker);return i={sourceFile:s,isTracked:!0,isOpenByClient:!1,isTypeshedFile:!1,isThirdPartyImport:t,isThirdPartyPyTypedPresent:n,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(i),s}setFileOpened(e,t,n,i){var r,s;let o=this._getSourceFileInfoFromPath(e);if(o)o.isOpenByClient=!0,o.diagnosticsVersion=0;else{const t=this._getImportNameForFile(e),n=new Ru(this._fs,e,t,!1,!1,this._console,this._logTracker,null!==(r=null==i?void 0:i.ipythonMode)&&void 0!==r&&r),a=null==i?void 0:i.chainedFilePath;o={sourceFile:n,isTracked:null!==(s=null==i?void 0:i.isTracked)&&void 0!==s&&s,chainedSourceFile:a?this._getSourceFileInfoFromPath(a):void 0,isOpenByClient:!0,isTypeshedFile:!1,isThirdPartyImport:!1,isThirdPartyPyTypedPresent:!1,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(o)}o.sourceFile.setClientVersion(t,n)}setFileClosed(e){const t=this._getSourceFileInfoFromPath(e);return t&&(t.isOpenByClient=!1,t.sourceFile.setClientVersion(null,[]),t.sourceFile.didContentsChangeOnDisk()&&(t.sourceFile.markDirty(),this._markFileDirtyRecursive(t,new Map))),this._removeUnneededFiles()}markAllFilesDirty(e,t=!0){const n=new Map;this._sourceFileList.forEach((i=>{e?i.sourceFile.markDirty(t):i.sourceFile.didContentsChangeOnDisk()&&(i.sourceFile.markDirty(t),this._markFileDirtyRecursive(i,n))})),n.size>0&&this._createNewEvaluator()}markFilesDirty(e,t,n=!0){const i=new Map;e.forEach((e=>{const r=this._getSourceFileInfoFromPath(e);if(r){const s=de(e);if("builtins.pyi"===s||"__builtins__.pyi"===s)return void this.markAllFilesDirty(t,n);(t||!r.isOpenByClient&&r.sourceFile.didContentsChangeOnDisk())&&(r.sourceFile.markDirty(n),this._markFileDirtyRecursive(r,i))}})),i.size>0&&this._createNewEvaluator()}getFileCount(){return this._sourceFileList.length}getTracked(){return this._sourceFileList.filter((e=>e.isTracked))}getOpened(){return this._sourceFileList.filter((e=>e.isOpenByClient))}getFilesToAnalyzeCount(){let e=0;return this._disableChecker||this._sourceFileList.forEach((t=>{t.sourceFile.isCheckingRequired()&&this._shouldCheckFile(t)&&e++})),e}isCheckingOnlyOpenFiles(){return this._configOptions.checkOnlyOpenFiles||!1}getSourceFile(e){const t=this._getSourceFileInfoFromPath(e);if(t)return t.sourceFile}getBoundSourceFile(e){const t=this._getSourceFileInfoFromPath(e);if(t)return this._bindFile(t),this.getSourceFile(e)}analyze(e,t=ot.CancellationToken.None){return this._runEvaluatorWithCancellationToken(t,(()=>{const t=new Pn,n=this._sourceFileList.filter((e=>e.isOpenByClient&&e.sourceFile.isCheckingRequired()));if(n.length>0){const i=e?e.openFilesTimeInMs:Number.MAX_VALUE;for(const e of n)if(this._checkTypes(e)&&t.getDurationInMilliseconds()>i)return!0;if(void 0!==e)return!0}if(!this._configOptions.checkOnlyOpenFiles){const n=e?e.noOpenFilesTimeInMs:Number.MAX_VALUE;for(const e of this._sourceFileList)if(this._isUserCode(e)&&this._checkTypes(e)&&t.getDurationInMilliseconds()>n)return!0}return!1}))}indexWorkspace(e,t){return this._configOptions.indexing?this._runEvaluatorWithCancellationToken(t,(()=>{const i=new Set;for(const e of this._sourceFileList)e.sourceFile.isParseRequired()||i.add(e);let r=0;for(const s of this._sourceFileList){if(!this._isUserCode(s)||!s.sourceFile.isIndexingRequired())continue;this._bindFile(s);const o=s.sourceFile.index({indexingForAutoImportMode:!1},t);if(o){if(++r>2e3)return this._console.warn("Workspace indexing has hit its upper limit: 2000 files"),n(this._sourceFileList,i),r;e(s.sourceFile.getFilePath(),o)}this._handleMemoryHighUsage()}return n(this._sourceFileList,i),r})):0;function n(e,t){for(const n of e)n.sourceFile.isParseRequired()||t.has(n)||n.sourceFile.dropParseAndBindInfo()}}printDependencies(e,t){const n=this._sourceFileList.filter((e=>!e.isTypeshedFile)).sort(((e,t)=>e.sourceFile.getFilePath()<t.sourceFile.getFilePath()?1:-1)),i=[];n.forEach((n=>{this._console.info("");let r=n.sourceFile.getFilePath();const s=Y(r,e);s&&(r=s),this._console.info(`${r}`),this._console.info(` Imports     ${n.imports.length} file`+(1===n.imports.length?"":"s")),t&&n.imports.forEach((e=>{this._console.info(`    ${e.sourceFile.getFilePath()}`)})),this._console.info(` Imported by ${n.importedBy.length} file`+(1===n.importedBy.length?"":"s")),t&&n.importedBy.forEach((e=>{this._console.info(`    ${e.sourceFile.getFilePath()}`)})),0===n.importedBy.length&&i.push(n.sourceFile)})),i.length>0&&(this._console.info(""),this._console.info(`${i.length} file${1===i.length?"":"s"} not explicitly imported`),i.forEach((e=>{this._console.info(`    ${e.getFilePath()}`)})))}writeTypeStub(e,t,n,i){for(const r of this._sourceFileList){ct(i);const s=Y(r.sourceFile.getFilePath(),e);if(void 0!==s){let e=me(te(n,s));e=t?te($(e),"__init__.pyi"):he(e)+".pyi";const o=$(e);try{Q(this._fs,o,n)}catch(e){throw new Error(`Could not create directory for '${o}'`)}this._bindFile(r),this._runEvaluatorWithCancellationToken(i,(()=>{new ip(e,r.sourceFile,this._evaluator).write()})),this._handleMemoryHighUsage()}}}getTypeForSymbol(e){return this._handleMemoryHighUsage(),(this._evaluator||this._createNewEvaluator()).getEffectiveTypeOfSymbol(e)}printType(e,t){return this._handleMemoryHighUsage(),(this._evaluator||this._createNewEvaluator()).printType(e,t)}static _getPrintTypeFlags(e){let t=0;return e.diagnosticRuleSet.printUnknownAsAny&&(t|=1),e.diagnosticRuleSet.omitConditionalConstraint&&(t|=64),e.diagnosticRuleSet.omitTypeArgsIfAny&&(t|=2),e.diagnosticRuleSet.omitUnannotatedParamType&&(t|=4),e.diagnosticRuleSet.pep604Printing&&(t|=8),t}get _fs(){return this._importResolver.fileSystem}_getImportNameForFile(e){return this._importResolver.getModuleNameForImport(e,this._configOptions.getDefaultExecEnvironment()).moduleName}_addShadowedFile(e,t){let n=this._getSourceFileInfoFromPath(t);if(!n){const e=this._getImportNameForFile(t);n={sourceFile:new Ru(this._fs,t,e,!1,!1,this._console,this._logTracker),isTracked:!1,isOpenByClient:!1,isTypeshedFile:!1,isThirdPartyImport:!1,isThirdPartyPyTypedPresent:!1,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(n)}return n.shadows.includes(e)||n.shadows.push(e),e.shadowedBy.includes(n)||e.shadowedBy.push(n),n.sourceFile}_createNewEvaluator(){return this._evaluator=function(e,t,n,i){if(!t.logCalls&&o())return Zu(e,t);function r(e,r,s){return t.logCalls?n.log(e,(e=>(e.add(null==i?void 0:i.print(s)),Fn.typeEvaluationTime.timeOperation(r))),t.minimumLoggingThreshold,!0):Fn.typeEvaluationTime.timeOperation(r)}const s=Zu(t.logCalls?r=>n.log("import lookup",(t=>(t.add(null==i?void 0:i.printFileOrModuleName(r)),e(r))),t.minimumLoggingThreshold,!0):e,t);return{runWithCancellationToken:s.runWithCancellationToken,getType:e=>r("getType",(()=>s.getType(e)),e),getTypeOfExpression:(e,t,n)=>r("getTypeOfExpression",(()=>s.getTypeOfExpression(e,t,n)),e),getTypeOfAnnotation:s.getTypeOfAnnotation,getTypeOfClass:e=>r("getTypeOfClass",(()=>s.getTypeOfClass(e)),e),getTypeOfFunction:e=>r("getTypeOfFunction",(()=>s.getTypeOfFunction(e)),e),getTypeForExpressionExpectingType:s.getTypeForExpressionExpectingType,evaluateTypeForSubnode:s.evaluateTypeForSubnode,evaluateTypesForStatement:e=>r("evaluateTypesForStatement",(()=>s.evaluateTypesForStatement(e)),e),evaluateTypesForMatchNode:s.evaluateTypesForMatchNode,evaluateTypesForCaseNode:s.evaluateTypesForCaseNode,evaluateTypeOfParameter:s.evaluateTypeOfParameter,canBeTruthy:s.canBeTruthy,canBeFalsy:s.canBeFalsy,removeTruthinessFromType:s.removeTruthinessFromType,removeFalsinessFromType:s.removeFalsinessFromType,getExpectedType:e=>r("getExpectedType",(()=>s.getExpectedType(e)),e),verifyRaiseExceptionType:e=>r("verifyRaiseExceptionType",(()=>s.verifyRaiseExceptionType(e)),e),verifyDeleteExpression:e=>r("verifyDeleteExpression",(()=>s.verifyDeleteExpression(e)),e),isAfterNodeReachable:e=>r("isAfterNodeReachable",(()=>s.isAfterNodeReachable(e)),e),isNodeReachable:(e,t)=>r("isNodeReachable",(()=>s.isNodeReachable(e,t)),e),isAsymmetricDescriptorAssignment:s.isAsymmetricDescriptorAssignment,suppressDiagnostics:(e,t)=>r("suppressDiagnostics",(()=>s.suppressDiagnostics(e,t))),getDeclarationsForNameNode:e=>r("getDeclarationsForNameNode",(()=>s.getDeclarationsForNameNode(e)),e),getTypeForDeclaration:e=>r("getTypeForDeclaration",(()=>s.getTypeForDeclaration(e)),e),resolveAliasDeclaration:(e,t,n)=>r("resolveAliasDeclaration",(()=>s.resolveAliasDeclaration(e,t,n)),e),resolveAliasDeclarationWithInfo:(e,t,n)=>r("resolveAliasDeclarationWithInfo",(()=>s.resolveAliasDeclarationWithInfo(e,t,n)),e),getTypeFromIterable:(e,t,n)=>r("getTypeFromIterable",(()=>s.getTypeFromIterable(e,t,n)),e),getTypeFromIterator:(e,t,n)=>r("getTypeFromIterator",(()=>s.getTypeFromIterator(e,t,n)),e),getGetterTypeFromProperty:(e,t)=>r("getGetterTypeFromProperty",(()=>s.getGetterTypeFromProperty(e,t)),e),getTypeForArgument:s.getTypeForArgument,markNamesAccessed:(e,t)=>r("markNamesAccessed",(()=>s.markNamesAccessed(e,t)),e),getScopeIdForNode:s.getScopeIdForNode,makeTopLevelTypeVarsConcrete:e=>r("makeTopLevelTypeVarsConcrete",(()=>s.makeTopLevelTypeVarsConcrete(e)),e),mapSubtypesExpandTypeVars:s.mapSubtypesExpandTypeVars,populateTypeVarMapBasedOnExpectedType:s.populateTypeVarMapBasedOnExpectedType,lookUpSymbolRecursive:s.lookUpSymbolRecursive,getDeclaredTypeOfSymbol:s.getDeclaredTypeOfSymbol,getEffectiveTypeOfSymbol:e=>r("getEffectiveTypeOfSymbol",(()=>s.getEffectiveTypeOfSymbol(e)),e),getEffectiveTypeOfSymbolForUsage:(e,t,n)=>r("getEffectiveTypeOfSymbolForUsage",(()=>s.getEffectiveTypeOfSymbolForUsage(e,t,n)),e),getInferredTypeOfDeclaration:s.getInferredTypeOfDeclaration,getDeclaredTypeForExpression:s.getDeclaredTypeForExpression,getFunctionDeclaredReturnType:e=>r("getFunctionDeclaredReturnType",(()=>s.getFunctionDeclaredReturnType(e)),e),getFunctionInferredReturnType:(e,t)=>r("getFunctionInferredReturnType",(()=>s.getFunctionInferredReturnType(e,t)),e),getBestOverloadForArguments:(e,t,n)=>s.getBestOverloadForArguments(e,t,n),getBuiltInType:(e,t)=>r("getBuiltInType",(()=>s.getBuiltInType(e,t)),e),getTypeOfMember:e=>r("getTypeOfMember",(()=>s.getTypeOfMember(e)),e.symbol),getTypeFromObjectMember:s.getTypeFromObjectMember,getBoundMethod:s.getBoundMethod,getTypeFromMagicMethodReturn:s.getTypeFromMagicMethodReturn,bindFunctionToClassOrObject:s.bindFunctionToClassOrObject,getCallSignatureInfo:(e,t,n)=>r("getCallSignatureInfo",(()=>s.getCallSignatureInfo(e,t,n)),e),getTypeAnnotationForParameter:(e,t)=>r("getTypeAnnotationForParameter",(()=>s.getTypeAnnotationForParameter(e,t)),e),getAbstractMethods:e=>r("getAbstractMethods",(()=>s.getAbstractMethods(e)),e),narrowConstrainedTypeVar:s.narrowConstrainedTypeVar,canAssignType:(e,t,n,i,o)=>r("canAssignType",(()=>s.canAssignType(e,t,n,i,o)),e),canOverrideMethod:(e,t,n,i)=>r("canOverrideMethod",(()=>s.canOverrideMethod(e,t,n,i)),t),canAssignProtocolClassToSelf:(e,t)=>r("canAssignProtocolClassToSelf",(()=>s.canAssignProtocolClassToSelf(e,t))),assignTypeToExpression:s.assignTypeToExpression,getBuiltInObject:s.getBuiltInObject,getTypingType:s.getTypingType,inferReturnTypeIfNecessary:s.inferReturnTypeIfNecessary,addError:(e,t)=>r("addError",(()=>s.addError(e,t)),t),addWarning:(e,t)=>r("addWarning",(()=>s.addWarning(e,t)),t),addInformation:(e,t)=>r("addInformation",(()=>s.addInformation(e,t)),t),addUnusedCode:(e,t)=>r("addUnusedCode",(()=>s.addUnusedCode(e,t)),e),addDeprecated:(e,t)=>r("addDeprecated",(()=>s.addDeprecated(e,t)),t),addDiagnostic:(e,t,n,i)=>r("addDiagnostic",(()=>s.addDiagnostic(e,t,n,i)),i),addDiagnosticForTextRange:(e,t,n,i,o)=>r("addDiagnosticForTextRange",(()=>s.addDiagnosticForTextRange(e,t,n,i,o))),printType:(e,t)=>r("printType",(()=>s.printType(e,t)),e),printFunctionParts:e=>r("printFunctionParts",(()=>s.printFunctionParts(e)),e),getTypeCacheSize:s.getTypeCacheSize,useSpeculativeMode:s.useSpeculativeMode,setTypeForNode:s.setTypeForNode,checkForCancellation:s.checkForCancellation}}(this._lookUpImport,{printTypeFlags:rp._getPrintTypeFlags(this._configOptions),logCalls:this._configOptions.logTypeEvaluationTime,minimumLoggingThreshold:this._configOptions.typeEvaluationTimeThreshold,analyzeUnannotatedFunctions:this._configOptions.analyzeUnannotatedFunctions,evaluateUnknownImportsAsAny:!!this._configOptions.evaluateUnknownImportsAsAny,verifyTypeCacheEvaluatorFlags:!!this._configOptions.internalTestMode},this._logTracker,this._configOptions.logTypeEvaluationTime?Fu(this._importResolver.getImportRoots(this._configOptions.findExecEnvironment(this._configOptions.projectRoot))):void 0),this._evaluator}_parseFile(e,t){if(this._isFileNeeded(e)&&e.sourceFile.isParseRequired()&&(e.sourceFile.parse(this._configOptions,this._importResolver,t)&&(this._parsedFileCount++,this._updateSourceFileImports(e,this._configOptions)),e.sourceFile.isFileDeleted())){e.isTracked=!1;const t=new Map;this._markFileDirtyRecursive(e,t),this._importResolver.invalidateCache()}}_bindFile(e,t){var n,i;if(!this._isFileNeeded(e)||!e.sourceFile.isBindingRequired())return;this._parseFile(e,t);const r=t=>{if(!t||t===e)return;if(this._bindFile(t),t.sourceFile.isFileDeleted())return;const n=t.sourceFile.getParseResults();if(!n)return;const i=Ft(n.parseTree);return w(void 0!==i),i};let s;e.builtinsImport&&e.builtinsImport!==e&&(s=null!==(i=null!==(n=r(e.chainedSourceFile))&&void 0!==n?n:r(e.ipythonDisplayImport))&&void 0!==i?i:r(e.builtinsImport)),e.sourceFile.bind(this._configOptions,this._lookUpImport,s)}_buildModuleSymbolsMap(e,t,n,i){return function(e,t,n){const i=new Map;return ct(n),e.forEach((e=>{if(e.shadows.length>0)return;const n=e.sourceFile.getFilePath(),r=e.sourceFile.getModuleSymbolTable();if(r){if(Yt(he(de(n))))return;return void i.set(n,{forEach(e){r.forEach(((t,n)=>{if(t.isExternallyHidden())return;const i=t.getDeclarations();if(!i||0===i.length)return;const r=i[0];if(!r)return;if(6===r.type)return;const s=1!==r.type||r.isConstant||r.isFinal?void 0:ot.SymbolKind.Variable;e({symbol:t,kind:s},n,!1)}))}})}const s=e.sourceFile.getCachedIndexResults();s&&t&&!s.privateOrProtected&&i.set(n,Gl(s,!1))})),i}(this._sourceFileList.filter((n=>n!==e&&(!t||this._isUserCode(n)))),n,i)}_shouldCheckFile(e){return!!e.isOpenByClient||!(this._configOptions.checkOnlyOpenFiles||!e.isTracked)}_checkTypes(e){return this._logTracker.log(`analyzing: ${e.sourceFile.getFilePath()}`,(t=>{if(!this._isFileNeeded(e))return t.suppress(),!1;if(!e.sourceFile.isCheckingRequired())return t.suppress(),!1;if(!this._shouldCheckFile(e))return t.suppress(),!1;if(this._bindFile(e),this._preCheckCallback){const t=e.sourceFile.getParseResults();t&&this._preCheckCallback(t,this._evaluator)}if(this._disableChecker||e.sourceFile.check(this._evaluator),this._handleMemoryHighUsage(),"none"!==this._configOptions.diagnosticRuleSet.reportImportCycles&&!this._allowedThirdPartyImports){const t=new Map;this._getImportsRecursive(e,t,0),t.forEach((e=>{Fn.cycleDetectionTime.timeOperation((()=>{this._detectAndReportImportCycles(e)}))}))}return!0}))}_getImportsRecursive(e,t,n){const i=ke(this._fs,e.sourceFile.getFilePath());if(!t.has(i))if(n>256)e.sourceFile.setHitMaxImportDepth(256);else{t.set(i,e);for(const i of e.imports)this._getImportsRecursive(i,t,n+1)}}_detectAndReportImportCycles(e,t=[],n=new Map){if(e.sourceFile.isStubFile()||e.isThirdPartyImport)return;const i=ke(this._fs,e.sourceFile.getFilePath());if(n.has(i))t.length>1&&e===t[0]&&this._logImportCycle(t);else{if(n.has(i))return;n.set(i,!0),t.push(e);for(const i of e.imports)this._detectAndReportImportCycles(i,t,n);n.set(i,!1),t.pop()}}_logImportCycle(e){const t=new _c;e.forEach((e=>{t.appendPath(e.sourceFile.getFilePath())})),t.normalizeOrder();const n=t.getPaths()[0],i=this._getSourceFileInfoFromPath(n);w(void 0!==i),i.sourceFile.addCircularDependency(t)}_markFileDirtyRecursive(e,t,n=!1){const i=ke(this._fs,e.sourceFile.getFilePath());t.has(i)||(e.sourceFile.markReanalysisRequired(n),t.set(i,!0),e.importedBy.forEach((n=>{const i=n.chainedSourceFile===e;this._markFileDirtyRecursive(n,t,i)})))}getTextOnRange(e,t,n){const i=this._getSourceFileInfoFromPath(e);if(!i)return;const r=i.sourceFile,s=r.getOpenFileContents();return void 0!==s?this._runEvaluatorWithCancellationToken(n,(()=>{this._parseFile(i);const e=r.getParseResults(),n=Ct(t,e.tokenizerOutput.lines);if(n)return s.substr(n.start,n.length)})):void 0}getAutoImports(e,t,n,i,r,s,o,a){const l=this._getSourceFileInfoFromPath(e);if(!l)return[];const c=l.sourceFile,u=c.getOpenFileContents();return void 0===u?[]:this._runEvaluatorWithCancellationToken(a,(()=>{this._bindFile(l);const p=c.getParseResults(),d=Ct(t,p.tokenizerOutput.lines);if(!d)return[];const h=Tr(p.parseTree,d.start);if(!h)return[];const m=u.substr(d.start,d.length),f=this._buildModuleSymbolsMap(l,!!r,!0,a),g=new Hl(this._configOptions.findExecEnvironment(e),this._importResolver,p,t.start,new $l,f,{lazyEdit:s,allowVariableInAll:o,libraryMap:r,patternMatcher:(e,t)=>function(e,t){if(t.startsWith(e))return 1;const n=t.toLocaleLowerCase(),i=e.toLocaleLowerCase();if(n.startsWith(i))return.75;let r=n.length,s=Number.MAX_VALUE;for(;r>0;){const e=F()(n.substr(0,r),i);e<s&&(s=e),r--}return s>=e.length?0:(e.length-s)/e.length*.5}(e,t)>n}),y=[],_=zs(h);if(_){const e=null==i?void 0:i.get(m);e&&y.push(...g.getAutoImportCandidatesForAbbr(m,e,a)),y.push(...g.getAutoImportCandidates(m,n,void 0,a).filter((e=>!_.lookUpSymbolRecursive(e.name))))}return y}))}getDiagnostics(e){const t=this._removeUnneededFiles();return this._sourceFileList.forEach((n=>{if(this._shouldCheckFile(n)){const i=n.sourceFile.getDiagnostics(e,n.diagnosticsVersion);void 0!==i&&(t.push({filePath:n.sourceFile.getFilePath(),version:n.sourceFile.getClientVersion(),diagnostics:i}),n.diagnosticsVersion=n.sourceFile.getDiagnosticVersion())}else!n.isOpenByClient&&e.checkOnlyOpenFiles&&void 0!==n.diagnosticsVersion&&(t.push({filePath:n.sourceFile.getFilePath(),version:n.sourceFile.getClientVersion(),diagnostics:[]}),n.diagnosticsVersion=void 0)})),t}getDiagnosticsForRange(e,t){const n=this.getSourceFile(e);if(!n)return[];const i=n.getDiagnostics(this._configOptions);return i?i.filter((e=>yt(e.range,t))):[]}getDefinitionsForPosition(e,t,n,i){return this._runEvaluatorWithCancellationToken(i,(()=>{const r=this._getSourceFileInfoFromPath(e);if(!r)return;this._bindFile(r);const s=this._configOptions.findExecEnvironment(e);return r.sourceFile.getDefinitionsForPosition(this._createSourceMapper(s),t,n,this._evaluator,i)}))}getTypeDefinitionsForPosition(e,t,n){return this._runEvaluatorWithCancellationToken(n,(()=>{const i=this._getSourceFileInfoFromPath(e);if(!i)return;this._bindFile(i);const r=this._configOptions.findExecEnvironment(e);return i.sourceFile.getTypeDefinitionsForPosition(this._createSourceMapper(r,!1,!0),t,this._evaluator,e,n)}))}reportReferencesForPosition(e,t,n,i,r){this._runEvaluatorWithCancellationToken(r,(()=>{const s=this._getSourceFileInfoFromPath(e);if(!s)return;const o=this._isUserCode(s);this._bindFile(s);const a=this._configOptions.findExecEnvironment(e),l=s.sourceFile.getDeclarationForPosition(this._createSourceMapper(a),t,this._evaluator,i,r);if(l)if(l.requiresGlobalSearch){for(const e of this._sourceFileList)if(ct(r),e.isOpenByClient||!o||this._isUserCode(e)){const t=e.sourceFile.getFileContent();(!t||t.search(l.symbolName)>=0)&&(this._bindFile(e),e.sourceFile.addReferences(l,n,this._evaluator,r)),this._handleMemoryHighUsage()}if(n)for(const e of l.declarations){if(ct(r),l.locations.some((t=>t.path===e.path)))continue;const t=this._getSourceFileInfoFromPath(e.path);if(!t)continue;const i=new Xl(l.requiresGlobalSearch,l.nodeAtOffset,l.symbolName,l.declarations);t.sourceFile.addReferences(i,n,this._evaluator,r);for(const t of i.locations)t.path===e.path&&_t(e.range,t.range)&&l.addLocations(t)}}else s.sourceFile.addReferences(l,n,this._evaluator,r)}))}getFileIndex(e,t,n){if(!t.indexingForAutoImportMode||!Yt(he(de(e))))return this._handleMemoryHighUsage(),this._runEvaluatorWithCancellationToken(n,(()=>{var i;const r=this._getSourceFileInfoFromPath(e);if(!r)return;const s=null!==(i=r.sourceFile.getFileContent())&&void 0!==i?i:"";return t.indexingForAutoImportMode&&!r.sourceFile.isStubFile()&&!r.sourceFile.isThirdPartyPyTypedPresent()&&s.indexOf("__all__")<0?void 0:(this._bindFile(r,s),r.sourceFile.index(t,n))}))}addSymbolsForDocument(e,t,n){return this._runEvaluatorWithCancellationToken(n,(()=>{const i=this._getSourceFileInfoFromPath(e);i&&(i.sourceFile.getCachedIndexResults()||this._bindFile(i),i.sourceFile.addHierarchicalSymbolsForDocument(t,n))}))}reportSymbolsForWorkspace(e,t,n){this._runEvaluatorWithCancellationToken(n,(()=>{if(e)for(const i of this._sourceFileList){if(!this._isUserCode(i))continue;i.sourceFile.getCachedIndexResults()||this._bindFile(i);const r=i.sourceFile.getSymbolsForDocument(e,n);r.length>0&&t(r),this._handleMemoryHighUsage()}}))}getHoverForPosition(e,t,n,i){return this._runEvaluatorWithCancellationToken(i,(()=>{const r=this._getSourceFileInfoFromPath(e);if(!r)return;this._bindFile(r);const s=this._configOptions.findExecEnvironment(e);return r.sourceFile.getHoverForPosition(this._createSourceMapper(s,!0),t,n,this._evaluator,i)}))}getDocumentHighlight(e,t,n){return this._runEvaluatorWithCancellationToken(n,(()=>{const i=this._getSourceFileInfoFromPath(e);if(!i)return;this._bindFile(i);const r=this._configOptions.findExecEnvironment(e);return i.sourceFile.getDocumentHighlight(this._createSourceMapper(r),t,this._evaluator,n)}))}getSignatureHelpForPosition(e,t,n,i){return this._runEvaluatorWithCancellationToken(i,(()=>{const r=this._getSourceFileInfoFromPath(e);if(!r)return;this._bindFile(r);const s=this._configOptions.findExecEnvironment(e);return r.sourceFile.getSignatureHelpForPosition(t,this._createSourceMapper(s,!0),this._evaluator,n,i)}))}async getCompletionsForPosition(e,t,n,i,r,s,o){var a,l;const c=this._getSourceFileInfoFromPath(e);if(!c)return;const u=this._logTracker.log(`completion at ${e}:${t.line}:${t.character}`,(a=>{var l,u;const p=this._runEvaluatorWithCancellationToken(o,(()=>{this._bindFile(c);const a=this._configOptions.findExecEnvironment(e);return c.sourceFile.getCompletionsForPosition(t,n,this._configOptions,this._importResolver,this._lookUpImport,this._evaluator,i,this._createSourceMapper(a,!0),r,s,(()=>this._buildModuleSymbolsMap(c,!!s,!1,o)),o)}));return a.add(`found ${null!==(u=null===(l=null==p?void 0:p.completionMap)||void 0===l?void 0:l.size)&&void 0!==u?u:"null"} items`),p})),p={completionList:Ln.CompletionList.create(null===(a=null==u?void 0:u.completionMap)||void 0===a?void 0:a.toArray()),memberAccessInfo:null==u?void 0:u.memberAccessInfo,autoImportInfo:null==u?void 0:u.autoImportInfo,extensionInfo:null==u?void 0:u.extensionInfo};if(!(null==u?void 0:u.completionMap)||!(null===(l=this._extension)||void 0===l?void 0:l.completionListExtension))return p;const d=c.sourceFile.getParseResults();if((null==d?void 0:d.parseTree)&&(null==d?void 0:d.text)){const e=xt(t,d.tokenizerOutput.lines);void 0!==e&&await this._extension.completionListExtension.updateCompletionResults(p,d,e,o)}return p}resolveCompletionItem(e,t,n,i,r,s){return this._runEvaluatorWithCancellationToken(s,(()=>{const o=this._getSourceFileInfoFromPath(e);if(!o)return;this._bindFile(o);const a=this._configOptions.findExecEnvironment(e);o.sourceFile.resolveCompletionItem(this._configOptions,this._importResolver,this._lookUpImport,this._evaluator,n,this._createSourceMapper(a,!0),i,r,(()=>this._buildModuleSymbolsMap(o,!!r,!1,s)),t,s)}))}renameModule(e,t,n){return this._runEvaluatorWithCancellationToken(n,(()=>{if(ge(this._fs,e)&&!this._getSourceFileInfoFromPath(e))return;const i=gc.createForModule(this._importResolver,this._configOptions,this._evaluator,e,t,n);return i?(this._processModuleReferences(i,i.lastModuleName,e),i.getEdits()):void 0}))}moveSymbolAtPosition(e,t,n,i){return this._runEvaluatorWithCancellationToken(i,(()=>{const r=this._getSourceFileInfoFromPath(e);if(!r)return;this._bindFile(r);const s=r.sourceFile.getParseResults();if(!s)return;const o=xt(n,s.tokenizerOutput.lines);if(void 0===o)return;const a=Tr(s.parseTree,o);if(void 0===a)return;if(38!==a.nodeType)return;const l=this._configOptions.findExecEnvironment(e),c=Ml.getDeclarationsForNode(a,this._evaluator,!1,i,this._createSourceMapper(l)),u=gc.createForSymbol(this._importResolver,this._configOptions,this._evaluator,e,t,c,i);return u?(this._processModuleReferences(u,a.value,e),{edits:u.getEdits(),fileOperations:[]}):void 0}))}renameSymbolAtPosition(e,t,n,i,r){return this._runEvaluatorWithCancellationToken(r,(()=>{const s=this._getSourceFileInfoFromPath(e);if(!s)return;this._bindFile(s);const o=this._configOptions.findExecEnvironment(e),a=s.sourceFile.getDeclarationForPosition(this._createSourceMapper(o),t,this._evaluator,void 0,r);if(!a)return;if(m(a.declarations,(e=>{var t;return!(!Gn(e)||e.usesLocalName&&e.node&&22!==e.node.nodeType&&(null===(t=e.node.alias)||void 0===t?void 0:t.value)===a.symbolName)})),0===a.declarations.length)return;if(!i&&a.declarations.some((e=>!this._isUserCode(this._getSourceFileInfoFromPath(e.path)))))return;if(a.requiresGlobalSearch&&!i)for(const e of this._sourceFileList)this._isUserCode(e)&&(this._bindFile(e),e.sourceFile.addReferences(a,!0,this._evaluator,r)),this._handleMemoryHighUsage();else(i||this._isUserCode(s))&&s.sourceFile.addReferences(a,!0,this._evaluator,r);const l=[];return a.locations.forEach((e=>{l.push({filePath:e.path,range:e.range,replacementText:n})})),l}))}getCallForPosition(e,t,n){const i=this._getSourceFileInfoFromPath(e);if(!i)return;this._bindFile(i);const r=this._configOptions.findExecEnvironment(e),s=i.sourceFile.getDeclarationForPosition(this._createSourceMapper(r),t,this._evaluator,void 0,n);if(!s||0===s.declarations.length)return;const o=Jl.getTargetDeclaration(s.declarations,s.nodeAtOffset);return Jl.getCallForDeclaration(s.symbolName,o,this._evaluator,n)}getIncomingCallsForPosition(e,t,n){const i=this._getSourceFileInfoFromPath(e);if(!i)return;this._bindFile(i);const r=this._configOptions.findExecEnvironment(e),s=i.sourceFile.getDeclarationForPosition(this._createSourceMapper(r),t,this._evaluator,void 0,n);if(!s||0===s.declarations.length)return;const o=Jl.getTargetDeclaration(s.declarations,s.nodeAtOffset);let a=[];for(const e of this._sourceFileList)if(this._isUserCode(e)||e.isOpenByClient){this._bindFile(e);const t=Jl.getIncomingCallsForDeclaration(e.sourceFile.getFilePath(),s.symbolName,o,e.sourceFile.getParseResults(),this._evaluator,n);t&&(a=a.concat(...t)),this._handleMemoryHighUsage()}return a}getOutgoingCallsForPosition(e,t,n){const i=this._getSourceFileInfoFromPath(e);if(!i)return;this._bindFile(i);const r=this._configOptions.findExecEnvironment(e),s=i.sourceFile.getDeclarationForPosition(this._createSourceMapper(r),t,this._evaluator,void 0,n);if(!s||0===s.declarations.length)return;const o=Jl.getTargetDeclaration(s.declarations,s.nodeAtOffset);return Jl.getOutgoingCallsForDeclaration(o,i.sourceFile.getParseResults(),this._evaluator,n)}performQuickAction(e,t,n,i){const r=this._getSourceFileInfoFromPath(e);if(r)return this._bindFile(r),r.sourceFile.performQuickAction(t,n,i)}getApiDocs(e,t){const n=[...t,Ln.MarkupKind.PlainText].map((e=>{switch(e){case Ln.MarkupKind.Markdown:return ds;case Ln.MarkupKind.PlainText:return hs;default:return}})).filter(Boolean)[0],i=e=>e?n(e):void 0,r=Object.create(null);for(const t of e){const e={leadingDots:0,nameParts:t.split("."),importedSymbols:[]},n=this._importResolver.resolveImport("",this._configOptions.findExecEnvironment("."),e);if(n.isImportFound){const e=n.resolvedPaths[n.resolvedPaths.length-1];this.addTrackedFiles([e],!0,!1);const s=this.getBoundSourceFile(e);if(s){const e=s.getParseResults().parseTree,n={id:t,name:t,kind:"module",fullName:t,docString:i(qr(e.statements)),children:[]};r[t]=n;const o=zs(e),a=(e,t,n)=>{n.forEach(((n,r)=>{if(!n.isExternallyHidden()&&!n.isPrivateMember()){const s=this.getTypeForSymbol(n),o=n.getDeclarations(),l=e=>o.some((t=>t.type===e));if(l(4)&&yo(s)){const n=s.details.fullName;e.push({id:n,name:r,children:[],docString:i(s.details.docString),fullName:n,kind:"class",baseClasses:s.details.baseClasses.map((e=>({name:e.details.name,fullName:e.details.fullName}))).filter((e=>"builtins.object"!==e.fullName))}),a(e[e.length-1].children,[...t,r],s.details.fields)}else if(l(3)&&Eo(s)){const t=s.details.fullName;e.push({id:t,name:r,docString:i(s.details.docString),fullName:t,kind:"function",params:this.apiDocsParamsInfo(s)})}else if(l(3)&&ko(s)){let t=1;for(const n of s.overloads){const s=n.details.fullName;e.push({id:`${s}-${t++}`,name:r,docString:i(n.details.docString),fullName:s,kind:"function",params:this.apiDocsParamsInfo(n)})}}else if(l(1)){const n=o.find((e=>1===e.type)),s=[...t,r].join(".");e.push({id:s,name:r,fullName:s,kind:"variable",docString:i(n.docString)})}else if(l(6)&&To(s)){const n=s.moduleName;e.push({id:n,name:r,children:[],docString:i(s.docString),fullName:n,kind:"module"}),a(e[e.length-1].children,[...t,r],s.fields)}}}))};a(n.children,[t],o.symbolTable)}}}return this._removeUnneededFiles(),r}apiDocsParamsInfo(e){return e.details.parameters.map((e=>({name:e.name,defaultValue:e.defaultValueExpression?xr(e.defaultValueExpression,0):void 0,category:0===e.category?"simple":1===e.category?"varargList":"varargDict"})))}test_createSourceMapper(e){return this._createSourceMapper(e,!1)}_processModuleReferences(e,t,n){var i;for(const r of this._sourceFileList){if(!this._isUserCode(r))continue;const s=r.sourceFile.getFilePath(),o=null!==(i=r.sourceFile.getFileContent())&&void 0!==i?i:"";if(s!==n&&o.indexOf(t)<0)continue;this._bindFile(r,o);const a=r.sourceFile.getParseResults();a&&(e.renameReferences(s,a),this._handleMemoryHighUsage())}}_handleMemoryHighUsage(){if(this._evaluator.getTypeCacheSize()>75e4||this._parsedFileCount>1e3){const e={heapUsed:0,rss:1};if(e.heapUsed>.9*e.rss){const t=Math.round(e.rss/1048576),n=Math.round(e.heapUsed/1048576);this._console.info(`Emptying type cache to avoid heap overflow. Used ${n}MB out of ${t}MB`),this._createNewEvaluator(),this._discardCachedParseResults(),this._parsedFileCount=0}}}_discardCachedParseResults(){for(const e of this._sourceFileList)e.sourceFile.dropParseAndBindInfo()}_isUserCode(e){return e&&e.isTracked&&!e.isThirdPartyImport&&!e.isTypeshedFile}_runEvaluatorWithCancellationToken(e,t){try{return e?this._evaluator.runWithCancellationToken(e,t):t()}catch(e){throw e instanceof lt||this._createNewEvaluator(),e}}_removeUnneededFiles(){const e=[];for(let t=0;t<this._sourceFileList.length;){const n=this._sourceFileList[t];this._isFileNeeded(n)?(this._shouldCheckFile(n)||void 0===n.diagnosticsVersion||(e.push({filePath:n.sourceFile.getFilePath(),version:n.sourceFile.getClientVersion(),diagnostics:[]}),n.diagnosticsVersion=void 0),t++):(e.push({filePath:n.sourceFile.getFilePath(),version:n.sourceFile.getClientVersion(),diagnostics:[]}),n.sourceFile.prepareForClose(),this._removeSourceFileFromListAndMap(n.sourceFile.getFilePath(),t),n.imports.forEach((i=>{const r=i.importedBy.findIndex((e=>e===n));if(!(r<0||(i.importedBy.splice(r,1),this._isFileNeeded(i)))){const n=this._sourceFileList.findIndex((e=>e===i));n>=0&&n<t&&(e.push({filePath:i.sourceFile.getFilePath(),version:i.sourceFile.getClientVersion(),diagnostics:[]}),i.sourceFile.prepareForClose(),this._removeSourceFileFromListAndMap(i.sourceFile.getFilePath(),n),t--)}})),n.shadowedBy.forEach((e=>{e.shadows=e.shadows.filter((e=>e!==n))})),n.shadowedBy=[])}return e}_isFileNeeded(e){return!e.sourceFile.isFileDeleted()&&(!(!e.isTracked&&!e.isOpenByClient)||e.shadows.length>0||0!==e.importedBy.length&&this._isImportNeededRecursive(e,new Map))}_isImportNeededRecursive(e,t){if(e.isTracked||e.isOpenByClient||e.shadows.length>0)return!0;const n=ke(this._fs,e.sourceFile.getFilePath());if(t.has(n))return!1;t.set(n,!0);for(const n of e.importedBy)if(this._isImportNeededRecursive(n,t))return!0;return!1}_createSourceMapper(e,t,n){return new Xa(this._importResolver,e,this._evaluator,((e,t)=>{const n=this._getSourceFileInfoFromPath(e);if(n)return this._addShadowedFile(n,t),this.getBoundSourceFile(t)}),(e=>this.getBoundSourceFile(e)),null!=t&&t,null!=n&&n)}_isImportAllowed(e,t,n){if(t.isNativeLib)return!1;let i=this._configOptions.useLibraryCodeForTypes||1===t.importType&&!!t.pyTypedInfo||2===t.importType&&e.isThirdPartyPyTypedPresent;return!((1===t.importType||e.isThirdPartyImport&&2===t.importType)&&(this._allowedThirdPartyImports&&(t.isRelative||this._allowedThirdPartyImports.some((e=>t.importName===e||!!t.importName.startsWith(e+"."))))&&(i=!0),!n))||i}_updateSourceFileImports(e,t){const n=[],i=e.sourceFile.getImports(),r=t=>{let n=!1,i=!1;return 1===t.importType?(n=!0,t.pyTypedInfo&&(i=!0)):e.isThirdPartyImport&&2===t.importType&&(n=!0,e.isThirdPartyPyTypedPresent&&(i=!0)),{isThirdPartyImport:n,isPyTypedPresent:i}},s=new Map;if(e.chainedSourceFile)if(e.chainedSourceFile.sourceFile.isFileDeleted())e.chainedSourceFile=void 0;else{const t=e.chainedSourceFile.sourceFile.getFilePath();s.set(ke(this._fs,t),{path:t,isTypeshedFile:!1,isThirdPartyImport:!1,isPyTypedPresent:!1})}i.forEach((n=>{if(n.isImportFound){if(this._isImportAllowed(e,n,n.isStubFile)&&n.resolvedPaths.length>0){const e=n.resolvedPaths[n.resolvedPaths.length-1];if(e){const t=r(n);s.set(ke(this._fs,e),{path:e,isTypeshedFile:!!n.isTypeshedFile,isThirdPartyImport:t.isThirdPartyImport,isPyTypedPresent:t.isPyTypedPresent})}}n.filteredImplicitImports.forEach((t=>{if(this._isImportAllowed(e,n,t.isStubFile)&&!t.isNativeLib){const e=r(n);s.set(ke(this._fs,t.path),{path:t.path,isTypeshedFile:!!n.isTypeshedFile,isThirdPartyImport:e.isThirdPartyImport,isPyTypedPresent:e.isPyTypedPresent})}}))}else t.verboseOutput&&(this._console.info(`Could not import '${n.importName}' in file '${e.sourceFile.getFilePath()}'`),n.importFailureInfo&&n.importFailureInfo.forEach((e=>{this._console.info(`  ${e}`)})))}));const o=new Map;e.imports.forEach((t=>{const n=ke(this._fs,t.sourceFile.getFilePath());s.has(n)?o.set(n,t):t.importedBy=t.importedBy.filter((t=>ke(this._fs,t.sourceFile.getFilePath())!==ke(this._fs,e.sourceFile.getFilePath())))})),s.forEach(((t,i)=>{if(!o.has(i)){let r;if(this._getSourceFileInfoFromPath(t.path))r=this._getSourceFileInfoFromPath(t.path);else{const e=this._getImportNameForFile(t.path);r={sourceFile:new Ru(this._fs,t.path,e,t.isThirdPartyImport,t.isPyTypedPresent,this._console,this._logTracker),isTracked:!1,isOpenByClient:!1,isTypeshedFile:t.isTypeshedFile,isThirdPartyImport:t.isThirdPartyImport,isThirdPartyPyTypedPresent:t.isPyTypedPresent,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(r),n.push(r)}r.importedBy.push(e),o.set(i,r)}})),e.imports=[],s.forEach(((t,n)=>{this._getSourceFileInfoFromPath(n)&&e.imports.push(this._getSourceFileInfoFromPath(n))})),e.builtinsImport=void 0;const a=e.sourceFile.getBuiltinsImport();if(a&&a.isImportFound){const t=a.resolvedPaths[a.resolvedPaths.length-1];e.builtinsImport=this._getSourceFileInfoFromPath(t)}e.ipythonDisplayImport=void 0;const l=e.sourceFile.getIPythonDisplayImport();if(l&&l.isImportFound){const t=l.resolvedPaths[l.resolvedPaths.length-1];e.ipythonDisplayImport=this._getSourceFileInfoFromPath(t)}return n}_getSourceFileInfoFromPath(e){return this._sourceFileMap.get(ke(this._fs,e))}_removeSourceFileFromListAndMap(e,t){this._sourceFileMap.delete(ke(this._fs,e)),this._sourceFileList.splice(t,1)}_addToSourceFileListAndMap(e){const t=ke(this._fs,e.sourceFile.getFilePath());w(!this._sourceFileMap.has(t)),this._sourceFileList.push(e),this._sourceFileMap.set(t,e)}}function sp(e,t){try{const n=e();t.postMessage({kind:"ok",data:n})}catch(e){if(lt.is(e))return void t.postMessage({kind:"cancelled",data:e.message});t.postMessage({kind:"failed",data:`Exception: ${e.message} in ${e.stack}`})}}function op(e){return new Promise(((t,n)=>{e.on("message",(e=>{switch(e.kind){case"ok":t(e.data);break;case"cancelled":n(new lt);break;case"failed":n(e.data);break;default:E(`unknown kind ${e.kind}`)}}))}))}var ap=__webpack_require__(6341);__webpack_require__(198);class lp{static shouldCheck(){const e=Date.now().valueOf();return e-this._lastCheckTimestamp>=5&&(this._lastCheckTimestamp=e,!0)}}lp._lastCheckTimestamp=0;class cp{constructor(e){this.cancellationFilePath=e,this.isCancelled=!1}cancel(){this.isCancelled||(this.isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this._disposeEmitter()))}get isCancellationRequested(){return!!this.isCancelled||(lp.shouldCheck()&&this._pipeExists()&&this.cancel(),this.isCancelled)}get onCancellationRequested(){return this._emitter||(this._emitter=new ot.Emitter),this._emitter.event}dispose(){this._disposeEmitter()}_disposeEmitter(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}_pipeExists(){try{return ap.statSync(this.cancellationFilePath),!0}catch(e){return!1}}}function up(e){return e?new cp(e):ot.CancellationToken.None}function pp(e){return e instanceof cp?e.cancellationFilePath:void 0}function dp(e){return e.diagnostics=e.diagnostics.map((e=>({filePath:e.filePath,version:e.version,diagnostics:hp(e.diagnostics)}))),e}function hp(e){return e.map((e=>{const t=new nl(e.category,e.message,e.range);if(e._actions)for(const n of e._actions)t.addAction(n);if(e._rule&&t.setRule(e._rule),e._relatedInfo)for(const n of e._relatedInfo)t.addRelatedInfo(n.message,n.filePath,n.range);return t}))}class mp{constructor(e,t){this.fileSpecs=[],this.logTypeEvaluationTime=!1,this.typeEvaluationTimeThreshold=50,this.enableAmbientAnalysis=!0,this.analyzeUnannotatedFunctions=!0,this.executionRoot=e,this.fromVsCodeExtension=t}}class fp{constructor(e=null){this._scope=e,this._resolved=!1,this._rejected=!1,this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}resolve(e){this._resolve.apply(this._scope?this._scope:this,arguments),this._resolved=!0}reject(e){this._reject.apply(this._scope?this._scope:this,arguments),this._rejected=!0}get promise(){return this._promise}get resolved(){return this._resolved}get rejected(){return this._rejected}get completed(){return this._rejected||this._resolved}}function gp(e=null){return new fp(e)}class yp{static runWithOptions(e,t,n,i,r=!0){const s=function(e,t,n,i,r){var s,o;const a=new mp(t,!0);return a.checkOnlyOpenFiles=n.openFilesOnly,a.useLibraryCodeForTypes=n.useLibraryCodeForTypes,a.typeCheckingMode=n.typeCheckingMode,a.autoImportCompletions=n.autoImportCompletions,a.indexing=n.indexing,a.logTypeEvaluationTime=null!==(s=n.logTypeEvaluationTime)&&void 0!==s&&s,a.typeEvaluationTimeThreshold=null!==(o=n.typeEvaluationTimeThreshold)&&void 0!==o?o:50,a.enableAmbientAnalysis=i,i?(a.watchForSourceChanges=n.watchForSourceChanges,a.watchForLibraryChanges=n.watchForLibraryChanges,a.watchForConfigChanges=n.watchForConfigChanges):(a.watchForSourceChanges=!1,a.watchForLibraryChanges=!1,a.watchForConfigChanges=!1),n.venvPath&&(a.venvPath=te(t||e,n.venvPath)),n.pythonPath&&(gn(n.pythonPath)||(a.pythonPath=te(t||e,n.pythonPath))),n.typeshedPath&&(a.typeshedPath=n.typeshedPath),n.stubPath&&(a.stubPath=n.stubPath),n.logLevel===On.Log&&(a.verboseOutput=!0),r&&(a.typeStubTargetImportName=r),a.autoSearchPaths=n.autoSearchPaths,a.extraPaths=n.extraPaths,a.diagnosticSeverityOverrides=n.diagnosticSeverityOverrides,a}(e,t.rootPath,n,r,i);t.serviceInstance.setOptions(s)}static async cloneService(e,t,n,i,r){const s={workspaceName:"temp workspace for cloned service",rootPath:t.rootPath,rootUri:t.rootUri,serviceInstance:t.serviceInstance.clone("cloned service",i,r),disableLanguageServices:!0,disableOrganizeImports:!0,isInitialized:gp()},o=await e.getSettings(t);return yp.runWithOptions(e.rootPath,s,o,n,!1),s.serviceInstance}}class _p{constructor(e){this._ls=e}async execute(e,t){if(e.arguments&&e.arguments.length>=2){const n=e.arguments[0],i=e.arguments[1],r=e.arguments[2],s=await yp.cloneService(this._ls,await this._ls.getWorkspaceForFile(null!=r?r:n),i,this._ls.createBackgroundAnalysis());try{await s.writeTypeStubInBackground(t),s.dispose();const e=`Type stub was successfully created for '${i}'.`;this._ls.window.showInformationMessage(e),this._ls.reanalyze()}catch(e){if(lt.is(e)){const e=`Type stub creation for '${i}' was canceled`;this._ls.console.error(e)}else{let t="";e instanceof Error&&(t=": "+e.message),t=`An error occurred when creating type stub for '${i}'`+t,this._ls.console.error(t),this._ls.window.showErrorMessage(t)}}}}}class vp{constructor(e){this._ls=e}async execute(e,t){if(e.arguments&&e.arguments.length>=1){const n=e.arguments[0],i=e.arguments.slice(1),r=this._ls.decodeTextDocumentUri(n),s=await this._ls.getWorkspaceForFile(r);return"pyright.organizeimports"===e.command&&s.disableOrganizeImports?[]:function(e,t){if(!t)return{};const n=[];return t.forEach((e=>{n.push({range:e.range,newText:e.replacementText})})),{changes:{[e]:n}}}(n,s.serviceInstance.performQuickAction(r,e.command,i,t))}}}class Tp{constructor(e){this._ls=e}async execute(e){this._ls.restart()}}class bp{constructor(e){this._createStub=new _p(e),this._restartServer=new Tp(e),this._quickAction=new vp(e)}async execute(e,t){switch(e.command){case"pyright.organizeimports":case"pyright.addoptionalforparam":return this._quickAction.execute(e,t);case"pyright.createtypestub":return this._createStub.execute(e,t);case"pyright.restartserver":return this._restartServer.execute(e);default:return new ot.ResponseError(1,"Unsupported command")}}isLongRunningCommand(e){switch(e){case"pyright.createtypestub":return!0;default:return!1}}}class Ip{get kind(){return 2}getPythonSearchPaths(e,t){return null==t||t.push("No access to python executable."),{paths:[],prefix:""}}getPythonVersion(e,t){}getPythonPlatform(e){}}var Sp=__webpack_require__(7256);class xp{constructor(e,t,n,i,r,s,o){this._console=e,this._configOptions=t,this._importResolver=n,this._backgroundAnalysis=r,this._maxAnalysisTime=s,this._disableChecker=o,this._program=new rp(this._importResolver,this._configOptions,this._console,i,void 0,this._disableChecker)}get configOptions(){return this._configOptions}get importResolver(){return this._importResolver}get program(){return this._program}get host(){return this._importResolver.host}get backgroundAnalysis(){return this._backgroundAnalysis}setConfigOptions(e){var t;this._configOptions=e,null===(t=this._backgroundAnalysis)||void 0===t||t.setConfigOptions(e),this._program.setConfigOptions(e)}setImportResolver(e){var t;this._importResolver=e,null===(t=this._backgroundAnalysis)||void 0===t||t.setImportResolver(e),this._program.setImportResolver(e),this._configOptions.getExecutionEnvironments().forEach((e=>this._ensurePartialStubPackages(e)))}setTrackedFiles(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.setTrackedFiles(e);const n=this._program.setTrackedFiles(e);this._reportDiagnosticsForRemovedFiles(n)}setAllowedThirdPartyImports(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.setAllowedThirdPartyImports(e),this._program.setAllowedThirdPartyImports(e)}setFileOpened(e,t,n,i){var r;null===(r=this._backgroundAnalysis)||void 0===r||r.setFileOpened(e,t,[{text:n}],i),this._program.setFileOpened(e,t,[{text:n}],i)}initializeFileSystem(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.initializeFileSystem(e)}updateOpenFileContents(e,t,n,i){var r;null===(r=this._backgroundAnalysis)||void 0===r||r.setFileOpened(e,t,n,i),this._program.setFileOpened(e,t,n,i),this.markFilesDirty([e],!0)}setFileClosed(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.setFileClosed(e);const n=this._program.setFileClosed(e);this._reportDiagnosticsForRemovedFiles(n)}markAllFilesDirty(e,t=!0){var n;null===(n=this._backgroundAnalysis)||void 0===n||n.markAllFilesDirty(e,t),this._program.markAllFilesDirty(e,t)}markFilesDirty(e,t,n=!0){var i;null===(i=this._backgroundAnalysis)||void 0===i||i.markFilesDirty(e,t,n),this._program.markFilesDirty(e,t,n)}setCompletionCallback(e){var t;this._onAnalysisCompletion=e,null===(t=this._backgroundAnalysis)||void 0===t||t.setCompletionCallback(e)}startAnalysis(e){return this._backgroundAnalysis?(this._backgroundAnalysis.startAnalysis(this._indices,e),!1):Mn(this._program,this._maxAnalysisTime,this._configOptions,this._onAnalysisCompletion,this._console,e)}test_setIndexing(e,t){const n=this._getIndices();for(const[t,i]of e)n.setWorkspaceIndex(t,i);for(const[e,i]of t)for(const[t,r]of i)n.setIndex(e,t,r)}startIndexing(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.startIndexing(e,this._configOptions,this.importResolver,this.host.kind,this._getIndices())}refreshIndexing(){var e;null===(e=this._backgroundAnalysis)||void 0===e||e.refreshIndexing(this._configOptions,this.importResolver,this.host.kind,this._indices)}cancelIndexing(){var e;null===(e=this._backgroundAnalysis)||void 0===e||e.cancelIndexing(this._configOptions)}getIndexing(e){var t;return null===(t=this._indices)||void 0===t?void 0:t.getIndex(this._configOptions.findExecEnvironment(e).root)}async getDiagnosticsForRange(e,t,n){return this._backgroundAnalysis?this._backgroundAnalysis.getDiagnosticsForRange(e,t,n):this._program.getDiagnosticsForRange(e,t)}async writeTypeStub(e,t,n,i){return this._backgroundAnalysis?this._backgroundAnalysis.writeTypeStub(e,t,n,i):(Mn(this._program,void 0,this._configOptions,this._onAnalysisCompletion,this._console,i),this._program.writeTypeStub(e,t,n,i))}invalidateAndForceReanalysis(e,t){var n;t&&this.refreshIndexing(),null===(n=this._backgroundAnalysis)||void 0===n||n.invalidateAndForceReanalysis(e),this._importResolver.invalidateCache(),this._program.markAllFilesDirty(!0,e)}restart(){var e;null===(e=this._backgroundAnalysis)||void 0===e||e.restart()}_ensurePartialStubPackages(e){var t;return null===(t=this._backgroundAnalysis)||void 0===t||t.ensurePartialStubPackages(e.root),this._importResolver.ensurePartialStubPackages(e)}_getIndices(){if(!this._indices){const e=this._program,t=new Map;this._indices={setWorkspaceIndex(t,n){var i;null===(i=e.getSourceFile(t))||void 0===i||i.cacheIndexResults(n)},getIndex:e=>t.get(e),setIndex(e,n,i){let r=t.get(e);r||(r=new Map,t.set(e,r)),r.set(n,i)},reset(){t.clear()}}}return this._indices}_reportDiagnosticsForRemovedFiles(e){e.length>0&&!this._backgroundAnalysis&&this._onAnalysisCompletion&&this._onAnalysisCompletion({diagnostics:e,filesInProgram:this._program.getFileCount(),filesRequiringAnalysis:this._program.getFilesToAnalyzeCount(),checkingOnlyOpenFiles:this._program.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:0})}}var Cp,wp=__webpack_require__(2125);function Ep(e){return 32===e||9===e||11===e||12===e||160===e||5760===e||e>=8192&&e<=8203||8239===e||8287===e||12288===e||65279===e}function kp(e){return 10===e||13===e||8232===e||8233===e}function Dp(e){return e>=48&&e<=57}function Ap(e,t,n){void 0===n&&(n=Cp.DEFAULT);var i=function(e,t){void 0===t&&(t=!1);var n=e.length,i=0,r="",s=0,o=16,a=0,l=0,c=0,u=0,p=0;function d(t,n){for(var r=0,s=0;r<t||!n;){var o=e.charCodeAt(i);if(o>=48&&o<=57)s=16*s+o-48;else if(o>=65&&o<=70)s=16*s+o-65+10;else{if(!(o>=97&&o<=102))break;s=16*s+o-97+10}i++,r++}return r<t&&(s=-1),s}function h(){if(r="",p=0,s=i,l=a,u=c,i>=n)return s=n,o=17;var t=e.charCodeAt(i);if(Ep(t)){do{i++,r+=String.fromCharCode(t),t=e.charCodeAt(i)}while(Ep(t));return o=15}if(kp(t))return i++,r+=String.fromCharCode(t),13===t&&10===e.charCodeAt(i)&&(i++,r+="\n"),a++,c=i,o=14;switch(t){case 123:return i++,o=1;case 125:return i++,o=2;case 91:return i++,o=3;case 93:return i++,o=4;case 58:return i++,o=6;case 44:return i++,o=5;case 34:return i++,r=function(){for(var t="",r=i;;){if(i>=n){t+=e.substring(r,i),p=2;break}var s=e.charCodeAt(i);if(34===s){t+=e.substring(r,i),i++;break}if(92!==s){if(s>=0&&s<=31){if(kp(s)){t+=e.substring(r,i),p=2;break}p=6}i++}else{if(t+=e.substring(r,i),++i>=n){p=2;break}switch(e.charCodeAt(i++)){case 34:t+='"';break;case 92:t+="\\";break;case 47:t+="/";break;case 98:t+="\b";break;case 102:t+="\f";break;case 110:t+="\n";break;case 114:t+="\r";break;case 116:t+="\t";break;case 117:var o=d(4,!0);o>=0?t+=String.fromCharCode(o):p=4;break;default:p=5}r=i}}return t}(),o=10;case 47:var h=i-1;if(47===e.charCodeAt(i+1)){for(i+=2;i<n&&!kp(e.charCodeAt(i));)i++;return r=e.substring(h,i),o=12}if(42===e.charCodeAt(i+1)){i+=2;for(var f=n-1,g=!1;i<f;){var y=e.charCodeAt(i);if(42===y&&47===e.charCodeAt(i+1)){i+=2,g=!0;break}i++,kp(y)&&(13===y&&10===e.charCodeAt(i)&&i++,a++,c=i)}return g||(i++,p=1),r=e.substring(h,i),o=13}return r+=String.fromCharCode(t),i++,o=16;case 45:if(r+=String.fromCharCode(t),++i===n||!Dp(e.charCodeAt(i)))return o=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return r+=function(){var t=i;if(48===e.charCodeAt(i))i++;else for(i++;i<e.length&&Dp(e.charCodeAt(i));)i++;if(i<e.length&&46===e.charCodeAt(i)){if(!(++i<e.length&&Dp(e.charCodeAt(i))))return p=3,e.substring(t,i);for(i++;i<e.length&&Dp(e.charCodeAt(i));)i++}var n=i;if(i<e.length&&(69===e.charCodeAt(i)||101===e.charCodeAt(i)))if((++i<e.length&&43===e.charCodeAt(i)||45===e.charCodeAt(i))&&i++,i<e.length&&Dp(e.charCodeAt(i))){for(i++;i<e.length&&Dp(e.charCodeAt(i));)i++;n=i}else p=3;return e.substring(t,n)}(),o=11;default:for(;i<n&&m(t);)i++,t=e.charCodeAt(i);if(s!==i){switch(r=e.substring(s,i)){case"true":return o=8;case"false":return o=9;case"null":return o=7}return o=16}return r+=String.fromCharCode(t),i++,o=16}}function m(e){if(Ep(e)||kp(e))return!1;switch(e){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}return{setPosition:function(e){i=e,r="",s=0,o=16,p=0},getPosition:function(){return i},scan:t?function(){var e;do{e=h()}while(e>=12&&e<=15);return e}:h,getToken:function(){return o},getTokenValue:function(){return r},getTokenOffset:function(){return s},getTokenLength:function(){return i-s},getTokenStartLine:function(){return l},getTokenStartCharacter:function(){return s-u},getTokenError:function(){return p}}}(e,!1);function r(e){return e?function(){return e(i.getTokenOffset(),i.getTokenLength(),i.getTokenStartLine(),i.getTokenStartCharacter())}:function(){return!0}}function s(e){return e?function(t){return e(t,i.getTokenOffset(),i.getTokenLength(),i.getTokenStartLine(),i.getTokenStartCharacter())}:function(){return!0}}var o=r(t.onObjectBegin),a=s(t.onObjectProperty),l=r(t.onObjectEnd),c=r(t.onArrayBegin),u=r(t.onArrayEnd),p=s(t.onLiteralValue),d=s(t.onSeparator),h=r(t.onComment),m=s(t.onError),f=n&&n.disallowComments,g=n&&n.allowTrailingComma;function y(){for(;;){var e=i.scan();switch(i.getTokenError()){case 4:_(14);break;case 5:_(15);break;case 3:_(13);break;case 1:f||_(11);break;case 2:_(12);break;case 6:_(16)}switch(e){case 12:case 13:f?_(10):h();break;case 16:_(1);break;case 15:case 14:break;default:return e}}}function _(e,t,n){if(void 0===t&&(t=[]),void 0===n&&(n=[]),m(e),t.length+n.length>0)for(var r=i.getToken();17!==r;){if(-1!==t.indexOf(r)){y();break}if(-1!==n.indexOf(r))break;r=y()}}function v(e){var t=i.getTokenValue();return e?p(t):a(t),y(),!0}return y(),17===i.getToken()?!!n.allowEmptyContent||(_(4,[],[]),!1):function e(){switch(i.getToken()){case 3:return function(){c(),y();for(var t=!1;4!==i.getToken()&&17!==i.getToken();){if(5===i.getToken()){if(t||_(4,[],[]),d(","),y(),4===i.getToken()&&g)break}else t&&_(6,[],[]);e()||_(4,[],[4,5]),t=!0}return u(),4!==i.getToken()?_(8,[4],[]):y(),!0}();case 1:return function(){o(),y();for(var t=!1;2!==i.getToken()&&17!==i.getToken();){if(5===i.getToken()){if(t||_(4,[],[]),d(","),y(),2===i.getToken()&&g)break}else t&&_(6,[],[]);(10!==i.getToken()?(_(3,[],[2,5]),0):(v(!1),6===i.getToken()?(d(":"),y(),e()||_(4,[],[2,5])):_(5,[],[2,5]),1))||_(4,[],[2,5]),t=!0}return l(),2!==i.getToken()?_(7,[2],[]):y(),!0}();case 10:return v(!0);default:return function(){switch(i.getToken()){case 11:var e=i.getTokenValue(),t=Number(e);isNaN(t)&&(_(2),t=0),p(t);break;case 7:p(null);break;case 8:p(!0);break;case 9:p(!1);break;default:return!1}return y(),!0}()}}()?(17!==i.getToken()&&_(9,[],[]),!0):(_(4,[],[]),!1)}!function(e){e.DEFAULT={allowTrailingComma:!1}}(Cp||(Cp={}));const Pp=["pyrightconfig.json"],Rp=X("/.git/"),Fp=/\.pyi?$/;class Np{constructor(e,t,n,i,r,s,o,a,l,c,u){this._typeStubTargetIsSingleFile=!1,this._requireTrackedFileUpdate=!0,this._lastUserInteractionTime=Date.now(),this._disposed=!1,this._instanceName=e,this._console=n||new Un,this._executionRootPath="",this._extension=o,this._importResolverFactory=r||Np.createImportResolver,this._maxAnalysisTimeInForeground=l,this._backgroundAnalysisProgramFactory=c,this._cancellationProvider=null!=u?u:new pt,this._hostFactory=null!=i?i:()=>new Ip,s=null!=s?s:new Ec("/");const p=this._importResolverFactory(t,s,this._hostFactory());this._backgroundAnalysisProgram=void 0!==c?c(this._console,s,p,this._extension,a,this._maxAnalysisTimeInForeground):new xp(this._console,s,p,this._extension,a,this._maxAnalysisTimeInForeground)}clone(e,t,n){const i=new Np(e,null!=n?n:this._fs,this._console,this._hostFactory,this._importResolverFactory,this._backgroundAnalysisProgram.configOptions,this._extension,t,this._maxAnalysisTimeInForeground,this._backgroundAnalysisProgramFactory,this._cancellationProvider);for(const e of this.backgroundAnalysisProgram.program.getOpened()){const t=e.sourceFile.getClientVersion();void 0!==t&&i.setFileOpened(e.sourceFile.getFilePath(),t,e.sourceFile.getOpenFileContents())}return i}dispose(){this._disposed=!0,this._removeSourceFileWatchers(),this._removeConfigFileWatcher(),this._removeLibraryFileWatcher(),this._clearReloadConfigTimer(),this._clearReanalysisTimer(),this._clearLibraryReanalysisTimer()}get backgroundAnalysisProgram(){return this._backgroundAnalysisProgram}static createImportResolver(e,t,n){return new In(e,t,n)}setCompletionCallback(e){this._onCompletionCallback=e,this._backgroundAnalysisProgram.setCompletionCallback(e)}setOptions(e){this._commandLineOptions=e;const t=this._hostFactory(),n=this._getConfigOptions(t,e);n.pythonPath&&n.ensureDefaultPythonVersion(t,this._console),n.ensureDefaultPythonPlatform(t,this._console),this._backgroundAnalysisProgram.setConfigOptions(n),this._executionRootPath=me(te(e.executionRoot,n.projectRoot)),this._applyConfigOptions(t)}isTracked(e){for(const t of this._configOptions.include)if(this._matchIncludeFileSpec(t.regExp,this._configOptions.exclude,e))return!0;return!1}setFileOpened(e,t,n,i=!1,r){this._backgroundAnalysisProgram.setFileOpened(e,t,n,{isTracked:this.isTracked(e),ipythonMode:i,chainedFilePath:r}),this._scheduleReanalysis(!1)}updateOpenFileContents(e,t,n,i=!1,r){this._backgroundAnalysisProgram.updateOpenFileContents(e,t,n,{isTracked:this.isTracked(e),ipythonMode:i,chainedFilePath:r}),this._scheduleReanalysis(!1)}test_setIndexing(e,t){this._backgroundAnalysisProgram.test_setIndexing(e,t)}startIndexing(e){this._backgroundAnalysisProgram.startIndexing(e)}setFileClosed(e){this._backgroundAnalysisProgram.setFileClosed(e),this._scheduleReanalysis(!1)}getParseResult(e){var t;return null===(t=this._program.getBoundSourceFile(e))||void 0===t?void 0:t.getParseResults()}getTextOnRange(e,t,n){return this._program.getTextOnRange(e,t,n)}getAutoImports(e,t,n,i,r,s,o){return this._program.getAutoImports(e,t,n,i,this._backgroundAnalysisProgram.getIndexing(e),r,s,o)}getDefinitionForPosition(e,t,n,i){return this._program.getDefinitionsForPosition(e,t,n,i)}getTypeDefinitionForPosition(e,t,n){return this._program.getTypeDefinitionsForPosition(e,t,n)}reportReferencesForPosition(e,t,n,i,r){this._program.reportReferencesForPosition(e,t,n,i,r)}addSymbolsForDocument(e,t,n){this._program.addSymbolsForDocument(e,t,n)}reportSymbolsForWorkspace(e,t,n){this._program.reportSymbolsForWorkspace(e,t,n)}getApiDocs(e,t){return this._program.getApiDocs(e,t)}getHoverForPosition(e,t,n,i){return this._program.getHoverForPosition(e,t,n,i)}getDocumentHighlight(e,t,n){return this._program.getDocumentHighlight(e,t,n)}getSignatureHelpForPosition(e,t,n,i){return this._program.getSignatureHelpForPosition(e,t,n,i)}getCompletionsForPosition(e,t,n,i,r,s){return this._program.getCompletionsForPosition(e,t,n,i,r,this._backgroundAnalysisProgram.getIndexing(e),s)}getEvaluator(){return this._program.evaluator}resolveCompletionItem(e,t,n,i,r){this._program.resolveCompletionItem(e,t,n,i,this._backgroundAnalysisProgram.getIndexing(e),r)}performQuickAction(e,t,n,i){return this._program.performQuickAction(e,t,n,i)}renameModule(e,t,n){return this._program.renameModule(e,t,n)}renameSymbolAtPosition(e,t,n,i,r){return this._program.renameSymbolAtPosition(e,t,n,i,r)}getCallForPosition(e,t,n){return this._program.getCallForPosition(e,t,n)}getIncomingCallsForPosition(e,t,n){return this._program.getIncomingCallsForPosition(e,t,n)}getOutgoingCallsForPosition(e,t,n){return this._program.getOutgoingCallsForPosition(e,t,n)}printStats(){this._console.info(""),this._console.info("Analysis stats");const e=this._program.getFileCount();this._console.info("Total files analyzed: "+e.toString())}printDependencies(e){this._program.printDependencies(this._executionRootPath,e)}getDiagnosticsForRange(e,t,n){return this._backgroundAnalysisProgram.getDiagnosticsForRange(e,t,n)}getConfigOptions(){return this._configOptions}getImportResolver(){return this._backgroundAnalysisProgram.importResolver}recordUserInteractionTime(){this._lastUserInteractionTime=Date.now(),this._analyzeTimer&&this._scheduleReanalysis(!1)}get test_program(){return this._program}test_getConfigOptions(e){return this._getConfigOptions(this._backgroundAnalysisProgram.host,e)}test_getFileNamesFromFileSpecs(){return this._getFileNamesFromFileSpecs()}_getConfigOptions(e,t){var n,i,r;let s,o,a=t.executionRoot;t.configFilePath?(s=te(t.executionRoot,me(t.configFilePath)),this._fs.existsSync(s)?s.toLowerCase().endsWith(".json")?a=$(s):(a=s,s=this._findConfigFile(s),s||this._console.info(`Configuration file not found at ${a}.`)):(this._console.info(`Configuration file not found at ${s}.`),s=t.executionRoot)):a&&(s=this._findConfigFile(a),s||t.fromVsCodeExtension||(s=this._findConfigFileHereOrUp(a)),s?a=$(s):(this._console.info("No configuration file found."),s=void 0)),s||(o=this._findPyprojectTomlFile(a),o||t.fromVsCodeExtension||(o=this._findPyprojectTomlFileHereOrUp(a)),o?(a=$(o),this._console.info(`pyproject.toml file found at ${a}.`)):this._console.info("No pyproject.toml file found."));const l=new Ec(a,this._typeCheckingMode),c=["**/node_modules","**/__pycache__","**/.*"];let u;if(t.pythonPath&&(this._console.info(`Setting pythonPath for service "${this._instanceName}": "${t.pythonPath}"`),l.pythonPath=t.pythonPath),l.defaultPythonPlatform=t.pythonPlatform,l.defaultPythonVersion=t.pythonVersion,l.ensureDefaultExtraPaths(this._fs,t.autoSearchPaths||!1,t.extraPaths),t.fileSpecs.length>0?t.fileSpecs.forEach((e=>{l.include.push(be(a,e))})):s||t.executionRoot&&(l.include.push(be(t.executionRoot,".")),c.forEach((e=>{l.exclude.push(be(t.executionRoot,e))}))),this._configFilePath=s||o,s?(this._console.info(`Loading configuration file at ${s}`),u=this._parseJsonConfigFile(s)):o&&(this._console.info(`Loading pyproject.toml file at ${o}`),u=this._parsePyprojectTomlFile(o)),u){l.initializeFromJson(u,this._typeCheckingMode,this._console,e,t.diagnosticSeverityOverrides,t.fileSpecs.length>0);const n=$(this._configFilePath);0===l.include.length&&(this._console.info(`No include entries specified; assuming ${n}`),l.include.push(be(n,"."))),0===l.exclude.length&&(c.forEach((e=>{this._console.info(`Auto-excluding ${e}`),l.exclude.push(be(n,e))})),void 0===l.autoExcludeVenv&&(l.autoExcludeVenv=!0))}else l.autoExcludeVenv=!0,l.applyDiagnosticOverrides(t.diagnosticSeverityOverrides);l.analyzeUnannotatedFunctions=null===(n=t.analyzeUnannotatedFunctions)||void 0===n||n;const p=(e,n)=>{const i=t.fromVsCodeExtension?"the client settings":"a command-line option";this._console.warn(`The ${e} has been specified in both the config file and ${i}. The value in the config file (${n}) will take precedence`)};if(t.venvPath&&(l.venvPath?p("venvPath",l.venvPath):l.venvPath=t.venvPath),t.typeshedPath&&(l.typeshedPath?p("typeshedPath",l.typeshedPath):l.typeshedPath=t.typeshedPath),l.verboseOutput=null!==(i=t.verboseOutput)&&void 0!==i?i:l.verboseOutput,l.checkOnlyOpenFiles=!!t.checkOnlyOpenFiles,l.autoImportCompletions=!!t.autoImportCompletions,l.indexing=!!t.indexing,l.logTypeEvaluationTime=!!t.logTypeEvaluationTime,l.typeEvaluationTimeThreshold=t.typeEvaluationTimeThreshold,void 0===l.useLibraryCodeForTypes?l.useLibraryCodeForTypes=!!t.useLibraryCodeForTypes:void 0!==t.useLibraryCodeForTypes&&p("useLibraryCodeForTypes",l.useLibraryCodeForTypes),t.stubPath?l.stubPath?p("stubPath",l.stubPath):l.stubPath=t.stubPath:l.stubPath||(l.stubPath=me(te(l.projectRoot,"typings"))),l.venvPath&&(this._fs.existsSync(l.venvPath)&&fe(this._fs,l.venvPath)||this._console.error(`venvPath ${l.venvPath} is not a valid directory.`),l.venv=null!==(r=l.venv)&&void 0!==r?r:this._configOptions.venv,l.venv)){const t=te(l.venvPath,l.venv);if(this._fs.existsSync(t)&&fe(this._fs,t)){const t=[];void 0===fn(this._fs,l,e,t)&&(this._console.error(`site-packages directory cannot be located for venvPath ${l.venvPath} and venv ${l.venv}.`),l.verboseOutput&&t.forEach((e=>{this._console.error(`  ${e}`)})))}else this._console.error(`venv ${l.venv} subdirectory not found in venv path ${l.venvPath}.`)}return l.venv&&(l.venvPath||this._console.warn("venvPath not specified, so venv settings will be ignored.")),l.typeshedPath&&(this._fs.existsSync(l.typeshedPath)&&fe(this._fs,l.typeshedPath)||this._console.error(`typeshedPath ${l.typeshedPath} is not a valid directory.`)),l.stubPath&&(this._fs.existsSync(l.stubPath)&&fe(this._fs,l.stubPath)||this._console.warn(`stubPath ${l.stubPath} is not a valid directory.`)),l}writeTypeStub(e){var t;const n=this._getTypeStubFolder();this._program.writeTypeStub(null!==(t=this._typeStubTargetPath)&&void 0!==t?t:"",this._typeStubTargetIsSingleFile,n,e)}writeTypeStubInBackground(e){var t;const n=this._getTypeStubFolder();return this._backgroundAnalysisProgram.writeTypeStub(null!==(t=this._typeStubTargetPath)&&void 0!==t?t:"",this._typeStubTargetIsSingleFile,n,e)}invalidateAndForceReanalysis(e=!0,t=!0,n=!1){n&&this._updateTrackedFileList(!1),this._backgroundAnalysisProgram.invalidateAndForceReanalysis(e,t)}restart(){this._applyConfigOptions(this._hostFactory()),this._backgroundAnalysisProgram.restart()}get _fs(){return this._backgroundAnalysisProgram.importResolver.fileSystem}get _program(){return this._backgroundAnalysisProgram.program}get _configOptions(){return this._backgroundAnalysisProgram.configOptions}get _watchForSourceChanges(){var e;return!!(null===(e=this._commandLineOptions)||void 0===e?void 0:e.watchForSourceChanges)}get _watchForLibraryChanges(){var e;return!!(null===(e=this._commandLineOptions)||void 0===e?void 0:e.watchForLibraryChanges)}get _watchForConfigChanges(){var e;return!!(null===(e=this._commandLineOptions)||void 0===e?void 0:e.watchForConfigChanges)}get _typeCheckingMode(){var e;return null===(e=this._commandLineOptions)||void 0===e?void 0:e.typeCheckingMode}get _verboseOutput(){return!!this._configOptions.verboseOutput}get _typeStubTargetImportName(){var e;return null===(e=this._commandLineOptions)||void 0===e?void 0:e.typeStubTargetImportName}_getTypeStubFolder(){const e=this._configOptions.stubPath;if(!this._typeStubTargetPath||!this._typeStubTargetImportName){const e=`Import '${this._typeStubTargetImportName}' could not be resolved`;throw this._console.error(e),new Error(e)}if(!e){const e="No typings path was specified";throw this._console.info(e),new Error(e)}const t=this._typeStubTargetImportName.split(".");if(0===t[0].length){const e=`Import '${this._typeStubTargetImportName}' could not be resolved`;throw this._console.error(e),new Error(e)}try{this._fs.existsSync(e)||this._fs.mkdirSync(e)}catch(t){const n=`Could not create typings directory '${e}'`;throw this._console.error(n),new Error(n)}const n=te(e,t[0]),i=te(e,...t);try{this._fs.existsSync(i)||Q(this._fs,i,e)}catch(e){const t=`Could not create typings subdirectory '${i}'`;throw this._console.error(t),new Error(t)}return n}_findConfigFileHereOrUp(e){return z(e,(e=>this._findConfigFile(e)))}_findConfigFile(e){for(const t of Pp){const n=te(e,t);if(this._fs.existsSync(n))return n}}_findPyprojectTomlFileHereOrUp(e){return z(e,(e=>this._findPyprojectTomlFile(e)))}_findPyprojectTomlFile(e){const t=te(e,"pyproject.toml");if(this._fs.existsSync(t))return t}_parseJsonConfigFile(e){return this._attemptParseFile(e,(e=>function(e,t,n){void 0===t&&(t=[]),void 0===n&&(n=Cp.DEFAULT);var i=null,r=[],s=[];function o(e){Array.isArray(r)?r.push(e):null!==i&&(r[i]=e)}return Ap(e,{onObjectBegin:function(){var e={};o(e),s.push(r),r=e,i=null},onObjectProperty:function(e){i=e},onObjectEnd:function(){r=s.pop()},onArrayBegin:function(){var e=[];o(e),s.push(r),r=e,i=null},onArrayEnd:function(){r=s.pop()},onLiteralValue:o,onError:function(e,n,i){t.push({error:e,offset:n,length:i})}},n),r[0]}(e)))}_parsePyprojectTomlFile(e){return this._attemptParseFile(e,((t,n)=>{try{const e=wp.parse(t);if(e&&e.tool&&e.tool.pyright)return e.tool.pyright}catch(e){throw this._console.error(`Pyproject file parse attempt ${n} error: ${JSON.stringify(e)}`),e}this._console.error(`Pyproject file "${e}" is missing "[tool.pyright]" section.`)}))}_attemptParseFile(e,t){let n="",i=0;for(;;){try{n=this._fs.readFileSync(e,"utf8")}catch{return this._console.error(`Config file "${e}" could not be read.`),void this._reportConfigParseError()}let r=!1;try{return t(n,i+1)}catch(e){r=!0}if(!r)break;if(i++>=5)return this._console.error(`Config file "${e}" could not be parsed. Verify that format is correct.`),void this._reportConfigParseError()}}_getFileNamesFromFileSpecs(){const e=new Map;return Fn.findFilesTime.timeOperation((()=>{const t=this._matchFiles(this._configOptions.include,this._configOptions.exclude);for(const n of t)e.set(n,n)})),[...e.values()]}_updateTrackedFileList(e){if(this._typeStubTargetImportName){const e=this._configOptions.findExecEnvironment(this._executionRootPath),t=vn(this._typeStubTargetImportName),n=this._backgroundAnalysisProgram.importResolver.resolveImport("",e,t);if(n.isImportFound){const e=[],t=n.resolvedPaths[n.resolvedPaths.length-1],i=ge(this._fs,t),r=i&&"__init__"===he(de(t));let s=t;i&&(s=$(s));for(let e=n.resolvedPaths.length-2;e>=0;e--)s=n.resolvedPaths[e]?n.resolvedPaths[e]:$(s);fe(this._fs,s)?this._typeStubTargetPath=s:ge(this._fs,s)&&(this._typeStubTargetPath=$(s)),t?(e.push(t),this._typeStubTargetIsSingleFile=1===n.resolvedPaths.length&&!r):this._typeStubTargetIsSingleFile=!1,n.filteredImplicitImports.forEach((t=>{e.push(t.path)})),this._backgroundAnalysisProgram.setAllowedThirdPartyImports([this._typeStubTargetImportName]),this._backgroundAnalysisProgram.setTrackedFiles(e)}else this._console.error(`Import '${this._typeStubTargetImportName}' not found`)}else{let t=[];this._console.info("Searching for source files"),t=this._getFileNamesFromFileSpecs(),this._backgroundAnalysisProgram.setTrackedFiles(t),this._backgroundAnalysisProgram.markAllFilesDirty(e),0===t.length?this._console.info("No source files found."):this._console.info(`Found ${t.length} source `+(1===t.length?"file":"files"))}this._requireTrackedFileUpdate=!1}_matchFiles(e,t){const n=[["bin","activate"],["Scripts","activate"],["pyvenv.cfg"]],i=[],r=Date.now();let s=!1;const o=(e,o)=>{if(s||.001*(Date.now()-r)>=10&&(this._console.error('Enumeration of workspace source files is taking longer than 10 seconds.\nThis may be because:\n* You have opened your home directory or entire hard drive as a workspace\n* Your workspace contains a very large number of directories and files\n* Your workspace contains a symlink to a directory with many files\n* Your workspace is remote, and file enumeration is slow\nTo reduce this time, open a workspace directory with fewer files or add a pyrightconfig.json configuration file with an "exclude" section to exclude subdirectories from your workspace. For more details, refer to https://github.com/microsoft/pyright/blob/main/docs/configuration.md.'),s=!0),this._configOptions.autoExcludeVenv&&n.some((t=>this._fs.existsSync(te(e,...t)))))return void this._console.info(`Auto-excluding ${e}`);const{files:a,directories:c}=ve(this._fs,e);for(const n of a){const r=te(e,n);this._matchIncludeFileSpec(o,t,r)&&i.push(r)}for(const n of c){const i=te(e,n);o.test(i)&&(this._isInExcludePath(i,t)||l(i,o))}},a=new Set,l=(e,t)=>{const n=_e(this._fs,e);if(n)if(a.has(n))this._console.warn(`Skipping recursive symlink "${e}" -> "${n}"`);else{a.add(n);try{o(e,t)}finally{a.delete(n)}}else this._console.warn(`Skipping broken link "${e}"`)};return e.forEach((e=>{if(!this._isInExcludePath(e.wildcardRoot,t)){let t=!1;const n=ye(this._fs,e.wildcardRoot);(null==n?void 0:n.isFile())?this._shouldIncludeFile(e.wildcardRoot)&&(i.push(e.wildcardRoot),t=!0):(null==n?void 0:n.isDirectory())&&(l(e.wildcardRoot,e.regExp),t=!0),t||this._console.error(`File or directory "${e.wildcardRoot}" does not exist.`)}})),i}_removeSourceFileWatchers(){this._sourceFileWatcher&&(this._sourceFileWatcher.close(),this._sourceFileWatcher=void 0)}_updateSourceFileWatchers(){if(this._removeSourceFileWatchers(),this._watchForSourceChanges&&this._configOptions.include.length>0){const e=this._configOptions.include.map((e=>te(this._executionRootPath,e.wildcardRoot)));try{this._verboseOutput&&this._console.info(`Adding fs watcher for directories:\n ${e.join("\n")}`);const t=et(e);this._sourceFileWatcher=this._fs.createFileSystemWatcher(e,((e,n)=>{if(!n)return;if(this._verboseOutput&&this._console.info(`SourceFile: Received fs event '${e}' for path '${n}'`),t(n))return;if(n.endsWith(".tmp")||n.endsWith(".git")||n.includes(Rp))return;const i=ye(this._fs,n);if(!i||!i.isFile()||n.endsWith(".py")||n.endsWith(".pyi"))if("change"===e&&i)this._backgroundAnalysisProgram.markFilesDirty([n],!1),this._scheduleReanalysis(!1);else{const e=de(n).split(".");let t=!1;4===e.length&&e[3]===e[1]&&32===e[2].length&&(t=!0),t||(this.invalidateAndForceReanalysis(!1,!1),this._scheduleReanalysis(!0))}}))}catch{this._console.error(`Exception caught when installing fs watcher for:\n ${e.join("\n")}`)}}}_removeLibraryFileWatcher(){this._libraryFileWatcher&&(this._libraryFileWatcher.close(),this._libraryFileWatcher=void 0)}_updateLibraryFileWatcher(){if(this._removeLibraryFileWatcher(),!this._watchForLibraryChanges)return;const e=fn(this._fs,this._backgroundAnalysisProgram.configOptions,this._backgroundAnalysisProgram.host,[],!0,this._executionRootPath);if(e&&e.length>0)try{this._verboseOutput&&this._console.info(`Adding fs watcher for library directories:\n ${e.join("\n")}`);const t=et(e);this._libraryFileWatcher=this._fs.createFileSystemWatcher(e,((e,n)=>{n&&(this._verboseOutput&&this._console.info(`LibraryFile: Received fs event '${e}' for path '${n}'`),t(n)||this._scheduleLibraryAnalysis())}))}catch{this._console.error(`Exception caught when installing fs watcher for:\n ${e.join("\n")}`)}}_clearLibraryReanalysisTimer(){var e;this._libraryReanalysisTimer&&(clearTimeout(this._libraryReanalysisTimer),this._libraryReanalysisTimer=void 0,null===(e=this._backgroundAnalysisProgram)||void 0===e||e.cancelIndexing())}_scheduleLibraryAnalysis(){this._disposed||(this._clearLibraryReanalysisTimer(),this._libraryReanalysisTimer=setTimeout((()=>{this._clearLibraryReanalysisTimer(),this.invalidateAndForceReanalysis(!1),this._scheduleReanalysis(!1)}),6e5))}_removeConfigFileWatcher(){this._configFileWatcher&&(this._configFileWatcher.close(),this._configFileWatcher=void 0)}_updateConfigFileWatcher(){this._removeConfigFileWatcher(),this._watchForConfigChanges&&(this._configFilePath?this._configFileWatcher=this._fs.createFileSystemWatcher([this._configFilePath],(e=>{this._verboseOutput&&this._console.info(`Received fs event '${e}' for config file`),this._scheduleReloadConfigFile()})):this._executionRootPath&&(this._configFileWatcher=this._fs.createFileSystemWatcher([this._executionRootPath],((e,t)=>{if(t&&("add"===e||"change"===e)){const n=de(t);n&&Pp.some((e=>e===n))&&(this._verboseOutput&&this._console.info(`Received fs event '${e}' for config file`),this._commandLineOptions&&this.setOptions(this._commandLineOptions))}}))))}_clearReloadConfigTimer(){this._reloadConfigTimer&&(clearTimeout(this._reloadConfigTimer),this._reloadConfigTimer=void 0)}_scheduleReloadConfigFile(){this._clearReloadConfigTimer(),this._reloadConfigTimer=setTimeout((()=>{this._clearReloadConfigTimer(),this._reloadConfigFile()}),100)}_reloadConfigFile(){if(this._updateConfigFileWatcher(),this._configFilePath){this._console.info(`Reloading configuration file at ${this._configFilePath}`);const e=this._backgroundAnalysisProgram.host,t=this._getConfigOptions(e,this._commandLineOptions);this._backgroundAnalysisProgram.setConfigOptions(t),this._applyConfigOptions(e)}}_applyConfigOptions(e){var t;const n=this._importResolverFactory(this._fs,this._backgroundAnalysisProgram.configOptions,e);if(this._backgroundAnalysisProgram.setImportResolver(n),(null===(t=this._commandLineOptions)||void 0===t?void 0:t.fromVsCodeExtension)||this._configOptions.verboseOutput){const e=this._configOptions.verboseOutput?On.Info:On.Log;for(const t of this._configOptions.getExecutionEnvironments())Vn(this._console,e,`Search paths for ${t.root||"<default>"}`),n.getImportRoots(t,!0).forEach((t=>{Vn(this._console,e,`  ${t}`)}))}this._updateLibraryFileWatcher(),this._updateConfigFileWatcher(),this._updateSourceFileWatchers(),this._updateTrackedFileList(!0),this._scheduleReanalysis(!1)}_clearReanalysisTimer(){this._analyzeTimer&&(clearTimeout(this._analyzeTimer),this._analyzeTimer=void 0)}_scheduleReanalysis(e){var t,n;if(this._disposed||!(null===(t=this._commandLineOptions)||void 0===t?void 0:t.enableAmbientAnalysis))return;e&&(this._requireTrackedFileUpdate=!0),null===(n=this._backgroundAnalysisCancellationSource)||void 0===n||n.cancel(),this._clearReanalysisTimer();const i=Date.now()-this._lastUserInteractionTime,r=Math.max(250-i,20);this._analyzeTimer=setTimeout((()=>{this._analyzeTimer=void 0,this._requireTrackedFileUpdate&&this._updateTrackedFileList(!1),this._backgroundAnalysisCancellationSource=this._cancellationProvider.createCancellationTokenSource(),this._backgroundAnalysisProgram.startAnalysis(this._backgroundAnalysisCancellationSource.token)&&this._scheduleReanalysis(!1)}),r)}_reportConfigParseError(){this._onCompletionCallback&&this._onCompletionCallback({diagnostics:[],filesInProgram:0,filesRequiringAnalysis:0,checkingOnlyOpenFiles:!0,fatalErrorOccurred:!1,configParseErrorOccurred:!0,elapsedTime:0})}_shouldIncludeFile(e){return Fp.test(e)}_isInExcludePath(e,t){return!!t.find((t=>t.regExp.test(e)))}_matchIncludeFileSpec(e,t,n){return!(!e.test(n)||this._isInExcludePath(n,t)||!this._shouldIncludeFile(n))}}var Mp;!function(e){e.is=function(e){return e&&e.edits&&Ln.WorkspaceEdit.is(e.edits)}}(Mp||(Mp={})),__webpack_require__(6755);class Op{constructor(e){this._reporter=e,this._isDisplayingProgress=!1}isEnabled(e){var t;return!!this._isDisplayingProgress||null!==(t=this._reporter.isEnabled(e))&&void 0!==t&&t}begin(){this._isDisplayingProgress||(this._isDisplayingProgress=!0,this._reporter.begin())}report(e){this._isDisplayingProgress&&this._reporter.report(e)}end(){this._isDisplayingProgress&&(this._isDisplayingProgress=!1,this._reporter.end())}}class Lp{constructor(e){this._fs=e}decodeTextDocumentPosition(e,t){return{filePath:we(this._fs,e.uri),position:t}}decodeTextDocumentUri(e){return we(this._fs,e)}}const Up=(0,Sp.attachWorkDone)(void 0,void 0);var qp=__webpack_require__(8764).Buffer;class Vp{constructor(e,t){if(this._keys=[],this._values=[],this._version=0,this._copyOnWrite=!1,this._comparer="object"==typeof e?e.comparer:e,this._order="object"==typeof e&&"insertion"===e.sort?[]:void 0,t){const e=Bp(t);try{for(let t=Wp(e);t;t=Wp(e)){const[e,n]=t.value;this.set(e,n)}}finally{jp(e)}}}get size(){return this._keys.length}get comparer(){return this._comparer}get[Symbol.toStringTag](){return"SortedMap"}has(e){return d(this._keys,e,t,this._comparer)>=0}get(e){const n=d(this._keys,e,t,this._comparer);return n>=0?this._values[n]:void 0}set(e,n){const i=d(this._keys,e,t,this._comparer);return i>=0?this._values[i]=n:(this._writePreamble(),u(this._keys,~i,e),u(this._values,~i,n),this._order&&u(this._order,~i,this._version),this._writePostScript()),this}delete(e){const n=d(this._keys,e,t,this._comparer);return n>=0&&(this._writePreamble(),this._orderedRemoveItemAt(this._keys,n),this._orderedRemoveItemAt(this._values,n),this._order&&this._orderedRemoveItemAt(this._order,n),this._writePostScript(),!0)}clear(){this.size>0&&(this._writePreamble(),this._keys.length=0,this._values.length=0,this._order&&(this._order.length=0),this._writePostScript())}forEach(e,t){const n=this._keys,i=this._values,r=this._getIterationOrder(),s=this._version;this._copyOnWrite=!0;try{if(r)for(const s of r)e.call(t,i[s],n[s],this);else for(let r=0;r<n.length;r++)e.call(t,i[r],n[r],this)}finally{s===this._version&&(this._copyOnWrite=!1)}}*keys(){const e=this._keys,t=this._getIterationOrder(),n=this._version;this._copyOnWrite=!0;try{if(t)for(const n of t)yield e[n];else yield*e}finally{n===this._version&&(this._copyOnWrite=!1)}}*values(){const e=this._values,t=this._getIterationOrder(),n=this._version;this._copyOnWrite=!0;try{if(t)for(const n of t)yield e[n];else yield*e}finally{n===this._version&&(this._copyOnWrite=!1)}}*entries(){const e=this._keys,t=this._values,n=this._getIterationOrder(),i=this._version;this._copyOnWrite=!0;try{if(n)for(const i of n)yield[e[i],t[i]];else for(let n=0;n<e.length;n++)yield[e[n],t[n]]}finally{i===this._version&&(this._copyOnWrite=!1)}}[Symbol.iterator](){return this.entries()}_writePreamble(){this._copyOnWrite&&(this._keys=this._keys.slice(),this._values=this._values.slice(),this._order&&(this._order=this._order.slice()),this._copyOnWrite=!1)}_writePostScript(){this._version++}_getIterationOrder(){if(this._order){const e=this._order;return this._order.map(((e,t)=>t)).sort(((t,n)=>e[t]-e[n]))}}_orderedRemoveItemAt(e,t){for(let n=t;n<e.length-1;n++)e[n]=e[n+1];e.pop()}}function Bp(e){return e[Symbol.iterator]()}function Wp(e){const t=e.next();return t.done?void 0:t}function jp(e){const t=e.return;"function"==typeof t&&t.call(e)}class zp{constructor(e){this._version=0,this._size=-1,this._parent=e,this._map=Object.create(e?e._map:null)}get size(){return(-1===this._size||this._parent&&this._parent._version!==this._parentVersion)&&(this._size=Object.keys(this._map).length,this._parent&&(this._parentVersion=this._parent._version)),this._size}get parent(){return this._parent}has(e){return void 0!==this._map[zp._escapeKey(e)]}get(e){const t=this._map[zp._escapeKey(e)];return t===zp._undefinedValue?void 0:t}set(e,t){return this._map[zp._escapeKey(e)]=void 0===t?zp._undefinedValue:t,this._size=-1,this._version++,this}delete(e){const t=zp._escapeKey(e);return void 0!==this._map[t]&&(delete this._map[t],this._size=-1,this._version++,!0)}clear(){this._map=Object.create(this._parent?this._parent._map:null),this._size=-1,this._version++}forEach(e){for(const t of Object.keys(this._map))e(this._map[t],zp._unescapeKey(t),this)}static _escapeKey(e){return e.length>=2&&"_"===e.charAt(0)&&"_"===e.charAt(1)?"_"+e:e}static _unescapeKey(e){return e.length>=3&&"_"===e.charAt(0)&&"_"===e.charAt(1)&&"_"===e.charAt(2)?e.slice(1):e}}zp._undefinedValue={};const $p=Object.freeze({EACCES:"access denied",EIO:"an I/O error occurred",ENOENT:"no such file or directory",EEXIST:"file already exists",ELOOP:"too many symbolic links encountered",ENOTDIR:"no such directory",EISDIR:"path is a directory",EBADF:"invalid file descriptor",EINVAL:"invalid value",ENOTEMPTY:"directory not empty",EPERM:"operation not permitted",EROFS:"file system is read-only"});function Hp(e,t=""){const n=new Error(`${e}: ${$p[e]} ${t}`);return n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,Hp),n}const Gp=function(){const e=Ie();return new RegExp(`^(?!(${e}|${e}${e}w+${e}|[a-zA-Z]:${e}?|)$)`)}(),Kp=/[:*?"<>|]/,Jp=/[:"<>|]/,Yp=/^\.{1,2}$|[:*?"<>|]/,Qp=/^\.{1,2}$|[:"<>|]/,Zp=/\.\w+$/;function Xp(e,t=2016){const n=G(e),i=ce(e);if(!function(e,t,n){const i=!!e[0],r=e.length>2,s=e.length>1,o=s&&Zp.test(e[e.length-1]),a=1024&t?2048&t?Jp:Kp:2048&t?Qp:Yp;if(1&t&&!i)return!1;if(2&t&&!r)return!1;if(4&t&&!s)return!1;if(8&t&&!o)return!1;if(16&t&&!n)return!1;if(1&t&&(t|=32),2&t&&(t|=64),4&t&&(t|=128),8&t&&(t|=256),16&t&&(t|=512),32&~t&&i)return!1;if(64&~t&&r)return!1;if(128&~t&&s)return!1;if(256&~t&&o)return!1;if(512&~t&&n)return!1;if(Gp.test(e[0]))return!1;for(let t=1;t<e.length;t++)if(a.test(e[t]))return!1;return!0}(n,t,i))throw Hp("ENOENT");return n.length>1&&i?J(K(n))+S.sep:J(K(n))}var ed=__webpack_require__(8764).Buffer;const td=X("/");let nd=0,id=0;class rd{constructor(e,t={}){this._lazy={},this._tmpfileCounter=0;const{time:n=-1,files:i,meta:r}=t;if(this.ignoreCase=e,this.stringComparer=this.ignoreCase?ae:oe,this._time=n,r)for(const e of Object.keys(r))this.meta.set(e,r[e]);i&&this._applyFiles(i,"");let s=t.cwd;if((!s||!Se(s))&&this._lazy.links){const e=Bp(this._lazy.links.keys());try{for(let t=Wp(e);t;t=Wp(e)){const e=t.value;s=s?ee(e,s):e;break}}finally{jp(e)}}s&&(Xp(s,2017),this.mkdirpSync(s)),this._cwd=s||""}get meta(){return this._lazy.meta||(this._lazy.meta=new zp(this._shadowRoot?this._shadowRoot.meta:void 0)),this._lazy.meta}get isReadonly(){return Object.isFrozen(this)}makeReadonly(){return Object.freeze(this),this}get shadowRoot(){return this._shadowRoot}snapshot(){if(this.isReadonly)return;const e=new rd(this.ignoreCase,{time:this._time});e._lazy=this._lazy,e._cwd=this._cwd,e._time=this._time,e._shadowRoot=this._shadowRoot,e._dirStack=this._dirStack,e.makeReadonly(),this._lazy={},this._shadowRoot=e}shadow(e=this.ignoreCase){if(!this.isReadonly)throw new Error("Cannot shadow a mutable file system.");if(e&&!this.ignoreCase)throw new Error("Cannot create a case-insensitive file system from a case-sensitive one.");const t=new rd(e,{time:this._time});return t._shadowRoot=this,t._cwd=this._cwd,t}time(e){if(void 0!==e&&this.isReadonly)throw Hp("EPERM");let t=this._time;return"function"==typeof t&&(t=t()),"object"==typeof t&&(t=t.getTime()),-1===t&&(t=Date.now()),void 0!==e&&(this._time=e),t}filemeta(e){const{node:t}=this._walk(this._resolve(e));if(!t)throw Hp("ENOENT");return this._filemeta(t)}_filemeta(e){if(!e.meta){const t=e.shadowRoot&&this._shadowRoot&&this._shadowRoot._filemeta(e.shadowRoot);e.meta=new zp(t)}return e.meta}cwd(){if(!this._cwd)throw new Error("The current working directory has not been set.");const{node:e}=this._walk(this._cwd);if(!e)throw Hp("ENOENT");if(!vd(e))throw Hp("ENOTDIR");return this._cwd}chdir(e){if(this.isReadonly)throw Hp("EPERM");e=this._resolve(e);const{node:t}=this._walk(e);if(!t)throw Hp("ENOENT");if(!vd(t))throw Hp("ENOTDIR");this._cwd=e}pushd(e){if(this.isReadonly)throw Hp("EPERM");e&&(e=this._resolve(e)),this._cwd&&(this._dirStack||(this._dirStack=[]),this._dirStack.push(this._cwd)),e&&e!==this._cwd&&this.chdir(e)}popd(){if(this.isReadonly)throw Hp("EPERM");const e=this._dirStack&&this._dirStack.pop();e&&this.chdir(e)}apply(e){this._applyFiles(e,this._cwd)}scanSync(e,t,n){e=this._resolve(e);const i=[];return this._scan(e,this._stat(this._walk(e)),t,n,!1,i),i}lscanSync(e,t,n){e=this._resolve(e);const i=[];return this._scan(e,this._stat(this._walk(e,!0)),t,n,!0,i),i}createFileSystemWatcher(e,t){return{close:()=>{}}}getModulePath(){return td}tmpdir(){return this.mkdirpSync("/tmp"),X("/tmp")}tmpfile(e){const t=(null==e?void 0:e.prefix)||"tmp",n=(null==e?void 0:e.prefix)?"-"+e.prefix:"",i=`${t}-${this._tmpfileCounter++}${n}`,r=te(this.tmpdir(),i);return this.writeFileSync(r,""),r}realCasePath(e){return e}isMappedFilePath(e){return!1}getOriginalFilePath(e){return e}getMappedFilePath(e){return e}getUri(e){return x.file(e).toString()}_scan(e,t,n,i,r,s){if("ancestors-or-self"!==n&&"self"!==n&&"descendants-or-self"!==n||i.accept&&!i.accept(e,t)||s.push(e),"ancestors-or-self"===n||"ancestors"===n){const t=$(e);if(t!==e)try{const e=this._stat(this._walk(t,r));i.traverse&&!i.traverse(t,e)||this._scan(t,e,"ancestors-or-self",i,r,s)}catch{}}if(("descendants-or-self"===n||"descendants"===n)&&t.isDirectory()&&(!i.traverse||i.traverse(e,t)))for(const t of this.readdirSync(e))try{const n=te(e,t),o=this._stat(this._walk(n,r));this._scan(n,o,"descendants-or-self",i,r,s)}catch{}}mountSync(e,t,n){if(this.isReadonly)throw Hp("EROFS");e=Xp(e,2017);const{parent:i,links:r,node:s,basename:o}=this._walk(this._resolve(t),!0);if(s)throw Hp("EEXIST");const a=this.time(),l=this._mknod(i?i.dev:++nd,fd,511,a);l.source=e,l.resolver=n,this._addLink(i,r,o,l,a)}rimrafSync(e){try{const t=this.lstatSync(e);if(t.isFile()||t.isSymbolicLink())this.unlinkSync(e);else if(t.isDirectory()){for(const t of this.readdirSync(e))this.rimrafSync(te(e,t));this.rmdirSync(e)}}catch(e){if("ENOENT"===e.code)return;throw e}}mkdirpSync(e){e=this._resolve(e);const t=this._walk(e,!0,((e,t)=>"ENOENT"===e.code?(this._mkdir(t),"retry"):"throw"));t.node||this._mkdir(t)}getFileListing(){let e="";const t=(n,i)=>{const r=Bp(i);try{for(let i=Wp(r);i;i=Wp(r)){const[r,c]=i.value,u=n?te(n,r):r,p=0===(s=this._cwd,o=u,a=this.ignoreCase,l=void 0,s=me(s),o=me(o),"string"==typeof a?(s=te(a,s),o=te(a,o)):"boolean"==typeof a&&(l=a),xe(s,o,U(l)))?"*":" ";e&&(e+="\n"),e+=p,vd(c)?(e+=le(u),t(u,this._getLinks(c))):_d(c)?e+=u:Td(c)&&(e+=`${u} -> ${c.symlink}`)}}finally{jp(r)}var s,o,a,l};return t(void 0,this._getRootLinks()),e}debugPrint(){console.log(this.getFileListing())}existsSync(e){const t=this._walk(this._resolve(e),!0,(()=>"stop"));return void 0!==t&&void 0!==t.node}statSync(e){return this._stat(this._walk(this._resolve(e)))}utimesSync(e,t,n){if(this.isReadonly)throw Hp("EROFS");if(!isFinite(+t)||!isFinite(+n))throw Hp("EINVAL");const i=this._walk(this._resolve(e));if(!i||!i.node)throw Hp("ENOENT");i.node.atimeMs=+t,i.node.mtimeMs=+n,i.node.ctimeMs=this.time()}lstatSync(e){return this._stat(this._walk(this._resolve(e),!0))}_stat(e){const t=e.node;if(!t)throw Hp("ENOENT",e.realpath);return new Id(t.dev,t.ino,t.mode,t.nlink,0,_d(t)?this._getSize(t):Td(t)?t.symlink.length:0,4096,0,t.atimeMs,t.mtimeMs,t.ctimeMs,t.birthtimeMs)}readdirSync(e){const{node:t}=this._walk(this._resolve(e));if(!t)throw Hp("ENOENT");if(!vd(t))throw Hp("ENOTDIR");return Array.from(this._getLinks(t).keys())}readdirEntriesSync(e){const{node:t}=this._walk(this._resolve(e));if(!t)throw Hp("ENOENT");if(!vd(t))throw Hp("ENOTDIR");return Array.from(this._getLinks(t).entries()).map((([e,t])=>function(e,t){return{isFile:()=>_d(t),isDirectory:()=>vd(t),isBlockDevice:()=>!1,isCharacterDevice:()=>!1,isFIFO:()=>!1,isSocket:()=>!1,isSymbolicLink:()=>Td(t),name:e}}(e,t)))}mkdirSync(e){if(this.isReadonly)throw Hp("EROFS");this._mkdir(this._walk(this._resolve(e),!0))}_mkdir({parent:e,links:t,node:n,basename:i}){if(n)throw Hp("EEXIST");const r=this.time(),s=this._mknod(e?e.dev:++nd,fd,511,r);this._addLink(e,t,i,s,r)}rmdirSync(e){if(this.isReadonly)throw Hp("EROFS");e=this._resolve(e);const{parent:t,links:n,node:i,basename:r}=this._walk(e,!0);if(!t)throw Hp("EPERM");if(!vd(i))throw Hp("ENOTDIR");if(0!==this._getLinks(i).size)throw Hp("ENOTEMPTY");this._removeLink(t,n,r,i)}linkSync(e,t){if(this.isReadonly)throw Hp("EROFS");const{node:n}=this._walk(this._resolve(e));if(!n)throw Hp("ENOENT");if(vd(n))throw Hp("EPERM");const{parent:i,links:r,basename:s,node:o}=this._walk(this._resolve(t),!0);if(!i)throw Hp("EPERM");if(o)throw Hp("EEXIST");this._addLink(i,r,s,n)}unlinkSync(e){if(this.isReadonly)throw Hp("EROFS");const{parent:t,links:n,node:i,basename:r}=this._walk(this._resolve(e),!0);if(!t)throw Hp("EPERM");if(!i)throw Hp("ENOENT");if(vd(i))throw Hp("EISDIR");this._removeLink(t,n,r,i)}renameSync(e,t){if(this.isReadonly)throw Hp("EROFS");const{parent:n,links:i,node:r,basename:s}=this._walk(this._resolve(e),!0);if(!n)throw Hp("EPERM");if(!r)throw Hp("ENOENT");const{parent:o,links:a,node:l,basename:c}=this._walk(this._resolve(t),!0);if(!o)throw Hp("EPERM");const u=this.time();if(l){if(vd(r)){if(!vd(l))throw Hp("ENOTDIR");if(this._getLinks(l).size>0)throw Hp("ENOTEMPTY")}else if(vd(l))throw Hp("EISDIR");this._removeLink(o,a,c,l,u)}this._replaceLink(n,i,s,o,a,c,r,u)}symlinkSync(e,t){if(this.isReadonly)throw Hp("EROFS");const{parent:n,links:i,node:r,basename:s}=this._walk(this._resolve(t),!0);if(!n)throw Hp("EPERM");if(r)throw Hp("EEXIST");const o=this.time(),a=this._mknod(n.dev,hd,438,o);a.symlink=Xp(e,2016),this._addLink(n,i,s,a,o)}realpathSync(e){const{realpath:t}=this._walk(this._resolve(e));return t}readFileSync(e,t=null){const{node:n}=this._walk(this._resolve(e));if(!n)throw Hp("ENOENT");if(vd(n))throw Hp("EISDIR");if(!_d(n))throw Hp("EBADF");const i=this._getBuffer(n).slice();return t?i.toString(t):i}writeFileSync(e,t,n=null){if(this.isReadonly)throw Hp("EROFS");const{parent:i,links:r,node:s,basename:o}=this._walk(this._resolve(e),!1);if(!i)throw Hp("EPERM");const a=this.time();let l=s;if(l||(l=this._mknod(i.dev,md,438,a),this._addLink(i,r,o,l,a)),vd(l))throw Hp("EISDIR");if(!_d(l))throw Hp("EBADF");l.buffer=ed.isBuffer(t)?t.slice():function(e,t){return qp.from&&qp.from!==Int8Array.from?qp.from(e,t):new qp(e,t)}(""+t,n||"utf8"),l.size=l.buffer.byteLength,l.mtimeMs=a,l.ctimeMs=a}readFile(e){return Promise.resolve(this.readFileSync(e))}readFileText(e,t){return Promise.resolve(this.readFileSync(e,t||"utf8"))}createReadStream(e){throw new Error("Not implemented in test file system.")}createWriteStream(e){throw new Error("Not implemented in test file system.")}copyFileSync(e,t){throw new Error("Not implemented in test file system.")}diff(e=this.shadowRoot,t={}){const n={};return(e?rd._rootDiff(n,this,e,t):rd._trackCreatedInodes(n,this,this._getRootLinks()))?n:void 0}static diff(e,t,n={}){const i={};return rd._rootDiff(i,e,t,n)?i:void 0}isInZipOrEgg(e){return!1}static _diffWorker(e,t,n,i,r,s){if(n&&!r)return rd._trackCreatedInodes(e,t,n);if(r&&!n)return rd._trackDeletedInodes(e,r);if(n&&r){let o=!1;return r.forEach(((t,i)=>{n.has(i)||(e[i]=vd(t)?new cd:new ud,o=!0)})),n.forEach(((n,a)=>{const l=r.get(a);if(l){if(vd(n)&&vd(l))return o=rd._directoryDiff(e,a,t,n,i,l,s)||o;if(_d(n)&&_d(l))return o=rd._fileDiff(e,a,t,n,i,l,s)||o;if(Td(n)&&Td(l))return o=rd._symlinkDiff(e,a,n,l)||o}return o=rd._trackCreatedInode(e,a,t,n)||o})),o}return!1}static _rootDiff(e,t,n,i){for(;!t._lazy.links&&t._shadowRoot;)t=t._shadowRoot;for(;!n._lazy.links&&n._shadowRoot;)n=n._shadowRoot;return t!==n&&!!(t._lazy.links||t._shadowRoot||n._lazy.links||n._shadowRoot)&&rd._diffWorker(e,t,t._getRootLinks(),n,n._getRootLinks(),i)}static _directoryDiff(e,t,n,i,r,s,o){for(;!i.links&&i.shadowRoot;)i=i.shadowRoot;for(;!s.links&&s.shadowRoot;)s=s.shadowRoot;if(i===s)return!1;if(gd(i)&&gd(s))return!1;if(!i.links&&!s.links&&i.resolver&&void 0!==i.source&&s.resolver===i.resolver&&s.source===i.source)return!1;const a={};return!!rd._diffWorker(a,n,n._getLinks(i),r,r._getLinks(s),o)&&(e[t]=new sd(a),!0)}static _fileDiff(e,t,n,i,r,s,o){for(;!i.buffer&&i.shadowRoot;)i=i.shadowRoot;for(;!s.buffer&&s.shadowRoot;)s=s.shadowRoot;if(i===s)return!1;if(yd(i)&&yd(s))return!1;if(!i.buffer&&!s.buffer&&i.resolver&&void 0!==i.source&&s.resolver===i.resolver&&s.source===i.source)return!1;const a=n._getBuffer(i),l=r._getBuffer(s);return a!==l&&(0===ed.compare(a,l)?!!o.includeChangedFileWithSameContent&&(e[t]=new ad(a),!0):(e[t]=new od(a),!0))}static _symlinkDiff(e,t,n,i){return n.symlink!==i.symlink&&(e[t]=new pd(n.symlink),!0)}static _trackCreatedInode(e,t,n,i){if(vd(i)){const r={};rd._trackCreatedInodes(r,n,n._getLinks(i)),e[t]=new sd(r)}else Td(i)?e[t]=new pd(i.symlink):e[t]=new od(i.buffer||"");return!0}static _trackCreatedInodes(e,t,n){return!!n.size&&(n.forEach(((n,i)=>{rd._trackCreatedInode(e,i,t,n)})),!0)}static _trackDeletedInodes(e,t){return!!t.size&&(t.forEach(((t,n)=>{e[n]=vd(t)?new cd:new ud})),!0)}_mknod(e,t,n,i=this.time()){return{dev:e,ino:++id,mode:n&~dd&-19&4095|t&dd,atimeMs:i,mtimeMs:i,ctimeMs:i,birthtimeMs:i,nlink:0}}_addLink(e,t,n,i,r=this.time()){t.set(n,i),i.nlink++,i.ctimeMs=r,e&&(e.mtimeMs=r),e||this._cwd||(this._cwd=n)}_removeLink(e,t,n,i,r=this.time()){t.delete(n),i.nlink--,i.ctimeMs=r,e&&(e.mtimeMs=r)}_replaceLink(e,t,n,i,r,s,o,a){e!==i?(this._removeLink(e,t,n,o,a),this._addLink(i,r,s,o,a)):(t.delete(n),t.set(s,o),e.mtimeMs=a,i.mtimeMs=a)}_getRootLinks(){if(!this._lazy.links){const e=new Vp(this.stringComparer);this._shadowRoot&&this._copyShadowLinks(this._shadowRoot._getRootLinks(),e),this._lazy.links=e}return this._lazy.links}_getLinks(e){if(!e.links){const t=new Vp(this.stringComparer),{source:n,resolver:i}=e;if(n&&i){e.source=void 0,e.resolver=void 0;for(const r of i.readdirSync(n)){const s=te(n,r),o=i.statSync(s);switch(o.mode&dd){case fd:{const s=this._mknod(e.dev,fd,511);s.source=te(n,r),s.resolver=i,this._addLink(e,t,r,s);break}case md:{const s=this._mknod(e.dev,md,438);s.source=te(n,r),s.resolver=i,s.size=o.size,this._addLink(e,t,r,s);break}}}}else this._shadowRoot&&e.shadowRoot&&this._copyShadowLinks(this._shadowRoot._getLinks(e.shadowRoot),t);e.links=t}return e.links}_getShadow(e){const t=this._lazy.shadows||(this._lazy.shadows=new Map);let n=t.get(e.ino);return n||(n={dev:e.dev,ino:e.ino,mode:e.mode,atimeMs:e.atimeMs,mtimeMs:e.mtimeMs,ctimeMs:e.ctimeMs,birthtimeMs:e.birthtimeMs,nlink:e.nlink,shadowRoot:e},Td(e)&&(n.symlink=e.symlink),t.set(n.ino,n)),n}_copyShadowLinks(e,t){const n=Bp(e);try{for(let e=Wp(n);e;e=Wp(n)){const[n,i]=e.value;t.set(n,this._getShadow(i))}}finally{jp(n)}}_getSize(e){return e.buffer?e.buffer.byteLength:void 0!==e.size?e.size:e.source&&e.resolver?e.size=e.resolver.statSync(e.source).size:this._shadowRoot&&e.shadowRoot?e.size=this._shadowRoot._getSize(e.shadowRoot):0}_getBuffer(e){if(!e.buffer){const{source:t,resolver:n}=e;t&&n?(e.source=void 0,e.resolver=void 0,e.size=void 0,e.buffer=n.readFileSync(t)):this._shadowRoot&&e.shadowRoot?e.buffer=this._shadowRoot._getBuffer(e.shadowRoot):e.buffer=ed.allocUnsafe(0)}return e.buffer}_walk(e,t,n){let i,r=this._getRootLinks(),s=G(e),o=0,a=0,l=!1;for(;;){if(a>=40)throw Hp("ELOOP");const e=o===s.length-1,n=s[o],u=r.get(n);if(e&&(t||!Td(u)))return{realpath:J(s),basename:n,parent:i,links:r,node:u};if(void 0===u){if(c(Hp("ENOENT"),u))continue;return}if(Td(u)){const e=ee(J(s.slice(0,o)),u.symlink);r=this._getRootLinks(),i=void 0,s=G(e).concat(s.slice(o+1)),o=0,a++,l=!1}else if(vd(u))r=this._getLinks(u),i=u,o++,l=!1;else if(!c(Hp("ENOTDIR"),u))return}function c(e,t){const a=J(s.slice(0,o+1)),c=s[o],u=!l&&n?n(e,{realpath:a,basename:c,parent:i,links:r,node:t}):"throw";if("stop"===u)return!1;if("retry"===u)return l=!0,!0;throw e}}_resolve(e){return this._cwd?ee(this._cwd,Xp(e,4064)):Xp(e,4065)}_applyFiles(e,t){const n=[];this._applyFilesWorker(e,t,n);for(const[e,i]of n){if(this.mkdirpSync($(i)),this.pushd($(i)),e instanceof pd){if(0===this.stringComparer($(i),i))throw new TypeError("Roots cannot be symbolic links.");this.symlinkSync(ee(t,e.symlink),i),this._applyFileExtendedOptions(i,e)}else if(e instanceof ld){if(0===this.stringComparer($(i),i))throw new TypeError("Roots cannot be hard links.");this.linkSync(e.path,i)}else this.mountSync(e.source,i,e.resolver),this._applyFileExtendedOptions(i,e);this.popd()}}_applyFileExtendedOptions(e,t){const{meta:n}=t;if(void 0!==n){const t=this.filemeta(e);for(const e of Object.keys(n))t.set(e,n[e])}}_applyFilesWorker(e,t,n){for(const i of Object.keys(e)){const r=bd(e[i]),s=t?ee(t,i):i;if(Xp(s,2017),null==r||r instanceof cd||r instanceof ud){if(0===this.stringComparer($(s),s))throw new TypeError("Roots cannot be deleted.");this.rimrafSync(s)}else if(r instanceof od){if(0===this.stringComparer($(s),s))throw new TypeError("Roots cannot be files.");this.mkdirpSync($(s)),this.writeFileSync(s,r.data,r.encoding),this._applyFileExtendedOptions(s,r)}else r instanceof sd?(this.mkdirpSync(s),this._applyFileExtendedOptions(s,r),this._applyFilesWorker(r.files,s,n)):n.push([r,s])}}}class sd{constructor(e,{meta:t}={}){this.files=e,this.meta=t}}class od{constructor(e,{meta:t,encoding:n}={}){this.data=e,this.encoding=n,this.meta=t}}class ad extends od{constructor(e,t){super(e,t)}}class ld{constructor(e){this.path=e}}class cd{}class ud{}class pd{constructor(e,{meta:t}={}){this.symlink=e,this.meta=t}}const dd=61440,hd=40960,md=32768,fd=16384;function gd(e){return!(e.links||e.shadowRoot||e.resolver||e.source)}function yd(e){return!(e.buffer||e.shadowRoot||e.resolver||e.source)}function _d(e){return void 0!==e&&(e.mode&dd)===md}function vd(e){return void 0!==e&&(e.mode&dd)===fd}function Td(e){return void 0!==e&&(e.mode&dd)===hd}function bd(e){return null==e||e instanceof sd||e instanceof od||e instanceof ld||e instanceof pd||e instanceof class{constructor(e,t,{meta:n}={}){this.source=e,this.resolver=t,this.meta=n}}||e instanceof cd||e instanceof ud?e:"string"==typeof e||ed.isBuffer(e)?new od(e):new sd(e)}class Id{constructor(e=0,t=0,n=0,i=0,r=0,s=0,o=0,a=0,l=0,c=0,u=0,p=0){this.dev=e,this.ino=t,this.mode=n,this.nlink=i,this.uid=0,this.gid=0,this.rdev=r,this.size=s,this.blksize=o,this.blocks=a,this.atimeMs=l,this.mtimeMs=c,this.ctimeMs=u,this.birthtimeMs=p,this.atime=new Date(this.atimeMs),this.mtime=new Date(this.mtimeMs),this.ctime=new Date(this.ctimeMs),this.birthtime=new Date(this.birthtimeMs)}isFile(){return(this.mode&dd)===md}isDirectory(){return(this.mode&dd)===fd}isSymbolicLink(){return(this.mode&dd)===hd}isBlockDevice(){return 24576==(this.mode&dd)}isCharacterDevice(){return 8192==(this.mode&dd)}isFIFO(){return 4096==(this.mode&dd)}isSocket(){return 49152==(this.mode&dd)}}class Sd extends Map{constructor(){super(...arguments),this._defaultWorkspacePath="<default>"}getNonDefaultWorkspaces(){const e=[];return this.forEach((t=>{t.rootPath&&e.push(t)})),e}getWorkspaceForFile(e,t){let n,i;if(this.forEach((e=>{e.rootPath&&t.startsWith(e.rootPath)&&(void 0===n||e.rootPath.startsWith(n))&&(n=e.rootPath,i=e)})),void 0===i){let t=this.get(this._defaultWorkspacePath);if(!t){const n=[...this.keys()];if(1===n.length)return this.get(n[0]);t={workspaceName:"",rootPath:"",rootUri:"",serviceInstance:e.createAnalyzerService(this._defaultWorkspacePath),disableLanguageServices:!1,disableOrganizeImports:!1,isInitialized:gp()},this.set(this._defaultWorkspacePath,t),e.updateSettingsForWorkspace(t).ignoreErrors()}return t}return i}}var xd=__webpack_require__(7630);const Cd={openFilesTimeInMs:50,noOpenFilesTimeInMs:200};class wd extends class{constructor(e,t,n){var i,r;this._serverOptions=e,this._connection=t,this.console=n,this._lastTriggerKind=ot.CompletionTriggerKind.Invoked,this.rootPath="",this.client={hasConfigurationCapability:!1,hasVisualStudioExtensionsCapability:!1,hasWorkspaceFoldersCapability:!1,hasWatchFileCapability:!1,hasActiveParameterCapability:!1,hasSignatureLabelOffsetCapability:!1,hasHierarchicalDocumentSymbolCapability:!1,hasWindowProgressCapability:!1,hasGoToDeclarationCapability:!1,hasDocumentChangeCapability:!1,hasDocumentAnnotationCapability:!1,hoverContentFormat:ot.MarkupKind.PlainText,completionDocFormat:ot.MarkupKind.PlainText,completionSupportsSnippet:!1,signatureDocFormat:ot.MarkupKind.PlainText,supportsDeprecatedDiagnosticTag:!1,supportsUnnecessaryDiagnosticTag:!1,completionItemResolveSupportsAdditionalTextEdits:!1},this.diagnosticTextSettings={},__webpack_require__.g.__rootDirectory=e.rootDirectory,this.console.info(`${e.productName} language server ${e.version&&e.version+" "}starting`),this.console.info(`Server root directory: ${e.rootDirectory}`),this._workspaceMap=this._serverOptions.workspaceMap,this._fileWatcherProvider=this._serverOptions.fileWatcherProvider,this.fs=new rt(this._serverOptions.fileSystem),this._uriParser=new Lp(this.fs);const s=this.fs.getModulePath();s&&this.fs.chdir(s),this.setupConnection(null!==(i=e.supportedCommands)&&void 0!==i?i:[],null!==(r=e.supportedCodeActions)&&void 0!==r?r:[]),this._progressReporter=new Op(this.createProgressReporter()),this._connection.listen()}decodeTextDocumentUri(e){return this._uriParser.decodeTextDocumentUri(e)}async getConfiguration(e,t){if(this.client.hasConfigurationCapability){const n={};return void 0!==e&&(n.scopeUri=e),void 0!==t&&(n.section=t),this._connection.workspace.getConfiguration(n)}if(this._defaultClientConfig)return n=this._defaultClientConfig,t.split(".").reduce(((e,t)=>e&&e[t]),n);var n}isOpenFilesOnly(e){return"workspace"!==e}getSeverityOverrides(e){const t=e;if(["error","warning","information","none"].includes(t))return t}getDiagnosticRuleName(e){const t=e;if(wc().includes(t))return t}createBackgroundAnalysisProgram(e,t,n,i,r,s){return new xp(e,t,n,i,r,s)}setExtension(e){this._serverOptions.extension=e}get window(){return this._connection.window}get supportAdvancedEdits(){return this.client.hasDocumentChangeCapability&&this.client.hasDocumentAnnotationCapability}createAnalyzerService(e){this.console.log(`Starting service instance "${e}"`);const t=new Np(e,this.fs,this.console,this.createHost.bind(this),this.createImportResolver.bind(this),void 0,this._serverOptions.extension,this.createBackgroundAnalysis(),this._serverOptions.maxAnalysisTimeInForeground,this.createBackgroundAnalysisProgram.bind(this),this._serverOptions.cancellationProvider);return t.setCompletionCallback((e=>this.onAnalysisCompletedHandler(e))),t}async getWorkspaceForFile(e){const t=this._workspaceMap.getWorkspaceForFile(this,e);return await t.isInitialized.promise,t}reanalyze(){this._workspaceMap.forEach((e=>{e.serviceInstance.invalidateAndForceReanalysis()}))}restart(){this._workspaceMap.forEach((e=>{e.serviceInstance.restart()}))}setupConnection(e,t){this._connection.onInitialize((n=>this.initialize(n,e,t))),this._connection.onInitialized((()=>this.onInitialized())),this._connection.onDidChangeConfiguration((e=>this.onDidChangeConfiguration(e))),this._connection.onCodeAction(((e,t)=>this.executeCodeAction(e,t))),this._connection.onDefinition((async(e,t)=>this.onDefinition(e,t))),this._connection.onDeclaration((async(e,t)=>this.onDeclaration(e,t))),this._connection.onTypeDefinition((async(e,t)=>this.onTypeDefinition(e,t))),this._connection.onReferences((async(e,t,n,i)=>this.onReferences(e,t,n,i))),this._connection.onDocumentSymbol((async(e,t)=>this.onDocumentSymbol(e,t))),this._connection.onWorkspaceSymbol((async(e,t,n,i)=>this.onWorkspaceSymbol(e,t,i))),this._connection.onHover((async(e,t)=>this.onHover(e,t))),this._connection.onDocumentHighlight((async(e,t)=>this.onDocumentHighlight(e,t))),this._connection.onSignatureHelp((async(e,t)=>this.onSignatureHelp(e,t))),this._connection.onCompletion(((e,t)=>this.onCompletion(e,t))),this._connection.onCompletionResolve((async(e,t)=>this.onCompletionResolve(e,t))),this._connection.onRenameRequest((async(e,t)=>this.onRenameRequest(e,t)));const n=this._connection.languages.callHierarchy;n.onPrepare((async(e,t)=>this.onPrepare(e,t))),n.onIncomingCalls((async(e,t)=>this.onIncomingCalls(e,t))),n.onOutgoingCalls((async(e,t)=>this.onOutgoingCalls(e,t))),this._connection.onDidOpenTextDocument((async e=>this.onDidOpenTextDocument(e))),this._connection.onDidChangeTextDocument((async e=>this.onDidChangeTextDocument(e))),this._connection.onDidCloseTextDocument((async e=>this.onDidCloseTextDocument(e))),this._connection.onDidChangeWatchedFiles((e=>this.onDidChangeWatchedFiles(e))),this._connection.onExecuteCommand((async(e,t,n)=>this.onExecuteCommand(e,t,n)))}async initialize(e,t,n){var i,r,s,o,a,l,c,u,p,d,h,m,f,g,y,_,v,T,b,I,S,x,C,w,E,k,D,A,P,R,F,N,M,O,L,U,q,V;this.diagnosticTextSettings={locale:e.locale,style:e.initializationOptions.diagnosticStyle},await dl(this.diagnosticTextSettings),this.rootPath=e.rootPath||"";const B=e.capabilities;this.client.hasConfigurationCapability=!!(null===(i=B.workspace)||void 0===i?void 0:i.configuration),this.client.hasWatchFileCapability=!!(null===(s=null===(r=B.workspace)||void 0===r?void 0:r.didChangeWatchedFiles)||void 0===s?void 0:s.dynamicRegistration),this.client.hasWorkspaceFoldersCapability=!!(null===(o=B.workspace)||void 0===o?void 0:o.workspaceFolders),this.client.hasVisualStudioExtensionsCapability=!!B.supportsVisualStudioExtensions,this.client.hasActiveParameterCapability=!!(null===(c=null===(l=null===(a=B.textDocument)||void 0===a?void 0:a.signatureHelp)||void 0===l?void 0:l.signatureInformation)||void 0===c?void 0:c.activeParameterSupport),this.client.hasSignatureLabelOffsetCapability=!!(null===(h=null===(d=null===(p=null===(u=B.textDocument)||void 0===u?void 0:u.signatureHelp)||void 0===p?void 0:p.signatureInformation)||void 0===d?void 0:d.parameterInformation)||void 0===h?void 0:h.labelOffsetSupport),this.client.hasHierarchicalDocumentSymbolCapability=!!(null===(f=null===(m=B.textDocument)||void 0===m?void 0:m.documentSymbol)||void 0===f?void 0:f.hierarchicalDocumentSymbolSupport),this.client.hasDocumentChangeCapability=!!(null===(y=null===(g=B.workspace)||void 0===g?void 0:g.workspaceEdit)||void 0===y?void 0:y.documentChanges)&&!!(null===(_=B.workspace.workspaceEdit)||void 0===_?void 0:_.resourceOperations),this.client.hasDocumentAnnotationCapability=!!(null===(T=null===(v=B.workspace)||void 0===v?void 0:v.workspaceEdit)||void 0===T?void 0:T.changeAnnotationSupport),this.client.hoverContentFormat=this._getCompatibleMarkupKind(null===(I=null===(b=B.textDocument)||void 0===b?void 0:b.hover)||void 0===I?void 0:I.contentFormat),this.client.completionDocFormat=this._getCompatibleMarkupKind(null===(C=null===(x=null===(S=B.textDocument)||void 0===S?void 0:S.completion)||void 0===x?void 0:x.completionItem)||void 0===C?void 0:C.documentationFormat),this.client.completionSupportsSnippet=!!(null===(k=null===(E=null===(w=B.textDocument)||void 0===w?void 0:w.completion)||void 0===E?void 0:E.completionItem)||void 0===k?void 0:k.snippetSupport),this.client.signatureDocFormat=this._getCompatibleMarkupKind(null===(P=null===(A=null===(D=B.textDocument)||void 0===D?void 0:D.signatureHelp)||void 0===A?void 0:A.signatureInformation)||void 0===P?void 0:P.documentationFormat);const W=(null===(N=null===(F=null===(R=B.textDocument)||void 0===R?void 0:R.publishDiagnostics)||void 0===F?void 0:F.tagSupport)||void 0===N?void 0:N.valueSet)||[];return this.client.supportsUnnecessaryDiagnosticTag=W.some((e=>e===ot.DiagnosticTag.Unnecessary)),this.client.supportsDeprecatedDiagnosticTag=W.some((e=>e===ot.DiagnosticTag.Deprecated)),this.client.hasWindowProgressCapability=!!(null===(M=B.window)||void 0===M?void 0:M.workDoneProgress),this.client.hasGoToDeclarationCapability=!!(null===(O=B.textDocument)||void 0===O?void 0:O.declaration),this.client.completionItemResolveSupportsAdditionalTextEdits=!!(null===(V=null===(q=null===(U=null===(L=B.textDocument)||void 0===L?void 0:L.completion)||void 0===U?void 0:U.completionItem)||void 0===q?void 0:q.resolveSupport)||void 0===V?void 0:V.properties.some((e=>"additionalTextEdits"===e))),e.workspaceFolders?e.workspaceFolders.forEach((e=>{const t=this._uriParser.decodeTextDocumentUri(e.uri);this._workspaceMap.set(t,this.createWorkspaceServiceInstance(e,t))})):e.rootPath&&this._workspaceMap.set(e.rootPath,this.createWorkspaceServiceInstance(void 0,e.rootPath)),this.updateSettingsForAllWorkspaces(),{capabilities:{textDocumentSync:ot.TextDocumentSyncKind.Incremental,definitionProvider:{workDoneProgress:!0},declarationProvider:{workDoneProgress:!0},typeDefinitionProvider:{workDoneProgress:!0},referencesProvider:{workDoneProgress:!0},documentSymbolProvider:{workDoneProgress:!0},workspaceSymbolProvider:{workDoneProgress:!0},hoverProvider:{workDoneProgress:!0},documentHighlightProvider:{workDoneProgress:!0},renameProvider:{workDoneProgress:!0},completionProvider:{triggerCharacters:this.client.hasVisualStudioExtensionsCapability?[".","[","@"]:[".","["],resolveProvider:!0,workDoneProgress:!0},signatureHelpProvider:{triggerCharacters:["(",",",")"],workDoneProgress:!0},codeActionProvider:{codeActionKinds:n,workDoneProgress:!0},executeCommandProvider:{commands:t,workDoneProgress:!0},callHierarchyProvider:!0}}}onInitialized(){this.client.hasWorkspaceFoldersCapability&&this._connection.workspace.onDidChangeWorkspaceFolders((e=>{e.removed.forEach((e=>{const t=this._uriParser.decodeTextDocumentUri(e.uri);this._workspaceMap.delete(t)})),e.added.forEach((async e=>{const t=this._uriParser.decodeTextDocumentUri(e.uri),n=this.createWorkspaceServiceInstance(e,t);this._workspaceMap.set(t,n),await this.updateSettingsForWorkspace(n)}))})),this.client.hasWatchFileCapability&&this._connection.client.register(ot.DidChangeWatchedFilesNotification.type,{watchers:[...Pp.map((e=>({globPattern:`**/${e}`,kind:ot.WatchKind.Create|ot.WatchKind.Change|ot.WatchKind.Delete}))),{globPattern:"**",kind:ot.WatchKind.Create|ot.WatchKind.Change|ot.WatchKind.Delete}]})}onDidChangeConfiguration(e){this.console.log("Received updated settings"),(null==e?void 0:e.settings)&&(this._defaultClientConfig=null==e?void 0:e.settings),this.updateSettingsForAllWorkspaces()}async onDefinition(e,t){return this.getDefinitions(e,t,this.client.hasGoToDeclarationCapability?sc.PreferSource:sc.All,((e,t,n,i,r)=>e.serviceInstance.getDefinitionForPosition(t,n,i,r)))}async onDeclaration(e,t){return this.getDefinitions(e,t,this.client.hasGoToDeclarationCapability?sc.PreferStubs:sc.All,((e,t,n,i,r)=>e.serviceInstance.getDefinitionForPosition(t,n,i,r)))}async onTypeDefinition(e,t){return this.getDefinitions(e,t,sc.All,((e,t,n,i,r)=>e.serviceInstance.getTypeDefinitionForPosition(t,n,r)))}async getDefinitions(e,t,n,i){this.recordUserInteractionTime();const{filePath:r,position:s}=this._uriParser.decodeTextDocumentPosition(e.textDocument,e.position),o=await this.getWorkspaceForFile(r);if(o.disableLanguageServices)return;const a=i(o,r,s,n,t);return a?a.filter((e=>!this.fs.isInZipOrEgg(e.path))).map((e=>ot.Location.create(Ee(this.fs,e.path),e.range))):void 0}async onReferences(e,t,n,i){this._pendingFindAllRefsCancellationSource&&(this._pendingFindAllRefsCancellationSource.cancel(),this._pendingFindAllRefsCancellationSource=void 0);const r=await this._getProgressReporter(n,ml.CodeAction.findingReferences(),t),s=r.source;this._pendingFindAllRefsCancellationSource=s;try{const{filePath:t,position:n}=this._uriParser.decodeTextDocumentPosition(e.textDocument,e.position),o=await this.getWorkspaceForFile(t);if(o.disableLanguageServices)return;const a=e=>e.filter((e=>!this.fs.isInZipOrEgg(e.path))).map((e=>ot.Location.create(Ee(this.fs,e.path),e.range))),l=[],c=i?e=>i.report(a(e)):e=>l.push(...a(e));return o.serviceInstance.reportReferencesForPosition(t,n,e.context.includeDeclaration,c,s.token),l}finally{r.reporter.done(),s.dispose()}}async onDocumentSymbol(e,t){this.recordUserInteractionTime();const n=this._uriParser.decodeTextDocumentUri(e.textDocument.uri),i=await this.getWorkspaceForFile(n);if(i.disableLanguageServices)return;const r=[];return i.serviceInstance.addSymbolsForDocument(n,r,t),this.client.hasHierarchicalDocumentSymbolCapability?r:function(e,t){const n=[];for(const i of t)Uc(n,e,i);return n}(e.textDocument.uri,r)}async onWorkspaceSymbol(e,t,n){const i=[],r=n?e=>n.report(e):e=>i.push(...e);for(const n of this._workspaceMap.values())await n.isInitialized.promise,n.disableLanguageServices||n.disableWorkspaceSymbol||n.serviceInstance.reportSymbolsForWorkspace(e.query,r,t);return i}async onHover(e,t){const{filePath:n,position:i}=this._uriParser.decodeTextDocumentPosition(e.textDocument,e.position),r=(await this.getWorkspaceForFile(n)).serviceInstance.getHoverForPosition(n,i,this.client.hoverContentFormat,t);return function(e,t){if(!t)return;const n=t.parts.map((t=>{if(t.python){if(e===ot.MarkupKind.Markdown)return"```python\n"+t.text+"\n```\n";if(e===ot.MarkupKind.PlainText)return t.text+"\n\n";E(`Unsupported markup type: ${e}`)}return t.text})).join("").trimEnd();return{contents:{kind:e,value:n},range:t.range}}(this.client.hoverContentFormat,r)}async onDocumentHighlight(e,t){const{filePath:n,position:i}=this._uriParser.decodeTextDocumentPosition(e.textDocument,e.position);return(await this.getWorkspaceForFile(n)).serviceInstance.getDocumentHighlight(n,i,t)}async onSignatureHelp(e,t){var n,i,r,s;const{filePath:o,position:a}=this._uriParser.decodeTextDocumentPosition(e.textDocument,e.position),l=await this.getWorkspaceForFile(o);if(l.disableLanguageServices)return;const c=l.serviceInstance.getSignatureHelpForPosition(o,a,this.client.signatureDocFormat,t);if(!c)return;const u=c.signatures.map((e=>{let t=[];e.parameters&&(t=e.parameters.map((e=>ot.ParameterInformation.create(this.client.hasSignatureLabelOffsetCapability?[e.startOffset,e.endOffset]:e.text,e.documentation))));const n=ot.SignatureInformation.create(e.label,void 0,...t);return void 0!==e.documentation&&(n.documentation=e.documentation),void 0!==e.activeParameter&&(n.activeParameter=e.activeParameter),n})),p=e=>{var t;return void 0!==e.activeParameter||!c.callHasParameters&&!(null===(t=e.parameters)||void 0===t?void 0:t.length)};let d=u.findIndex(p);-1===d&&(d=null);let h=null!==d?u[d].activeParameter:null;if((null===(n=e.context)||void 0===n?void 0:n.isRetrigger)&&e.context.triggerKind!==ot.SignatureHelpTriggerKind.Invoked){const t=null!==(r=null===(i=e.context.activeSignatureHelp)||void 0===i?void 0:i.activeSignature)&&void 0!==r?r:null;if(null!==t&&t<u.length){const e=u[t];p(e)&&(d=t,h=null!==(s=e.activeParameter)&&void 0!==s?s:null)}}return(this.client.hasActiveParameterCapability||null===d)&&(h=Math.max(...u.map((e=>{var t,n;return null!==(n=null===(t=e.parameters)||void 0===t?void 0:t.length)&&void 0!==n?n:0})))),{signatures:u,activeSignature:d,activeParameter:h}}async onCompletion(e,t){var n,i;const r=this._lastTriggerKind!==ot.CompletionTriggerKind.TriggerForIncompleteCompletions||(null===(n=e.context)||void 0===n?void 0:n.triggerKind)!==ot.CompletionTriggerKind.TriggerForIncompleteCompletions;this._lastTriggerKind=null===(i=e.context)||void 0===i?void 0:i.triggerKind;const{filePath:s,position:o}=this._uriParser.decodeTextDocumentPosition(e.textDocument,e.position),a=await this.getWorkspaceForFile(s);if(a.disableLanguageServices)return;const l=await this.getWorkspaceCompletionsForPosition(a,s,o,a.rootPath,this.getCompletionOptions(e),t);return l&&l.completionList&&(l.completionList.isIncomplete=r),null==l?void 0:l.completionList}async onCompletionResolve(e,t){const n=e.data;if(n&&n.filePath){const i=await this.getWorkspaceForFile(n.workspacePath);this.resolveWorkspaceCompletionItem(i,n.filePath,e,t)}return e}async onRenameRequest(e,t){const{filePath:n,position:i}=this._uriParser.decodeTextDocumentPosition(e.textDocument,e.position),r=await this.getWorkspaceForFile(n);if(r.disableLanguageServices)return;const s=r.serviceInstance.renameSymbolAtPosition(n,i,e.newName,""===r.rootPath,t);return s?function(e,t){const n={changes:{}};return t.forEach((t=>{const i=Ee(e,t.filePath);n.changes[i]=n.changes[i]||[],n.changes[i].push({range:t.range,newText:t.replacementText})})),n}(this.fs,s):void 0}async onPrepare(e,t){const{filePath:n,position:i}=this._uriParser.decodeTextDocumentPosition(e.textDocument,e.position),r=await this.getWorkspaceForFile(n);if(r.disableLanguageServices)return null;const s=r.serviceInstance.getCallForPosition(n,i,t)||null;return s?this.fs.isInZipOrEgg(s.uri)?null:(s.uri=Ee(this.fs,s.uri),[s]):null}async onIncomingCalls(e,t){const{filePath:n,position:i}=this._uriParser.decodeTextDocumentPosition(e.item,e.item.range.start),r=await this.getWorkspaceForFile(n);if(r.disableLanguageServices)return null;let s=r.serviceInstance.getIncomingCallsForPosition(n,i,t)||null;return s&&0!==s.length?(s=s.filter((e=>!this.fs.isInZipOrEgg(e.from.uri))),s.forEach((e=>{e.from.uri=Ee(this.fs,e.from.uri)})),s):null}async onOutgoingCalls(e,t){const{filePath:n,position:i}=this._uriParser.decodeTextDocumentPosition(e.item,e.item.range.start),r=await this.getWorkspaceForFile(n);if(r.disableLanguageServices)return null;let s=r.serviceInstance.getOutgoingCallsForPosition(n,i,t)||null;return s&&0!==s.length?(s=s.filter((e=>!this.fs.isInZipOrEgg(e.to.uri))),s.forEach((e=>{e.to.uri=Ee(this.fs,e.to.uri)})),s):null}async onDidOpenTextDocument(e){const t=this._uriParser.decodeTextDocumentUri(e.textDocument.uri);this.fs.addUriMap(e.textDocument.uri,t)&&(await this.getWorkspaceForFile(t)).serviceInstance.setFileOpened(t,e.textDocument.version,e.textDocument.text)}async onDidChangeTextDocument(e){this.recordUserInteractionTime();const t=this._uriParser.decodeTextDocumentUri(e.textDocument.uri);this.fs.hasUriMapEntry(e.textDocument.uri,t)&&(await this.getWorkspaceForFile(t)).serviceInstance.updateOpenFileContents(t,e.textDocument.version,e.contentChanges)}async onDidCloseTextDocument(e){const t=this._uriParser.decodeTextDocumentUri(e.textDocument.uri);this.fs.removeUriMap(e.textDocument.uri,t)&&(await this.getWorkspaceForFile(t)).serviceInstance.setFileClosed(t)}onDidChangeWatchedFiles(e){e.changes.forEach((e=>{const t=this._uriParser.decodeTextDocumentUri(e.uri),n=1===e.type?"add":"change";this._fileWatcherProvider.onFileChange(n,t)}))}async onExecuteCommand(e,t,n){this._pendingCommandCancellationSource&&(this._pendingCommandCancellationSource.cancel(),this._pendingCommandCancellationSource=void 0);const i=async t=>{const n=await this.executeCommand(e,t);return ot.WorkspaceEdit.is(n)&&this._connection.workspace.applyEdit({label:`Command '${e.command}'`,edit:n}),Mp.is(n)&&await this._connection.workspace.applyEdit({label:n.label,edit:n.edits}),n};if(!this.isLongRunningCommand(e.command))return await i(t);{const e=await this._getProgressReporter(n,ml.CodeAction.executingCommand(),t),r=e.source;this._pendingCommandCancellationSource=r;try{return await i(r.token)}finally{e.reporter.done(),r.dispose()}}}resolveWorkspaceCompletionItem(e,t,n,i){e.serviceInstance.resolveCompletionItem(t,n,this.getCompletionOptions(),void 0,i)}getWorkspaceCompletionsForPosition(e,t,n,i,r,s){return e.serviceInstance.getCompletionsForPosition(t,n,i,r,void 0,s)}updateSettingsForAllWorkspaces(){this._workspaceMap.forEach((e=>{this.updateSettingsForWorkspace(e).ignoreErrors()}))}getCompletionOptions(e){return{format:this.client.completionDocFormat,snippet:this.client.completionSupportsSnippet,lazyEdit:this.client.completionItemResolveSupportsAdditionalTextEdits,autoImport:!0}}createWorkspaceServiceInstance(e,t){var n,i,r;return{workspaceName:null!==(n=null==e?void 0:e.name)&&void 0!==n?n:"",rootPath:t,rootUri:null!==(i=null==e?void 0:e.uri)&&void 0!==i?i:"",serviceInstance:this.createAnalyzerService(null!==(r=null==e?void 0:e.name)&&void 0!==r?r:t),disableLanguageServices:!1,disableOrganizeImports:!1,disableWorkspaceSymbol:!1,isInitialized:gp()}}convertDiagnostics(e){return[{uri:Ee(this.fs,e.filePath),version:e.version,diagnostics:this._convertDiagnostics(e.diagnostics)}]}onAnalysisCompletedHandler(e){if(e.diagnostics.forEach((e=>{this.fs.isInZipOrEgg(e.filePath)||(this._sendDiagnostics(this.convertDiagnostics(e)),this.fs.pendingRequest(e.filePath,e.diagnostics.length>0))})),this._progressReporter.isEnabled(e))if(e.filesRequiringAnalysis>0){this._progressReporter.begin();const t=1===e.filesRequiringAnalysis?ml.CodeAction.filesToAnalyzeOne():ml.CodeAction.filesToAnalyzeCount().format({count:e.filesRequiringAnalysis});this._progressReporter.report(t)}else this._progressReporter.end();else this._progressReporter.end()}async updateSettingsForWorkspace(e,t){var n;t=null!=t?t:await this.getSettings(e),this.console.level=null!==(n=t.logLevel)&&void 0!==n?n:On.Info,this.updateOptionsAndRestartService(e,t),e.disableLanguageServices=!!t.disableLanguageServices,e.disableOrganizeImports=!!t.disableOrganizeImports,e.isInitialized.resolve(!0)}updateOptionsAndRestartService(e,t,n){yp.runWithOptions(this.rootPath,e,t,n)}convertLogLevel(e){if(!e)return On.Info;switch(e.toLowerCase()){case"error":return On.Error;case"warning":return On.Warn;case"information":return On.Info;case"trace":return On.Log;default:return On.Info}}_sendDiagnostics(e){for(const t of e)this._connection.sendDiagnostics(t)}_getCompatibleMarkupKind(e){const t=[ot.MarkupKind.PlainText,ot.MarkupKind.Markdown];for(const n of null!=e?e:[])if(t.includes(n))return n;return ot.MarkupKind.PlainText}async _getProgressReporter(e,t,n){if(e.constructor!==Up.constructor)return{reporter:e,source:ut(n)};const i=await this._connection.window.createWorkDoneProgress();return i.begin(t,void 0,void 0,!0),{reporter:i,source:ut(n,i.token)}}_convertDiagnostics(e){const t=[];return e.forEach((e=>{const n=function(e){switch(e){case 0:return ot.DiagnosticSeverity.Error;case 1:return ot.DiagnosticSeverity.Warning;case 2:return ot.DiagnosticSeverity.Information;case 3:case 4:return ot.DiagnosticSeverity.Hint}}(e.category),i=e.getRule(),r=ot.Diagnostic.create(e.range,e.message,n,i,this._serverOptions.productName);if(3===e.category){if(r.tags=[ot.DiagnosticTag.Unnecessary],r.severity=ot.DiagnosticSeverity.Hint,!this.client.supportsUnnecessaryDiagnosticTag)return}else if(4===e.category&&(r.tags=[ot.DiagnosticTag.Deprecated],r.severity=ot.DiagnosticSeverity.Hint,!this.client.supportsDeprecatedDiagnosticTag))return;if(i){const e=this.getDocumentationUrlForDiagnosticRule(i);e&&(r.codeDescription={href:e})}const s=e.getRelatedInfo();s.length>0&&(r.relatedInformation=s.filter((e=>!this.fs.isInZipOrEgg(e.filePath))).map((e=>ot.DiagnosticRelatedInformation.create(ot.Location.create(Ee(this.fs,e.filePath),e.range),e.message)))),t.push(r)})),t}recordUserInteractionTime(){this._workspaceMap.forEach((e=>{e.serviceInstance.recordUserInteractionTime()}))}getDocumentationUrlForDiagnosticRule(e){return"https://github.com/microsoft/pyright/blob/main/docs/configuration.md"}expandPathVariables(e,t){return t.replace(/\$\{(.*?)\}/g,((t,n)=>{const i=n.trim();return"workspaceFolder"===i?e:"env:HOME"===i&&void 0!=={}.HOME?{}.HOME:"env:USERNAME"===i&&void 0!=={}.USERNAME?{}.USERNAME:"env:VIRTUAL_ENV"===i&&void 0!=={}.VIRTUAL_ENV?{}.VIRTUAL_ENV:t}))}}{constructor(e){const t=__webpack_require__(306).i8||"",n=__webpack_require__.g.__rootDirectory||"/",i=new qn(e.console),r=new Sd,s=nt;super({productName:"Pyright",rootDirectory:n,version:t,workspaceMap:r,fileSystem:new rd(!1,{cwd:X("/")}),fileWatcherProvider:s,cancellationProvider:new pt,maxAnalysisTimeInForeground:Cd,supportedCodeActions:[xd.CodeActionKind.QuickFix,xd.CodeActionKind.SourceOrganizeImports]},e,i),this._controller=new bp(this)}setupConnection(e,t){super.setupConnection(e,t),this._connection.onNotification("pyright/createFile",(e=>{const t=this._uriParser.decodeTextDocumentUri(e.uri);this._serverOptions.fileSystem.apply({[t]:""}),this._workspaceMap.forEach((t=>{const n=t.serviceInstance.backgroundAnalysisProgram.backgroundAnalysis;null==n||n.createFile(e),t.serviceInstance.invalidateAndForceReanalysis()}))})),this._connection.onNotification("pyright/deleteFile",(e=>{const t=this._uriParser.decodeTextDocumentUri(e.uri);this._serverOptions.fileSystem.unlinkSync(t),this._workspaceMap.forEach((t=>{const n=t.serviceInstance.backgroundAnalysisProgram.backgroundAnalysis;null==n||n.deleteFile(e),t.serviceInstance.invalidateAndForceReanalysis()}))})),this._connection.onRequest(Sn,(e=>{var t;return this._workspaceMap.getWorkspaceForFile(this,e.path).serviceInstance.getApiDocs(e.modules,null!==(t=e.documentationFormat)&&void 0!==t?t:[xd.MarkupKind.PlainText])}))}async initialize(e,t,n){const{files:i}=e.initializationOptions;return"object"==typeof i&&(this._initialFiles=i,this._serverOptions.fileSystem.apply(i)),super.initialize(e,t,n)}async getSettings(e){const t={watchForSourceChanges:!1,watchForLibraryChanges:!1,watchForConfigChanges:!1,openFilesOnly:!0,useLibraryCodeForTypes:!1,disableLanguageServices:!1,disableOrganizeImports:!1,typeCheckingMode:"basic",diagnosticSeverityOverrides:{},logLevel:On.Info,autoImportCompletions:!0};try{const n=await this.getConfiguration(e.rootUri,"python");if(n){const i=n.pythonPath;i&&r(i)&&!gn(i)&&(t.pythonPath=ee(e.rootPath,this.expandPathVariables(e.rootPath,i)));const s=n.venvPath;s&&r(s)&&(t.venvPath=ee(e.rootPath,this.expandPathVariables(e.rootPath,s)))}const i=await this.getConfiguration(e.rootUri,"python.analysis");if(i){const n=i.typeshedPaths;if(n&&Array.isArray(n)&&n.length>0){const i=n[0];i&&r(i)&&(t.typeshedPath=ee(e.rootPath,this.expandPathVariables(e.rootPath,i)))}const s=i.stubPath;s&&r(s)&&(t.stubPath=ee(e.rootPath,this.expandPathVariables(e.rootPath,s)));const o=i.diagnosticSeverityOverrides;if(o)for(const[e,n]of Object.entries(o)){const i=this.getDiagnosticRuleName(e),r=this.getSeverityOverrides(n);i&&r&&(t.diagnosticSeverityOverrides[i]=r)}void 0!==i.diagnosticMode?t.openFilesOnly=this.isOpenFilesOnly(i.diagnosticMode):void 0!==i.openFilesOnly&&(t.openFilesOnly=!!i.openFilesOnly),void 0!==i.useLibraryCodeForTypes&&(t.useLibraryCodeForTypes=!!i.useLibraryCodeForTypes),t.logLevel=this.convertLogLevel(i.logLevel),t.autoSearchPaths=!!i.autoSearchPaths;const a=i.extraPaths;a&&Array.isArray(a)&&a.length>0&&(t.extraPaths=a.filter((e=>e&&r(e))).map((t=>ee(e.rootPath,this.expandPathVariables(e.rootPath,t))))),void 0!==i.typeCheckingMode&&(t.typeCheckingMode=i.typeCheckingMode),void 0!==i.autoImportCompletions&&(t.autoImportCompletions=i.autoImportCompletions),t.logLevel===On.Log&&void 0!==i.logTypeEvaluationTime&&(t.logTypeEvaluationTime=i.logTypeEvaluationTime),void 0!==i.typeEvaluationTimeThreshold&&(t.typeEvaluationTimeThreshold=i.typeEvaluationTimeThreshold)}else t.autoSearchPaths=!0;const s=await this.getConfiguration(e.rootUri,"pyright");if(s){void 0!==s.openFilesOnly&&(t.openFilesOnly=!!s.openFilesOnly),void 0!==s.useLibraryCodeForTypes&&(t.useLibraryCodeForTypes=!!s.useLibraryCodeForTypes),t.disableLanguageServices=!!s.disableLanguageServices,t.disableOrganizeImports=!!s.disableOrganizeImports;const e=s.typeCheckingMode;e&&r(e)&&(t.typeCheckingMode=e)}}catch(e){this.console.error(`Error reading settings: ${e}`)}return t}createBackgroundAnalysis(){const e=new Ed(this.console,this.diagnosticTextSettings);return this._initialFiles&&e.initializeFileSystem(this._initialFiles),e}createHost(){return new Ip}createImportResolver(e,t,n){return new In(e,t,n)}executeCommand(e,t){return this._controller.execute(e,t)}isLongRunningCommand(e){return this._controller.isLongRunningCommand(e)}async executeCodeAction(e,t){this.recordUserInteractionTime();const n=this._uriParser.decodeTextDocumentUri(e.textDocument.uri),i=await this.getWorkspaceForFile(n);return class{static async getCodeActionsForPosition(e,t,n,i){ct(i);const r=[];if(!e.disableLanguageServices){const s=await e.serviceInstance.getDiagnosticsForRange(t,n,i),o=s.find((e=>{const t=e.getActions();return t&&t.find((e=>"pyright.createtypestub"===e.action))}));if(o){const n=o.getActions().find((e=>"pyright.createtypestub"===e.action));if(n){const i=ot.CodeAction.create(ml.CodeAction.createTypeStubFor().format({moduleName:n.moduleName}),ot.Command.create(ml.CodeAction.createTypeStub(),"pyright.createtypestub",e.rootPath,n.moduleName,t),ot.CodeActionKind.QuickFix);r.push(i)}}const a=s.find((e=>{const t=e.getActions();return t&&t.find((e=>"pyright.addoptionalforparam"===e.action))}));if(a){const n=a.getActions().find((e=>"pyright.addoptionalforparam"===e.action));if(n){const i=e.serviceInstance.getImportResolver().fileSystem,s=ot.CodeAction.create(ml.CodeAction.addOptionalToAnnotation(),ot.Command.create(ml.CodeAction.addOptionalToAnnotation(),"pyright.addoptionalforparam",Ee(i,t),n.offsetOfTypeNode),ot.CodeActionKind.QuickFix);r.push(s)}}}return r}}.getCodeActionsForPosition(i,n,e.range,t)}createProgressReporter(){let e;return{isEnabled:e=>!0,begin:()=>{this.client.hasWindowProgressCapability?(e=this._connection.window.createWorkDoneProgress(),e.then((e=>{e.begin("")})).ignoreErrors()):this._connection.sendNotification("pyright/beginProgress")},report:t=>{e?e.then((e=>{e.report(t)})).ignoreErrors():this._connection.sendNotification("pyright/reportProgress",t)},end:()=>{e?(e.then((e=>{e.done()})).ignoreErrors(),e=void 0):this._connection.sendNotification("pyright/endProgress")}}}}class Ed extends class{constructor(e){this.console=e,this._onAnalysisCompletion=Nn}setup(e){this._worker=e,e.on("message",(e=>this.onMessage(e))),e.on("error",(e=>{this.log(On.Error,`Error occurred on background thread: ${JSON.stringify(e)}`)}))}onMessage(e){switch(e.requestType){case"log":{const t=e.data;this.log(t.level,t.message);break}case"analysisResult":this._onAnalysisCompletion(dp(e.data));break;default:E(`${e.requestType} is not expected`)}}setCompletionCallback(e){this._onAnalysisCompletion=null!=e?e:Nn}initializeFileSystem(e){this.enqueueRequest({requestType:"initializeFileSystem",data:e})}createFile(e){this.enqueueRequest({requestType:"createFile",data:e})}deleteFile(e){this.enqueueRequest({requestType:"deleteFile",data:e})}setImportResolver(e){this.enqueueRequest({requestType:"setImportResolver",data:e.host.kind})}setConfigOptions(e){this.enqueueRequest({requestType:"setConfigOptions",data:e})}setTrackedFiles(e){this.enqueueRequest({requestType:"setTrackedFiles",data:e})}setAllowedThirdPartyImports(e){this.enqueueRequest({requestType:"setAllowedThirdPartyImports",data:e})}ensurePartialStubPackages(e){this.enqueueRequest({requestType:"ensurePartialStubPackages",data:{executionRoot:e}})}setFileOpened(e,t,n,i){this.enqueueRequest({requestType:"setFileOpened",data:{filePath:e,version:t,contents:n,options:i}})}setFileClosed(e){this.enqueueRequest({requestType:"setFileClosed",data:e})}markAllFilesDirty(e,t){this.enqueueRequest({requestType:"markAllFilesDirty",data:{evenIfContentsAreSame:e,indexingNeeded:t}})}markFilesDirty(e,t,n){this.enqueueRequest({requestType:"markFilesDirty",data:{filePaths:e,evenIfContentsAreSame:t,indexingNeeded:n}})}startAnalysis(e,t){this._startOrResumeAnalysis("analyze",e,t)}_startOrResumeAnalysis(e,t,n){const{port1:i,port2:r}=En();i.on("message",(e=>{switch(e.requestType){case"analysisResult":this._onAnalysisCompletion(dp(e.data));break;case"analysisPaused":r.close(),i.close(),this._startOrResumeAnalysis("resumeAnalysis",t,n);break;case"indexResult":{const{path:n,indexResults:i}=e.data;null==t||t.setWorkspaceIndex(n,i);break}case"analysisDone":!function(e){e instanceof cp&&e.dispose()}(n),r.close(),i.close();break;default:E(`${e.requestType} is not expected`)}})),i.start(),r.start();const s=pp(n);this.enqueueRequest({requestType:e,data:s,port:r})}startIndexing(e,t,n,i,r){}refreshIndexing(e,t,n,i){}cancelIndexing(e){}async getDiagnosticsForRange(e,t,n){ct(n);const{port1:i,port2:r}=En();i.start(),r.start();const s=op(i),o=pp(n);this.enqueueRequest({requestType:"getDiagnosticsForRange",data:{filePath:e,range:t,cancellationId:o},port:r});const a=await s;return r.close(),i.close(),hp(a)}async writeTypeStub(e,t,n,i){ct(i);const{port1:r,port2:s}=En(),o=op(r),a=pp(i);this.enqueueRequest({requestType:"writeTypeStub",data:{targetImportPath:e,targetIsSingleFile:t,stubPath:n,cancellationId:a},port:s}),await o,s.close(),r.close()}invalidateAndForceReanalysis(e){this.enqueueRequest({requestType:"invalidateAndForceReanalysis",data:e})}restart(){this.enqueueRequest({requestType:"restart",data:null})}enqueueRequest(e){this._worker&&this._worker.postMessage(e,e.port?[e.port]:void 0)}log(e,t){Vn(this.console,e,t)}}{constructor(e,t){super(e);const n=(i={rootDirectory:__webpack_require__.g.__rootDirectory,cancellationFolderName:void 0,runner:void 0,diagnosticTextSettings:t},wn().createWorker(i));var i;this.setup(n)}}class kd extends class extends class{constructor(e,t){var n;this.parentPort=e,n=t.cancellationFolderName,at=n,__webpack_require__.g.__rootDirectory=t.rootDirectory,this._realFs=this.createRealFileSystem(),this.fs=new rt(this._realFs)}log(e,t){var n;null===(n=this.parentPort)||void 0===n||n.postMessage({requestType:"log",data:{level:e,message:t}})}getConsole(){return{log:e=>{this.log(On.Log,e)},info:e=>{this.log(On.Info,e)},warn:e=>{this.log(On.Warn,e)},error:e=>{this.log(On.Error,e)},level:On.Log}}}{constructor(e,t,n){super(e,t),this._extension=n;const i=t;this.log(On.Info,`Background analysis(${Dn()}) root directory: ${i.rootDirectory}`),this._configOptions=new Ec(i.rootDirectory),this._host=this.createHost(),this._importResolver=this.createImportResolver(this.fs,this._configOptions,this._host);const r=this.getConsole();this._logTracker=new Bn(r,`BG(${Dn()})`),this._program=new rp(this._importResolver,this._configOptions,r,this._extension,this._logTracker)}get program(){return this._program}start(){var e,t,n,i;this.log(On.Info,`Background analysis(${Dn()}) started`),null===(e=this.parentPort)||void 0===e||e.on("message",(e=>this.onMessage(e))),null===(t=this.parentPort)||void 0===t||t.on("error",(e=>E(`failed ${e}`))),null===(n=this.parentPort)||void 0===n||n.on("exit",(e=>{0!==e&&E(`worker stopped with exit code ${e}`)})),null===(i=this.parentPort)||void 0===i||i.start()}onMessage(e){switch(this.log(On.Log,`Background analysis message: ${e.requestType}`),e.requestType){case"initializeFileSystem":this._realFs.apply(e.data);break;case"createFile":{const t=we(this.fs,e.data.uri);this._realFs.apply({[t]:""});break}case"deleteFile":{const t=we(this.fs,e.data.uri);this.fs.unlinkSync(t);break}case"analyze":{const t=e.port,n=up(e.data),i=this.program.getFilesToAnalyzeCount();this._onAnalysisCompletion(t,{diagnostics:[],filesInProgram:this.program.getFileCount(),filesRequiringAnalysis:i,checkingOnlyOpenFiles:this.program.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:0}),this._analyzeOneChunk(t,n,e);break}case"resumeAnalysis":{const t=e.port,n=up(e.data);this._analyzeOneChunk(t,n,e);break}case"getDiagnosticsForRange":sp((()=>{const{filePath:t,range:n,cancellationId:i}=e.data;return ct(up(i)),this.program.getDiagnosticsForRange(t,n)}),e.port);break;case"writeTypeStub":sp((()=>{const{targetImportPath:t,targetIsSingleFile:n,stubPath:i,cancellationId:r}=e.data,s=up(r);Mn(this.program,void 0,this._configOptions,Nn,this.getConsole(),s),this.program.writeTypeStub(t,n,i,s)}),e.port);break;case"setImportResolver":this._importResolver=this.createImportResolver(this.fs,this._configOptions,this.createHost()),this.program.setImportResolver(this._importResolver);break;case"setConfigOptions":this._configOptions=function(e){const t=new Ec(e.projectRoot),n=e=>({wildcardRoot:e.wildcardRoot,regExp:new RegExp(e.regExp.source)});return t.pythonPath=e.pythonPath,t.typeshedPath=e.typeshedPath,t.stubPath=e.stubPath,t.autoExcludeVenv=e.autoExcludeVenv,t.verboseOutput=e.verboseOutput,t.checkOnlyOpenFiles=e.checkOnlyOpenFiles,t.useLibraryCodeForTypes=e.useLibraryCodeForTypes,t.internalTestMode=e.internalTestMode,t.indexGenerationMode=e.indexGenerationMode,t.venvPath=e.venvPath,t.venv=e.venv,t.defaultPythonVersion=e.defaultPythonVersion,t.defaultPythonPlatform=e.defaultPythonPlatform,t.defaultExtraPaths=e.defaultExtraPaths,t.diagnosticRuleSet=e.diagnosticRuleSet,t.executionEnvironments=e.executionEnvironments,t.autoImportCompletions=e.autoImportCompletions,t.indexing=e.indexing,t.logTypeEvaluationTime=e.logTypeEvaluationTime,t.typeEvaluationTimeThreshold=e.typeEvaluationTimeThreshold,t.include=e.include.map((e=>n(e))),t.exclude=e.exclude.map((e=>n(e))),t.ignore=e.ignore.map((e=>n(e))),t.strict=e.strict.map((e=>n(e))),t}(e.data),this._importResolver=this.createImportResolver(this.fs,this._configOptions,this._host),this.program.setConfigOptions(this._configOptions),this.program.setImportResolver(this._importResolver);break;case"setTrackedFiles":{const t=this.program.setTrackedFiles(e.data);this._reportDiagnostics(t,this.program.getFilesToAnalyzeCount(),0);break}case"setAllowedThirdPartyImports":this.program.setAllowedThirdPartyImports(e.data);break;case"ensurePartialStubPackages":{const{executionRoot:t}=e.data,n=this._configOptions.getExecutionEnvironments().find((e=>e.root===t));n&&this._importResolver.ensurePartialStubPackages(n);break}case"setFileOpened":{const{filePath:t,version:n,contents:i,options:r}=e.data;this.program.setFileOpened(t,n,i,r);break}case"setFileClosed":{const t=this.program.setFileClosed(e.data);this._reportDiagnostics(t,this.program.getFilesToAnalyzeCount(),0);break}case"markAllFilesDirty":{const{evenIfContentsAreSame:t,indexingNeeded:n}=e.data;this.program.markAllFilesDirty(t,n);break}case"markFilesDirty":{const{filePaths:t,evenIfContentsAreSame:n,indexingNeeded:i}=e.data;this.program.markFilesDirty(t,n,i);break}case"invalidateAndForceReanalysis":this._importResolver.invalidateCache(),this.program.markAllFilesDirty(!0,e.data);break;case"restart":this._importResolver=this.createImportResolver(this.fs,this._configOptions,this._host),this.program.setImportResolver(this._importResolver);break;default:E(`${e.requestType} is not expected`)}}_analyzeOneChunk(e,t,n){Mn(this.program,{openFilesTimeInMs:50,noOpenFilesTimeInMs:200},this._configOptions,(t=>this._onAnalysisCompletion(e,t)),this.getConsole(),t)?this._analysisPaused(e,n.data):(this.processIndexing(e,t),this.analysisDone(e,n.data))}processIndexing(e,t){}reportIndex(e,t){e.postMessage({requestType:"indexResult",data:t})}_reportDiagnostics(e,t,n){this.parentPort&&this._onAnalysisCompletion(this.parentPort,{diagnostics:e,filesInProgram:this.program.getFileCount(),filesRequiringAnalysis:t,checkingOnlyOpenFiles:this.program.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:n})}_onAnalysisCompletion(e,t){e.postMessage({requestType:"analysisResult",data:t})}_analysisPaused(e,t){e.postMessage({requestType:"analysisPaused",data:t})}analysisDone(e,t){e.postMessage({requestType:"analysisDone",data:t})}}{constructor(e){super(kn(),e)}createRealFileSystem(){return new rd(!1,{cwd:X("/")})}createHost(){return new Ip}createImportResolver(e,t,n){return new In(e,t,n)}}class Dd{constructor(e){this._parentPort=e}threadId(){return self.name}parentPort(){return this._parentPort?new Ad(this._parentPort):null}createWorker(e){const t=new globalThis.MessageChannel;return self.postMessage({type:"browser/newWorker",initialData:e,port:t.port1},[t.port1]),t.port1.start(),t.port2.start(),new Ad(t.port2)}createMessageChannel(){const e=new globalThis.MessageChannel;return{port1:new Ad(e.port1),port2:new Ad(e.port2)}}}class Ad{constructor(e){this.delegate=e}unwrap(){return this.delegate}postMessage(e,t){t?this.delegate.postMessage(Pd(e),Pd(t)):this.delegate.postMessage(e)}on(e,t){"message"===e&&this.delegate.addEventListener(e,(e=>{const n=e.data;t(An(n,(e=>e instanceof globalThis.MessagePort?new Ad(e):e)))}))}start(){this.delegate.start()}close(){this.delegate.close()}}function Pd(e){return An(e,(e=>e instanceof Ad?e.unwrap():e))}const Rd=self;Rd.addEventListener("message",(async t=>{if("browser/boot"===t.data.type){const n=t.data,{mode:i,port:r,initialData:s}=n;try{if("foreground"===i)Cn(new Dd),Rd.app=new wd((0,e.createConnection)(new e.BrowserMessageReader(Rd),new e.BrowserMessageWriter(Rd)));else{if("background"!==i)throw new Error(`Invalid "mode" boot parameter: ${i}`);if(!s)throw new Error('Missing "initialData" background boot parameter.');if(!(r instanceof MessagePort))throw new Error(`Invalid "port" parameter: ${r}`);Cn(new Dd(r)),await dl(s.diagnosticTextSettings),Rd.app=new kd(s),Rd.app.start()}}catch(t){throw Rd.close(),t}}}))})()})();
//# sourceMappingURL=pyright-main-9de05813f9fe07eabc93.worker.js.map