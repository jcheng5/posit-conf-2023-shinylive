// Shinylive 0.1.6.9001
// Copyright 2023 RStudio, PBC
var jt=Object.create;var He=Object.defineProperty;var Wt=Object.getOwnPropertyDescriptor;var Nt=Object.getOwnPropertyNames;var Ft=Object.getPrototypeOf,Bt=Object.prototype.hasOwnProperty;var j=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var qt=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var $t=(e,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Nt(t))!Bt.call(e,o)&&o!==r&&He(e,o,{get:()=>t[o],enumerable:!(s=Wt(t,o))||s.enumerable});return e};var Ht=(e,t,r)=>(r=e!=null?jt(Ft(e)):{},$t(t||!e||!e.__esModule?He(r,"default",{value:e,enumerable:!0}):r,e));var Pt=qt((mn,kt)=>{"use strict";kt.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}});var H=class{constructor(){this._buffer=[];this._resolve=null,this._promise=null,this._notifyAll()}async _wait(){await this._promise}_notifyAll(){this._resolve&&this._resolve(),this._promise=new Promise(t=>this._resolve=t)}async dequeue(){for(;this._buffer.length===0;)await this._wait();return this._buffer.shift()}enqueue(t){this._buffer.push(t),this._notifyAll()}};function ce(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}var Jt=Object.create,it=Object.defineProperty,zt=Object.getOwnPropertyDescriptor,Kt=Object.getOwnPropertyNames,Gt=Object.getPrototypeOf,Xt=Object.prototype.hasOwnProperty,V=(e=>typeof j<"u"?j:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof j<"u"?j:t)[r]}):e)(function(e){if(typeof j<"u")return j.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),A=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Qt=(e,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Kt(t))!Xt.call(e,o)&&o!==r&&it(e,o,{get:()=>t[o],enumerable:!(s=zt(t,o))||s.enumerable});return e},J=(e,t,r)=>(r=e!=null?Jt(Gt(e)):{},Qt(t||!e||!e.__esModule?it(r,"default",{value:e,enumerable:!0}):r,e)),xe=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},P=(e,t,r)=>(xe(e,t,"read from private field"),r?r.call(e):t.get(e)),F=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},Ve=(e,t,r,s)=>(xe(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r);var re=(e,t,r)=>(xe(e,t,"access private method"),r),ne=A(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getUint64=e.getInt64=e.setInt64=e.setUint64=e.UINT32_MAX=void 0,e.UINT32_MAX=4294967295;function t(i,n,l){let p=l/4294967296,d=l;i.setUint32(n,p),i.setUint32(n+4,d)}e.setUint64=t;function r(i,n,l){let p=Math.floor(l/4294967296),d=l;i.setUint32(n,p),i.setUint32(n+4,d)}e.setInt64=r;function s(i,n){let l=i.getInt32(n),p=i.getUint32(n+4);return l*4294967296+p}e.getInt64=s;function o(i,n){let l=i.getUint32(n),p=i.getUint32(n+4);return l*4294967296+p}e.getUint64=o}),ke=A(e=>{"use strict";var t,r,s;Object.defineProperty(e,"__esModule",{value:!0}),e.utf8DecodeTD=e.TEXT_DECODER_THRESHOLD=e.utf8DecodeJs=e.utf8EncodeTE=e.TEXT_ENCODER_THRESHOLD=e.utf8EncodeJs=e.utf8Count=void 0;var o=ne(),i=(typeof process>"u"||((t=process==null?void 0:process.env)===null||t===void 0?void 0:t.TEXT_ENCODING)!=="never")&&typeof TextEncoder<"u"&&typeof TextDecoder<"u";function n(a){let u=a.length,f=0,c=0;for(;c<u;){let g=a.charCodeAt(c++);if(g&4294967168)if(!(g&4294965248))f+=2;else{if(g>=55296&&g<=56319&&c<u){let v=a.charCodeAt(c);(v&64512)===56320&&(++c,g=((g&1023)<<10)+(v&1023)+65536)}g&4294901760?f+=4:f+=3}else{f++;continue}}return f}e.utf8Count=n;function l(a,u,f){let c=a.length,g=f,v=0;for(;v<c;){let E=a.charCodeAt(v++);if(E&4294967168)if(!(E&4294965248))u[g++]=E>>6&31|192;else{if(E>=55296&&E<=56319&&v<c){let R=a.charCodeAt(v);(R&64512)===56320&&(++v,E=((E&1023)<<10)+(R&1023)+65536)}E&4294901760?(u[g++]=E>>18&7|240,u[g++]=E>>12&63|128,u[g++]=E>>6&63|128):(u[g++]=E>>12&15|224,u[g++]=E>>6&63|128)}else{u[g++]=E;continue}u[g++]=E&63|128}}e.utf8EncodeJs=l;var p=i?new TextEncoder:void 0;e.TEXT_ENCODER_THRESHOLD=i?typeof process<"u"&&((r=process==null?void 0:process.env)===null||r===void 0?void 0:r.TEXT_ENCODING)!=="force"?200:0:o.UINT32_MAX;function d(a,u,f){u.set(p.encode(a),f)}function w(a,u,f){p.encodeInto(a,u.subarray(f))}e.utf8EncodeTE=p!=null&&p.encodeInto?w:d;var b=4096;function m(a,u,f){let c=u,g=c+f,v=[],E="";for(;c<g;){let R=a[c++];if(!(R&128))v.push(R);else if((R&224)===192){let S=a[c++]&63;v.push((R&31)<<6|S)}else if((R&240)===224){let S=a[c++]&63,T=a[c++]&63;v.push((R&31)<<12|S<<6|T)}else if((R&248)===240){let S=a[c++]&63,T=a[c++]&63,D=a[c++]&63,O=(R&7)<<18|S<<12|T<<6|D;O>65535&&(O-=65536,v.push(O>>>10&1023|55296),O=56320|O&1023),v.push(O)}else v.push(R);v.length>=b&&(E+=String.fromCharCode(...v),v.length=0)}return v.length>0&&(E+=String.fromCharCode(...v)),E}e.utf8DecodeJs=m;var y=i?new TextDecoder:null;e.TEXT_DECODER_THRESHOLD=i?typeof process<"u"&&((s=process==null?void 0:process.env)===null||s===void 0?void 0:s.TEXT_DECODER)!=="force"?200:0:o.UINT32_MAX;function _(a,u,f){let c=a.subarray(u,u+f);return y.decode(c)}e.utf8DecodeTD=_}),ot=A(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExtData=void 0;var t=class{constructor(r,s){this.type=r,this.data=s}};e.ExtData=t}),Pe=A(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DecodeError=void 0;var t=class extends Error{constructor(r){super(r);let s=Object.create(t.prototype);Object.setPrototypeOf(this,s),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:t.name})}};e.DecodeError=t}),at=A(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.timestampExtension=e.decodeTimestampExtension=e.decodeTimestampToTimeSpec=e.encodeTimestampExtension=e.encodeDateToTimeSpec=e.encodeTimeSpecToTimestamp=e.EXT_TIMESTAMP=void 0;var t=Pe(),r=ne();e.EXT_TIMESTAMP=-1;var s=4294967296-1,o=17179869184-1;function i({sec:w,nsec:b}){if(w>=0&&b>=0&&w<=o)if(b===0&&w<=s){let m=new Uint8Array(4);return new DataView(m.buffer).setUint32(0,w),m}else{let m=w/4294967296,y=w&4294967295,_=new Uint8Array(8),a=new DataView(_.buffer);return a.setUint32(0,b<<2|m&3),a.setUint32(4,y),_}else{let m=new Uint8Array(12),y=new DataView(m.buffer);return y.setUint32(0,b),(0,r.setInt64)(y,4,w),m}}e.encodeTimeSpecToTimestamp=i;function n(w){let b=w.getTime(),m=Math.floor(b/1e3),y=(b-m*1e3)*1e6,_=Math.floor(y/1e9);return{sec:m+_,nsec:y-_*1e9}}e.encodeDateToTimeSpec=n;function l(w){if(w instanceof Date){let b=n(w);return i(b)}else return null}e.encodeTimestampExtension=l;function p(w){let b=new DataView(w.buffer,w.byteOffset,w.byteLength);switch(w.byteLength){case 4:return{sec:b.getUint32(0),nsec:0};case 8:{let m=b.getUint32(0),y=b.getUint32(4),_=(m&3)*4294967296+y,a=m>>>2;return{sec:_,nsec:a}}case 12:{let m=(0,r.getInt64)(b,4),y=b.getUint32(0);return{sec:m,nsec:y}}default:throw new t.DecodeError(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${w.length}`)}}e.decodeTimestampToTimeSpec=p;function d(w){let b=p(w);return new Date(b.sec*1e3+b.nsec/1e6)}e.decodeTimestampExtension=d,e.timestampExtension={type:e.EXT_TIMESTAMP,encode:l,decode:d}}),Se=A(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExtensionCodec=void 0;var t=ot(),r=at(),s=class{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(r.timestampExtension)}register({type:o,encode:i,decode:n}){if(o>=0)this.encoders[o]=i,this.decoders[o]=n;else{let l=1+o;this.builtInEncoders[l]=i,this.builtInDecoders[l]=n}}tryToEncode(o,i){for(let n=0;n<this.builtInEncoders.length;n++){let l=this.builtInEncoders[n];if(l!=null){let p=l(o,i);if(p!=null){let d=-1-n;return new t.ExtData(d,p)}}}for(let n=0;n<this.encoders.length;n++){let l=this.encoders[n];if(l!=null){let p=l(o,i);if(p!=null){let d=n;return new t.ExtData(d,p)}}}return o instanceof t.ExtData?o:null}decode(o,i,n){let l=i<0?this.builtInDecoders[-1-i]:this.decoders[i];return l?l(o,i,n):new t.ExtData(i,o)}};e.ExtensionCodec=s,s.defaultCodec=new s}),lt=A(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createDataView=e.ensureUint8Array=void 0;function t(s){return s instanceof Uint8Array?s:ArrayBuffer.isView(s)?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):s instanceof ArrayBuffer?new Uint8Array(s):Uint8Array.from(s)}e.ensureUint8Array=t;function r(s){if(s instanceof ArrayBuffer)return new DataView(s);let o=t(s);return new DataView(o.buffer,o.byteOffset,o.byteLength)}e.createDataView=r}),ct=A(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Encoder=e.DEFAULT_INITIAL_BUFFER_SIZE=e.DEFAULT_MAX_DEPTH=void 0;var t=ke(),r=Se(),s=ne(),o=lt();e.DEFAULT_MAX_DEPTH=100,e.DEFAULT_INITIAL_BUFFER_SIZE=2048;var i=class{constructor(n=r.ExtensionCodec.defaultCodec,l=void 0,p=e.DEFAULT_MAX_DEPTH,d=e.DEFAULT_INITIAL_BUFFER_SIZE,w=!1,b=!1,m=!1,y=!1){this.extensionCodec=n,this.context=l,this.maxDepth=p,this.initialBufferSize=d,this.sortKeys=w,this.forceFloat32=b,this.ignoreUndefined=m,this.forceIntegerToFloat=y,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}reinitializeState(){this.pos=0}encodeSharedRef(n){return this.reinitializeState(),this.doEncode(n,1),this.bytes.subarray(0,this.pos)}encode(n){return this.reinitializeState(),this.doEncode(n,1),this.bytes.slice(0,this.pos)}doEncode(n,l){if(l>this.maxDepth)throw new Error(`Too deep objects in depth ${l}`);n==null?this.encodeNil():typeof n=="boolean"?this.encodeBoolean(n):typeof n=="number"?this.encodeNumber(n):typeof n=="string"?this.encodeString(n):this.encodeObject(n,l)}ensureBufferSizeToWrite(n){let l=this.pos+n;this.view.byteLength<l&&this.resizeBuffer(l*2)}resizeBuffer(n){let l=new ArrayBuffer(n),p=new Uint8Array(l),d=new DataView(l);p.set(this.bytes),this.view=d,this.bytes=p}encodeNil(){this.writeU8(192)}encodeBoolean(n){n===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(n){Number.isSafeInteger(n)&&!this.forceIntegerToFloat?n>=0?n<128?this.writeU8(n):n<256?(this.writeU8(204),this.writeU8(n)):n<65536?(this.writeU8(205),this.writeU16(n)):n<4294967296?(this.writeU8(206),this.writeU32(n)):(this.writeU8(207),this.writeU64(n)):n>=-32?this.writeU8(224|n+32):n>=-128?(this.writeU8(208),this.writeI8(n)):n>=-32768?(this.writeU8(209),this.writeI16(n)):n>=-2147483648?(this.writeU8(210),this.writeI32(n)):(this.writeU8(211),this.writeI64(n)):this.forceFloat32?(this.writeU8(202),this.writeF32(n)):(this.writeU8(203),this.writeF64(n))}writeStringHeader(n){if(n<32)this.writeU8(160+n);else if(n<256)this.writeU8(217),this.writeU8(n);else if(n<65536)this.writeU8(218),this.writeU16(n);else if(n<4294967296)this.writeU8(219),this.writeU32(n);else throw new Error(`Too long string: ${n} bytes in UTF-8`)}encodeString(n){if(n.length>t.TEXT_ENCODER_THRESHOLD){let l=(0,t.utf8Count)(n);this.ensureBufferSizeToWrite(5+l),this.writeStringHeader(l),(0,t.utf8EncodeTE)(n,this.bytes,this.pos),this.pos+=l}else{let l=(0,t.utf8Count)(n);this.ensureBufferSizeToWrite(5+l),this.writeStringHeader(l),(0,t.utf8EncodeJs)(n,this.bytes,this.pos),this.pos+=l}}encodeObject(n,l){let p=this.extensionCodec.tryToEncode(n,this.context);if(p!=null)this.encodeExtension(p);else if(Array.isArray(n))this.encodeArray(n,l);else if(ArrayBuffer.isView(n))this.encodeBinary(n);else if(typeof n=="object")this.encodeMap(n,l);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(n)}`)}encodeBinary(n){let l=n.byteLength;if(l<256)this.writeU8(196),this.writeU8(l);else if(l<65536)this.writeU8(197),this.writeU16(l);else if(l<4294967296)this.writeU8(198),this.writeU32(l);else throw new Error(`Too large binary: ${l}`);let p=(0,o.ensureUint8Array)(n);this.writeU8a(p)}encodeArray(n,l){let p=n.length;if(p<16)this.writeU8(144+p);else if(p<65536)this.writeU8(220),this.writeU16(p);else if(p<4294967296)this.writeU8(221),this.writeU32(p);else throw new Error(`Too large array: ${p}`);for(let d of n)this.doEncode(d,l+1)}countWithoutUndefined(n,l){let p=0;for(let d of l)n[d]!==void 0&&p++;return p}encodeMap(n,l){let p=Object.keys(n);this.sortKeys&&p.sort();let d=this.ignoreUndefined?this.countWithoutUndefined(n,p):p.length;if(d<16)this.writeU8(128+d);else if(d<65536)this.writeU8(222),this.writeU16(d);else if(d<4294967296)this.writeU8(223),this.writeU32(d);else throw new Error(`Too large map object: ${d}`);for(let w of p){let b=n[w];this.ignoreUndefined&&b===void 0||(this.encodeString(w),this.doEncode(b,l+1))}}encodeExtension(n){let l=n.data.length;if(l===1)this.writeU8(212);else if(l===2)this.writeU8(213);else if(l===4)this.writeU8(214);else if(l===8)this.writeU8(215);else if(l===16)this.writeU8(216);else if(l<256)this.writeU8(199),this.writeU8(l);else if(l<65536)this.writeU8(200),this.writeU16(l);else if(l<4294967296)this.writeU8(201),this.writeU32(l);else throw new Error(`Too large extension object: ${l}`);this.writeI8(n.type),this.writeU8a(n.data)}writeU8(n){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,n),this.pos++}writeU8a(n){let l=n.length;this.ensureBufferSizeToWrite(l),this.bytes.set(n,this.pos),this.pos+=l}writeI8(n){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,n),this.pos++}writeU16(n){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,n),this.pos+=2}writeI16(n){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,n),this.pos+=2}writeU32(n){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,n),this.pos+=4}writeI32(n){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,n),this.pos+=4}writeF32(n){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,n),this.pos+=4}writeF64(n){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,n),this.pos+=8}writeU64(n){this.ensureBufferSizeToWrite(8),(0,s.setUint64)(this.view,this.pos,n),this.pos+=8}writeI64(n){this.ensureBufferSizeToWrite(8),(0,s.setInt64)(this.view,this.pos,n),this.pos+=8}};e.Encoder=i}),Yt=A(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.encode=void 0;var t=ct(),r={};function s(o,i=r){return new t.Encoder(i.extensionCodec,i.context,i.maxDepth,i.initialBufferSize,i.sortKeys,i.forceFloat32,i.ignoreUndefined,i.forceIntegerToFloat).encodeSharedRef(o)}e.encode=s}),Zt=A(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.prettyByte=void 0;function t(r){return`${r<0?"-":""}0x${Math.abs(r).toString(16).padStart(2,"0")}`}e.prettyByte=t}),er=A(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CachedKeyDecoder=void 0;var t=ke(),r=16,s=16,o=class{constructor(i=r,n=s){this.maxKeyLength=i,this.maxLengthPerKey=n,this.hit=0,this.miss=0,this.caches=[];for(let l=0;l<this.maxKeyLength;l++)this.caches.push([])}canBeCached(i){return i>0&&i<=this.maxKeyLength}find(i,n,l){let p=this.caches[l-1];e:for(let d of p){let w=d.bytes;for(let b=0;b<l;b++)if(w[b]!==i[n+b])continue e;return d.str}return null}store(i,n){let l=this.caches[i.length-1],p={bytes:i,str:n};l.length>=this.maxLengthPerKey?l[Math.random()*l.length|0]=p:l.push(p)}decode(i,n,l){let p=this.find(i,n,l);if(p!=null)return this.hit++,p;this.miss++;let d=(0,t.utf8DecodeJs)(i,n,l),w=Uint8Array.prototype.slice.call(i,n,n+l);return this.store(w,d),d}};e.CachedKeyDecoder=o}),Te=A(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Decoder=e.DataViewIndexOutOfBoundsError=void 0;var t=Zt(),r=Se(),s=ne(),o=ke(),i=lt(),n=er(),l=Pe(),p=a=>{let u=typeof a;return u==="string"||u==="number"},d=-1,w=new DataView(new ArrayBuffer(0)),b=new Uint8Array(w.buffer);e.DataViewIndexOutOfBoundsError=(()=>{try{w.getInt8(0)}catch(a){return a.constructor}throw new Error("never reached")})();var m=new e.DataViewIndexOutOfBoundsError("Insufficient data"),y=new n.CachedKeyDecoder,_=class{constructor(a=r.ExtensionCodec.defaultCodec,u=void 0,f=s.UINT32_MAX,c=s.UINT32_MAX,g=s.UINT32_MAX,v=s.UINT32_MAX,E=s.UINT32_MAX,R=y){this.extensionCodec=a,this.context=u,this.maxStrLength=f,this.maxBinLength=c,this.maxArrayLength=g,this.maxMapLength=v,this.maxExtLength=E,this.keyDecoder=R,this.totalPos=0,this.pos=0,this.view=w,this.bytes=b,this.headByte=d,this.stack=[]}reinitializeState(){this.totalPos=0,this.headByte=d,this.stack.length=0}setBuffer(a){this.bytes=(0,i.ensureUint8Array)(a),this.view=(0,i.createDataView)(this.bytes),this.pos=0}appendBuffer(a){if(this.headByte===d&&!this.hasRemaining(1))this.setBuffer(a);else{let u=this.bytes.subarray(this.pos),f=(0,i.ensureUint8Array)(a),c=new Uint8Array(u.length+f.length);c.set(u),c.set(f,u.length),this.setBuffer(c)}}hasRemaining(a){return this.view.byteLength-this.pos>=a}createExtraByteError(a){let{view:u,pos:f}=this;return new RangeError(`Extra ${u.byteLength-f} of ${u.byteLength} byte(s) found at buffer[${a}]`)}decode(a){this.reinitializeState(),this.setBuffer(a);let u=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return u}*decodeMulti(a){for(this.reinitializeState(),this.setBuffer(a);this.hasRemaining(1);)yield this.doDecodeSync()}async decodeAsync(a){let u=!1,f;for await(let E of a){if(u)throw this.createExtraByteError(this.totalPos);this.appendBuffer(E);try{f=this.doDecodeSync(),u=!0}catch(R){if(!(R instanceof e.DataViewIndexOutOfBoundsError))throw R}this.totalPos+=this.pos}if(u){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return f}let{headByte:c,pos:g,totalPos:v}=this;throw new RangeError(`Insufficient data in parsing ${(0,t.prettyByte)(c)} at ${v} (${g} in the current buffer)`)}decodeArrayStream(a){return this.decodeMultiAsync(a,!0)}decodeStream(a){return this.decodeMultiAsync(a,!1)}async*decodeMultiAsync(a,u){let f=u,c=-1;for await(let g of a){if(u&&c===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(g),f&&(c=this.readArraySize(),f=!1,this.complete());try{for(;yield this.doDecodeSync(),--c!==0;);}catch(v){if(!(v instanceof e.DataViewIndexOutOfBoundsError))throw v}this.totalPos+=this.pos}}doDecodeSync(){e:for(;;){let a=this.readHeadByte(),u;if(a>=224)u=a-256;else if(a<192)if(a<128)u=a;else if(a<144){let c=a-128;if(c!==0){this.pushMapState(c),this.complete();continue e}else u={}}else if(a<160){let c=a-144;if(c!==0){this.pushArrayState(c),this.complete();continue e}else u=[]}else{let c=a-160;u=this.decodeUtf8String(c,0)}else if(a===192)u=null;else if(a===194)u=!1;else if(a===195)u=!0;else if(a===202)u=this.readF32();else if(a===203)u=this.readF64();else if(a===204)u=this.readU8();else if(a===205)u=this.readU16();else if(a===206)u=this.readU32();else if(a===207)u=this.readU64();else if(a===208)u=this.readI8();else if(a===209)u=this.readI16();else if(a===210)u=this.readI32();else if(a===211)u=this.readI64();else if(a===217){let c=this.lookU8();u=this.decodeUtf8String(c,1)}else if(a===218){let c=this.lookU16();u=this.decodeUtf8String(c,2)}else if(a===219){let c=this.lookU32();u=this.decodeUtf8String(c,4)}else if(a===220){let c=this.readU16();if(c!==0){this.pushArrayState(c),this.complete();continue e}else u=[]}else if(a===221){let c=this.readU32();if(c!==0){this.pushArrayState(c),this.complete();continue e}else u=[]}else if(a===222){let c=this.readU16();if(c!==0){this.pushMapState(c),this.complete();continue e}else u={}}else if(a===223){let c=this.readU32();if(c!==0){this.pushMapState(c),this.complete();continue e}else u={}}else if(a===196){let c=this.lookU8();u=this.decodeBinary(c,1)}else if(a===197){let c=this.lookU16();u=this.decodeBinary(c,2)}else if(a===198){let c=this.lookU32();u=this.decodeBinary(c,4)}else if(a===212)u=this.decodeExtension(1,0);else if(a===213)u=this.decodeExtension(2,0);else if(a===214)u=this.decodeExtension(4,0);else if(a===215)u=this.decodeExtension(8,0);else if(a===216)u=this.decodeExtension(16,0);else if(a===199){let c=this.lookU8();u=this.decodeExtension(c,1)}else if(a===200){let c=this.lookU16();u=this.decodeExtension(c,2)}else if(a===201){let c=this.lookU32();u=this.decodeExtension(c,4)}else throw new l.DecodeError(`Unrecognized type byte: ${(0,t.prettyByte)(a)}`);this.complete();let f=this.stack;for(;f.length>0;){let c=f[f.length-1];if(c.type===0)if(c.array[c.position]=u,c.position++,c.position===c.size)f.pop(),u=c.array;else continue e;else if(c.type===1){if(!p(u))throw new l.DecodeError("The type of key must be string or number but "+typeof u);if(u==="__proto__")throw new l.DecodeError("The key __proto__ is not allowed");c.key=u,c.type=2;continue e}else if(c.map[c.key]=u,c.readCount++,c.readCount===c.size)f.pop(),u=c.map;else{c.key=null,c.type=1;continue e}}return u}}readHeadByte(){return this.headByte===d&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=d}readArraySize(){let a=this.readHeadByte();switch(a){case 220:return this.readU16();case 221:return this.readU32();default:{if(a<160)return a-144;throw new l.DecodeError(`Unrecognized array type byte: ${(0,t.prettyByte)(a)}`)}}}pushMapState(a){if(a>this.maxMapLength)throw new l.DecodeError(`Max length exceeded: map length (${a}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.push({type:1,size:a,key:null,readCount:0,map:{}})}pushArrayState(a){if(a>this.maxArrayLength)throw new l.DecodeError(`Max length exceeded: array length (${a}) > maxArrayLength (${this.maxArrayLength})`);this.stack.push({type:0,size:a,array:new Array(a),position:0})}decodeUtf8String(a,u){var f;if(a>this.maxStrLength)throw new l.DecodeError(`Max length exceeded: UTF-8 byte length (${a}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+u+a)throw m;let c=this.pos+u,g;return this.stateIsMapKey()&&!((f=this.keyDecoder)===null||f===void 0)&&f.canBeCached(a)?g=this.keyDecoder.decode(this.bytes,c,a):a>o.TEXT_DECODER_THRESHOLD?g=(0,o.utf8DecodeTD)(this.bytes,c,a):g=(0,o.utf8DecodeJs)(this.bytes,c,a),this.pos+=u+a,g}stateIsMapKey(){return this.stack.length>0?this.stack[this.stack.length-1].type===1:!1}decodeBinary(a,u){if(a>this.maxBinLength)throw new l.DecodeError(`Max length exceeded: bin length (${a}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(a+u))throw m;let f=this.pos+u,c=this.bytes.subarray(f,f+a);return this.pos+=u+a,c}decodeExtension(a,u){if(a>this.maxExtLength)throw new l.DecodeError(`Max length exceeded: ext length (${a}) > maxExtLength (${this.maxExtLength})`);let f=this.view.getInt8(this.pos+u),c=this.decodeBinary(a,u+1);return this.extensionCodec.decode(c,f,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){let a=this.view.getUint8(this.pos);return this.pos++,a}readI8(){let a=this.view.getInt8(this.pos);return this.pos++,a}readU16(){let a=this.view.getUint16(this.pos);return this.pos+=2,a}readI16(){let a=this.view.getInt16(this.pos);return this.pos+=2,a}readU32(){let a=this.view.getUint32(this.pos);return this.pos+=4,a}readI32(){let a=this.view.getInt32(this.pos);return this.pos+=4,a}readU64(){let a=(0,s.getUint64)(this.view,this.pos);return this.pos+=8,a}readI64(){let a=(0,s.getInt64)(this.view,this.pos);return this.pos+=8,a}readF32(){let a=this.view.getFloat32(this.pos);return this.pos+=4,a}readF64(){let a=this.view.getFloat64(this.pos);return this.pos+=8,a}};e.Decoder=_}),ut=A(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decodeMulti=e.decode=e.defaultDecodeOptions=void 0;var t=Te();e.defaultDecodeOptions={};function r(o,i=e.defaultDecodeOptions){return new t.Decoder(i.extensionCodec,i.context,i.maxStrLength,i.maxBinLength,i.maxArrayLength,i.maxMapLength,i.maxExtLength).decode(o)}e.decode=r;function s(o,i=e.defaultDecodeOptions){return new t.Decoder(i.extensionCodec,i.context,i.maxStrLength,i.maxBinLength,i.maxArrayLength,i.maxMapLength,i.maxExtLength).decodeMulti(o)}e.decodeMulti=s}),tr=A(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ensureAsyncIterable=e.asyncIterableFromStream=e.isAsyncIterable=void 0;function t(i){return i[Symbol.asyncIterator]!=null}e.isAsyncIterable=t;function r(i){if(i==null)throw new Error("Assertion Failure: value must not be null nor undefined")}async function*s(i){let n=i.getReader();try{for(;;){let{done:l,value:p}=await n.read();if(l)return;r(p),yield p}}finally{n.releaseLock()}}e.asyncIterableFromStream=s;function o(i){return t(i)?i:s(i)}e.ensureAsyncIterable=o}),rr=A(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decodeStream=e.decodeMultiStream=e.decodeArrayStream=e.decodeAsync=void 0;var t=Te(),r=tr(),s=ut();async function o(p,d=s.defaultDecodeOptions){let w=(0,r.ensureAsyncIterable)(p);return new t.Decoder(d.extensionCodec,d.context,d.maxStrLength,d.maxBinLength,d.maxArrayLength,d.maxMapLength,d.maxExtLength).decodeAsync(w)}e.decodeAsync=o;function i(p,d=s.defaultDecodeOptions){let w=(0,r.ensureAsyncIterable)(p);return new t.Decoder(d.extensionCodec,d.context,d.maxStrLength,d.maxBinLength,d.maxArrayLength,d.maxMapLength,d.maxExtLength).decodeArrayStream(w)}e.decodeArrayStream=i;function n(p,d=s.defaultDecodeOptions){let w=(0,r.ensureAsyncIterable)(p);return new t.Decoder(d.extensionCodec,d.context,d.maxStrLength,d.maxBinLength,d.maxArrayLength,d.maxMapLength,d.maxExtLength).decodeStream(w)}e.decodeMultiStream=n;function l(p,d=s.defaultDecodeOptions){return n(p,d)}e.decodeStream=l}),Me=A(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decodeTimestampExtension=e.encodeTimestampExtension=e.decodeTimestampToTimeSpec=e.encodeTimeSpecToTimestamp=e.encodeDateToTimeSpec=e.EXT_TIMESTAMP=e.ExtData=e.ExtensionCodec=e.Encoder=e.DataViewIndexOutOfBoundsError=e.DecodeError=e.Decoder=e.decodeStream=e.decodeMultiStream=e.decodeArrayStream=e.decodeAsync=e.decodeMulti=e.decode=e.encode=void 0;var t=Yt();Object.defineProperty(e,"encode",{enumerable:!0,get:function(){return t.encode}});var r=ut();Object.defineProperty(e,"decode",{enumerable:!0,get:function(){return r.decode}}),Object.defineProperty(e,"decodeMulti",{enumerable:!0,get:function(){return r.decodeMulti}});var s=rr();Object.defineProperty(e,"decodeAsync",{enumerable:!0,get:function(){return s.decodeAsync}}),Object.defineProperty(e,"decodeArrayStream",{enumerable:!0,get:function(){return s.decodeArrayStream}}),Object.defineProperty(e,"decodeMultiStream",{enumerable:!0,get:function(){return s.decodeMultiStream}}),Object.defineProperty(e,"decodeStream",{enumerable:!0,get:function(){return s.decodeStream}});var o=Te();Object.defineProperty(e,"Decoder",{enumerable:!0,get:function(){return o.Decoder}}),Object.defineProperty(e,"DataViewIndexOutOfBoundsError",{enumerable:!0,get:function(){return o.DataViewIndexOutOfBoundsError}});var i=Pe();Object.defineProperty(e,"DecodeError",{enumerable:!0,get:function(){return i.DecodeError}});var n=ct();Object.defineProperty(e,"Encoder",{enumerable:!0,get:function(){return n.Encoder}});var l=Se();Object.defineProperty(e,"ExtensionCodec",{enumerable:!0,get:function(){return l.ExtensionCodec}});var p=ot();Object.defineProperty(e,"ExtData",{enumerable:!0,get:function(){return p.ExtData}});var d=at();Object.defineProperty(e,"EXT_TIMESTAMP",{enumerable:!0,get:function(){return d.EXT_TIMESTAMP}}),Object.defineProperty(e,"encodeDateToTimeSpec",{enumerable:!0,get:function(){return d.encodeDateToTimeSpec}}),Object.defineProperty(e,"encodeTimeSpecToTimestamp",{enumerable:!0,get:function(){return d.encodeTimeSpecToTimestamp}}),Object.defineProperty(e,"decodeTimestampToTimeSpec",{enumerable:!0,get:function(){return d.decodeTimestampToTimeSpec}}),Object.defineProperty(e,"encodeTimestampExtension",{enumerable:!0,get:function(){return d.encodeTimestampExtension}}),Object.defineProperty(e,"decodeTimestampExtension",{enumerable:!0,get:function(){return d.decodeTimestampExtension}})}),Ae=class extends Error{constructor(e){super(e),this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}};var Je=class extends Ae{};var N=typeof process<"u"&&process.release&&process.release.name==="node",ue;if(globalThis.document)ue=e=>new Promise((t,r)=>{let s=document.createElement("script");s.src=e,s.onload=()=>t(),s.onerror=r,document.head.appendChild(s)});else if(globalThis.importScripts)ue=async e=>{try{globalThis.importScripts(e)}catch(t){if(t instanceof TypeError)await Promise.resolve().then(()=>J(V(e)));else throw t}};else if(N)ue=async e=>{let t=(await Promise.resolve().then(()=>J(V("path")))).default;await Promise.resolve().then(()=>J(V(t.resolve(e))))};else throw new Ae("Cannot determine runtime environment");var sr=new WeakMap;function nr(e,t){return sr.set(e,t),e}var xs=J(Me()),ks=new TextEncoder;var ze,Ke,ir,or;ze=new WeakMap,Ke=new WeakMap,ir=new WeakSet,or=function(){P(this,ze).push(new Promise(e=>{P(this,Ke).push(e)}))};function Ge(e,t,r){return ar({type:"response",data:{uuid:e,resp:t}},r)}function ar(e,t){return t&&nr(e,t),e}var lr;lr=new WeakMap;var Ps=J(Me()),Ss=new TextDecoder("utf-8"),cr,ur,dr,pr,hr;cr=new WeakMap,ur=new WeakMap,dr=new WeakMap,pr=new WeakMap,hr=new WeakMap;var Ts=new Int32Array(new ArrayBuffer(4));var h={};function yr(e){Object.keys(e).forEach(t=>h._free(e[t]))}N&&(globalThis.Worker=V("worker_threads").Worker);var fr,mr,gr,de;fr=new WeakMap,mr=new WeakSet,gr=function(e){N?e.on("message",t=>{P(this,de).call(this,e,t)}):e.onmessage=t=>P(this,de).call(this,e,t.data)},de=new WeakMap;var wr,br,vr,_r;wr=new WeakMap,br=new WeakMap,vr=new WeakMap,_r=new WeakMap;var Ms=J(Me());N&&(globalThis.Worker=V("worker_threads").Worker);var pe,he,ye,Er,Rr,Xe,Qe,xr,kr,fe;pe=new WeakMap,he=new WeakMap,ye=new WeakMap,Er=new WeakSet,Rr=async function(e){Ve(this,he,await navigator.serviceWorker.register(e)),await navigator.serviceWorker.ready,window.addEventListener("beforeunload",()=>{var r;(r=P(this,he))==null||r.unregister()});let t=await new Promise(r=>{navigator.serviceWorker.addEventListener("message",function s(o){o.data.type==="registration-successful"&&(navigator.serviceWorker.removeEventListener("message",s),r(o.data.clientId))}),this.activeRegistration().postMessage({type:"register-client-main"})});return navigator.serviceWorker.addEventListener("message",r=>{re(this,Xe,Qe).call(this,r)}),t},Xe=new WeakSet,Qe=async function(e){if(e.data.type==="request"){let t=e.data.data,r=P(this,pe).get(t);if(!r)throw new Je("Request not found during service worker XHR request");switch(P(this,pe).delete(t),r.type){case"read":{let s=await this.inputQueue.get();this.activeRegistration().postMessage({type:"wasm-webr-fetch-response",uuid:t,response:Ge(t,s)});break}case"interrupt":{let s=P(this,ye);this.activeRegistration().postMessage({type:"wasm-webr-fetch-response",uuid:t,response:Ge(t,s)}),this.inputQueue.reset(),Ve(this,ye,!1);break}default:throw new Je(`Unsupported request type '${r.type}'.`)}return}},xr=new WeakSet,kr=function(e){N?e.on("message",t=>{P(this,fe).call(this,e,t)}):e.onmessage=t=>P(this,fe).call(this,e,t.data)},fe=new WeakMap;var Pr,Sr,Tr,Mr,Ar,Ur;Pr=new WeakMap,Sr=new WeakMap,Tr=new WeakMap,Mr=new WeakMap,Ar=new WeakMap,Ur=new WeakMap;N&&(globalThis.Worker=V("worker_threads").Worker);var Ir,Or,Cr,me;Ir=new WeakMap,Or=new WeakSet,Cr=function(e){N?e.on("message",t=>{P(this,me).call(this,e,t)}):e.onmessage=t=>P(this,me).call(this,e,t.data)},me=new WeakMap;var Lr,Dr,jr,Wr,Nr,Fr;Lr=new WeakMap,Dr=new WeakMap,jr=new WeakMap,Wr=new WeakMap,Nr=new WeakMap,Fr=new WeakMap;var Br={Automatic:0,SharedArrayBuffer:1,ServiceWorker:2,PostMessage:3};var qr=N?__dirname+"/":"https://webr.r-wasm.org/v0.2.1/",$r="https://repo.r-wasm.org";var k={null:0,symbol:1,pairlist:2,closure:3,environment:4,promise:5,call:6,special:7,builtin:8,string:9,logical:10,integer:13,double:14,complex:15,character:16,dots:17,any:18,list:19,expression:20,bytecode:21,pointer:22,weakref:23,raw:24,s4:25,new:30,free:31,function:99};function dt(e){return e&&typeof e=="object"&&Object.keys(k).includes(e.type)}function pt(e){return e&&typeof e=="object"&&"re"in e&&"im"in e}function ge(e){return h._Rf_protect(W(e)),e}function I(e,t){return h._Rf_protect(W(e)),++t.n,e}function Hr(e){let t=h._malloc(4);return h._R_ProtectWithIndex(W(e),t),{loc:h.getValue(t,"i32"),ptr:t}}function Vr(e){h._Rf_unprotect(1),h._free(e.ptr)}function Jr(e,t){return h._R_Reprotect(W(e),t.loc),e}function C(e){h._Rf_unprotect(e)}function Ye(e,t,r){h._Rf_defineVar(W(t),W(r),W(e))}function zr(e,t){let r={},s={n:0};try{let o=new yt(t);I(o,s),r.code=h.allocateUTF8(e);let i=h._R_ParseEvalString(r.code,o.ptr);return x.wrap(i)}finally{yr(r),C(s.n)}}function ie(e,t){return h.getWasmTableEntry(h.GOT.ffi_safe_eval.value)(W(e),W(t))}function W(e){return Qr(e)?e.ptr:e}function B(e,t){if(h._TYPEOF(e.ptr)!==k[t])throw new Error(`Unexpected object type "${e.type()}" when expecting type "${t}"`)}function Kr(e){if(dt(e))return new(Rt(k[e.type]))(e);if(e&&typeof e=="object"&&"type"in e&&e.type==="null")return new ht;if(e===null)return new Y({type:"logical",names:null,values:[null]});if(typeof e=="boolean")return new Y(e);if(typeof e=="number")return new Oe(e);if(typeof e=="string")return new G(e);if(pt(e))return new Ce(e);if(Array.isArray(e))return Gr(e);throw new Error("Robj construction for this JS object is not yet supported")}function Gr(e){let t={n:0};try{let r=new oe([new K("c"),...e]);return I(r,t),r.eval()}finally{C(t.n)}}var M=class{constructor(e){this.ptr=e}type(){let e=h._TYPEOF(this.ptr);return Object.keys(k).find(t=>k[t]===e)}},Q,se,z=class extends M{constructor(e){if(!(e instanceof M))return Kr(e);super(e.ptr),F(this,Q)}static wrap(e){let t=h._TYPEOF(e);return new(Rt(t))(new M(e))}get[Symbol.toStringTag](){return`RObject:${this.type()}`}static getPersistentObject(e){return U[e]}getPropertyValue(e){return this[e]}inspect(){zr(".Internal(inspect(x))",{x:this})}isNull(){return h._TYPEOF(this.ptr)===k.null}isUnbound(){return this.ptr===U.unboundValue.ptr}attrs(){return Ue.wrap(h._ATTRIB(this.ptr))}setNames(e){let t;if(e===null)t=U.null;else if(Array.isArray(e)&&e.every(r=>typeof r=="string"||r===null))t=new G(e);else throw new Error("Argument to setNames must be null or an Array of strings or null");return h._Rf_setAttrib(this.ptr,U.namesSymbol.ptr,t.ptr),this}names(){let e=G.wrap(h._Rf_getAttrib(this.ptr,U.namesSymbol.ptr));return e.isNull()?null:e.toArray()}includes(e){let t=this.names();return t&&t.includes(e)}toJs(e={depth:0},t=1){throw new Error("This R object cannot be converted to JS")}subset(e){return re(this,Q,se).call(this,e,U.bracketSymbol.ptr)}get(e){return re(this,Q,se).call(this,e,U.bracket2Symbol.ptr)}getDollar(e){return re(this,Q,se).call(this,e,U.dollarSymbol.ptr)}pluck(...e){let t=Hr(U.null);try{let r=(o,i)=>{let n=o.get(i);return Jr(n,t)},s=e.reduce(r,this);return s.isNull()?void 0:s}finally{Vr(t)}}set(e,t){let r={n:0};try{let s=new z(e);I(s,r);let o=new z(t);I(o,r);let i=new K("[[<-"),n=h._Rf_lang4(i.ptr,this.ptr,s.ptr,o.ptr);return I(n,r),z.wrap(ie(n,U.baseEnv))}finally{C(r.n)}}static getMethods(e){let t=new Set,r=e;do Object.getOwnPropertyNames(r).map(s=>t.add(s));while(r=Object.getPrototypeOf(r));return[...t.keys()].filter(s=>typeof e[s]=="function")}},x=z;Q=new WeakSet,se=function(e,t){let r={n:0};try{let s=new z(e);I(s,r);let o=h._Rf_lang3(t,this.ptr,s.ptr);return I(o,r),z.wrap(ie(o,U.baseEnv))}finally{C(r.n)}};var ht=class extends x{constructor(){return super(new M(h.getValue(h._R_NilValue,"*"))),this}toJs(){return{type:"null"}}},K=class extends x{constructor(e){if(e instanceof M){B(e,"symbol"),super(e);return}let t=h.allocateUTF8(e);try{super(new M(h._Rf_install(t)))}finally{h._free(t)}}toJs(){let e=this.toObject();return{type:"symbol",printname:e.printname,symvalue:e.symvalue,internal:e.internal}}toObject(){return{printname:this.printname().isUnbound()?null:this.printname().toString(),symvalue:this.symvalue().isUnbound()?null:this.symvalue().ptr,internal:this.internal().isNull()?null:this.internal().ptr}}toString(){return this.printname().toString()}printname(){return Ie.wrap(h._PRINTNAME(this.ptr))}symvalue(){return x.wrap(h._SYMVALUE(this.ptr))}internal(){return x.wrap(h._INTERNAL(this.ptr))}},Ue=class extends x{constructor(e){if(e instanceof M)return B(e,"pairlist"),super(e),this;let t={n:0};try{let{names:r,values:s}=Z(e),o=Ue.wrap(h._Rf_allocList(s.length));I(o,t);for(let[i,n]=[0,o];!n.isNull();[i,n]=[i+1,n.cdr()])n.setcar(new x(s[i]));o.setNames(r),super(o)}finally{C(t.n)}}get length(){return this.toArray().length}toArray(e={depth:1}){return this.toJs(e).values}toObject({allowDuplicateKey:e=!0,allowEmptyKey:t=!1,depth:r=1}={}){let s=this.entries({depth:r}),o=s.map(([i,n])=>i);if(!e&&new Set(o).size!==o.length)throw new Error("Duplicate key when converting pairlist without allowDuplicateKey enabled");if(!t&&o.some(i=>!i))throw new Error("Empty or null key when converting pairlist without allowEmptyKey enabled");return Object.fromEntries(s.filter((i,n)=>s.findIndex(l=>l[0]===i[0])===n))}entries(e={depth:1}){let t=this.toJs(e);return t.values.map((r,s)=>[t.names?t.names[s]:null,r])}toJs(e={depth:0},t=1){let r=[],s=!1,o=[];for(let i=this;!i.isNull();i=i.cdr()){let n=i.tag();n.isNull()?r.push(""):(s=!0,r.push(n.toString())),e.depth&&t>=e.depth?o.push(i.car()):o.push(i.car().toJs(e,t+1))}return{type:"pairlist",names:s?r:null,values:o}}includes(e){return e in this.toObject()}setcar(e){h._SETCAR(this.ptr,e.ptr)}car(){return x.wrap(h._CAR(this.ptr))}cdr(){return x.wrap(h._CDR(this.ptr))}tag(){return x.wrap(h._TAG(this.ptr))}},oe=class extends x{constructor(e){if(e instanceof M)return B(e,"call"),super(e),this;let t={n:0};try{let{values:r}=Z(e),s=r.map(i=>I(new x(i),t)),o=oe.wrap(h._Rf_allocVector(k.call,r.length));I(o,t);for(let[i,n]=[0,o];!n.isNull();[i,n]=[i+1,n.cdr()])n.setcar(s[i]);super(o)}finally{C(t.n)}}setcar(e){h._SETCAR(this.ptr,e.ptr)}car(){return x.wrap(h._CAR(this.ptr))}cdr(){return x.wrap(h._CDR(this.ptr))}eval(){return x.wrap(ie(this.ptr,U.baseEnv))}},Xr=class extends x{constructor(e){if(e instanceof M)return B(e,"list"),super(e),this;let t={n:0};try{let{names:r,values:s}=Z(e),o=h._Rf_allocVector(k.list,s.length);I(o,t),s.forEach((i,n)=>{h._SET_VECTOR_ELT(o,n,new x(i).ptr)}),x.wrap(o).setNames(r),super(new M(o))}finally{C(t.n)}}get length(){return h._LENGTH(this.ptr)}toArray(e={depth:1}){return this.toJs(e).values}toObject({allowDuplicateKey:e=!0,allowEmptyKey:t=!1,depth:r=1}={}){let s=this.entries({depth:r}),o=s.map(([i,n])=>i);if(!e&&new Set(o).size!==o.length)throw new Error("Duplicate key when converting list without allowDuplicateKey enabled");if(!t&&o.some(i=>!i))throw new Error("Empty or null key when converting list without allowEmptyKey enabled");return Object.fromEntries(s.filter((i,n)=>s.findIndex(l=>l[0]===i[0])===n))}entries(e={depth:1}){let t=this.toJs(e);return t.values.map((r,s)=>[t.names?t.names[s]:null,r])}toJs(e={depth:0},t=1){return{type:"list",names:this.names(),values:[...Array(this.length).keys()].map(r=>e.depth&&t>=e.depth?this.get(r+1):this.get(r+1).toJs(e,t+1))}}},te=class extends x{exec(...e){let t={n:0};try{let r=new oe([this,...e]);return I(r,t),r.eval()}finally{C(t.n)}}},Ie=class extends x{constructor(e){if(e instanceof M){B(e,"string"),super(e);return}let t=h.allocateUTF8(e);try{super(new M(h._Rf_mkChar(t)))}finally{h._free(t)}}toString(){return h.UTF8ToString(h._R_CHAR(this.ptr))}toJs(){return{type:"string",value:this.toString()}}},yt=class extends x{constructor(e={}){if(e instanceof M)return B(e,"environment"),super(e),this;let t=0;try{let{names:r,values:s}=Z(e),o=ge(h._R_NewEnv(U.globalEnv.ptr,0,0));++t,s.forEach((i,n)=>{let l=r?r[n]:null;if(!l)throw new Error("Can't create object in new environment with empty symbol name");let p=new K(l),d=ge(new x(i));try{Ye(o,p,d)}finally{C(1)}}),super(new M(o))}finally{C(t)}}ls(e=!1,t=!0){return G.wrap(h._R_lsInternal3(this.ptr,Number(e),Number(t))).toArray()}bind(e,t){let r=new K(e),s=ge(new x(t));try{Ye(this,r,s)}finally{C(1)}}names(){return this.ls(!0,!0)}frame(){return x.wrap(h._FRAME(this.ptr))}subset(e){if(typeof e=="number")throw new Error("Object of type environment is not subsettable");return this.getDollar(e)}toObject({depth:e=0}={}){let t=this.names();return Object.fromEntries([...Array(t.length).keys()].map(r=>[t[r],this.getDollar(t[r]).toJs({depth:e})]))}toJs(e={depth:0},t=1){let r=this.names(),s=[...Array(r.length).keys()].map(o=>e.depth&&t>=e.depth?this.getDollar(r[o]):this.getDollar(r[o]).toJs(e,t+1));return{type:"environment",names:r,values:s}}},X=class extends x{constructor(e,t,r){if(e instanceof M)return B(e,t),super(e),this;let s={n:0};try{let{names:o,values:i}=Z(e),n=h._Rf_allocVector(k[t],i.length);I(n,s),i.forEach(r(n)),x.wrap(n).setNames(o),super(new M(n))}finally{C(s.n)}}get length(){return h._LENGTH(this.ptr)}get(e){return super.get(e)}subset(e){return super.subset(e)}getDollar(e){throw new Error("$ operator is invalid for atomic vectors")}detectMissing(){let e={n:0};try{let t=h._Rf_lang2(new K("is.na").ptr,this.ptr);I(t,e);let r=Y.wrap(ie(t,U.baseEnv));I(r,e);let s=r.toTypedArray();return Array.from(s).map(o=>!!o)}finally{C(e.n)}}toArray(){let e=this.toTypedArray();return this.detectMissing().map((t,r)=>t?null:e[r])}toObject({allowDuplicateKey:e=!0,allowEmptyKey:t=!1}={}){let r=this.entries(),s=r.map(([o,i])=>o);if(!e&&new Set(s).size!==s.length)throw new Error("Duplicate key when converting atomic vector without allowDuplicateKey enabled");if(!t&&s.some(o=>!o))throw new Error("Empty or null key when converting atomic vector without allowEmptyKey enabled");return Object.fromEntries(r.filter((o,i)=>r.findIndex(n=>n[0]===o[0])===i))}entries(){let e=this.toArray(),t=this.names();return e.map((r,s)=>[t?t[s]:null,r])}toJs(){return{type:this.type(),names:this.names(),values:this.toArray()}}},we,ft=class extends X{constructor(e){super(e,"logical",P(ft,we))}getBoolean(e){return this.get(e).toArray()[0]}toBoolean(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getBoolean(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS boolean");return e}toTypedArray(){return new Int32Array(h.HEAP32.subarray(h._LOGICAL(this.ptr)/4,h._LOGICAL(this.ptr)/4+this.length))}toArray(){let e=this.toTypedArray();return this.detectMissing().map((t,r)=>t?null:!!e[r])}},Y=ft;we=new WeakMap,F(Y,we,e=>{let t=h._LOGICAL(e),r=h.getValue(h._R_NaInt,"i32");return(s,o)=>{h.setValue(t+4*o,s===null?r:!!s,"i32")}});var be,mt=class extends X{constructor(e){super(e,"integer",P(mt,be))}getNumber(e){return this.get(e).toArray()[0]}toNumber(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getNumber(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS number");return e}toTypedArray(){return new Int32Array(h.HEAP32.subarray(h._INTEGER(this.ptr)/4,h._INTEGER(this.ptr)/4+this.length))}},gt=mt;be=new WeakMap,F(gt,be,e=>{let t=h._INTEGER(e),r=h.getValue(h._R_NaInt,"i32");return(s,o)=>{h.setValue(t+4*o,s===null?r:Math.round(Number(s)),"i32")}});var ve,wt=class extends X{constructor(e){super(e,"double",P(wt,ve))}getNumber(e){return this.get(e).toArray()[0]}toNumber(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getNumber(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS number");return e}toTypedArray(){return new Float64Array(h.HEAPF64.subarray(h._REAL(this.ptr)/8,h._REAL(this.ptr)/8+this.length))}},Oe=wt;ve=new WeakMap,F(Oe,ve,e=>{let t=h._REAL(e),r=h.getValue(h._R_NaReal,"double");return(s,o)=>{h.setValue(t+8*o,s===null?r:s,"double")}});var _e,bt=class extends X{constructor(e){super(e,"complex",P(bt,_e))}getComplex(e){return this.get(e).toArray()[0]}toComplex(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getComplex(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS object");return e}toTypedArray(){return new Float64Array(h.HEAPF64.subarray(h._COMPLEX(this.ptr)/8,h._COMPLEX(this.ptr)/8+2*this.length))}toArray(){let e=this.toTypedArray();return this.detectMissing().map((t,r)=>t?null:{re:e[2*r],im:e[2*r+1]})}},Ce=bt;_e=new WeakMap,F(Ce,_e,e=>{let t=h._COMPLEX(e),r=h.getValue(h._R_NaReal,"double");return(s,o)=>{h.setValue(t+8*(2*o),s===null?r:s.re,"double"),h.setValue(t+8*(2*o+1),s===null?r:s.im,"double")}});var Ee,vt=class extends X{constructor(e){super(e,"character",P(vt,Ee))}getString(e){return this.get(e).toArray()[0]}toString(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getString(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS string");return e}toTypedArray(){return new Uint32Array(h.HEAPU32.subarray(h._STRING_PTR(this.ptr)/4,h._STRING_PTR(this.ptr)/4+this.length))}toArray(){return this.detectMissing().map((e,t)=>e?null:h.UTF8ToString(h._R_CHAR(h._STRING_ELT(this.ptr,t))))}},G=vt;Ee=new WeakMap,F(G,Ee,e=>(t,r)=>{t===null?h._SET_STRING_ELT(e,r,U.naString.ptr):h._SET_STRING_ELT(e,r,new Ie(t).ptr)});var Re,_t=class extends X{constructor(e){super(e,"raw",P(_t,Re))}getNumber(e){return this.get(e).toArray()[0]}toNumber(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getNumber(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS number");return e}toTypedArray(){return new Uint8Array(h.HEAPU8.subarray(h._RAW(this.ptr),h._RAW(this.ptr)+this.length))}},Et=_t;Re=new WeakMap,F(Et,Re,e=>{let t=h._RAW(e);return(r,s)=>{h.setValue(t+s,Number(r),"i8")}});function Z(e){return dt(e)?e:Array.isArray(e)||ArrayBuffer.isView(e)?{names:null,values:e}:e&&typeof e=="object"&&!pt(e)?{names:Object.keys(e),values:Object.values(e)}:{names:null,values:[e]}}function Rt(e){let t={[k.null]:ht,[k.symbol]:K,[k.pairlist]:Ue,[k.closure]:te,[k.environment]:yt,[k.call]:oe,[k.special]:te,[k.builtin]:te,[k.string]:Ie,[k.logical]:Y,[k.integer]:gt,[k.double]:Oe,[k.complex]:Ce,[k.character]:G,[k.list]:Xr,[k.raw]:Et,[k.function]:te};return e in t?t[e]:x}function Qr(e){return e instanceof x}var U;var Ze,et,tt,rt,st,Yr,Zr,es,ts,rs,ss,ns;Ze=new WeakMap,et=new WeakMap,tt=new WeakMap,rt=new WeakMap,st=new WeakMap,Yr=new WeakMap,Zr=new WeakMap,es=new WeakMap,ts=new WeakMap,rs=new WeakMap,ss=new WeakSet,ns=async function(){for(;;){let e=await this.webR.read();switch(e.type){case"stdout":P(this,Ze).call(this,e.data);break;case"stderr":P(this,et).call(this,e.data);break;case"prompt":P(this,tt).call(this,e.data);break;case"canvas":e.data.event==="canvasImage"?P(this,rt).call(this,e.data.image):e.data.event==="canvasNewPage"&&P(this,st).call(this);break;case"closed":return;default:console.warn(`Unhandled output type for webR Console: ${e.type}.`)}}};var is={FONTCONFIG_PATH:"/etc/fonts",R_HOME:"/usr/lib/R",R_ENABLE_JIT:"0"},As={RArgs:[],REnv:is,baseUrl:qr,serviceWorkerUrl:"",repoUrl:$r,homedir:"/home/web_user",interactive:!0,channelType:Br.Automatic,createLazyFilesystem:!0},nt,os,as,ls;nt=new WeakMap,os=new WeakMap,as=new WeakSet,ls=async function(){for(;;){let e=await P(this,nt).readSystem();switch(e.type){case"setTimeoutWasm":setTimeout((t,r)=>{this.invokeWasmFunction(t,...r)},e.data.delay,e.data.ptr,e.data.args);break;case"console.log":console.log(e.data);break;case"console.warn":console.warn(e.data);break;case"console.error":console.error(e.data);break;default:throw new Ae("Unknown system message type `"+e.type+"`")}}};var cs,us,ds;cs=new WeakMap,us=new WeakMap,ds=new WeakMap;async function Le(e,t,r,s){let o=s.runPython(`_shiny_app_registry["${t}"].app.call_pyodide`);await ps(e,r,o)}async function ps(e,t,r){let s=new H;t.addEventListener("message",n=>{n.data.type==="http.request"&&s.enqueue({type:"http.request",body:n.data.body,more_body:n.data.more_body})}),t.start();async function o(){return s.dequeue()}async function i(n){if(n=Object.fromEntries(n.toJs()),n.type==="http.response.start")t.postMessage({type:n.type,status:n.status,headers:hs(n.headers)});else if(n.type==="http.response.body")t.postMessage({type:n.type,body:n.body,more_body:n.more_body});else throw new Error(`Unhandled ASGI event: ${n.type}`)}await r(e,o,i)}function hs(e){return e=e.map(([t,r])=>[ce(t),ce(r)]),Object.fromEntries(e)}var ae=class extends EventTarget{constructor(r){super();this.readyState=0,this.addEventListener("open",s=>{this.onopen&&this.onopen(s)}),this.addEventListener("message",s=>{this.onmessage&&this.onmessage(s)}),this.addEventListener("error",s=>{this.onerror&&this.onerror(s)}),this.addEventListener("close",s=>{this.onclose&&this.onclose(s)}),this._port=r,r.addEventListener("message",this._onMessage.bind(this)),r.start()}accept(){this.readyState===0&&(this.readyState=1,this._port.postMessage({type:"open"}))}send(r){if(this.readyState===0)throw new DOMException("Can't send messages while WebSocket is in CONNECTING state","InvalidStateError");this.readyState>1||this._port.postMessage({type:"message",value:{data:r}})}close(r,s){this.readyState>1||(this.readyState=2,this._port.postMessage({type:"close",value:{code:r,reason:s}}),this.readyState=3,this.dispatchEvent(new CloseEvent("close",{code:r,reason:s})))}_onMessage(r){let s=r.data;switch(s.type){case"open":if(this.readyState===0){this.readyState=1,this.dispatchEvent(new Event("open"));return}break;case"message":if(this.readyState===1){this.dispatchEvent(new MessageEvent("message",{...s.value}));return}break;case"close":if(this.readyState<3){this.readyState=3,this.dispatchEvent(new CloseEvent("close",{...s.value}));return}break}this._reportError(`Unexpected event '${s.type}' while in readyState ${this.readyState}`,1002)}_reportError(r,s){this.dispatchEvent(new ErrorEvent("error",{message:r})),typeof s=="number"&&this.close(s,r)}};async function De(e,t,r,s){let o=new ae(r),i=s.runPython(`_shiny_app_registry["${t}"].app.call_pyodide`);await ys(e,o,i)}async function ys(e,t,r){let s={type:"websocket",asgi:{version:"3.0",spec_version:"2.1"},path:e,headers:[]},o=new H;o.enqueue({type:"websocket.connect"});async function i(){return await o.dequeue()}async function n(l){if(l=Object.fromEntries(l.toJs()),l.type==="websocket.accept")t.accept();else if(l.type==="websocket.send")t.send(l.text??l.bytes);else if(l.type==="websocket.close")t.close(l.code,l.reason),o.enqueue({type:"websocket.disconnect"});else throw t.close(1002,"ASGI protocol error"),new Error(`Unhandled ASGI event: ${l.type}`)}t.addEventListener("message",l=>{let p=l,d={type:"websocket.receive"};typeof p.data=="string"?d.text=p.data:d.bytes=p.data,o.enqueue(d)}),t.addEventListener("close",l=>{let p=l;o.enqueue({type:"websocket.disconnect",code:p.code})}),t.addEventListener("error",l=>{console.error(l)}),await r(s,i,n)}function xt(e){let t={message:"An unknown error occured",name:e.name};return e instanceof Error&&(t.message=e.message,e.stack&&(t.stack=e.stack)),t}var q,St,je,Tt,fs={exports:{}},Mt={exports:{}};Mt.exports=function(){function e(y){return!isNaN(parseFloat(y))&&isFinite(y)}function t(y){return y.charAt(0).toUpperCase()+y.substring(1)}function r(y){return function(){return this[y]}}var s=["isConstructor","isEval","isNative","isToplevel"],o=["columnNumber","lineNumber"],i=["fileName","functionName","source"],n=["args"],l=["evalOrigin"],p=s.concat(o,i,n,l);function d(y){if(y)for(var _=0;_<p.length;_++)y[p[_]]!==void 0&&this["set"+t(p[_])](y[p[_]])}d.prototype={getArgs:function(){return this.args},setArgs:function(y){if(Object.prototype.toString.call(y)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=y},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(y){if(y instanceof d)this.evalOrigin=y;else{if(!(y instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new d(y)}},toString:function(){var y=this.getFileName()||"",_=this.getLineNumber()||"",a=this.getColumnNumber()||"",u=this.getFunctionName()||"";return this.getIsEval()?y?"[eval] ("+y+":"+_+":"+a+")":"[eval]:"+_+":"+a:u?u+" ("+y+":"+_+":"+a+")":y+":"+_+":"+a}},d.fromString=function(y){var _=y.indexOf("("),a=y.lastIndexOf(")"),u=y.substring(0,_),f=y.substring(_+1,a).split(","),c=y.substring(a+1);if(c.indexOf("@")===0)var g=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(c,""),v=g[1],E=g[2],R=g[3];return new d({functionName:u,args:f||void 0,fileName:v,lineNumber:E||void 0,columnNumber:R||void 0})};for(var w=0;w<s.length;w++)d.prototype["get"+t(s[w])]=r(s[w]),d.prototype["set"+t(s[w])]=function(y){return function(_){this[y]=!!_}}(s[w]);for(var b=0;b<o.length;b++)d.prototype["get"+t(o[b])]=r(o[b]),d.prototype["set"+t(o[b])]=function(y){return function(_){if(!e(_))throw new TypeError(y+" must be a Number");this[y]=Number(_)}}(o[b]);for(var m=0;m<i.length;m++)d.prototype["get"+t(i[m])]=r(i[m]),d.prototype["set"+t(i[m])]=function(y){return function(_){this[y]=String(_)}}(i[m]);return d}();var ms=fs.exports=(q=Mt.exports,St=/(^|@)\S+:\d+/,je=/^\s*at .*(\S+:\d+|\(native\))/m,Tt=/^(eval@)?(\[native code])?$/,{parse:function(e){if(e.stacktrace!==void 0||e["opera#sourceloc"]!==void 0)return this.parseOpera(e);if(e.stack&&e.stack.match(je))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(e.indexOf(":")===-1)return[e];var t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(e){return e.stack.split(`
`).filter(function(t){return!!t.match(je)},this).map(function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var r=t.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),s=r.match(/ (\(.+\)$)/);r=s?r.replace(s[0],""):r;var o=this.extractLocation(s?s[1]:r),i=s&&r||void 0,n=["eval","<anonymous>"].indexOf(o[0])>-1?void 0:o[0];return new q({functionName:i,fileName:n,lineNumber:o[1],columnNumber:o[2],source:t})},this)},parseFFOrSafari:function(e){return e.stack.split(`
`).filter(function(t){return!t.match(Tt)},this).map(function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),t.indexOf("@")===-1&&t.indexOf(":")===-1)return new q({functionName:t});var r=/((.*".+"[^@]*)?[^@]*)(?:@)/,s=t.match(r),o=s&&s[1]?s[1]:void 0,i=this.extractLocation(t.replace(r,""));return new q({functionName:o,fileName:i[0],lineNumber:i[1],columnNumber:i[2],source:t})},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf(`
`)>-1&&e.message.split(`
`).length>e.stacktrace.split(`
`).length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)/i,r=e.message.split(`
`),s=[],o=2,i=r.length;o<i;o+=2){var n=t.exec(r[o]);n&&s.push(new q({fileName:n[2],lineNumber:n[1],source:r[o]}))}return s},parseOpera10:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=e.stacktrace.split(`
`),s=[],o=0,i=r.length;o<i;o+=2){var n=t.exec(r[o]);n&&s.push(new q({functionName:n[3]||void 0,fileName:n[2],lineNumber:n[1],source:r[o]}))}return s},parseOpera11:function(e){return e.stack.split(`
`).filter(function(t){return!!t.match(St)&&!t.match(/^Error created at/)},this).map(function(t){var r,s=t.split("@"),o=this.extractLocation(s.pop()),i=s.shift()||"",n=i.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;i.match(/\(([^)]*)\)/)&&(r=i.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var l=r===void 0||r==="[arguments not available]"?void 0:r.split(",");return new q({functionName:n,args:l,fileName:o[0],lineNumber:o[1],columnNumber:o[2],source:t})},this)}}),ee=typeof process<"u"&&process.release&&process.release.name==="node"&&process.browser===void 0,At,We,Ne,Ut,It,Ot,Fe,Ct,le;if(Ot=ee?function(e,t){return Ne.resolve(t||".",e)}:function(e,t){return t===void 0&&(t=location),new URL(e,t).toString()},ee||(Fe="/"),Ct=ee?async function(e,t){if(e.startsWith("file://")&&(e=e.slice(7)),e.includes("://")){let r=await We(e);if(!r.ok)throw new Error(`Failed to load '${e}': request failed.`);return new Uint8Array(await r.arrayBuffer())}{let r=await It.readFile(e);return new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}}:async function(e,t){let r=new URL(e,location),s=t?{integrity:t}:{},o=await fetch(r,s);if(!o.ok)throw new Error(`Failed to load '${r}': request failed.`);return new Uint8Array(await o.arrayBuffer())},globalThis.document)le=async e=>await import(e);else if(globalThis.importScripts)le=async e=>{try{globalThis.importScripts(e)}catch(t){if(!(t instanceof TypeError))throw t;await import(e)}};else{if(!ee)throw new Error("Cannot determine runtime environment");le=async function(e){e.startsWith("file://")&&(e=e.slice(7)),e.includes("://")?Ut.runInThisContext(await(await We(e)).text()):await import(At.pathToFileURL(e).href)}}function gs(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ws(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=gs(e),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(o){t[o]=e[o]&&function(i){return new Promise(function(n,l){(function(p,d,w,b){Promise.resolve(b).then(function(m){p({value:m,done:w})},d)})(n,l,(i=e[o](i)).done,i.value)})}}}var bs=async e=>{let t=[];await async function s(o){var i,n;try{for(var l,p=ws(o.values());!(l=await p.next()).done;){let d=l.value;t.push(d),d.kind==="directory"&&await s(d)}}catch(d){i={error:d}}finally{try{l&&!l.done&&(n=p.return)&&await n.call(p)}finally{if(i)throw i.error}}}(e);let r=new Map;r.set(".",e);for(let s of t){let o=(await e.resolve(s)).join("/");r.set(o,s)}return r};function vs(e,t){e.runPythonInternal_dict=e._pyodide._base.eval_code("{}"),e.importlib=e.runPythonInternal("import importlib; importlib");let r=e.importlib.import_module;e.sys=r("sys"),e.sys.path.insert(0,t.homedir),e.os=r("os");let s=e.runPythonInternal("import __main__; __main__.__dict__"),o=e.runPythonInternal("import builtins; builtins.__dict__");var i;e.globals=(i=o,new Proxy(s,{get:(p,d)=>d==="get"?w=>{let b=p.get(w);return b===void 0&&(b=i.get(w)),b}:d==="has"?w=>p.has(w)||i.has(w):Reflect.get(p,d)}));let n=e._pyodide._importhook;n.register_js_finder(),n.register_js_module("js",t.jsglobals);let l=e.makePublicAPI();return n.register_js_module("pyodide_js",l),e.pyodide_py=r("pyodide"),e.pyodide_code=r("pyodide.code"),e.pyodide_ffi=r("pyodide.ffi"),e.package_loader=r("pyodide._package_loader"),e.sitepackages=e.package_loader.SITE_PACKAGES.__str__(),e.dsodir=e.package_loader.DSO_DIR.__str__(),e.defaultLdLibraryPath=[e.dsodir,e.sitepackages],e.os.environ.__setitem__("LD_LIBRARY_PATH",e.defaultLdLibraryPath.join(":")),l.pyodide_py=e.pyodide_py,l.globals=e.globals,l}async function Be(e={}){await async function(){if(!ee||(At=(await import("url")).default,It=await import("fs/promises"),We=globalThis.fetch?fetch:(await import("node-fetch")).default,Ut=(await import("vm")).default,Ne=await import("path"),Fe=Ne.sep,typeof j<"u"))return;let m={fs:await import("fs"),crypto:await import("crypto"),ws:await Promise.resolve().then(()=>Ht(Pt())),child_process:await import("child_process")};globalThis.require=function(y){return m[y]}}();let t=e.indexURL||function(){if(typeof __dirname=="string")return __dirname;let m;try{throw new Error}catch(a){m=a}let y=ms.parse(m)[0].fileName,_=y.lastIndexOf(Fe);if(_===-1)throw new Error("Could not extract indexURL path from pyodide module location");return y.slice(0,_)}();t=Ot(t),t.endsWith("/")||(t+="/"),e.indexURL=t;let r={fullStdLib:!1,jsglobals:globalThis,stdin:globalThis.prompt?globalThis.prompt:void 0,homedir:"/home/pyodide",lockFileURL:t+"repodata.json",args:[],_node_mounts:[]},s=Object.assign(r,e),o=Ct(s.indexURL+"pyodide_py.tar"),i=function(){let m={noImageDecoding:!0,noAudioDecoding:!0,noWasmDecoding:!1,preRun:[],quit:(y,_)=>{throw m.exited={status:y,toThrow:_},_}};return m}();i.print=s.stdout,i.printErr=s.stderr,i.preRun.push(()=>{for(let m of s._node_mounts)i.FS.mkdirTree(m),i.FS.mount(i.NODEFS,{root:m},m)}),i.arguments=s.args;let n={config:s};i.API=n,function(m,y){m.preRun.push(function(){try{m.FS.mkdirTree(y)}catch(_){console.error(`Error occurred while making a home directory '${y}':`),console.error(_),console.error("Using '/' for a home directory instead"),y="/"}m.ENV.HOME=y,m.FS.chdir(y)})}(i,s.homedir);let l=new Promise(m=>i.postRun=m);if(i.locateFile=m=>s.indexURL+m,typeof _createPyodideModule!="function"){let m=`${s.indexURL}pyodide.asm.js`;await le(m)}if(await _createPyodideModule(i),await l,i.exited)throw i.exited.toThrow;if(n.version!=="0.22.1")throw new Error(`Pyodide version does not match: '0.22.1' <==> '${n.version}'. If you updated the Pyodide version, make sure you also updated the 'indexURL' parameter passed to loadPyodide.`);i.locateFile=m=>{throw new Error("Didn't expect to load any more file_packager files!")},function(m){let y=m.FS,_=m.FS.filesystems.MEMFS,a=m.PATH,u={DIR_MODE:16895,FILE_MODE:33279,mount:function(f){if(!f.opts.fileSystemHandle)throw new Error("opts.fileSystemHandle is required");return _.mount.apply(null,arguments)},syncfs:async(f,c,g)=>{try{let v=u.getLocalSet(f),E=await u.getRemoteSet(f),R=c?E:v,S=c?v:E;await u.reconcile(f,R,S),g(null)}catch(v){g(v)}},getLocalSet:f=>{let c=Object.create(null);function g(R){return R!=="."&&R!==".."}function v(R){return S=>a.join2(R,S)}let E=y.readdir(f.mountpoint).filter(g).map(v(f.mountpoint));for(;E.length;){let R=E.pop(),S=y.stat(R);y.isDir(S.mode)&&E.push.apply(E,y.readdir(R).filter(g).map(v(R))),c[R]={timestamp:S.mtime,mode:S.mode}}return{type:"local",entries:c}},getRemoteSet:async f=>{let c=Object.create(null),g=await bs(f.opts.fileSystemHandle);for(let[v,E]of g)v!=="."&&(c[a.join2(f.mountpoint,v)]={timestamp:E.kind==="file"?(await E.getFile()).lastModifiedDate:new Date,mode:E.kind==="file"?u.FILE_MODE:u.DIR_MODE});return{type:"remote",entries:c,handles:g}},loadLocalEntry:f=>{let c=y.lookupPath(f).node,g=y.stat(f);if(y.isDir(g.mode))return{timestamp:g.mtime,mode:g.mode};if(y.isFile(g.mode))return c.contents=_.getFileDataAsTypedArray(c),{timestamp:g.mtime,mode:g.mode,contents:c.contents};throw new Error("node type not supported")},storeLocalEntry:(f,c)=>{if(y.isDir(c.mode))y.mkdirTree(f,c.mode);else{if(!y.isFile(c.mode))throw new Error("node type not supported");y.writeFile(f,c.contents,{canOwn:!0})}y.chmod(f,c.mode),y.utime(f,c.timestamp,c.timestamp)},removeLocalEntry:f=>{var c=y.stat(f);y.isDir(c.mode)?y.rmdir(f):y.isFile(c.mode)&&y.unlink(f)},loadRemoteEntry:async f=>{if(f.kind==="file"){let c=await f.getFile();return{contents:new Uint8Array(await c.arrayBuffer()),mode:u.FILE_MODE,timestamp:c.lastModifiedDate}}if(f.kind==="directory")return{mode:u.DIR_MODE,timestamp:new Date};throw new Error("unknown kind: "+f.kind)},storeRemoteEntry:async(f,c,g)=>{let v=f.get(a.dirname(c)),E=y.isFile(g.mode)?await v.getFileHandle(a.basename(c),{create:!0}):await v.getDirectoryHandle(a.basename(c),{create:!0});if(E.kind==="file"){let R=await E.createWritable();await R.write(g.contents),await R.close()}f.set(c,E)},removeRemoteEntry:async(f,c)=>{await f.get(a.dirname(c)).removeEntry(a.basename(c)),f.delete(c)},reconcile:async(f,c,g)=>{let v=0,E=[];Object.keys(c.entries).forEach(function(T){let D=c.entries[T],O=g.entries[T];(!O||y.isFile(D.mode)&&D.timestamp.getTime()>O.timestamp.getTime())&&(E.push(T),v++)}),E.sort();let R=[];if(Object.keys(g.entries).forEach(function(T){c.entries[T]||(R.push(T),v++)}),R.sort().reverse(),!v)return;let S=c.type==="remote"?c.handles:g.handles;for(let T of E){let D=a.normalize(T.replace(f.mountpoint,"/")).substring(1);if(g.type==="local"){let O=S.get(D),Dt=await u.loadRemoteEntry(O);u.storeLocalEntry(T,Dt)}else{let O=u.loadLocalEntry(T);await u.storeRemoteEntry(S,D,O)}}for(let T of R)if(g.type==="local")u.removeLocalEntry(T);else{let D=a.normalize(T.replace(f.mountpoint,"/")).substring(1);await u.removeRemoteEntry(S,D)}}};m.FS.filesystems.NATIVEFS_ASYNC=u}(i);let p=await o;(function(m,y){let _=m.FS.open("/pyodide_py.tar","w");m.FS.write(_,y,0,y.byteLength,void 0,!0),m.FS.close(_);let[a,u]=m.API.rawRun(`
from sys import version_info
pyversion = f"python{version_info.major}.{version_info.minor}"
import shutil
shutil.unpack_archive("/pyodide_py.tar", f"/lib/{pyversion}/")
del shutil
import importlib
importlib.invalidate_caches()
del importlib
`);a&&m.API.fatal_loading_error(`Failed to unpack standard library.
`,u),m.FS.unlink("/pyodide_py.tar")})(i,p);let[d,w]=n.rawRun("import _pyodide_core");d&&i.API.fatal_loading_error(`Failed to import _pyodide_core
`,w);let b=vs(n,s);if(b.version.includes("dev")||n.setCdnUrl(`https://cdn.jsdelivr.net/pyodide/v${b.version}/full/`),await n.packageIndexReady,n._pyodide._importhook.register_module_not_found_hook(n._import_name_to_package_name),n.repodata_info.version!=="0.22.1")throw new Error("Lock file version doesn't match Pyodide version");return n.package_loader.init_loaded_packages(),s.fullStdLib&&await b.loadPackage(n._pyodide._importhook.UNVENDORED_STDLIBS),n.initializeStreams(s.stdin,s.stdout,s.stderr),b}async function Lt(e,t){let r=e.globals.get("repr");e.globals.set("js_pyodide",e);let s=await e.runPythonAsync(`
  import pyodide.console
  import __main__
  pyodide.console.PyodideConsole(__main__.__dict__)
  `),o=s.complete.copy();s.destroy(),t&&e.globals.set("callJS",t);let i=await e.runPythonAsync(`
  def _short_format_last_traceback() -> str:
      import sys
      import traceback
      e = sys.last_value
      found_marker = False
      nframes = 0
      for (frame, _) in traceback.walk_tb(e.__traceback__):
          if frame.f_code.co_filename in ("<console>", "<exec>"):
              found_marker = True
          if found_marker:
              nframes += 1
      return "".join(traceback.format_exception(type(e), e, e.__traceback__, -nframes))

  _short_format_last_traceback
  `);return await e.runPythonAsync("del _short_format_last_traceback"),{repr:r,tabComplete:o,shortFormatLastTraceback:i}}function qe(e,t="none",r,s){return{get value(){return r.isPyProxy(e)?e.toJs():e},get printed_value(){return s(e)},get to_html(){let i;try{i=r.globals.get("_to_html")}catch(l){console.error("Couldn't find _to_html function: ",l),i=p=>({type:"text",value:"Couldn't finding _to_html function."})}return i(e).toJs({dict_converter:Object.fromEntries})},get none(){}}[t]}var $e="none",L;self.stdout_callback=function(e){self.postMessage({type:"nonreply",subtype:"output",stdout:e})};self.stderr_callback=function(e){self.postMessage({type:"nonreply",subtype:"output",stderr:e})};async function _s(e,t){self.postMessage({type:"nonreply",subtype:"callJS",fnName:e.toJs(),args:t.toJs()})}var $;self.onmessage=async function(e){let t=e.data;if(t.type==="openChannel"){let s=e.ports[0];De(t.path,t.appName,s,L);return}else if(t.type==="makeRequest"){let s=e.ports[0];Le(t.scope,t.appName,s,L);return}let r=e.ports[0];try{if(t.type==="init")$e==="none"&&($e="loading",L=await Be({...t.config,stdout:self.stdout_callback,stderr:self.stderr_callback}),$=await Lt(L,_s),$e="loaded"),r.postMessage({type:"reply",subtype:"done"});else if(t.type==="loadPackagesFromImports")await L.loadPackagesFromImports(t.code);else if(t.type==="runPythonAsync"){await L.loadPackagesFromImports(t.code);let s=await L.runPythonAsync(t.code);t.printResult&&s!==void 0&&self.stdout_callback($.repr(s));try{let o=qe(s,t.returnResult,L,$.repr);r.postMessage({type:"reply",subtype:"done",value:o})}finally{L.isPyProxy(s)&&s.destroy()}}else if(t.type==="tabComplete"){let s=$.tabComplete(t.code).toJs()[0];r.postMessage({type:"reply",subtype:"tabCompletions",completions:s})}else if(t.type==="callPyAsync"){let{fnName:s,args:o,kwargs:i}=t,n=L.globals.get(s[0]);for(let d of s.slice(1))n=n[d];let l=n.callKwargs(...o,i),p=await Promise.resolve(l);t.printResult&&p!==void 0&&self.stdout_callback($.repr(p));try{let d=qe(p,t.returnResult,L,$.repr);r.postMessage({type:"reply",subtype:"done",value:d})}finally{L.isPyProxy(p)&&p.destroy()}}else r.postMessage({type:"reply",subtype:"done",error:new Error(`Unknown message type: ${t.toString()}`)})}catch(s){s instanceof L.PythonError&&(s.message=$.shortFormatLastTraceback()),r.postMessage({type:"reply",subtype:"done",error:xt(s)})}};
